(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function t(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(s){if(s.ep)return;s.ep=!0;const c=t(s);fetch(s.href,c)}})();function kv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pd={exports:{}},hc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lp;function dw(){if(Lp)return hc;Lp=1;var e=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function t(i,s,c){var f=null;if(c!==void 0&&(f=""+c),s.key!==void 0&&(f=""+s.key),"key"in s){c={};for(var d in s)d!=="key"&&(c[d]=s[d])}else c=s;return s=c.ref,{$$typeof:e,type:i,key:f,ref:s!==void 0?s:null,props:c}}return hc.Fragment=a,hc.jsx=t,hc.jsxs=t,hc}var Ip;function hw(){return Ip||(Ip=1,pd.exports=dw()),pd.exports}var u=hw(),gd={exports:{}},at={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bp;function mw(){if(Bp)return at;Bp=1;var e=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),f=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),y=Symbol.iterator;function _(A){return A===null||typeof A!="object"?null:(A=y&&A[y]||A["@@iterator"],typeof A=="function"?A:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,T={};function C(A,E,O){this.props=A,this.context=E,this.refs=T,this.updater=O||w}C.prototype.isReactComponent={},C.prototype.setState=function(A,E){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,E,"setState")},C.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function L(){}L.prototype=C.prototype;function N(A,E,O){this.props=A,this.context=E,this.refs=T,this.updater=O||w}var j=N.prototype=new L;j.constructor=N,b(j,C.prototype),j.isPureReactComponent=!0;var V=Array.isArray;function M(){}var k={H:null,A:null,T:null,S:null},W=Object.prototype.hasOwnProperty;function K(A,E,O){var B=O.ref;return{$$typeof:e,type:A,key:E,ref:B!==void 0?B:null,props:O}}function J(A,E){return K(A.type,E,A.props)}function Z(A){return typeof A=="object"&&A!==null&&A.$$typeof===e}function Q(A){var E={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(O){return E[O]})}var re=/\/+/g;function ue(A,E){return typeof A=="object"&&A!==null&&A.key!=null?Q(""+A.key):E.toString(36)}function ve(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(M,M):(A.status="pending",A.then(function(E){A.status==="pending"&&(A.status="fulfilled",A.value=E)},function(E){A.status==="pending"&&(A.status="rejected",A.reason=E)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function ee(A,E,O,B,z){var le=typeof A;(le==="undefined"||le==="boolean")&&(A=null);var ye=!1;if(A===null)ye=!0;else switch(le){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(A.$$typeof){case e:case a:ye=!0;break;case p:return ye=A._init,ee(ye(A._payload),E,O,B,z)}}if(ye)return z=z(A),ye=B===""?"."+ue(A,0):B,V(z)?(O="",ye!=null&&(O=ye.replace(re,"$&/")+"/"),ee(z,E,O,"",function(De){return De})):z!=null&&(Z(z)&&(z=J(z,O+(z.key==null||A&&A.key===z.key?"":(""+z.key).replace(re,"$&/")+"/")+ye)),E.push(z)),1;ye=0;var Ne=B===""?".":B+":";if(V(A))for(var Te=0;Te<A.length;Te++)B=A[Te],le=Ne+ue(B,Te),ye+=ee(B,E,O,le,z);else if(Te=_(A),typeof Te=="function")for(A=Te.call(A),Te=0;!(B=A.next()).done;)B=B.value,le=Ne+ue(B,Te++),ye+=ee(B,E,O,le,z);else if(le==="object"){if(typeof A.then=="function")return ee(ve(A),E,O,B,z);throw E=String(A),Error("Objects are not valid as a React child (found: "+(E==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":E)+"). If you meant to render a collection of children, use an array instead.")}return ye}function G(A,E,O){if(A==null)return A;var B=[],z=0;return ee(A,B,"","",function(le){return E.call(O,le,z++)}),B}function ae(A){if(A._status===-1){var E=A._result;E=E(),E.then(function(O){(A._status===0||A._status===-1)&&(A._status=1,A._result=O)},function(O){(A._status===0||A._status===-1)&&(A._status=2,A._result=O)}),A._status===-1&&(A._status=0,A._result=E)}if(A._status===1)return A._result.default;throw A._result}var R=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var E=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(E))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},se={map:G,forEach:function(A,E,O){G(A,function(){E.apply(this,arguments)},O)},count:function(A){var E=0;return G(A,function(){E++}),E},toArray:function(A){return G(A,function(E){return E})||[]},only:function(A){if(!Z(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return at.Activity=v,at.Children=se,at.Component=C,at.Fragment=t,at.Profiler=s,at.PureComponent=N,at.StrictMode=i,at.Suspense=h,at.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,at.__COMPILER_RUNTIME={__proto__:null,c:function(A){return k.H.useMemoCache(A)}},at.cache=function(A){return function(){return A.apply(null,arguments)}},at.cacheSignal=function(){return null},at.cloneElement=function(A,E,O){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var B=b({},A.props),z=A.key;if(E!=null)for(le in E.key!==void 0&&(z=""+E.key),E)!W.call(E,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&E.ref===void 0||(B[le]=E[le]);var le=arguments.length-2;if(le===1)B.children=O;else if(1<le){for(var ye=Array(le),Ne=0;Ne<le;Ne++)ye[Ne]=arguments[Ne+2];B.children=ye}return K(A.type,z,B)},at.createContext=function(A){return A={$$typeof:f,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:c,_context:A},A},at.createElement=function(A,E,O){var B,z={},le=null;if(E!=null)for(B in E.key!==void 0&&(le=""+E.key),E)W.call(E,B)&&B!=="key"&&B!=="__self"&&B!=="__source"&&(z[B]=E[B]);var ye=arguments.length-2;if(ye===1)z.children=O;else if(1<ye){for(var Ne=Array(ye),Te=0;Te<ye;Te++)Ne[Te]=arguments[Te+2];z.children=Ne}if(A&&A.defaultProps)for(B in ye=A.defaultProps,ye)z[B]===void 0&&(z[B]=ye[B]);return K(A,le,z)},at.createRef=function(){return{current:null}},at.forwardRef=function(A){return{$$typeof:d,render:A}},at.isValidElement=Z,at.lazy=function(A){return{$$typeof:p,_payload:{_status:-1,_result:A},_init:ae}},at.memo=function(A,E){return{$$typeof:m,type:A,compare:E===void 0?null:E}},at.startTransition=function(A){var E=k.T,O={};k.T=O;try{var B=A(),z=k.S;z!==null&&z(O,B),typeof B=="object"&&B!==null&&typeof B.then=="function"&&B.then(M,R)}catch(le){R(le)}finally{E!==null&&O.types!==null&&(E.types=O.types),k.T=E}},at.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},at.use=function(A){return k.H.use(A)},at.useActionState=function(A,E,O){return k.H.useActionState(A,E,O)},at.useCallback=function(A,E){return k.H.useCallback(A,E)},at.useContext=function(A){return k.H.useContext(A)},at.useDebugValue=function(){},at.useDeferredValue=function(A,E){return k.H.useDeferredValue(A,E)},at.useEffect=function(A,E){return k.H.useEffect(A,E)},at.useEffectEvent=function(A){return k.H.useEffectEvent(A)},at.useId=function(){return k.H.useId()},at.useImperativeHandle=function(A,E,O){return k.H.useImperativeHandle(A,E,O)},at.useInsertionEffect=function(A,E){return k.H.useInsertionEffect(A,E)},at.useLayoutEffect=function(A,E){return k.H.useLayoutEffect(A,E)},at.useMemo=function(A,E){return k.H.useMemo(A,E)},at.useOptimistic=function(A,E){return k.H.useOptimistic(A,E)},at.useReducer=function(A,E,O){return k.H.useReducer(A,E,O)},at.useRef=function(A){return k.H.useRef(A)},at.useState=function(A){return k.H.useState(A)},at.useSyncExternalStore=function(A,E,O){return k.H.useSyncExternalStore(A,E,O)},at.useTransition=function(){return k.H.useTransition()},at.version="19.2.0",at}var Up;function oh(){return Up||(Up=1,gd.exports=mw()),gd.exports}var ce=oh();const Ia=kv(ce);var vd={exports:{}},mc={},yd={exports:{}},_d={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zp;function xw(){return zp||(zp=1,(function(e){function a(ee,G){var ae=ee.length;ee.push(G);e:for(;0<ae;){var R=ae-1>>>1,se=ee[R];if(0<s(se,G))ee[R]=G,ee[ae]=se,ae=R;else break e}}function t(ee){return ee.length===0?null:ee[0]}function i(ee){if(ee.length===0)return null;var G=ee[0],ae=ee.pop();if(ae!==G){ee[0]=ae;e:for(var R=0,se=ee.length,A=se>>>1;R<A;){var E=2*(R+1)-1,O=ee[E],B=E+1,z=ee[B];if(0>s(O,ae))B<se&&0>s(z,O)?(ee[R]=z,ee[B]=ae,R=B):(ee[R]=O,ee[E]=ae,R=E);else if(B<se&&0>s(z,ae))ee[R]=z,ee[B]=ae,R=B;else break e}}return G}function s(ee,G){var ae=ee.sortIndex-G.sortIndex;return ae!==0?ae:ee.id-G.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var f=Date,d=f.now();e.unstable_now=function(){return f.now()-d}}var h=[],m=[],p=1,v=null,y=3,_=!1,w=!1,b=!1,T=!1,C=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function j(ee){for(var G=t(m);G!==null;){if(G.callback===null)i(m);else if(G.startTime<=ee)i(m),G.sortIndex=G.expirationTime,a(h,G);else break;G=t(m)}}function V(ee){if(b=!1,j(ee),!w)if(t(h)!==null)w=!0,M||(M=!0,Q());else{var G=t(m);G!==null&&ve(V,G.startTime-ee)}}var M=!1,k=-1,W=5,K=-1;function J(){return T?!0:!(e.unstable_now()-K<W)}function Z(){if(T=!1,M){var ee=e.unstable_now();K=ee;var G=!0;try{e:{w=!1,b&&(b=!1,L(k),k=-1),_=!0;var ae=y;try{t:{for(j(ee),v=t(h);v!==null&&!(v.expirationTime>ee&&J());){var R=v.callback;if(typeof R=="function"){v.callback=null,y=v.priorityLevel;var se=R(v.expirationTime<=ee);if(ee=e.unstable_now(),typeof se=="function"){v.callback=se,j(ee),G=!0;break t}v===t(h)&&i(h),j(ee)}else i(h);v=t(h)}if(v!==null)G=!0;else{var A=t(m);A!==null&&ve(V,A.startTime-ee),G=!1}}break e}finally{v=null,y=ae,_=!1}G=void 0}}finally{G?Q():M=!1}}}var Q;if(typeof N=="function")Q=function(){N(Z)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,ue=re.port2;re.port1.onmessage=Z,Q=function(){ue.postMessage(null)}}else Q=function(){C(Z,0)};function ve(ee,G){k=C(function(){ee(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(ee){switch(y){case 1:case 2:case 3:var G=3;break;default:G=y}var ae=y;y=G;try{return ee()}finally{y=ae}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(ee,G){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ae=y;y=ee;try{return G()}finally{y=ae}},e.unstable_scheduleCallback=function(ee,G,ae){var R=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?R+ae:R):ae=R,ee){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=ae+se,ee={id:p++,callback:G,priorityLevel:ee,startTime:ae,expirationTime:se,sortIndex:-1},ae>R?(ee.sortIndex=ae,a(m,ee),t(h)===null&&ee===t(m)&&(b?(L(k),k=-1):b=!0,ve(V,ae-R))):(ee.sortIndex=se,a(h,ee),w||_||(w=!0,M||(M=!0,Q()))),ee},e.unstable_shouldYield=J,e.unstable_wrapCallback=function(ee){var G=y;return function(){var ae=y;y=G;try{return ee.apply(this,arguments)}finally{y=ae}}}})(_d)),_d}var Pp;function pw(){return Pp||(Pp=1,yd.exports=xw()),yd.exports}var bd={exports:{}},za={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hp;function gw(){if(Hp)return za;Hp=1;var e=oh();function a(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(a(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function c(h,m,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:h,containerInfo:m,implementation:p}}var f=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return za.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,za.createPortal=function(h,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return c(h,m,null,p)},za.flushSync=function(h){var m=f.T,p=i.p;try{if(f.T=null,i.p=2,h)return h()}finally{f.T=m,i.p=p,i.d.f()}},za.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(h,m))},za.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},za.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var p=m.as,v=d(p,m.crossOrigin),y=typeof m.integrity=="string"?m.integrity:void 0,_=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?i.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:_}):p==="script"&&i.d.X(h,{crossOrigin:v,integrity:y,fetchPriority:_,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},za.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=d(m.as,m.crossOrigin);i.d.M(h,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(h)},za.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,v=d(p,m.crossOrigin);i.d.L(h,p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},za.preloadModule=function(h,m){if(typeof h=="string")if(m){var p=d(m.as,m.crossOrigin);i.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(h)},za.requestFormReset=function(h){i.d.r(h)},za.unstable_batchedUpdates=function(h,m){return h(m)},za.useFormState=function(h,m,p){return f.H.useFormState(h,m,p)},za.useFormStatus=function(){return f.H.useHostTransitionStatus()},za.version="19.2.0",za}var Vp;function vw(){if(Vp)return bd.exports;Vp=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(a){console.error(a)}}return e(),bd.exports=gw(),bd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gp;function yw(){if(Gp)return mc;Gp=1;var e=pw(),a=oh(),t=vw();function i(r){var n="https://react.dev/errors/"+r;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function c(r){var n=r,l=r;if(r.alternate)for(;n.return;)n=n.return;else{r=n;do n=r,(n.flags&4098)!==0&&(l=n.return),r=n.return;while(r)}return n.tag===3?l:null}function f(r){if(r.tag===13){var n=r.memoizedState;if(n===null&&(r=r.alternate,r!==null&&(n=r.memoizedState)),n!==null)return n.dehydrated}return null}function d(r){if(r.tag===31){var n=r.memoizedState;if(n===null&&(r=r.alternate,r!==null&&(n=r.memoizedState)),n!==null)return n.dehydrated}return null}function h(r){if(c(r)!==r)throw Error(i(188))}function m(r){var n=r.alternate;if(!n){if(n=c(r),n===null)throw Error(i(188));return n!==r?null:r}for(var l=r,o=n;;){var x=l.return;if(x===null)break;var g=x.alternate;if(g===null){if(o=x.return,o!==null){l=o;continue}break}if(x.child===g.child){for(g=x.child;g;){if(g===l)return h(x),r;if(g===o)return h(x),n;g=g.sibling}throw Error(i(188))}if(l.return!==o.return)l=x,o=g;else{for(var S=!1,F=x.child;F;){if(F===l){S=!0,l=x,o=g;break}if(F===o){S=!0,o=x,l=g;break}F=F.sibling}if(!S){for(F=g.child;F;){if(F===l){S=!0,l=g,o=x;break}if(F===o){S=!0,o=g,l=x;break}F=F.sibling}if(!S)throw Error(i(189))}}if(l.alternate!==o)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?r:n}function p(r){var n=r.tag;if(n===5||n===26||n===27||n===6)return r;for(r=r.child;r!==null;){if(n=p(r),n!==null)return n;r=r.sibling}return null}var v=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),L=Symbol.for("react.consumer"),N=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function Q(r){return r===null||typeof r!="object"?null:(r=Z&&r[Z]||r["@@iterator"],typeof r=="function"?r:null)}var re=Symbol.for("react.client.reference");function ue(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===re?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case b:return"Fragment";case C:return"Profiler";case T:return"StrictMode";case V:return"Suspense";case M:return"SuspenseList";case K:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case N:return r.displayName||"Context";case L:return(r._context.displayName||"Context")+".Consumer";case j:var n=r.render;return r=r.displayName,r||(r=n.displayName||n.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case k:return n=r.displayName||null,n!==null?n:ue(r.type)||"Memo";case W:n=r._payload,r=r._init;try{return ue(r(n))}catch{}}return null}var ve=Array.isArray,ee=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},R=[],se=-1;function A(r){return{current:r}}function E(r){0>se||(r.current=R[se],R[se]=null,se--)}function O(r,n){se++,R[se]=r.current,r.current=n}var B=A(null),z=A(null),le=A(null),ye=A(null);function Ne(r,n){switch(O(le,n),O(z,r),O(B,null),n.nodeType){case 9:case 11:r=(r=n.documentElement)&&(r=r.namespaceURI)?ip(r):0;break;default:if(r=n.tagName,n=n.namespaceURI)n=ip(n),r=sp(n,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}E(B),O(B,r)}function Te(){E(B),E(z),E(le)}function De(r){r.memoizedState!==null&&O(ye,r);var n=B.current,l=sp(n,r.type);n!==l&&(O(z,r),O(B,l))}function Ve(r){z.current===r&&(E(B),E(z)),ye.current===r&&(E(ye),oc._currentValue=ae)}var q,ct;function We(r){if(q===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);q=n&&n[1]||"",ct=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+q+r+ct}var tt=!1;function qe(r,n){if(!r||tt)return"";tt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(n){var Ce=function(){throw Error()};if(Object.defineProperty(Ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ce,[])}catch(_e){var ge=_e}Reflect.construct(r,[],Ce)}else{try{Ce.call()}catch(_e){ge=_e}r.call(Ce.prototype)}}else{try{throw Error()}catch(_e){ge=_e}(Ce=r())&&typeof Ce.catch=="function"&&Ce.catch(function(){})}}catch(_e){if(_e&&ge&&typeof _e.stack=="string")return[_e.stack,ge.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=o.DetermineComponentFrameRoot(),S=g[0],F=g[1];if(S&&F){var te=S.split(`
`),xe=F.split(`
`);for(x=o=0;o<te.length&&!te[o].includes("DetermineComponentFrameRoot");)o++;for(;x<xe.length&&!xe[x].includes("DetermineComponentFrameRoot");)x++;if(o===te.length||x===xe.length)for(o=te.length-1,x=xe.length-1;1<=o&&0<=x&&te[o]!==xe[x];)x--;for(;1<=o&&0<=x;o--,x--)if(te[o]!==xe[x]){if(o!==1||x!==1)do if(o--,x--,0>x||te[o]!==xe[x]){var Ee=`
`+te[o].replace(" at new "," at ");return r.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",r.displayName)),Ee}while(1<=o&&0<=x);break}}}finally{tt=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?We(l):""}function Re(r,n){switch(r.tag){case 26:case 27:case 5:return We(r.type);case 16:return We("Lazy");case 13:return r.child!==n&&n!==null?We("Suspense Fallback"):We("Suspense");case 19:return We("SuspenseList");case 0:case 15:return qe(r.type,!1);case 11:return qe(r.type.render,!1);case 1:return qe(r.type,!0);case 31:return We("Activity");default:return""}}function vt(r){try{var n="",l=null;do n+=Re(r,l),l=r,r=r.return;while(r);return n}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var Bt=Object.prototype.hasOwnProperty,Kt=e.unstable_scheduleCallback,Sa=e.unstable_cancelCallback,Ar=e.unstable_shouldYield,ar=e.unstable_requestPaint,bt=e.unstable_now,ya=e.unstable_getCurrentPriorityLevel,Pe=e.unstable_ImmediatePriority,Be=e.unstable_UserBlockingPriority,Ue=e.unstable_NormalPriority,He=e.unstable_LowPriority,Fe=e.unstable_IdlePriority,Je=e.log,mt=e.unstable_setDisableYieldValue,et=null,_t=null;function na(r){if(typeof Je=="function"&&mt(r),_t&&typeof _t.setStrictMode=="function")try{_t.setStrictMode(et,r)}catch{}}var Zt=Math.clz32?Math.clz32:Es,Ii=Math.log,Qn=Math.LN2;function Es(r){return r>>>=0,r===0?32:31-(Ii(r)/Qn|0)|0}var kr=256,Kr=262144,Jn=4194304;function Ea(r){var n=r&42;if(n!==0)return n;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ei(r,n,l){var o=r.pendingLanes;if(o===0)return 0;var x=0,g=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var F=o&134217727;return F!==0?(o=F&~g,o!==0?x=Ea(o):(S&=F,S!==0?x=Ea(S):l||(l=F&~r,l!==0&&(x=Ea(l))))):(F=o&~g,F!==0?x=Ea(F):S!==0?x=Ea(S):l||(l=o&~r,l!==0&&(x=Ea(l)))),x===0?0:n!==0&&n!==x&&(n&g)===0&&(g=x&-x,l=n&-n,g>=l||g===32&&(l&4194048)!==0)?n:x}function Sn(r,n){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&n)===0}function $t(r,n){switch(r){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zr(){var r=Jn;return Jn<<=1,(Jn&62914560)===0&&(Jn=4194304),r}function Bi(r){for(var n=[],l=0;31>l;l++)n.push(r);return n}function on(r,n){r.pendingLanes|=n,n!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Ui(r,n,l,o,x,g){var S=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var F=r.entanglements,te=r.expirationTimes,xe=r.hiddenUpdates;for(l=S&~l;0<l;){var Ee=31-Zt(l),Ce=1<<Ee;F[Ee]=0,te[Ee]=-1;var ge=xe[Ee];if(ge!==null)for(xe[Ee]=null,Ee=0;Ee<ge.length;Ee++){var _e=ge[Ee];_e!==null&&(_e.lane&=-536870913)}l&=~Ce}o!==0&&zi(r,o,0),g!==0&&x===0&&r.tag!==0&&(r.suspendedLanes|=g&~(S&~n))}function zi(r,n,l){r.pendingLanes|=n,r.suspendedLanes&=~n;var o=31-Zt(n);r.entangledLanes|=n,r.entanglements[o]=r.entanglements[o]|1073741824|l&261930}function En(r,n){var l=r.entangledLanes|=n;for(r=r.entanglements;l;){var o=31-Zt(l),x=1<<o;x&n|r[o]&n&&(r[o]|=n),l&=~x}}function Ts(r,n){var l=n&-n;return l=(l&42)!==0?1:Ba(l),(l&(r.suspendedLanes|n))!==0?0:l}function Ba(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function hr(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function D(){var r=G.p;return r!==0?r:(r=window.event,r===void 0?32:Cp(r.type))}function X(r,n){var l=G.p;try{return G.p=r,n()}finally{G.p=l}}var I=Math.random().toString(36).slice(2),U="__reactFiber$"+I,H="__reactProps$"+I,Y="__reactContainer$"+I,he="__reactEvents$"+I,Se="__reactListeners$"+I,me="__reactHandles$"+I,pe="__reactResources$"+I,ne="__reactMarker$"+I;function P(r){delete r[U],delete r[H],delete r[he],delete r[Se],delete r[me]}function fe(r){var n=r[U];if(n)return n;for(var l=r.parentNode;l;){if(n=l[Y]||l[U]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(r=hp(r);r!==null;){if(l=r[U])return l;r=hp(r)}return n}r=l,l=r.parentNode}return null}function be(r){if(r=r[U]||r[Y]){var n=r.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return r}return null}function ke(r){var n=r.tag;if(n===5||n===26||n===27||n===6)return r.stateNode;throw Error(i(33))}function Oe(r){var n=r[pe];return n||(n=r[pe]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function Ie(r){r[ne]=!0}var it=new Set,xt={};function At(r,n){Ua(r,n),Ua(r+"Capture",n)}function Ua(r,n){for(xt[r]=n,r=0;r<n.length;r++)it.add(n[r])}var zt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$r={},mr={};function Tl(r){return Bt.call(mr,r)?!0:Bt.call($r,r)?!1:zt.test(r)?mr[r]=!0:($r[r]=!0,!1)}function rr(r,n,l){if(Tl(n))if(l===null)r.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(n);return;case"boolean":var o=n.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){r.removeAttribute(n);return}}r.setAttribute(n,""+l)}}function l0(r,n,l){if(l===null)r.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(n);return}r.setAttribute(n,""+l)}}function Tn(r,n,l,o){if(o===null)r.removeAttribute(l);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(n,l,""+o)}}function Cr(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function $h(r){var n=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function i_(r,n,l){var o=Object.getOwnPropertyDescriptor(r.constructor.prototype,n);if(!r.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var x=o.get,g=o.set;return Object.defineProperty(r,n,{configurable:!0,get:function(){return x.call(this)},set:function(S){l=""+S,g.call(this,S)}}),Object.defineProperty(r,n,{enumerable:o.enumerable}),{getValue:function(){return l},setValue:function(S){l=""+S},stopTracking:function(){r._valueTracker=null,delete r[n]}}}}function cf(r){if(!r._valueTracker){var n=$h(r)?"checked":"value";r._valueTracker=i_(r,n,""+r[n])}}function Qh(r){if(!r)return!1;var n=r._valueTracker;if(!n)return!0;var l=n.getValue(),o="";return r&&(o=$h(r)?r.checked?"true":"false":r.value),r=o,r!==l?(n.setValue(r),!0):!1}function c0(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var s_=/[\n"\\]/g;function Dr(r){return r.replace(s_,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function of(r,n,l,o,x,g,S,F){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),n!=null?S==="number"?(n===0&&r.value===""||r.value!=n)&&(r.value=""+Cr(n)):r.value!==""+Cr(n)&&(r.value=""+Cr(n)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),n!=null?ff(r,S,Cr(n)):l!=null?ff(r,S,Cr(l)):o!=null&&r.removeAttribute("value"),x==null&&g!=null&&(r.defaultChecked=!!g),x!=null&&(r.checked=x&&typeof x!="function"&&typeof x!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?r.name=""+Cr(F):r.removeAttribute("name")}function Jh(r,n,l,o,x,g,S,F){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(r.type=g),n!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||n!=null)){cf(r);return}l=l!=null?""+Cr(l):"",n=n!=null?""+Cr(n):l,F||n===r.value||(r.value=n),r.defaultValue=n}o=o??x,o=typeof o!="function"&&typeof o!="symbol"&&!!o,r.checked=F?r.checked:!!o,r.defaultChecked=!!o,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S),cf(r)}function ff(r,n,l){n==="number"&&c0(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function Ns(r,n,l,o){if(r=r.options,n){n={};for(var x=0;x<l.length;x++)n["$"+l[x]]=!0;for(l=0;l<r.length;l++)x=n.hasOwnProperty("$"+r[l].value),r[l].selected!==x&&(r[l].selected=x),x&&o&&(r[l].defaultSelected=!0)}else{for(l=""+Cr(l),n=null,x=0;x<r.length;x++){if(r[x].value===l){r[x].selected=!0,o&&(r[x].defaultSelected=!0);return}n!==null||r[x].disabled||(n=r[x])}n!==null&&(n.selected=!0)}}function em(r,n,l){if(n!=null&&(n=""+Cr(n),n!==r.value&&(r.value=n),l==null)){r.defaultValue!==n&&(r.defaultValue=n);return}r.defaultValue=l!=null?""+Cr(l):""}function tm(r,n,l,o){if(n==null){if(o!=null){if(l!=null)throw Error(i(92));if(ve(o)){if(1<o.length)throw Error(i(93));o=o[0]}l=o}l==null&&(l=""),n=l}l=Cr(n),r.defaultValue=l,o=r.textContent,o===l&&o!==""&&o!==null&&(r.value=o),cf(r)}function As(r,n){if(n){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=n;return}}r.textContent=n}var l_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function am(r,n,l){var o=n.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?o?r.setProperty(n,""):n==="float"?r.cssFloat="":r[n]="":o?r.setProperty(n,l):typeof l!="number"||l===0||l_.has(n)?n==="float"?r.cssFloat=l:r[n]=(""+l).trim():r[n]=l+"px"}function rm(r,n,l){if(n!=null&&typeof n!="object")throw Error(i(62));if(r=r.style,l!=null){for(var o in l)!l.hasOwnProperty(o)||n!=null&&n.hasOwnProperty(o)||(o.indexOf("--")===0?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="");for(var x in n)o=n[x],n.hasOwnProperty(x)&&l[x]!==o&&am(r,x,o)}else for(var g in n)n.hasOwnProperty(g)&&am(r,g,n[g])}function uf(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var c_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),o_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function o0(r){return o_.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Nn(){}var df=null;function hf(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ks=null,Cs=null;function nm(r){var n=be(r);if(n&&(r=n.stateNode)){var l=r[H]||null;e:switch(r=n.stateNode,n.type){case"input":if(of(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),n=l.name,l.type==="radio"&&n!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Dr(""+n)+'"][type="radio"]'),n=0;n<l.length;n++){var o=l[n];if(o!==r&&o.form===r.form){var x=o[H]||null;if(!x)throw Error(i(90));of(o,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(n=0;n<l.length;n++)o=l[n],o.form===r.form&&Qh(o)}break e;case"textarea":em(r,l.value,l.defaultValue);break e;case"select":n=l.value,n!=null&&Ns(r,!!l.multiple,n,!1)}}}var mf=!1;function im(r,n,l){if(mf)return r(n,l);mf=!0;try{var o=r(n);return o}finally{if(mf=!1,(ks!==null||Cs!==null)&&(Z0(),ks&&(n=ks,r=Cs,Cs=ks=null,nm(n),r)))for(n=0;n<r.length;n++)nm(r[n])}}function Nl(r,n){var l=r.stateNode;if(l===null)return null;var o=l[H]||null;if(o===null)return null;l=o[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(r=r.type,o=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!o;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(i(231,n,typeof l));return l}var An=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xf=!1;if(An)try{var Al={};Object.defineProperty(Al,"passive",{get:function(){xf=!0}}),window.addEventListener("test",Al,Al),window.removeEventListener("test",Al,Al)}catch{xf=!1}var ti=null,pf=null,f0=null;function sm(){if(f0)return f0;var r,n=pf,l=n.length,o,x="value"in ti?ti.value:ti.textContent,g=x.length;for(r=0;r<l&&n[r]===x[r];r++);var S=l-r;for(o=1;o<=S&&n[l-o]===x[g-o];o++);return f0=x.slice(r,1<o?1-o:void 0)}function u0(r){var n=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&n===13&&(r=13)):r=n,r===10&&(r=13),32<=r||r===13?r:0}function d0(){return!0}function lm(){return!1}function nr(r){function n(l,o,x,g,S){this._reactName=l,this._targetInst=x,this.type=o,this.nativeEvent=g,this.target=S,this.currentTarget=null;for(var F in r)r.hasOwnProperty(F)&&(l=r[F],this[F]=l?l(g):g[F]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?d0:lm,this.isPropagationStopped=lm,this}return v(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=d0)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=d0)},persist:function(){},isPersistent:d0}),n}var Pi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},h0=nr(Pi),kl=v({},Pi,{view:0,detail:0}),f_=nr(kl),gf,vf,Cl,m0=v({},kl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_f,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Cl&&(Cl&&r.type==="mousemove"?(gf=r.screenX-Cl.screenX,vf=r.screenY-Cl.screenY):vf=gf=0,Cl=r),gf)},movementY:function(r){return"movementY"in r?r.movementY:vf}}),cm=nr(m0),u_=v({},m0,{dataTransfer:0}),d_=nr(u_),h_=v({},kl,{relatedTarget:0}),yf=nr(h_),m_=v({},Pi,{animationName:0,elapsedTime:0,pseudoElement:0}),x_=nr(m_),p_=v({},Pi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),g_=nr(p_),v_=v({},Pi,{data:0}),om=nr(v_),y_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},__={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},b_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function w_(r){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(r):(r=b_[r])?!!n[r]:!1}function _f(){return w_}var S_=v({},kl,{key:function(r){if(r.key){var n=y_[r.key]||r.key;if(n!=="Unidentified")return n}return r.type==="keypress"?(r=u0(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?__[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_f,charCode:function(r){return r.type==="keypress"?u0(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?u0(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),E_=nr(S_),T_=v({},m0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fm=nr(T_),N_=v({},kl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_f}),A_=nr(N_),k_=v({},Pi,{propertyName:0,elapsedTime:0,pseudoElement:0}),C_=nr(k_),D_=v({},m0,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),j_=nr(D_),F_=v({},Pi,{newState:0,oldState:0}),O_=nr(F_),R_=[9,13,27,32],bf=An&&"CompositionEvent"in window,Dl=null;An&&"documentMode"in document&&(Dl=document.documentMode);var M_=An&&"TextEvent"in window&&!Dl,um=An&&(!bf||Dl&&8<Dl&&11>=Dl),dm=" ",hm=!1;function mm(r,n){switch(r){case"keyup":return R_.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ds=!1;function L_(r,n){switch(r){case"compositionend":return xm(n);case"keypress":return n.which!==32?null:(hm=!0,dm);case"textInput":return r=n.data,r===dm&&hm?null:r;default:return null}}function I_(r,n){if(Ds)return r==="compositionend"||!bf&&mm(r,n)?(r=sm(),f0=pf=ti=null,Ds=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return um&&n.locale!=="ko"?null:n.data;default:return null}}var B_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pm(r){var n=r&&r.nodeName&&r.nodeName.toLowerCase();return n==="input"?!!B_[r.type]:n==="textarea"}function gm(r,n,l,o){ks?Cs?Cs.push(o):Cs=[o]:ks=o,n=ro(n,"onChange"),0<n.length&&(l=new h0("onChange","change",null,l,o),r.push({event:l,listeners:n}))}var jl=null,Fl=null;function U_(r){J1(r,0)}function x0(r){var n=ke(r);if(Qh(n))return r}function vm(r,n){if(r==="change")return n}var ym=!1;if(An){var wf;if(An){var Sf="oninput"in document;if(!Sf){var _m=document.createElement("div");_m.setAttribute("oninput","return;"),Sf=typeof _m.oninput=="function"}wf=Sf}else wf=!1;ym=wf&&(!document.documentMode||9<document.documentMode)}function bm(){jl&&(jl.detachEvent("onpropertychange",wm),Fl=jl=null)}function wm(r){if(r.propertyName==="value"&&x0(Fl)){var n=[];gm(n,Fl,r,hf(r)),im(U_,n)}}function z_(r,n,l){r==="focusin"?(bm(),jl=n,Fl=l,jl.attachEvent("onpropertychange",wm)):r==="focusout"&&bm()}function P_(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return x0(Fl)}function H_(r,n){if(r==="click")return x0(n)}function V_(r,n){if(r==="input"||r==="change")return x0(n)}function G_(r,n){return r===n&&(r!==0||1/r===1/n)||r!==r&&n!==n}var xr=typeof Object.is=="function"?Object.is:G_;function Ol(r,n){if(xr(r,n))return!0;if(typeof r!="object"||r===null||typeof n!="object"||n===null)return!1;var l=Object.keys(r),o=Object.keys(n);if(l.length!==o.length)return!1;for(o=0;o<l.length;o++){var x=l[o];if(!Bt.call(n,x)||!xr(r[x],n[x]))return!1}return!0}function Sm(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Em(r,n){var l=Sm(r);r=0;for(var o;l;){if(l.nodeType===3){if(o=r+l.textContent.length,r<=n&&o>=n)return{node:l,offset:n-r};r=o}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Sm(l)}}function Tm(r,n){return r&&n?r===n?!0:r&&r.nodeType===3?!1:n&&n.nodeType===3?Tm(r,n.parentNode):"contains"in r?r.contains(n):r.compareDocumentPosition?!!(r.compareDocumentPosition(n)&16):!1:!1}function Nm(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var n=c0(r.document);n instanceof r.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)r=n.contentWindow;else break;n=c0(r.document)}return n}function Ef(r){var n=r&&r.nodeName&&r.nodeName.toLowerCase();return n&&(n==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||n==="textarea"||r.contentEditable==="true")}var X_=An&&"documentMode"in document&&11>=document.documentMode,js=null,Tf=null,Rl=null,Nf=!1;function Am(r,n,l){var o=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Nf||js==null||js!==c0(o)||(o=js,"selectionStart"in o&&Ef(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Rl&&Ol(Rl,o)||(Rl=o,o=ro(Tf,"onSelect"),0<o.length&&(n=new h0("onSelect","select",null,n,l),r.push({event:n,listeners:o}),n.target=js)))}function Hi(r,n){var l={};return l[r.toLowerCase()]=n.toLowerCase(),l["Webkit"+r]="webkit"+n,l["Moz"+r]="moz"+n,l}var Fs={animationend:Hi("Animation","AnimationEnd"),animationiteration:Hi("Animation","AnimationIteration"),animationstart:Hi("Animation","AnimationStart"),transitionrun:Hi("Transition","TransitionRun"),transitionstart:Hi("Transition","TransitionStart"),transitioncancel:Hi("Transition","TransitionCancel"),transitionend:Hi("Transition","TransitionEnd")},Af={},km={};An&&(km=document.createElement("div").style,"AnimationEvent"in window||(delete Fs.animationend.animation,delete Fs.animationiteration.animation,delete Fs.animationstart.animation),"TransitionEvent"in window||delete Fs.transitionend.transition);function Vi(r){if(Af[r])return Af[r];if(!Fs[r])return r;var n=Fs[r],l;for(l in n)if(n.hasOwnProperty(l)&&l in km)return Af[r]=n[l];return r}var Cm=Vi("animationend"),Dm=Vi("animationiteration"),jm=Vi("animationstart"),Y_=Vi("transitionrun"),W_=Vi("transitionstart"),q_=Vi("transitioncancel"),Fm=Vi("transitionend"),Om=new Map,kf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");kf.push("scrollEnd");function Qr(r,n){Om.set(r,n),At(n,[r])}var p0=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},jr=[],Os=0,Cf=0;function g0(){for(var r=Os,n=Cf=Os=0;n<r;){var l=jr[n];jr[n++]=null;var o=jr[n];jr[n++]=null;var x=jr[n];jr[n++]=null;var g=jr[n];if(jr[n++]=null,o!==null&&x!==null){var S=o.pending;S===null?x.next=x:(x.next=S.next,S.next=x),o.pending=x}g!==0&&Rm(l,x,g)}}function v0(r,n,l,o){jr[Os++]=r,jr[Os++]=n,jr[Os++]=l,jr[Os++]=o,Cf|=o,r.lanes|=o,r=r.alternate,r!==null&&(r.lanes|=o)}function Df(r,n,l,o){return v0(r,n,l,o),y0(r)}function Gi(r,n){return v0(r,null,null,n),y0(r)}function Rm(r,n,l){r.lanes|=l;var o=r.alternate;o!==null&&(o.lanes|=l);for(var x=!1,g=r.return;g!==null;)g.childLanes|=l,o=g.alternate,o!==null&&(o.childLanes|=l),g.tag===22&&(r=g.stateNode,r===null||r._visibility&1||(x=!0)),r=g,g=g.return;return r.tag===3?(g=r.stateNode,x&&n!==null&&(x=31-Zt(l),r=g.hiddenUpdates,o=r[x],o===null?r[x]=[n]:o.push(n),n.lane=l|536870912),g):null}function y0(r){if(50<ac)throw ac=0,Uu=null,Error(i(185));for(var n=r.return;n!==null;)r=n,n=r.return;return r.tag===3?r.stateNode:null}var Rs={};function K_(r,n,l,o){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pr(r,n,l,o){return new K_(r,n,l,o)}function jf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function kn(r,n){var l=r.alternate;return l===null?(l=pr(r.tag,n,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=n,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,n=r.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function Mm(r,n){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,n=l.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),r}function _0(r,n,l,o,x,g){var S=0;if(o=r,typeof r=="function")jf(r)&&(S=1);else if(typeof r=="string")S=ew(r,l,B.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case K:return r=pr(31,l,n,x),r.elementType=K,r.lanes=g,r;case b:return Xi(l.children,x,g,n);case T:S=8,x|=24;break;case C:return r=pr(12,l,n,x|2),r.elementType=C,r.lanes=g,r;case V:return r=pr(13,l,n,x),r.elementType=V,r.lanes=g,r;case M:return r=pr(19,l,n,x),r.elementType=M,r.lanes=g,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case N:S=10;break e;case L:S=9;break e;case j:S=11;break e;case k:S=14;break e;case W:S=16,o=null;break e}S=29,l=Error(i(130,r===null?"null":typeof r,"")),o=null}return n=pr(S,l,n,x),n.elementType=r,n.type=o,n.lanes=g,n}function Xi(r,n,l,o){return r=pr(7,r,o,n),r.lanes=l,r}function Ff(r,n,l){return r=pr(6,r,null,n),r.lanes=l,r}function Lm(r){var n=pr(18,null,null,0);return n.stateNode=r,n}function Of(r,n,l){return n=pr(4,r.children!==null?r.children:[],r.key,n),n.lanes=l,n.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},n}var Im=new WeakMap;function Fr(r,n){if(typeof r=="object"&&r!==null){var l=Im.get(r);return l!==void 0?l:(n={value:r,source:n,stack:vt(n)},Im.set(r,n),n)}return{value:r,source:n,stack:vt(n)}}var Ms=[],Ls=0,b0=null,Ml=0,Or=[],Rr=0,ai=null,fn=1,un="";function Cn(r,n){Ms[Ls++]=Ml,Ms[Ls++]=b0,b0=r,Ml=n}function Bm(r,n,l){Or[Rr++]=fn,Or[Rr++]=un,Or[Rr++]=ai,ai=r;var o=fn;r=un;var x=32-Zt(o)-1;o&=~(1<<x),l+=1;var g=32-Zt(n)+x;if(30<g){var S=x-x%5;g=(o&(1<<S)-1).toString(32),o>>=S,x-=S,fn=1<<32-Zt(n)+x|l<<x|o,un=g+r}else fn=1<<g|l<<x|o,un=r}function Rf(r){r.return!==null&&(Cn(r,1),Bm(r,1,0))}function Mf(r){for(;r===b0;)b0=Ms[--Ls],Ms[Ls]=null,Ml=Ms[--Ls],Ms[Ls]=null;for(;r===ai;)ai=Or[--Rr],Or[Rr]=null,un=Or[--Rr],Or[Rr]=null,fn=Or[--Rr],Or[Rr]=null}function Um(r,n){Or[Rr++]=fn,Or[Rr++]=un,Or[Rr++]=ai,fn=n.id,un=n.overflow,ai=r}var Da=null,Pt=null,yt=!1,ri=null,Mr=!1,Lf=Error(i(519));function ni(r){var n=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ll(Fr(n,r)),Lf}function zm(r){var n=r.stateNode,l=r.type,o=r.memoizedProps;switch(n[U]=r,n[H]=o,l){case"dialog":dt("cancel",n),dt("close",n);break;case"iframe":case"object":case"embed":dt("load",n);break;case"video":case"audio":for(l=0;l<nc.length;l++)dt(nc[l],n);break;case"source":dt("error",n);break;case"img":case"image":case"link":dt("error",n),dt("load",n);break;case"details":dt("toggle",n);break;case"input":dt("invalid",n),Jh(n,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":dt("invalid",n);break;case"textarea":dt("invalid",n),tm(n,o.value,o.defaultValue,o.children)}l=o.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||n.textContent===""+l||o.suppressHydrationWarning===!0||rp(n.textContent,l)?(o.popover!=null&&(dt("beforetoggle",n),dt("toggle",n)),o.onScroll!=null&&dt("scroll",n),o.onScrollEnd!=null&&dt("scrollend",n),o.onClick!=null&&(n.onclick=Nn),n=!0):n=!1,n||ni(r,!0)}function Pm(r){for(Da=r.return;Da;)switch(Da.tag){case 5:case 31:case 13:Mr=!1;return;case 27:case 3:Mr=!0;return;default:Da=Da.return}}function Is(r){if(r!==Da)return!1;if(!yt)return Pm(r),yt=!0,!1;var n=r.tag,l;if((l=n!==3&&n!==27)&&((l=n===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||ed(r.type,r.memoizedProps)),l=!l),l&&Pt&&ni(r),Pm(r),n===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));Pt=dp(r)}else if(n===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));Pt=dp(r)}else n===27?(n=Pt,vi(r.type)?(r=sd,sd=null,Pt=r):Pt=n):Pt=Da?Ir(r.stateNode.nextSibling):null;return!0}function Yi(){Pt=Da=null,yt=!1}function If(){var r=ri;return r!==null&&(cr===null?cr=r:cr.push.apply(cr,r),ri=null),r}function Ll(r){ri===null?ri=[r]:ri.push(r)}var Bf=A(null),Wi=null,Dn=null;function ii(r,n,l){O(Bf,n._currentValue),n._currentValue=l}function jn(r){r._currentValue=Bf.current,E(Bf)}function Uf(r,n,l){for(;r!==null;){var o=r.alternate;if((r.childLanes&n)!==n?(r.childLanes|=n,o!==null&&(o.childLanes|=n)):o!==null&&(o.childLanes&n)!==n&&(o.childLanes|=n),r===l)break;r=r.return}}function zf(r,n,l,o){var x=r.child;for(x!==null&&(x.return=r);x!==null;){var g=x.dependencies;if(g!==null){var S=x.child;g=g.firstContext;e:for(;g!==null;){var F=g;g=x;for(var te=0;te<n.length;te++)if(F.context===n[te]){g.lanes|=l,F=g.alternate,F!==null&&(F.lanes|=l),Uf(g.return,l,r),o||(S=null);break e}g=F.next}}else if(x.tag===18){if(S=x.return,S===null)throw Error(i(341));S.lanes|=l,g=S.alternate,g!==null&&(g.lanes|=l),Uf(S,l,r),S=null}else S=x.child;if(S!==null)S.return=x;else for(S=x;S!==null;){if(S===r){S=null;break}if(x=S.sibling,x!==null){x.return=S.return,S=x;break}S=S.return}x=S}}function Bs(r,n,l,o){r=null;for(var x=n,g=!1;x!==null;){if(!g){if((x.flags&524288)!==0)g=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var S=x.alternate;if(S===null)throw Error(i(387));if(S=S.memoizedProps,S!==null){var F=x.type;xr(x.pendingProps.value,S.value)||(r!==null?r.push(F):r=[F])}}else if(x===ye.current){if(S=x.alternate,S===null)throw Error(i(387));S.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(r!==null?r.push(oc):r=[oc])}x=x.return}r!==null&&zf(n,r,l,o),n.flags|=262144}function w0(r){for(r=r.firstContext;r!==null;){if(!xr(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function qi(r){Wi=r,Dn=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function ja(r){return Hm(Wi,r)}function S0(r,n){return Wi===null&&qi(r),Hm(r,n)}function Hm(r,n){var l=n._currentValue;if(n={context:n,memoizedValue:l,next:null},Dn===null){if(r===null)throw Error(i(308));Dn=n,r.dependencies={lanes:0,firstContext:n},r.flags|=524288}else Dn=Dn.next=n;return l}var Z_=typeof AbortController<"u"?AbortController:function(){var r=[],n=this.signal={aborted:!1,addEventListener:function(l,o){r.push(o)}};this.abort=function(){n.aborted=!0,r.forEach(function(l){return l()})}},$_=e.unstable_scheduleCallback,Q_=e.unstable_NormalPriority,ua={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pf(){return{controller:new Z_,data:new Map,refCount:0}}function Il(r){r.refCount--,r.refCount===0&&$_(Q_,function(){r.controller.abort()})}var Bl=null,Hf=0,Us=0,zs=null;function J_(r,n){if(Bl===null){var l=Bl=[];Hf=0,Us=Xu(),zs={status:"pending",value:void 0,then:function(o){l.push(o)}}}return Hf++,n.then(Vm,Vm),n}function Vm(){if(--Hf===0&&Bl!==null){zs!==null&&(zs.status="fulfilled");var r=Bl;Bl=null,Us=0,zs=null;for(var n=0;n<r.length;n++)(0,r[n])()}}function eb(r,n){var l=[],o={status:"pending",value:null,reason:null,then:function(x){l.push(x)}};return r.then(function(){o.status="fulfilled",o.value=n;for(var x=0;x<l.length;x++)(0,l[x])(n)},function(x){for(o.status="rejected",o.reason=x,x=0;x<l.length;x++)(0,l[x])(void 0)}),o}var Gm=ee.S;ee.S=function(r,n){A1=bt(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&J_(r,n),Gm!==null&&Gm(r,n)};var Ki=A(null);function Vf(){var r=Ki.current;return r!==null?r:Ut.pooledCache}function E0(r,n){n===null?O(Ki,Ki.current):O(Ki,n.pool)}function Xm(){var r=Vf();return r===null?null:{parent:ua._currentValue,pool:r}}var Ps=Error(i(460)),Gf=Error(i(474)),T0=Error(i(542)),N0={then:function(){}};function Ym(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Wm(r,n,l){switch(l=r[l],l===void 0?r.push(n):l!==n&&(n.then(Nn,Nn),n=l),n.status){case"fulfilled":return n.value;case"rejected":throw r=n.reason,Km(r),r;default:if(typeof n.status=="string")n.then(Nn,Nn);else{if(r=Ut,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=n,r.status="pending",r.then(function(o){if(n.status==="pending"){var x=n;x.status="fulfilled",x.value=o}},function(o){if(n.status==="pending"){var x=n;x.status="rejected",x.reason=o}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw r=n.reason,Km(r),r}throw $i=n,Ps}}function Zi(r){try{var n=r._init;return n(r._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?($i=l,Ps):l}}var $i=null;function qm(){if($i===null)throw Error(i(459));var r=$i;return $i=null,r}function Km(r){if(r===Ps||r===T0)throw Error(i(483))}var Hs=null,Ul=0;function A0(r){var n=Ul;return Ul+=1,Hs===null&&(Hs=[]),Wm(Hs,r,n)}function zl(r,n){n=n.props.ref,r.ref=n!==void 0?n:null}function k0(r,n){throw n.$$typeof===y?Error(i(525)):(r=Object.prototype.toString.call(n),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":r)))}function Zm(r){function n(oe,ie){if(r){var de=oe.deletions;de===null?(oe.deletions=[ie],oe.flags|=16):de.push(ie)}}function l(oe,ie){if(!r)return null;for(;ie!==null;)n(oe,ie),ie=ie.sibling;return null}function o(oe){for(var ie=new Map;oe!==null;)oe.key!==null?ie.set(oe.key,oe):ie.set(oe.index,oe),oe=oe.sibling;return ie}function x(oe,ie){return oe=kn(oe,ie),oe.index=0,oe.sibling=null,oe}function g(oe,ie,de){return oe.index=de,r?(de=oe.alternate,de!==null?(de=de.index,de<ie?(oe.flags|=67108866,ie):de):(oe.flags|=67108866,ie)):(oe.flags|=1048576,ie)}function S(oe){return r&&oe.alternate===null&&(oe.flags|=67108866),oe}function F(oe,ie,de,Ae){return ie===null||ie.tag!==6?(ie=Ff(de,oe.mode,Ae),ie.return=oe,ie):(ie=x(ie,de),ie.return=oe,ie)}function te(oe,ie,de,Ae){var Xe=de.type;return Xe===b?Ee(oe,ie,de.props.children,Ae,de.key):ie!==null&&(ie.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===W&&Zi(Xe)===ie.type)?(ie=x(ie,de.props),zl(ie,de),ie.return=oe,ie):(ie=_0(de.type,de.key,de.props,null,oe.mode,Ae),zl(ie,de),ie.return=oe,ie)}function xe(oe,ie,de,Ae){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==de.containerInfo||ie.stateNode.implementation!==de.implementation?(ie=Of(de,oe.mode,Ae),ie.return=oe,ie):(ie=x(ie,de.children||[]),ie.return=oe,ie)}function Ee(oe,ie,de,Ae,Xe){return ie===null||ie.tag!==7?(ie=Xi(de,oe.mode,Ae,Xe),ie.return=oe,ie):(ie=x(ie,de),ie.return=oe,ie)}function Ce(oe,ie,de){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=Ff(""+ie,oe.mode,de),ie.return=oe,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case _:return de=_0(ie.type,ie.key,ie.props,null,oe.mode,de),zl(de,ie),de.return=oe,de;case w:return ie=Of(ie,oe.mode,de),ie.return=oe,ie;case W:return ie=Zi(ie),Ce(oe,ie,de)}if(ve(ie)||Q(ie))return ie=Xi(ie,oe.mode,de,null),ie.return=oe,ie;if(typeof ie.then=="function")return Ce(oe,A0(ie),de);if(ie.$$typeof===N)return Ce(oe,S0(oe,ie),de);k0(oe,ie)}return null}function ge(oe,ie,de,Ae){var Xe=ie!==null?ie.key:null;if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return Xe!==null?null:F(oe,ie,""+de,Ae);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case _:return de.key===Xe?te(oe,ie,de,Ae):null;case w:return de.key===Xe?xe(oe,ie,de,Ae):null;case W:return de=Zi(de),ge(oe,ie,de,Ae)}if(ve(de)||Q(de))return Xe!==null?null:Ee(oe,ie,de,Ae,null);if(typeof de.then=="function")return ge(oe,ie,A0(de),Ae);if(de.$$typeof===N)return ge(oe,ie,S0(oe,de),Ae);k0(oe,de)}return null}function _e(oe,ie,de,Ae,Xe){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return oe=oe.get(de)||null,F(ie,oe,""+Ae,Xe);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case _:return oe=oe.get(Ae.key===null?de:Ae.key)||null,te(ie,oe,Ae,Xe);case w:return oe=oe.get(Ae.key===null?de:Ae.key)||null,xe(ie,oe,Ae,Xe);case W:return Ae=Zi(Ae),_e(oe,ie,de,Ae,Xe)}if(ve(Ae)||Q(Ae))return oe=oe.get(de)||null,Ee(ie,oe,Ae,Xe,null);if(typeof Ae.then=="function")return _e(oe,ie,de,A0(Ae),Xe);if(Ae.$$typeof===N)return _e(oe,ie,de,S0(ie,Ae),Xe);k0(ie,Ae)}return null}function ze(oe,ie,de,Ae){for(var Xe=null,Et=null,Ge=ie,st=ie=0,gt=null;Ge!==null&&st<de.length;st++){Ge.index>st?(gt=Ge,Ge=null):gt=Ge.sibling;var Tt=ge(oe,Ge,de[st],Ae);if(Tt===null){Ge===null&&(Ge=gt);break}r&&Ge&&Tt.alternate===null&&n(oe,Ge),ie=g(Tt,ie,st),Et===null?Xe=Tt:Et.sibling=Tt,Et=Tt,Ge=gt}if(st===de.length)return l(oe,Ge),yt&&Cn(oe,st),Xe;if(Ge===null){for(;st<de.length;st++)Ge=Ce(oe,de[st],Ae),Ge!==null&&(ie=g(Ge,ie,st),Et===null?Xe=Ge:Et.sibling=Ge,Et=Ge);return yt&&Cn(oe,st),Xe}for(Ge=o(Ge);st<de.length;st++)gt=_e(Ge,oe,st,de[st],Ae),gt!==null&&(r&&gt.alternate!==null&&Ge.delete(gt.key===null?st:gt.key),ie=g(gt,ie,st),Et===null?Xe=gt:Et.sibling=gt,Et=gt);return r&&Ge.forEach(function(Si){return n(oe,Si)}),yt&&Cn(oe,st),Xe}function Ke(oe,ie,de,Ae){if(de==null)throw Error(i(151));for(var Xe=null,Et=null,Ge=ie,st=ie=0,gt=null,Tt=de.next();Ge!==null&&!Tt.done;st++,Tt=de.next()){Ge.index>st?(gt=Ge,Ge=null):gt=Ge.sibling;var Si=ge(oe,Ge,Tt.value,Ae);if(Si===null){Ge===null&&(Ge=gt);break}r&&Ge&&Si.alternate===null&&n(oe,Ge),ie=g(Si,ie,st),Et===null?Xe=Si:Et.sibling=Si,Et=Si,Ge=gt}if(Tt.done)return l(oe,Ge),yt&&Cn(oe,st),Xe;if(Ge===null){for(;!Tt.done;st++,Tt=de.next())Tt=Ce(oe,Tt.value,Ae),Tt!==null&&(ie=g(Tt,ie,st),Et===null?Xe=Tt:Et.sibling=Tt,Et=Tt);return yt&&Cn(oe,st),Xe}for(Ge=o(Ge);!Tt.done;st++,Tt=de.next())Tt=_e(Ge,oe,st,Tt.value,Ae),Tt!==null&&(r&&Tt.alternate!==null&&Ge.delete(Tt.key===null?st:Tt.key),ie=g(Tt,ie,st),Et===null?Xe=Tt:Et.sibling=Tt,Et=Tt);return r&&Ge.forEach(function(uw){return n(oe,uw)}),yt&&Cn(oe,st),Xe}function Lt(oe,ie,de,Ae){if(typeof de=="object"&&de!==null&&de.type===b&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case _:e:{for(var Xe=de.key;ie!==null;){if(ie.key===Xe){if(Xe=de.type,Xe===b){if(ie.tag===7){l(oe,ie.sibling),Ae=x(ie,de.props.children),Ae.return=oe,oe=Ae;break e}}else if(ie.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===W&&Zi(Xe)===ie.type){l(oe,ie.sibling),Ae=x(ie,de.props),zl(Ae,de),Ae.return=oe,oe=Ae;break e}l(oe,ie);break}else n(oe,ie);ie=ie.sibling}de.type===b?(Ae=Xi(de.props.children,oe.mode,Ae,de.key),Ae.return=oe,oe=Ae):(Ae=_0(de.type,de.key,de.props,null,oe.mode,Ae),zl(Ae,de),Ae.return=oe,oe=Ae)}return S(oe);case w:e:{for(Xe=de.key;ie!==null;){if(ie.key===Xe)if(ie.tag===4&&ie.stateNode.containerInfo===de.containerInfo&&ie.stateNode.implementation===de.implementation){l(oe,ie.sibling),Ae=x(ie,de.children||[]),Ae.return=oe,oe=Ae;break e}else{l(oe,ie);break}else n(oe,ie);ie=ie.sibling}Ae=Of(de,oe.mode,Ae),Ae.return=oe,oe=Ae}return S(oe);case W:return de=Zi(de),Lt(oe,ie,de,Ae)}if(ve(de))return ze(oe,ie,de,Ae);if(Q(de)){if(Xe=Q(de),typeof Xe!="function")throw Error(i(150));return de=Xe.call(de),Ke(oe,ie,de,Ae)}if(typeof de.then=="function")return Lt(oe,ie,A0(de),Ae);if(de.$$typeof===N)return Lt(oe,ie,S0(oe,de),Ae);k0(oe,de)}return typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint"?(de=""+de,ie!==null&&ie.tag===6?(l(oe,ie.sibling),Ae=x(ie,de),Ae.return=oe,oe=Ae):(l(oe,ie),Ae=Ff(de,oe.mode,Ae),Ae.return=oe,oe=Ae),S(oe)):l(oe,ie)}return function(oe,ie,de,Ae){try{Ul=0;var Xe=Lt(oe,ie,de,Ae);return Hs=null,Xe}catch(Ge){if(Ge===Ps||Ge===T0)throw Ge;var Et=pr(29,Ge,null,oe.mode);return Et.lanes=Ae,Et.return=oe,Et}finally{}}}var Qi=Zm(!0),$m=Zm(!1),si=!1;function Xf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yf(r,n){r=r.updateQueue,n.updateQueue===r&&(n.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function li(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ci(r,n,l){var o=r.updateQueue;if(o===null)return null;if(o=o.shared,(kt&2)!==0){var x=o.pending;return x===null?n.next=n:(n.next=x.next,x.next=n),o.pending=n,n=y0(r),Rm(r,null,l),n}return v0(r,o,n,l),y0(r)}function Pl(r,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194048)!==0)){var o=n.lanes;o&=r.pendingLanes,l|=o,n.lanes=l,En(r,l)}}function Wf(r,n){var l=r.updateQueue,o=r.alternate;if(o!==null&&(o=o.updateQueue,l===o)){var x=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var S={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?x=g=S:g=g.next=S,l=l.next}while(l!==null);g===null?x=g=n:g=g.next=n}else x=g=n;l={baseState:o.baseState,firstBaseUpdate:x,lastBaseUpdate:g,shared:o.shared,callbacks:o.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=n:r.next=n,l.lastBaseUpdate=n}var qf=!1;function Hl(){if(qf){var r=zs;if(r!==null)throw r}}function Vl(r,n,l,o){qf=!1;var x=r.updateQueue;si=!1;var g=x.firstBaseUpdate,S=x.lastBaseUpdate,F=x.shared.pending;if(F!==null){x.shared.pending=null;var te=F,xe=te.next;te.next=null,S===null?g=xe:S.next=xe,S=te;var Ee=r.alternate;Ee!==null&&(Ee=Ee.updateQueue,F=Ee.lastBaseUpdate,F!==S&&(F===null?Ee.firstBaseUpdate=xe:F.next=xe,Ee.lastBaseUpdate=te))}if(g!==null){var Ce=x.baseState;S=0,Ee=xe=te=null,F=g;do{var ge=F.lane&-536870913,_e=ge!==F.lane;if(_e?(pt&ge)===ge:(o&ge)===ge){ge!==0&&ge===Us&&(qf=!0),Ee!==null&&(Ee=Ee.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var ze=r,Ke=F;ge=n;var Lt=l;switch(Ke.tag){case 1:if(ze=Ke.payload,typeof ze=="function"){Ce=ze.call(Lt,Ce,ge);break e}Ce=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Ke.payload,ge=typeof ze=="function"?ze.call(Lt,Ce,ge):ze,ge==null)break e;Ce=v({},Ce,ge);break e;case 2:si=!0}}ge=F.callback,ge!==null&&(r.flags|=64,_e&&(r.flags|=8192),_e=x.callbacks,_e===null?x.callbacks=[ge]:_e.push(ge))}else _e={lane:ge,tag:F.tag,payload:F.payload,callback:F.callback,next:null},Ee===null?(xe=Ee=_e,te=Ce):Ee=Ee.next=_e,S|=ge;if(F=F.next,F===null){if(F=x.shared.pending,F===null)break;_e=F,F=_e.next,_e.next=null,x.lastBaseUpdate=_e,x.shared.pending=null}}while(!0);Ee===null&&(te=Ce),x.baseState=te,x.firstBaseUpdate=xe,x.lastBaseUpdate=Ee,g===null&&(x.shared.lanes=0),hi|=S,r.lanes=S,r.memoizedState=Ce}}function Qm(r,n){if(typeof r!="function")throw Error(i(191,r));r.call(n)}function Jm(r,n){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)Qm(l[r],n)}var Vs=A(null),C0=A(0);function ex(r,n){r=zn,O(C0,r),O(Vs,n),zn=r|n.baseLanes}function Kf(){O(C0,zn),O(Vs,Vs.current)}function Zf(){zn=C0.current,E(Vs),E(C0)}var gr=A(null),Lr=null;function oi(r){var n=r.alternate;O(ia,ia.current&1),O(gr,r),Lr===null&&(n===null||Vs.current!==null||n.memoizedState!==null)&&(Lr=r)}function $f(r){O(ia,ia.current),O(gr,r),Lr===null&&(Lr=r)}function tx(r){r.tag===22?(O(ia,ia.current),O(gr,r),Lr===null&&(Lr=r)):fi()}function fi(){O(ia,ia.current),O(gr,gr.current)}function vr(r){E(gr),Lr===r&&(Lr=null),E(ia)}var ia=A(0);function D0(r){for(var n=r;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||rd(l)||nd(l)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Fn=0,rt=null,Rt=null,da=null,j0=!1,Gs=!1,Ji=!1,F0=0,Gl=0,Xs=null,tb=0;function Qt(){throw Error(i(321))}function Qf(r,n){if(n===null)return!1;for(var l=0;l<n.length&&l<r.length;l++)if(!xr(r[l],n[l]))return!1;return!0}function Jf(r,n,l,o,x,g){return Fn=g,rt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,ee.H=r===null||r.memoizedState===null?Bx:mu,Ji=!1,g=l(o,x),Ji=!1,Gs&&(g=rx(n,l,o,x)),ax(r),g}function ax(r){ee.H=Wl;var n=Rt!==null&&Rt.next!==null;if(Fn=0,da=Rt=rt=null,j0=!1,Gl=0,Xs=null,n)throw Error(i(300));r===null||ha||(r=r.dependencies,r!==null&&w0(r)&&(ha=!0))}function rx(r,n,l,o){rt=r;var x=0;do{if(Gs&&(Xs=null),Gl=0,Gs=!1,25<=x)throw Error(i(301));if(x+=1,da=Rt=null,r.updateQueue!=null){var g=r.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}ee.H=Ux,g=n(l,o)}while(Gs);return g}function ab(){var r=ee.H,n=r.useState()[0];return n=typeof n.then=="function"?Xl(n):n,r=r.useState()[0],(Rt!==null?Rt.memoizedState:null)!==r&&(rt.flags|=1024),n}function eu(){var r=F0!==0;return F0=0,r}function tu(r,n,l){n.updateQueue=r.updateQueue,n.flags&=-2053,r.lanes&=~l}function au(r){if(j0){for(r=r.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}j0=!1}Fn=0,da=Rt=rt=null,Gs=!1,Gl=F0=0,Xs=null}function Ka(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return da===null?rt.memoizedState=da=r:da=da.next=r,da}function sa(){if(Rt===null){var r=rt.alternate;r=r!==null?r.memoizedState:null}else r=Rt.next;var n=da===null?rt.memoizedState:da.next;if(n!==null)da=n,Rt=r;else{if(r===null)throw rt.alternate===null?Error(i(467)):Error(i(310));Rt=r,r={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},da===null?rt.memoizedState=da=r:da=da.next=r}return da}function O0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xl(r){var n=Gl;return Gl+=1,Xs===null&&(Xs=[]),r=Wm(Xs,r,n),n=rt,(da===null?n.memoizedState:da.next)===null&&(n=n.alternate,ee.H=n===null||n.memoizedState===null?Bx:mu),r}function R0(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Xl(r);if(r.$$typeof===N)return ja(r)}throw Error(i(438,String(r)))}function ru(r){var n=null,l=rt.updateQueue;if(l!==null&&(n=l.memoCache),n==null){var o=rt.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(n={data:o.data.map(function(x){return x.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),l===null&&(l=O0(),rt.updateQueue=l),l.memoCache=n,l=n.data[n.index],l===void 0)for(l=n.data[n.index]=Array(r),o=0;o<r;o++)l[o]=J;return n.index++,l}function On(r,n){return typeof n=="function"?n(r):n}function M0(r){var n=sa();return nu(n,Rt,r)}function nu(r,n,l){var o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=l;var x=r.baseQueue,g=o.pending;if(g!==null){if(x!==null){var S=x.next;x.next=g.next,g.next=S}n.baseQueue=x=g,o.pending=null}if(g=r.baseState,x===null)r.memoizedState=g;else{n=x.next;var F=S=null,te=null,xe=n,Ee=!1;do{var Ce=xe.lane&-536870913;if(Ce!==xe.lane?(pt&Ce)===Ce:(Fn&Ce)===Ce){var ge=xe.revertLane;if(ge===0)te!==null&&(te=te.next={lane:0,revertLane:0,gesture:null,action:xe.action,hasEagerState:xe.hasEagerState,eagerState:xe.eagerState,next:null}),Ce===Us&&(Ee=!0);else if((Fn&ge)===ge){xe=xe.next,ge===Us&&(Ee=!0);continue}else Ce={lane:0,revertLane:xe.revertLane,gesture:null,action:xe.action,hasEagerState:xe.hasEagerState,eagerState:xe.eagerState,next:null},te===null?(F=te=Ce,S=g):te=te.next=Ce,rt.lanes|=ge,hi|=ge;Ce=xe.action,Ji&&l(g,Ce),g=xe.hasEagerState?xe.eagerState:l(g,Ce)}else ge={lane:Ce,revertLane:xe.revertLane,gesture:xe.gesture,action:xe.action,hasEagerState:xe.hasEagerState,eagerState:xe.eagerState,next:null},te===null?(F=te=ge,S=g):te=te.next=ge,rt.lanes|=Ce,hi|=Ce;xe=xe.next}while(xe!==null&&xe!==n);if(te===null?S=g:te.next=F,!xr(g,r.memoizedState)&&(ha=!0,Ee&&(l=zs,l!==null)))throw l;r.memoizedState=g,r.baseState=S,r.baseQueue=te,o.lastRenderedState=g}return x===null&&(o.lanes=0),[r.memoizedState,o.dispatch]}function iu(r){var n=sa(),l=n.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=r;var o=l.dispatch,x=l.pending,g=n.memoizedState;if(x!==null){l.pending=null;var S=x=x.next;do g=r(g,S.action),S=S.next;while(S!==x);xr(g,n.memoizedState)||(ha=!0),n.memoizedState=g,n.baseQueue===null&&(n.baseState=g),l.lastRenderedState=g}return[g,o]}function nx(r,n,l){var o=rt,x=sa(),g=yt;if(g){if(l===void 0)throw Error(i(407));l=l()}else l=n();var S=!xr((Rt||x).memoizedState,l);if(S&&(x.memoizedState=l,ha=!0),x=x.queue,cu(lx.bind(null,o,x,r),[r]),x.getSnapshot!==n||S||da!==null&&da.memoizedState.tag&1){if(o.flags|=2048,Ys(9,{destroy:void 0},sx.bind(null,o,x,l,n),null),Ut===null)throw Error(i(349));g||(Fn&127)!==0||ix(o,n,l)}return l}function ix(r,n,l){r.flags|=16384,r={getSnapshot:n,value:l},n=rt.updateQueue,n===null?(n=O0(),rt.updateQueue=n,n.stores=[r]):(l=n.stores,l===null?n.stores=[r]:l.push(r))}function sx(r,n,l,o){n.value=l,n.getSnapshot=o,cx(n)&&ox(r)}function lx(r,n,l){return l(function(){cx(n)&&ox(r)})}function cx(r){var n=r.getSnapshot;r=r.value;try{var l=n();return!xr(r,l)}catch{return!0}}function ox(r){var n=Gi(r,2);n!==null&&or(n,r,2)}function su(r){var n=Ka();if(typeof r=="function"){var l=r;if(r=l(),Ji){na(!0);try{l()}finally{na(!1)}}}return n.memoizedState=n.baseState=r,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:On,lastRenderedState:r},n}function fx(r,n,l,o){return r.baseState=l,nu(r,Rt,typeof o=="function"?o:On)}function rb(r,n,l,o,x){if(B0(r))throw Error(i(485));if(r=n.action,r!==null){var g={payload:x,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){g.listeners.push(S)}};ee.T!==null?l(!0):g.isTransition=!1,o(g),l=n.pending,l===null?(g.next=n.pending=g,ux(n,g)):(g.next=l.next,n.pending=l.next=g)}}function ux(r,n){var l=n.action,o=n.payload,x=r.state;if(n.isTransition){var g=ee.T,S={};ee.T=S;try{var F=l(x,o),te=ee.S;te!==null&&te(S,F),dx(r,n,F)}catch(xe){lu(r,n,xe)}finally{g!==null&&S.types!==null&&(g.types=S.types),ee.T=g}}else try{g=l(x,o),dx(r,n,g)}catch(xe){lu(r,n,xe)}}function dx(r,n,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(o){hx(r,n,o)},function(o){return lu(r,n,o)}):hx(r,n,l)}function hx(r,n,l){n.status="fulfilled",n.value=l,mx(n),r.state=l,n=r.pending,n!==null&&(l=n.next,l===n?r.pending=null:(l=l.next,n.next=l,ux(r,l)))}function lu(r,n,l){var o=r.pending;if(r.pending=null,o!==null){o=o.next;do n.status="rejected",n.reason=l,mx(n),n=n.next;while(n!==o)}r.action=null}function mx(r){r=r.listeners;for(var n=0;n<r.length;n++)(0,r[n])()}function xx(r,n){return n}function px(r,n){if(yt){var l=Ut.formState;if(l!==null){e:{var o=rt;if(yt){if(Pt){t:{for(var x=Pt,g=Mr;x.nodeType!==8;){if(!g){x=null;break t}if(x=Ir(x.nextSibling),x===null){x=null;break t}}g=x.data,x=g==="F!"||g==="F"?x:null}if(x){Pt=Ir(x.nextSibling),o=x.data==="F!";break e}}ni(o)}o=!1}o&&(n=l[0])}}return l=Ka(),l.memoizedState=l.baseState=n,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xx,lastRenderedState:n},l.queue=o,l=Mx.bind(null,rt,o),o.dispatch=l,o=su(!1),g=hu.bind(null,rt,!1,o.queue),o=Ka(),x={state:n,dispatch:null,action:r,pending:null},o.queue=x,l=rb.bind(null,rt,x,g,l),x.dispatch=l,o.memoizedState=r,[n,l,!1]}function gx(r){var n=sa();return vx(n,Rt,r)}function vx(r,n,l){if(n=nu(r,n,xx)[0],r=M0(On)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var o=Xl(n)}catch(S){throw S===Ps?T0:S}else o=n;n=sa();var x=n.queue,g=x.dispatch;return l!==n.memoizedState&&(rt.flags|=2048,Ys(9,{destroy:void 0},nb.bind(null,x,l),null)),[o,g,r]}function nb(r,n){r.action=n}function yx(r){var n=sa(),l=Rt;if(l!==null)return vx(n,l,r);sa(),n=n.memoizedState,l=sa();var o=l.queue.dispatch;return l.memoizedState=r,[n,o,!1]}function Ys(r,n,l,o){return r={tag:r,create:l,deps:o,inst:n,next:null},n=rt.updateQueue,n===null&&(n=O0(),rt.updateQueue=n),l=n.lastEffect,l===null?n.lastEffect=r.next=r:(o=l.next,l.next=r,r.next=o,n.lastEffect=r),r}function _x(){return sa().memoizedState}function L0(r,n,l,o){var x=Ka();rt.flags|=r,x.memoizedState=Ys(1|n,{destroy:void 0},l,o===void 0?null:o)}function I0(r,n,l,o){var x=sa();o=o===void 0?null:o;var g=x.memoizedState.inst;Rt!==null&&o!==null&&Qf(o,Rt.memoizedState.deps)?x.memoizedState=Ys(n,g,l,o):(rt.flags|=r,x.memoizedState=Ys(1|n,g,l,o))}function bx(r,n){L0(8390656,8,r,n)}function cu(r,n){I0(2048,8,r,n)}function ib(r){rt.flags|=4;var n=rt.updateQueue;if(n===null)n=O0(),rt.updateQueue=n,n.events=[r];else{var l=n.events;l===null?n.events=[r]:l.push(r)}}function wx(r){var n=sa().memoizedState;return ib({ref:n,nextImpl:r}),function(){if((kt&2)!==0)throw Error(i(440));return n.impl.apply(void 0,arguments)}}function Sx(r,n){return I0(4,2,r,n)}function Ex(r,n){return I0(4,4,r,n)}function Tx(r,n){if(typeof n=="function"){r=r();var l=n(r);return function(){typeof l=="function"?l():n(null)}}if(n!=null)return r=r(),n.current=r,function(){n.current=null}}function Nx(r,n,l){l=l!=null?l.concat([r]):null,I0(4,4,Tx.bind(null,n,r),l)}function ou(){}function Ax(r,n){var l=sa();n=n===void 0?null:n;var o=l.memoizedState;return n!==null&&Qf(n,o[1])?o[0]:(l.memoizedState=[r,n],r)}function kx(r,n){var l=sa();n=n===void 0?null:n;var o=l.memoizedState;if(n!==null&&Qf(n,o[1]))return o[0];if(o=r(),Ji){na(!0);try{r()}finally{na(!1)}}return l.memoizedState=[o,n],o}function fu(r,n,l){return l===void 0||(Fn&1073741824)!==0&&(pt&261930)===0?r.memoizedState=n:(r.memoizedState=l,r=C1(),rt.lanes|=r,hi|=r,l)}function Cx(r,n,l,o){return xr(l,n)?l:Vs.current!==null?(r=fu(r,l,o),xr(r,n)||(ha=!0),r):(Fn&42)===0||(Fn&1073741824)!==0&&(pt&261930)===0?(ha=!0,r.memoizedState=l):(r=C1(),rt.lanes|=r,hi|=r,n)}function Dx(r,n,l,o,x){var g=G.p;G.p=g!==0&&8>g?g:8;var S=ee.T,F={};ee.T=F,hu(r,!1,n,l);try{var te=x(),xe=ee.S;if(xe!==null&&xe(F,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var Ee=eb(te,o);Yl(r,n,Ee,br(r))}else Yl(r,n,o,br(r))}catch(Ce){Yl(r,n,{then:function(){},status:"rejected",reason:Ce},br())}finally{G.p=g,S!==null&&F.types!==null&&(S.types=F.types),ee.T=S}}function sb(){}function uu(r,n,l,o){if(r.tag!==5)throw Error(i(476));var x=jx(r).queue;Dx(r,x,n,ae,l===null?sb:function(){return Fx(r),l(o)})}function jx(r){var n=r.memoizedState;if(n!==null)return n;n={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:On,lastRenderedState:ae},next:null};var l={};return n.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:On,lastRenderedState:l},next:null},r.memoizedState=n,r=r.alternate,r!==null&&(r.memoizedState=n),n}function Fx(r){var n=jx(r);n.next===null&&(n=r.alternate.memoizedState),Yl(r,n.next.queue,{},br())}function du(){return ja(oc)}function Ox(){return sa().memoizedState}function Rx(){return sa().memoizedState}function lb(r){for(var n=r.return;n!==null;){switch(n.tag){case 24:case 3:var l=br();r=li(l);var o=ci(n,r,l);o!==null&&(or(o,n,l),Pl(o,n,l)),n={cache:Pf()},r.payload=n;return}n=n.return}}function cb(r,n,l){var o=br();l={lane:o,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},B0(r)?Lx(n,l):(l=Df(r,n,l,o),l!==null&&(or(l,r,o),Ix(l,n,o)))}function Mx(r,n,l){var o=br();Yl(r,n,l,o)}function Yl(r,n,l,o){var x={lane:o,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(B0(r))Lx(n,x);else{var g=r.alternate;if(r.lanes===0&&(g===null||g.lanes===0)&&(g=n.lastRenderedReducer,g!==null))try{var S=n.lastRenderedState,F=g(S,l);if(x.hasEagerState=!0,x.eagerState=F,xr(F,S))return v0(r,n,x,0),Ut===null&&g0(),!1}catch{}finally{}if(l=Df(r,n,x,o),l!==null)return or(l,r,o),Ix(l,n,o),!0}return!1}function hu(r,n,l,o){if(o={lane:2,revertLane:Xu(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},B0(r)){if(n)throw Error(i(479))}else n=Df(r,l,o,2),n!==null&&or(n,r,2)}function B0(r){var n=r.alternate;return r===rt||n!==null&&n===rt}function Lx(r,n){Gs=j0=!0;var l=r.pending;l===null?n.next=n:(n.next=l.next,l.next=n),r.pending=n}function Ix(r,n,l){if((l&4194048)!==0){var o=n.lanes;o&=r.pendingLanes,l|=o,n.lanes=l,En(r,l)}}var Wl={readContext:ja,use:R0,useCallback:Qt,useContext:Qt,useEffect:Qt,useImperativeHandle:Qt,useLayoutEffect:Qt,useInsertionEffect:Qt,useMemo:Qt,useReducer:Qt,useRef:Qt,useState:Qt,useDebugValue:Qt,useDeferredValue:Qt,useTransition:Qt,useSyncExternalStore:Qt,useId:Qt,useHostTransitionStatus:Qt,useFormState:Qt,useActionState:Qt,useOptimistic:Qt,useMemoCache:Qt,useCacheRefresh:Qt};Wl.useEffectEvent=Qt;var Bx={readContext:ja,use:R0,useCallback:function(r,n){return Ka().memoizedState=[r,n===void 0?null:n],r},useContext:ja,useEffect:bx,useImperativeHandle:function(r,n,l){l=l!=null?l.concat([r]):null,L0(4194308,4,Tx.bind(null,n,r),l)},useLayoutEffect:function(r,n){return L0(4194308,4,r,n)},useInsertionEffect:function(r,n){L0(4,2,r,n)},useMemo:function(r,n){var l=Ka();n=n===void 0?null:n;var o=r();if(Ji){na(!0);try{r()}finally{na(!1)}}return l.memoizedState=[o,n],o},useReducer:function(r,n,l){var o=Ka();if(l!==void 0){var x=l(n);if(Ji){na(!0);try{l(n)}finally{na(!1)}}}else x=n;return o.memoizedState=o.baseState=x,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:x},o.queue=r,r=r.dispatch=cb.bind(null,rt,r),[o.memoizedState,r]},useRef:function(r){var n=Ka();return r={current:r},n.memoizedState=r},useState:function(r){r=su(r);var n=r.queue,l=Mx.bind(null,rt,n);return n.dispatch=l,[r.memoizedState,l]},useDebugValue:ou,useDeferredValue:function(r,n){var l=Ka();return fu(l,r,n)},useTransition:function(){var r=su(!1);return r=Dx.bind(null,rt,r.queue,!0,!1),Ka().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,n,l){var o=rt,x=Ka();if(yt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=n(),Ut===null)throw Error(i(349));(pt&127)!==0||ix(o,n,l)}x.memoizedState=l;var g={value:l,getSnapshot:n};return x.queue=g,bx(lx.bind(null,o,g,r),[r]),o.flags|=2048,Ys(9,{destroy:void 0},sx.bind(null,o,g,l,n),null),l},useId:function(){var r=Ka(),n=Ut.identifierPrefix;if(yt){var l=un,o=fn;l=(o&~(1<<32-Zt(o)-1)).toString(32)+l,n="_"+n+"R_"+l,l=F0++,0<l&&(n+="H"+l.toString(32)),n+="_"}else l=tb++,n="_"+n+"r_"+l.toString(32)+"_";return r.memoizedState=n},useHostTransitionStatus:du,useFormState:px,useActionState:px,useOptimistic:function(r){var n=Ka();n.memoizedState=n.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=l,n=hu.bind(null,rt,!0,l),l.dispatch=n,[r,n]},useMemoCache:ru,useCacheRefresh:function(){return Ka().memoizedState=lb.bind(null,rt)},useEffectEvent:function(r){var n=Ka(),l={impl:r};return n.memoizedState=l,function(){if((kt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},mu={readContext:ja,use:R0,useCallback:Ax,useContext:ja,useEffect:cu,useImperativeHandle:Nx,useInsertionEffect:Sx,useLayoutEffect:Ex,useMemo:kx,useReducer:M0,useRef:_x,useState:function(){return M0(On)},useDebugValue:ou,useDeferredValue:function(r,n){var l=sa();return Cx(l,Rt.memoizedState,r,n)},useTransition:function(){var r=M0(On)[0],n=sa().memoizedState;return[typeof r=="boolean"?r:Xl(r),n]},useSyncExternalStore:nx,useId:Ox,useHostTransitionStatus:du,useFormState:gx,useActionState:gx,useOptimistic:function(r,n){var l=sa();return fx(l,Rt,r,n)},useMemoCache:ru,useCacheRefresh:Rx};mu.useEffectEvent=wx;var Ux={readContext:ja,use:R0,useCallback:Ax,useContext:ja,useEffect:cu,useImperativeHandle:Nx,useInsertionEffect:Sx,useLayoutEffect:Ex,useMemo:kx,useReducer:iu,useRef:_x,useState:function(){return iu(On)},useDebugValue:ou,useDeferredValue:function(r,n){var l=sa();return Rt===null?fu(l,r,n):Cx(l,Rt.memoizedState,r,n)},useTransition:function(){var r=iu(On)[0],n=sa().memoizedState;return[typeof r=="boolean"?r:Xl(r),n]},useSyncExternalStore:nx,useId:Ox,useHostTransitionStatus:du,useFormState:yx,useActionState:yx,useOptimistic:function(r,n){var l=sa();return Rt!==null?fx(l,Rt,r,n):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:ru,useCacheRefresh:Rx};Ux.useEffectEvent=wx;function xu(r,n,l,o){n=r.memoizedState,l=l(o,n),l=l==null?n:v({},n,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var pu={enqueueSetState:function(r,n,l){r=r._reactInternals;var o=br(),x=li(o);x.payload=n,l!=null&&(x.callback=l),n=ci(r,x,o),n!==null&&(or(n,r,o),Pl(n,r,o))},enqueueReplaceState:function(r,n,l){r=r._reactInternals;var o=br(),x=li(o);x.tag=1,x.payload=n,l!=null&&(x.callback=l),n=ci(r,x,o),n!==null&&(or(n,r,o),Pl(n,r,o))},enqueueForceUpdate:function(r,n){r=r._reactInternals;var l=br(),o=li(l);o.tag=2,n!=null&&(o.callback=n),n=ci(r,o,l),n!==null&&(or(n,r,l),Pl(n,r,l))}};function zx(r,n,l,o,x,g,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(o,g,S):n.prototype&&n.prototype.isPureReactComponent?!Ol(l,o)||!Ol(x,g):!0}function Px(r,n,l,o){r=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,o),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,o),n.state!==r&&pu.enqueueReplaceState(n,n.state,null)}function es(r,n){var l=n;if("ref"in n){l={};for(var o in n)o!=="ref"&&(l[o]=n[o])}if(r=r.defaultProps){l===n&&(l=v({},l));for(var x in r)l[x]===void 0&&(l[x]=r[x])}return l}function Hx(r){p0(r)}function Vx(r){console.error(r)}function Gx(r){p0(r)}function U0(r,n){try{var l=r.onUncaughtError;l(n.value,{componentStack:n.stack})}catch(o){setTimeout(function(){throw o})}}function Xx(r,n,l){try{var o=r.onCaughtError;o(l.value,{componentStack:l.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function gu(r,n,l){return l=li(l),l.tag=3,l.payload={element:null},l.callback=function(){U0(r,n)},l}function Yx(r){return r=li(r),r.tag=3,r}function Wx(r,n,l,o){var x=l.type.getDerivedStateFromError;if(typeof x=="function"){var g=o.value;r.payload=function(){return x(g)},r.callback=function(){Xx(n,l,o)}}var S=l.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){Xx(n,l,o),typeof x!="function"&&(mi===null?mi=new Set([this]):mi.add(this));var F=o.stack;this.componentDidCatch(o.value,{componentStack:F!==null?F:""})})}function ob(r,n,l,o,x){if(l.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(n=l.alternate,n!==null&&Bs(n,l,x,!0),l=gr.current,l!==null){switch(l.tag){case 31:case 13:return Lr===null?$0():l.alternate===null&&Jt===0&&(Jt=3),l.flags&=-257,l.flags|=65536,l.lanes=x,o===N0?l.flags|=16384:(n=l.updateQueue,n===null?l.updateQueue=new Set([o]):n.add(o),Hu(r,o,x)),!1;case 22:return l.flags|=65536,o===N0?l.flags|=16384:(n=l.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([o])},l.updateQueue=n):(l=n.retryQueue,l===null?n.retryQueue=new Set([o]):l.add(o)),Hu(r,o,x)),!1}throw Error(i(435,l.tag))}return Hu(r,o,x),$0(),!1}if(yt)return n=gr.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=x,o!==Lf&&(r=Error(i(422),{cause:o}),Ll(Fr(r,l)))):(o!==Lf&&(n=Error(i(423),{cause:o}),Ll(Fr(n,l))),r=r.current.alternate,r.flags|=65536,x&=-x,r.lanes|=x,o=Fr(o,l),x=gu(r.stateNode,o,x),Wf(r,x),Jt!==4&&(Jt=2)),!1;var g=Error(i(520),{cause:o});if(g=Fr(g,l),tc===null?tc=[g]:tc.push(g),Jt!==4&&(Jt=2),n===null)return!0;o=Fr(o,l),l=n;do{switch(l.tag){case 3:return l.flags|=65536,r=x&-x,l.lanes|=r,r=gu(l.stateNode,o,r),Wf(l,r),!1;case 1:if(n=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(mi===null||!mi.has(g))))return l.flags|=65536,x&=-x,l.lanes|=x,x=Yx(x),Wx(x,r,l,o),Wf(l,x),!1}l=l.return}while(l!==null);return!1}var vu=Error(i(461)),ha=!1;function Fa(r,n,l,o){n.child=r===null?$m(n,null,l,o):Qi(n,r.child,l,o)}function qx(r,n,l,o,x){l=l.render;var g=n.ref;if("ref"in o){var S={};for(var F in o)F!=="ref"&&(S[F]=o[F])}else S=o;return qi(n),o=Jf(r,n,l,S,g,x),F=eu(),r!==null&&!ha?(tu(r,n,x),Rn(r,n,x)):(yt&&F&&Rf(n),n.flags|=1,Fa(r,n,o,x),n.child)}function Kx(r,n,l,o,x){if(r===null){var g=l.type;return typeof g=="function"&&!jf(g)&&g.defaultProps===void 0&&l.compare===null?(n.tag=15,n.type=g,Zx(r,n,g,o,x)):(r=_0(l.type,null,o,n,n.mode,x),r.ref=n.ref,r.return=n,n.child=r)}if(g=r.child,!Nu(r,x)){var S=g.memoizedProps;if(l=l.compare,l=l!==null?l:Ol,l(S,o)&&r.ref===n.ref)return Rn(r,n,x)}return n.flags|=1,r=kn(g,o),r.ref=n.ref,r.return=n,n.child=r}function Zx(r,n,l,o,x){if(r!==null){var g=r.memoizedProps;if(Ol(g,o)&&r.ref===n.ref)if(ha=!1,n.pendingProps=o=g,Nu(r,x))(r.flags&131072)!==0&&(ha=!0);else return n.lanes=r.lanes,Rn(r,n,x)}return yu(r,n,l,o,x)}function $x(r,n,l,o){var x=o.children,g=r!==null?r.memoizedState:null;if(r===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((n.flags&128)!==0){if(g=g!==null?g.baseLanes|l:l,r!==null){for(o=n.child=r.child,x=0;o!==null;)x=x|o.lanes|o.childLanes,o=o.sibling;o=x&~g}else o=0,n.child=null;return Qx(r,n,g,l,o)}if((l&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},r!==null&&E0(n,g!==null?g.cachePool:null),g!==null?ex(n,g):Kf(),tx(n);else return o=n.lanes=536870912,Qx(r,n,g!==null?g.baseLanes|l:l,l,o)}else g!==null?(E0(n,g.cachePool),ex(n,g),fi(),n.memoizedState=null):(r!==null&&E0(n,null),Kf(),fi());return Fa(r,n,x,l),n.child}function ql(r,n){return r!==null&&r.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Qx(r,n,l,o,x){var g=Vf();return g=g===null?null:{parent:ua._currentValue,pool:g},n.memoizedState={baseLanes:l,cachePool:g},r!==null&&E0(n,null),Kf(),tx(n),r!==null&&Bs(r,n,o,!0),n.childLanes=x,null}function z0(r,n){return n=H0({mode:n.mode,children:n.children},r.mode),n.ref=r.ref,r.child=n,n.return=r,n}function Jx(r,n,l){return Qi(n,r.child,null,l),r=z0(n,n.pendingProps),r.flags|=2,vr(n),n.memoizedState=null,r}function fb(r,n,l){var o=n.pendingProps,x=(n.flags&128)!==0;if(n.flags&=-129,r===null){if(yt){if(o.mode==="hidden")return r=z0(n,o),n.lanes=536870912,ql(null,r);if($f(n),(r=Pt)?(r=up(r,Mr),r=r!==null&&r.data==="&"?r:null,r!==null&&(n.memoizedState={dehydrated:r,treeContext:ai!==null?{id:fn,overflow:un}:null,retryLane:536870912,hydrationErrors:null},l=Lm(r),l.return=n,n.child=l,Da=n,Pt=null)):r=null,r===null)throw ni(n);return n.lanes=536870912,null}return z0(n,o)}var g=r.memoizedState;if(g!==null){var S=g.dehydrated;if($f(n),x)if(n.flags&256)n.flags&=-257,n=Jx(r,n,l);else if(n.memoizedState!==null)n.child=r.child,n.flags|=128,n=null;else throw Error(i(558));else if(ha||Bs(r,n,l,!1),x=(l&r.childLanes)!==0,ha||x){if(o=Ut,o!==null&&(S=Ts(o,l),S!==0&&S!==g.retryLane))throw g.retryLane=S,Gi(r,S),or(o,r,S),vu;$0(),n=Jx(r,n,l)}else r=g.treeContext,Pt=Ir(S.nextSibling),Da=n,yt=!0,ri=null,Mr=!1,r!==null&&Um(n,r),n=z0(n,o),n.flags|=4096;return n}return r=kn(r.child,{mode:o.mode,children:o.children}),r.ref=n.ref,n.child=r,r.return=n,r}function P0(r,n){var l=n.ref;if(l===null)r!==null&&r.ref!==null&&(n.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(r===null||r.ref!==l)&&(n.flags|=4194816)}}function yu(r,n,l,o,x){return qi(n),l=Jf(r,n,l,o,void 0,x),o=eu(),r!==null&&!ha?(tu(r,n,x),Rn(r,n,x)):(yt&&o&&Rf(n),n.flags|=1,Fa(r,n,l,x),n.child)}function e1(r,n,l,o,x,g){return qi(n),n.updateQueue=null,l=rx(n,o,l,x),ax(r),o=eu(),r!==null&&!ha?(tu(r,n,g),Rn(r,n,g)):(yt&&o&&Rf(n),n.flags|=1,Fa(r,n,l,g),n.child)}function t1(r,n,l,o,x){if(qi(n),n.stateNode===null){var g=Rs,S=l.contextType;typeof S=="object"&&S!==null&&(g=ja(S)),g=new l(o,g),n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=pu,n.stateNode=g,g._reactInternals=n,g=n.stateNode,g.props=o,g.state=n.memoizedState,g.refs={},Xf(n),S=l.contextType,g.context=typeof S=="object"&&S!==null?ja(S):Rs,g.state=n.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&(xu(n,l,S,o),g.state=n.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(S=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),S!==g.state&&pu.enqueueReplaceState(g,g.state,null),Vl(n,o,g,x),Hl(),g.state=n.memoizedState),typeof g.componentDidMount=="function"&&(n.flags|=4194308),o=!0}else if(r===null){g=n.stateNode;var F=n.memoizedProps,te=es(l,F);g.props=te;var xe=g.context,Ee=l.contextType;S=Rs,typeof Ee=="object"&&Ee!==null&&(S=ja(Ee));var Ce=l.getDerivedStateFromProps;Ee=typeof Ce=="function"||typeof g.getSnapshotBeforeUpdate=="function",F=n.pendingProps!==F,Ee||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(F||xe!==S)&&Px(n,g,o,S),si=!1;var ge=n.memoizedState;g.state=ge,Vl(n,o,g,x),Hl(),xe=n.memoizedState,F||ge!==xe||si?(typeof Ce=="function"&&(xu(n,l,Ce,o),xe=n.memoizedState),(te=si||zx(n,l,te,o,ge,xe,S))?(Ee||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(n.flags|=4194308)):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=o,n.memoizedState=xe),g.props=o,g.state=xe,g.context=S,o=te):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),o=!1)}else{g=n.stateNode,Yf(r,n),S=n.memoizedProps,Ee=es(l,S),g.props=Ee,Ce=n.pendingProps,ge=g.context,xe=l.contextType,te=Rs,typeof xe=="object"&&xe!==null&&(te=ja(xe)),F=l.getDerivedStateFromProps,(xe=typeof F=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S!==Ce||ge!==te)&&Px(n,g,o,te),si=!1,ge=n.memoizedState,g.state=ge,Vl(n,o,g,x),Hl();var _e=n.memoizedState;S!==Ce||ge!==_e||si||r!==null&&r.dependencies!==null&&w0(r.dependencies)?(typeof F=="function"&&(xu(n,l,F,o),_e=n.memoizedState),(Ee=si||zx(n,l,Ee,o,ge,_e,te)||r!==null&&r.dependencies!==null&&w0(r.dependencies))?(xe||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(o,_e,te),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(o,_e,te)),typeof g.componentDidUpdate=="function"&&(n.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof g.componentDidUpdate!="function"||S===r.memoizedProps&&ge===r.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&ge===r.memoizedState||(n.flags|=1024),n.memoizedProps=o,n.memoizedState=_e),g.props=o,g.state=_e,g.context=te,o=Ee):(typeof g.componentDidUpdate!="function"||S===r.memoizedProps&&ge===r.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&ge===r.memoizedState||(n.flags|=1024),o=!1)}return g=o,P0(r,n),o=(n.flags&128)!==0,g||o?(g=n.stateNode,l=o&&typeof l.getDerivedStateFromError!="function"?null:g.render(),n.flags|=1,r!==null&&o?(n.child=Qi(n,r.child,null,x),n.child=Qi(n,null,l,x)):Fa(r,n,l,x),n.memoizedState=g.state,r=n.child):r=Rn(r,n,x),r}function a1(r,n,l,o){return Yi(),n.flags|=256,Fa(r,n,l,o),n.child}var _u={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bu(r){return{baseLanes:r,cachePool:Xm()}}function wu(r,n,l){return r=r!==null?r.childLanes&~l:0,n&&(r|=_r),r}function r1(r,n,l){var o=n.pendingProps,x=!1,g=(n.flags&128)!==0,S;if((S=g)||(S=r!==null&&r.memoizedState===null?!1:(ia.current&2)!==0),S&&(x=!0,n.flags&=-129),S=(n.flags&32)!==0,n.flags&=-33,r===null){if(yt){if(x?oi(n):fi(),(r=Pt)?(r=up(r,Mr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(n.memoizedState={dehydrated:r,treeContext:ai!==null?{id:fn,overflow:un}:null,retryLane:536870912,hydrationErrors:null},l=Lm(r),l.return=n,n.child=l,Da=n,Pt=null)):r=null,r===null)throw ni(n);return nd(r)?n.lanes=32:n.lanes=536870912,null}var F=o.children;return o=o.fallback,x?(fi(),x=n.mode,F=H0({mode:"hidden",children:F},x),o=Xi(o,x,l,null),F.return=n,o.return=n,F.sibling=o,n.child=F,o=n.child,o.memoizedState=bu(l),o.childLanes=wu(r,S,l),n.memoizedState=_u,ql(null,o)):(oi(n),Su(n,F))}var te=r.memoizedState;if(te!==null&&(F=te.dehydrated,F!==null)){if(g)n.flags&256?(oi(n),n.flags&=-257,n=Eu(r,n,l)):n.memoizedState!==null?(fi(),n.child=r.child,n.flags|=128,n=null):(fi(),F=o.fallback,x=n.mode,o=H0({mode:"visible",children:o.children},x),F=Xi(F,x,l,null),F.flags|=2,o.return=n,F.return=n,o.sibling=F,n.child=o,Qi(n,r.child,null,l),o=n.child,o.memoizedState=bu(l),o.childLanes=wu(r,S,l),n.memoizedState=_u,n=ql(null,o));else if(oi(n),nd(F)){if(S=F.nextSibling&&F.nextSibling.dataset,S)var xe=S.dgst;S=xe,o=Error(i(419)),o.stack="",o.digest=S,Ll({value:o,source:null,stack:null}),n=Eu(r,n,l)}else if(ha||Bs(r,n,l,!1),S=(l&r.childLanes)!==0,ha||S){if(S=Ut,S!==null&&(o=Ts(S,l),o!==0&&o!==te.retryLane))throw te.retryLane=o,Gi(r,o),or(S,r,o),vu;rd(F)||$0(),n=Eu(r,n,l)}else rd(F)?(n.flags|=192,n.child=r.child,n=null):(r=te.treeContext,Pt=Ir(F.nextSibling),Da=n,yt=!0,ri=null,Mr=!1,r!==null&&Um(n,r),n=Su(n,o.children),n.flags|=4096);return n}return x?(fi(),F=o.fallback,x=n.mode,te=r.child,xe=te.sibling,o=kn(te,{mode:"hidden",children:o.children}),o.subtreeFlags=te.subtreeFlags&65011712,xe!==null?F=kn(xe,F):(F=Xi(F,x,l,null),F.flags|=2),F.return=n,o.return=n,o.sibling=F,n.child=o,ql(null,o),o=n.child,F=r.child.memoizedState,F===null?F=bu(l):(x=F.cachePool,x!==null?(te=ua._currentValue,x=x.parent!==te?{parent:te,pool:te}:x):x=Xm(),F={baseLanes:F.baseLanes|l,cachePool:x}),o.memoizedState=F,o.childLanes=wu(r,S,l),n.memoizedState=_u,ql(r.child,o)):(oi(n),l=r.child,r=l.sibling,l=kn(l,{mode:"visible",children:o.children}),l.return=n,l.sibling=null,r!==null&&(S=n.deletions,S===null?(n.deletions=[r],n.flags|=16):S.push(r)),n.child=l,n.memoizedState=null,l)}function Su(r,n){return n=H0({mode:"visible",children:n},r.mode),n.return=r,r.child=n}function H0(r,n){return r=pr(22,r,null,n),r.lanes=0,r}function Eu(r,n,l){return Qi(n,r.child,null,l),r=Su(n,n.pendingProps.children),r.flags|=2,n.memoizedState=null,r}function n1(r,n,l){r.lanes|=n;var o=r.alternate;o!==null&&(o.lanes|=n),Uf(r.return,n,l)}function Tu(r,n,l,o,x,g){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:o,tail:l,tailMode:x,treeForkCount:g}:(S.isBackwards=n,S.rendering=null,S.renderingStartTime=0,S.last=o,S.tail=l,S.tailMode=x,S.treeForkCount=g)}function i1(r,n,l){var o=n.pendingProps,x=o.revealOrder,g=o.tail;o=o.children;var S=ia.current,F=(S&2)!==0;if(F?(S=S&1|2,n.flags|=128):S&=1,O(ia,S),Fa(r,n,o,l),o=yt?Ml:0,!F&&r!==null&&(r.flags&128)!==0)e:for(r=n.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&n1(r,l,n);else if(r.tag===19)n1(r,l,n);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(x){case"forwards":for(l=n.child,x=null;l!==null;)r=l.alternate,r!==null&&D0(r)===null&&(x=l),l=l.sibling;l=x,l===null?(x=n.child,n.child=null):(x=l.sibling,l.sibling=null),Tu(n,!1,x,l,g,o);break;case"backwards":case"unstable_legacy-backwards":for(l=null,x=n.child,n.child=null;x!==null;){if(r=x.alternate,r!==null&&D0(r)===null){n.child=x;break}r=x.sibling,x.sibling=l,l=x,x=r}Tu(n,!0,l,null,g,o);break;case"together":Tu(n,!1,null,null,void 0,o);break;default:n.memoizedState=null}return n.child}function Rn(r,n,l){if(r!==null&&(n.dependencies=r.dependencies),hi|=n.lanes,(l&n.childLanes)===0)if(r!==null){if(Bs(r,n,l,!1),(l&n.childLanes)===0)return null}else return null;if(r!==null&&n.child!==r.child)throw Error(i(153));if(n.child!==null){for(r=n.child,l=kn(r,r.pendingProps),n.child=l,l.return=n;r.sibling!==null;)r=r.sibling,l=l.sibling=kn(r,r.pendingProps),l.return=n;l.sibling=null}return n.child}function Nu(r,n){return(r.lanes&n)!==0?!0:(r=r.dependencies,!!(r!==null&&w0(r)))}function ub(r,n,l){switch(n.tag){case 3:Ne(n,n.stateNode.containerInfo),ii(n,ua,r.memoizedState.cache),Yi();break;case 27:case 5:De(n);break;case 4:Ne(n,n.stateNode.containerInfo);break;case 10:ii(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,$f(n),null;break;case 13:var o=n.memoizedState;if(o!==null)return o.dehydrated!==null?(oi(n),n.flags|=128,null):(l&n.child.childLanes)!==0?r1(r,n,l):(oi(n),r=Rn(r,n,l),r!==null?r.sibling:null);oi(n);break;case 19:var x=(r.flags&128)!==0;if(o=(l&n.childLanes)!==0,o||(Bs(r,n,l,!1),o=(l&n.childLanes)!==0),x){if(o)return i1(r,n,l);n.flags|=128}if(x=n.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),O(ia,ia.current),o)break;return null;case 22:return n.lanes=0,$x(r,n,l,n.pendingProps);case 24:ii(n,ua,r.memoizedState.cache)}return Rn(r,n,l)}function s1(r,n,l){if(r!==null)if(r.memoizedProps!==n.pendingProps)ha=!0;else{if(!Nu(r,l)&&(n.flags&128)===0)return ha=!1,ub(r,n,l);ha=(r.flags&131072)!==0}else ha=!1,yt&&(n.flags&1048576)!==0&&Bm(n,Ml,n.index);switch(n.lanes=0,n.tag){case 16:e:{var o=n.pendingProps;if(r=Zi(n.elementType),n.type=r,typeof r=="function")jf(r)?(o=es(r,o),n.tag=1,n=t1(null,n,r,o,l)):(n.tag=0,n=yu(null,n,r,o,l));else{if(r!=null){var x=r.$$typeof;if(x===j){n.tag=11,n=qx(null,n,r,o,l);break e}else if(x===k){n.tag=14,n=Kx(null,n,r,o,l);break e}}throw n=ue(r)||r,Error(i(306,n,""))}}return n;case 0:return yu(r,n,n.type,n.pendingProps,l);case 1:return o=n.type,x=es(o,n.pendingProps),t1(r,n,o,x,l);case 3:e:{if(Ne(n,n.stateNode.containerInfo),r===null)throw Error(i(387));o=n.pendingProps;var g=n.memoizedState;x=g.element,Yf(r,n),Vl(n,o,null,l);var S=n.memoizedState;if(o=S.cache,ii(n,ua,o),o!==g.cache&&zf(n,[ua],l,!0),Hl(),o=S.element,g.isDehydrated)if(g={element:o,isDehydrated:!1,cache:S.cache},n.updateQueue.baseState=g,n.memoizedState=g,n.flags&256){n=a1(r,n,o,l);break e}else if(o!==x){x=Fr(Error(i(424)),n),Ll(x),n=a1(r,n,o,l);break e}else{switch(r=n.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Pt=Ir(r.firstChild),Da=n,yt=!0,ri=null,Mr=!0,l=$m(n,null,o,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Yi(),o===x){n=Rn(r,n,l);break e}Fa(r,n,o,l)}n=n.child}return n;case 26:return P0(r,n),r===null?(l=gp(n.type,null,n.pendingProps,null))?n.memoizedState=l:yt||(l=n.type,r=n.pendingProps,o=no(le.current).createElement(l),o[U]=n,o[H]=r,Oa(o,l,r),Ie(o),n.stateNode=o):n.memoizedState=gp(n.type,r.memoizedProps,n.pendingProps,r.memoizedState),null;case 27:return De(n),r===null&&yt&&(o=n.stateNode=mp(n.type,n.pendingProps,le.current),Da=n,Mr=!0,x=Pt,vi(n.type)?(sd=x,Pt=Ir(o.firstChild)):Pt=x),Fa(r,n,n.pendingProps.children,l),P0(r,n),r===null&&(n.flags|=4194304),n.child;case 5:return r===null&&yt&&((x=o=Pt)&&(o=Pb(o,n.type,n.pendingProps,Mr),o!==null?(n.stateNode=o,Da=n,Pt=Ir(o.firstChild),Mr=!1,x=!0):x=!1),x||ni(n)),De(n),x=n.type,g=n.pendingProps,S=r!==null?r.memoizedProps:null,o=g.children,ed(x,g)?o=null:S!==null&&ed(x,S)&&(n.flags|=32),n.memoizedState!==null&&(x=Jf(r,n,ab,null,null,l),oc._currentValue=x),P0(r,n),Fa(r,n,o,l),n.child;case 6:return r===null&&yt&&((r=l=Pt)&&(l=Hb(l,n.pendingProps,Mr),l!==null?(n.stateNode=l,Da=n,Pt=null,r=!0):r=!1),r||ni(n)),null;case 13:return r1(r,n,l);case 4:return Ne(n,n.stateNode.containerInfo),o=n.pendingProps,r===null?n.child=Qi(n,null,o,l):Fa(r,n,o,l),n.child;case 11:return qx(r,n,n.type,n.pendingProps,l);case 7:return Fa(r,n,n.pendingProps,l),n.child;case 8:return Fa(r,n,n.pendingProps.children,l),n.child;case 12:return Fa(r,n,n.pendingProps.children,l),n.child;case 10:return o=n.pendingProps,ii(n,n.type,o.value),Fa(r,n,o.children,l),n.child;case 9:return x=n.type._context,o=n.pendingProps.children,qi(n),x=ja(x),o=o(x),n.flags|=1,Fa(r,n,o,l),n.child;case 14:return Kx(r,n,n.type,n.pendingProps,l);case 15:return Zx(r,n,n.type,n.pendingProps,l);case 19:return i1(r,n,l);case 31:return fb(r,n,l);case 22:return $x(r,n,l,n.pendingProps);case 24:return qi(n),o=ja(ua),r===null?(x=Vf(),x===null&&(x=Ut,g=Pf(),x.pooledCache=g,g.refCount++,g!==null&&(x.pooledCacheLanes|=l),x=g),n.memoizedState={parent:o,cache:x},Xf(n),ii(n,ua,x)):((r.lanes&l)!==0&&(Yf(r,n),Vl(n,null,null,l),Hl()),x=r.memoizedState,g=n.memoizedState,x.parent!==o?(x={parent:o,cache:o},n.memoizedState=x,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=x),ii(n,ua,o)):(o=g.cache,ii(n,ua,o),o!==x.cache&&zf(n,[ua],l,!0))),Fa(r,n,n.pendingProps.children,l),n.child;case 29:throw n.pendingProps}throw Error(i(156,n.tag))}function Mn(r){r.flags|=4}function Au(r,n,l,o,x){if((n=(r.mode&32)!==0)&&(n=!1),n){if(r.flags|=16777216,(x&335544128)===x)if(r.stateNode.complete)r.flags|=8192;else if(O1())r.flags|=8192;else throw $i=N0,Gf}else r.flags&=-16777217}function l1(r,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!wp(n))if(O1())r.flags|=8192;else throw $i=N0,Gf}function V0(r,n){n!==null&&(r.flags|=4),r.flags&16384&&(n=r.tag!==22?Zr():536870912,r.lanes|=n,Zs|=n)}function Kl(r,n){if(!yt)switch(r.tailMode){case"hidden":n=r.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var o=null;l!==null;)l.alternate!==null&&(o=l),l=l.sibling;o===null?n||r.tail===null?r.tail=null:r.tail.sibling=null:o.sibling=null}}function Ht(r){var n=r.alternate!==null&&r.alternate.child===r.child,l=0,o=0;if(n)for(var x=r.child;x!==null;)l|=x.lanes|x.childLanes,o|=x.subtreeFlags&65011712,o|=x.flags&65011712,x.return=r,x=x.sibling;else for(x=r.child;x!==null;)l|=x.lanes|x.childLanes,o|=x.subtreeFlags,o|=x.flags,x.return=r,x=x.sibling;return r.subtreeFlags|=o,r.childLanes=l,n}function db(r,n,l){var o=n.pendingProps;switch(Mf(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(n),null;case 1:return Ht(n),null;case 3:return l=n.stateNode,o=null,r!==null&&(o=r.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),jn(ua),Te(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(Is(n)?Mn(n):r===null||r.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,If())),Ht(n),null;case 26:var x=n.type,g=n.memoizedState;return r===null?(Mn(n),g!==null?(Ht(n),l1(n,g)):(Ht(n),Au(n,x,null,o,l))):g?g!==r.memoizedState?(Mn(n),Ht(n),l1(n,g)):(Ht(n),n.flags&=-16777217):(r=r.memoizedProps,r!==o&&Mn(n),Ht(n),Au(n,x,r,o,l)),null;case 27:if(Ve(n),l=le.current,x=n.type,r!==null&&n.stateNode!=null)r.memoizedProps!==o&&Mn(n);else{if(!o){if(n.stateNode===null)throw Error(i(166));return Ht(n),null}r=B.current,Is(n)?zm(n):(r=mp(x,o,l),n.stateNode=r,Mn(n))}return Ht(n),null;case 5:if(Ve(n),x=n.type,r!==null&&n.stateNode!=null)r.memoizedProps!==o&&Mn(n);else{if(!o){if(n.stateNode===null)throw Error(i(166));return Ht(n),null}if(g=B.current,Is(n))zm(n);else{var S=no(le.current);switch(g){case 1:g=S.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:g=S.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":g=S.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":g=S.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":g=S.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof o.is=="string"?S.createElement("select",{is:o.is}):S.createElement("select"),o.multiple?g.multiple=!0:o.size&&(g.size=o.size);break;default:g=typeof o.is=="string"?S.createElement(x,{is:o.is}):S.createElement(x)}}g[U]=n,g[H]=o;e:for(S=n.child;S!==null;){if(S.tag===5||S.tag===6)g.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===n)break e;for(;S.sibling===null;){if(S.return===null||S.return===n)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}n.stateNode=g;e:switch(Oa(g,x,o),x){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&Mn(n)}}return Ht(n),Au(n,n.type,r===null?null:r.memoizedProps,n.pendingProps,l),null;case 6:if(r&&n.stateNode!=null)r.memoizedProps!==o&&Mn(n);else{if(typeof o!="string"&&n.stateNode===null)throw Error(i(166));if(r=le.current,Is(n)){if(r=n.stateNode,l=n.memoizedProps,o=null,x=Da,x!==null)switch(x.tag){case 27:case 5:o=x.memoizedProps}r[U]=n,r=!!(r.nodeValue===l||o!==null&&o.suppressHydrationWarning===!0||rp(r.nodeValue,l)),r||ni(n,!0)}else r=no(r).createTextNode(o),r[U]=n,n.stateNode=r}return Ht(n),null;case 31:if(l=n.memoizedState,r===null||r.memoizedState!==null){if(o=Is(n),l!==null){if(r===null){if(!o)throw Error(i(318));if(r=n.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[U]=n}else Yi(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Ht(n),r=!1}else l=If(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=l),r=!0;if(!r)return n.flags&256?(vr(n),n):(vr(n),null);if((n.flags&128)!==0)throw Error(i(558))}return Ht(n),null;case 13:if(o=n.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(x=Is(n),o!==null&&o.dehydrated!==null){if(r===null){if(!x)throw Error(i(318));if(x=n.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(i(317));x[U]=n}else Yi(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Ht(n),x=!1}else x=If(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=x),x=!0;if(!x)return n.flags&256?(vr(n),n):(vr(n),null)}return vr(n),(n.flags&128)!==0?(n.lanes=l,n):(l=o!==null,r=r!==null&&r.memoizedState!==null,l&&(o=n.child,x=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(x=o.alternate.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==x&&(o.flags|=2048)),l!==r&&l&&(n.child.flags|=8192),V0(n,n.updateQueue),Ht(n),null);case 4:return Te(),r===null&&Ku(n.stateNode.containerInfo),Ht(n),null;case 10:return jn(n.type),Ht(n),null;case 19:if(E(ia),o=n.memoizedState,o===null)return Ht(n),null;if(x=(n.flags&128)!==0,g=o.rendering,g===null)if(x)Kl(o,!1);else{if(Jt!==0||r!==null&&(r.flags&128)!==0)for(r=n.child;r!==null;){if(g=D0(r),g!==null){for(n.flags|=128,Kl(o,!1),r=g.updateQueue,n.updateQueue=r,V0(n,r),n.subtreeFlags=0,r=l,l=n.child;l!==null;)Mm(l,r),l=l.sibling;return O(ia,ia.current&1|2),yt&&Cn(n,o.treeForkCount),n.child}r=r.sibling}o.tail!==null&&bt()>q0&&(n.flags|=128,x=!0,Kl(o,!1),n.lanes=4194304)}else{if(!x)if(r=D0(g),r!==null){if(n.flags|=128,x=!0,r=r.updateQueue,n.updateQueue=r,V0(n,r),Kl(o,!0),o.tail===null&&o.tailMode==="hidden"&&!g.alternate&&!yt)return Ht(n),null}else 2*bt()-o.renderingStartTime>q0&&l!==536870912&&(n.flags|=128,x=!0,Kl(o,!1),n.lanes=4194304);o.isBackwards?(g.sibling=n.child,n.child=g):(r=o.last,r!==null?r.sibling=g:n.child=g,o.last=g)}return o.tail!==null?(r=o.tail,o.rendering=r,o.tail=r.sibling,o.renderingStartTime=bt(),r.sibling=null,l=ia.current,O(ia,x?l&1|2:l&1),yt&&Cn(n,o.treeForkCount),r):(Ht(n),null);case 22:case 23:return vr(n),Zf(),o=n.memoizedState!==null,r!==null?r.memoizedState!==null!==o&&(n.flags|=8192):o&&(n.flags|=8192),o?(l&536870912)!==0&&(n.flags&128)===0&&(Ht(n),n.subtreeFlags&6&&(n.flags|=8192)):Ht(n),l=n.updateQueue,l!==null&&V0(n,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),o=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),o!==l&&(n.flags|=2048),r!==null&&E(Ki),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),jn(ua),Ht(n),null;case 25:return null;case 30:return null}throw Error(i(156,n.tag))}function hb(r,n){switch(Mf(n),n.tag){case 1:return r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 3:return jn(ua),Te(),r=n.flags,(r&65536)!==0&&(r&128)===0?(n.flags=r&-65537|128,n):null;case 26:case 27:case 5:return Ve(n),null;case 31:if(n.memoizedState!==null){if(vr(n),n.alternate===null)throw Error(i(340));Yi()}return r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 13:if(vr(n),r=n.memoizedState,r!==null&&r.dehydrated!==null){if(n.alternate===null)throw Error(i(340));Yi()}return r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 19:return E(ia),null;case 4:return Te(),null;case 10:return jn(n.type),null;case 22:case 23:return vr(n),Zf(),r!==null&&E(Ki),r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 24:return jn(ua),null;case 25:return null;default:return null}}function c1(r,n){switch(Mf(n),n.tag){case 3:jn(ua),Te();break;case 26:case 27:case 5:Ve(n);break;case 4:Te();break;case 31:n.memoizedState!==null&&vr(n);break;case 13:vr(n);break;case 19:E(ia);break;case 10:jn(n.type);break;case 22:case 23:vr(n),Zf(),r!==null&&E(Ki);break;case 24:jn(ua)}}function Zl(r,n){try{var l=n.updateQueue,o=l!==null?l.lastEffect:null;if(o!==null){var x=o.next;l=x;do{if((l.tag&r)===r){o=void 0;var g=l.create,S=l.inst;o=g(),S.destroy=o}l=l.next}while(l!==x)}}catch(F){Dt(n,n.return,F)}}function ui(r,n,l){try{var o=n.updateQueue,x=o!==null?o.lastEffect:null;if(x!==null){var g=x.next;o=g;do{if((o.tag&r)===r){var S=o.inst,F=S.destroy;if(F!==void 0){S.destroy=void 0,x=n;var te=l,xe=F;try{xe()}catch(Ee){Dt(x,te,Ee)}}}o=o.next}while(o!==g)}}catch(Ee){Dt(n,n.return,Ee)}}function o1(r){var n=r.updateQueue;if(n!==null){var l=r.stateNode;try{Jm(n,l)}catch(o){Dt(r,r.return,o)}}}function f1(r,n,l){l.props=es(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(o){Dt(r,n,o)}}function $l(r,n){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var o=r.stateNode;break;case 30:o=r.stateNode;break;default:o=r.stateNode}typeof l=="function"?r.refCleanup=l(o):l.current=o}}catch(x){Dt(r,n,x)}}function dn(r,n){var l=r.ref,o=r.refCleanup;if(l!==null)if(typeof o=="function")try{o()}catch(x){Dt(r,n,x)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(x){Dt(r,n,x)}else l.current=null}function u1(r){var n=r.type,l=r.memoizedProps,o=r.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":l.autoFocus&&o.focus();break e;case"img":l.src?o.src=l.src:l.srcSet&&(o.srcset=l.srcSet)}}catch(x){Dt(r,r.return,x)}}function ku(r,n,l){try{var o=r.stateNode;Mb(o,r.type,l,n),o[H]=n}catch(x){Dt(r,r.return,x)}}function d1(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&vi(r.type)||r.tag===4}function Cu(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||d1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&vi(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Du(r,n,l){var o=r.tag;if(o===5||o===6)r=r.stateNode,n?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,n):(n=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,n.appendChild(r),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=Nn));else if(o!==4&&(o===27&&vi(r.type)&&(l=r.stateNode,n=null),r=r.child,r!==null))for(Du(r,n,l),r=r.sibling;r!==null;)Du(r,n,l),r=r.sibling}function G0(r,n,l){var o=r.tag;if(o===5||o===6)r=r.stateNode,n?l.insertBefore(r,n):l.appendChild(r);else if(o!==4&&(o===27&&vi(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(G0(r,n,l),r=r.sibling;r!==null;)G0(r,n,l),r=r.sibling}function h1(r){var n=r.stateNode,l=r.memoizedProps;try{for(var o=r.type,x=n.attributes;x.length;)n.removeAttributeNode(x[0]);Oa(n,o,l),n[U]=r,n[H]=l}catch(g){Dt(r,r.return,g)}}var Ln=!1,ma=!1,ju=!1,m1=typeof WeakSet=="function"?WeakSet:Set,Ta=null;function mb(r,n){if(r=r.containerInfo,Qu=uo,r=Nm(r),Ef(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var o=l.getSelection&&l.getSelection();if(o&&o.rangeCount!==0){l=o.anchorNode;var x=o.anchorOffset,g=o.focusNode;o=o.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var S=0,F=-1,te=-1,xe=0,Ee=0,Ce=r,ge=null;t:for(;;){for(var _e;Ce!==l||x!==0&&Ce.nodeType!==3||(F=S+x),Ce!==g||o!==0&&Ce.nodeType!==3||(te=S+o),Ce.nodeType===3&&(S+=Ce.nodeValue.length),(_e=Ce.firstChild)!==null;)ge=Ce,Ce=_e;for(;;){if(Ce===r)break t;if(ge===l&&++xe===x&&(F=S),ge===g&&++Ee===o&&(te=S),(_e=Ce.nextSibling)!==null)break;Ce=ge,ge=Ce.parentNode}Ce=_e}l=F===-1||te===-1?null:{start:F,end:te}}else l=null}l=l||{start:0,end:0}}else l=null;for(Ju={focusedElem:r,selectionRange:l},uo=!1,Ta=n;Ta!==null;)if(n=Ta,r=n.child,(n.subtreeFlags&1028)!==0&&r!==null)r.return=n,Ta=r;else for(;Ta!==null;){switch(n=Ta,g=n.alternate,r=n.flags,n.tag){case 0:if((r&4)!==0&&(r=n.updateQueue,r=r!==null?r.events:null,r!==null))for(l=0;l<r.length;l++)x=r[l],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&g!==null){r=void 0,l=n,x=g.memoizedProps,g=g.memoizedState,o=l.stateNode;try{var ze=es(l.type,x);r=o.getSnapshotBeforeUpdate(ze,g),o.__reactInternalSnapshotBeforeUpdate=r}catch(Ke){Dt(l,l.return,Ke)}}break;case 3:if((r&1024)!==0){if(r=n.stateNode.containerInfo,l=r.nodeType,l===9)ad(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":ad(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=n.sibling,r!==null){r.return=n.return,Ta=r;break}Ta=n.return}}function x1(r,n,l){var o=l.flags;switch(l.tag){case 0:case 11:case 15:Bn(r,l),o&4&&Zl(5,l);break;case 1:if(Bn(r,l),o&4)if(r=l.stateNode,n===null)try{r.componentDidMount()}catch(S){Dt(l,l.return,S)}else{var x=es(l.type,n.memoizedProps);n=n.memoizedState;try{r.componentDidUpdate(x,n,r.__reactInternalSnapshotBeforeUpdate)}catch(S){Dt(l,l.return,S)}}o&64&&o1(l),o&512&&$l(l,l.return);break;case 3:if(Bn(r,l),o&64&&(r=l.updateQueue,r!==null)){if(n=null,l.child!==null)switch(l.child.tag){case 27:case 5:n=l.child.stateNode;break;case 1:n=l.child.stateNode}try{Jm(r,n)}catch(S){Dt(l,l.return,S)}}break;case 27:n===null&&o&4&&h1(l);case 26:case 5:Bn(r,l),n===null&&o&4&&u1(l),o&512&&$l(l,l.return);break;case 12:Bn(r,l);break;case 31:Bn(r,l),o&4&&v1(r,l);break;case 13:Bn(r,l),o&4&&y1(r,l),o&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=Sb.bind(null,l),Vb(r,l))));break;case 22:if(o=l.memoizedState!==null||Ln,!o){n=n!==null&&n.memoizedState!==null||ma,x=Ln;var g=ma;Ln=o,(ma=n)&&!g?Un(r,l,(l.subtreeFlags&8772)!==0):Bn(r,l),Ln=x,ma=g}break;case 30:break;default:Bn(r,l)}}function p1(r){var n=r.alternate;n!==null&&(r.alternate=null,p1(n)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(n=r.stateNode,n!==null&&P(n)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Yt=null,ir=!1;function In(r,n,l){for(l=l.child;l!==null;)g1(r,n,l),l=l.sibling}function g1(r,n,l){if(_t&&typeof _t.onCommitFiberUnmount=="function")try{_t.onCommitFiberUnmount(et,l)}catch{}switch(l.tag){case 26:ma||dn(l,n),In(r,n,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:ma||dn(l,n);var o=Yt,x=ir;vi(l.type)&&(Yt=l.stateNode,ir=!1),In(r,n,l),sc(l.stateNode),Yt=o,ir=x;break;case 5:ma||dn(l,n);case 6:if(o=Yt,x=ir,Yt=null,In(r,n,l),Yt=o,ir=x,Yt!==null)if(ir)try{(Yt.nodeType===9?Yt.body:Yt.nodeName==="HTML"?Yt.ownerDocument.body:Yt).removeChild(l.stateNode)}catch(g){Dt(l,n,g)}else try{Yt.removeChild(l.stateNode)}catch(g){Dt(l,n,g)}break;case 18:Yt!==null&&(ir?(r=Yt,op(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),nl(r)):op(Yt,l.stateNode));break;case 4:o=Yt,x=ir,Yt=l.stateNode.containerInfo,ir=!0,In(r,n,l),Yt=o,ir=x;break;case 0:case 11:case 14:case 15:ui(2,l,n),ma||ui(4,l,n),In(r,n,l);break;case 1:ma||(dn(l,n),o=l.stateNode,typeof o.componentWillUnmount=="function"&&f1(l,n,o)),In(r,n,l);break;case 21:In(r,n,l);break;case 22:ma=(o=ma)||l.memoizedState!==null,In(r,n,l),ma=o;break;default:In(r,n,l)}}function v1(r,n){if(n.memoizedState===null&&(r=n.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{nl(r)}catch(l){Dt(n,n.return,l)}}}function y1(r,n){if(n.memoizedState===null&&(r=n.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{nl(r)}catch(l){Dt(n,n.return,l)}}function xb(r){switch(r.tag){case 31:case 13:case 19:var n=r.stateNode;return n===null&&(n=r.stateNode=new m1),n;case 22:return r=r.stateNode,n=r._retryCache,n===null&&(n=r._retryCache=new m1),n;default:throw Error(i(435,r.tag))}}function X0(r,n){var l=xb(r);n.forEach(function(o){if(!l.has(o)){l.add(o);var x=Eb.bind(null,r,o);o.then(x,x)}})}function sr(r,n){var l=n.deletions;if(l!==null)for(var o=0;o<l.length;o++){var x=l[o],g=r,S=n,F=S;e:for(;F!==null;){switch(F.tag){case 27:if(vi(F.type)){Yt=F.stateNode,ir=!1;break e}break;case 5:Yt=F.stateNode,ir=!1;break e;case 3:case 4:Yt=F.stateNode.containerInfo,ir=!0;break e}F=F.return}if(Yt===null)throw Error(i(160));g1(g,S,x),Yt=null,ir=!1,g=x.alternate,g!==null&&(g.return=null),x.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)_1(n,r),n=n.sibling}var Jr=null;function _1(r,n){var l=r.alternate,o=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:sr(n,r),lr(r),o&4&&(ui(3,r,r.return),Zl(3,r),ui(5,r,r.return));break;case 1:sr(n,r),lr(r),o&512&&(ma||l===null||dn(l,l.return)),o&64&&Ln&&(r=r.updateQueue,r!==null&&(o=r.callbacks,o!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?o:l.concat(o))));break;case 26:var x=Jr;if(sr(n,r),lr(r),o&512&&(ma||l===null||dn(l,l.return)),o&4){var g=l!==null?l.memoizedState:null;if(o=r.memoizedState,l===null)if(o===null)if(r.stateNode===null){e:{o=r.type,l=r.memoizedProps,x=x.ownerDocument||x;t:switch(o){case"title":g=x.getElementsByTagName("title")[0],(!g||g[ne]||g[U]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=x.createElement(o),x.head.insertBefore(g,x.querySelector("head > title"))),Oa(g,o,l),g[U]=r,Ie(g),o=g;break e;case"link":var S=_p("link","href",x).get(o+(l.href||""));if(S){for(var F=0;F<S.length;F++)if(g=S[F],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){S.splice(F,1);break t}}g=x.createElement(o),Oa(g,o,l),x.head.appendChild(g);break;case"meta":if(S=_p("meta","content",x).get(o+(l.content||""))){for(F=0;F<S.length;F++)if(g=S[F],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){S.splice(F,1);break t}}g=x.createElement(o),Oa(g,o,l),x.head.appendChild(g);break;default:throw Error(i(468,o))}g[U]=r,Ie(g),o=g}r.stateNode=o}else bp(x,r.type,r.stateNode);else r.stateNode=yp(x,o,r.memoizedProps);else g!==o?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,o===null?bp(x,r.type,r.stateNode):yp(x,o,r.memoizedProps)):o===null&&r.stateNode!==null&&ku(r,r.memoizedProps,l.memoizedProps)}break;case 27:sr(n,r),lr(r),o&512&&(ma||l===null||dn(l,l.return)),l!==null&&o&4&&ku(r,r.memoizedProps,l.memoizedProps);break;case 5:if(sr(n,r),lr(r),o&512&&(ma||l===null||dn(l,l.return)),r.flags&32){x=r.stateNode;try{As(x,"")}catch(ze){Dt(r,r.return,ze)}}o&4&&r.stateNode!=null&&(x=r.memoizedProps,ku(r,x,l!==null?l.memoizedProps:x)),o&1024&&(ju=!0);break;case 6:if(sr(n,r),lr(r),o&4){if(r.stateNode===null)throw Error(i(162));o=r.memoizedProps,l=r.stateNode;try{l.nodeValue=o}catch(ze){Dt(r,r.return,ze)}}break;case 3:if(lo=null,x=Jr,Jr=io(n.containerInfo),sr(n,r),Jr=x,lr(r),o&4&&l!==null&&l.memoizedState.isDehydrated)try{nl(n.containerInfo)}catch(ze){Dt(r,r.return,ze)}ju&&(ju=!1,b1(r));break;case 4:o=Jr,Jr=io(r.stateNode.containerInfo),sr(n,r),lr(r),Jr=o;break;case 12:sr(n,r),lr(r);break;case 31:sr(n,r),lr(r),o&4&&(o=r.updateQueue,o!==null&&(r.updateQueue=null,X0(r,o)));break;case 13:sr(n,r),lr(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(W0=bt()),o&4&&(o=r.updateQueue,o!==null&&(r.updateQueue=null,X0(r,o)));break;case 22:x=r.memoizedState!==null;var te=l!==null&&l.memoizedState!==null,xe=Ln,Ee=ma;if(Ln=xe||x,ma=Ee||te,sr(n,r),ma=Ee,Ln=xe,lr(r),o&8192)e:for(n=r.stateNode,n._visibility=x?n._visibility&-2:n._visibility|1,x&&(l===null||te||Ln||ma||ts(r)),l=null,n=r;;){if(n.tag===5||n.tag===26){if(l===null){te=l=n;try{if(g=te.stateNode,x)S=g.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{F=te.stateNode;var Ce=te.memoizedProps.style,ge=Ce!=null&&Ce.hasOwnProperty("display")?Ce.display:null;F.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(ze){Dt(te,te.return,ze)}}}else if(n.tag===6){if(l===null){te=n;try{te.stateNode.nodeValue=x?"":te.memoizedProps}catch(ze){Dt(te,te.return,ze)}}}else if(n.tag===18){if(l===null){te=n;try{var _e=te.stateNode;x?fp(_e,!0):fp(te.stateNode,!1)}catch(ze){Dt(te,te.return,ze)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===r)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;l===n&&(l=null),n=n.return}l===n&&(l=null),n.sibling.return=n.return,n=n.sibling}o&4&&(o=r.updateQueue,o!==null&&(l=o.retryQueue,l!==null&&(o.retryQueue=null,X0(r,l))));break;case 19:sr(n,r),lr(r),o&4&&(o=r.updateQueue,o!==null&&(r.updateQueue=null,X0(r,o)));break;case 30:break;case 21:break;default:sr(n,r),lr(r)}}function lr(r){var n=r.flags;if(n&2){try{for(var l,o=r.return;o!==null;){if(d1(o)){l=o;break}o=o.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var x=l.stateNode,g=Cu(r);G0(r,g,x);break;case 5:var S=l.stateNode;l.flags&32&&(As(S,""),l.flags&=-33);var F=Cu(r);G0(r,F,S);break;case 3:case 4:var te=l.stateNode.containerInfo,xe=Cu(r);Du(r,xe,te);break;default:throw Error(i(161))}}catch(Ee){Dt(r,r.return,Ee)}r.flags&=-3}n&4096&&(r.flags&=-4097)}function b1(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var n=r;b1(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),r=r.sibling}}function Bn(r,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)x1(r,n.alternate,n),n=n.sibling}function ts(r){for(r=r.child;r!==null;){var n=r;switch(n.tag){case 0:case 11:case 14:case 15:ui(4,n,n.return),ts(n);break;case 1:dn(n,n.return);var l=n.stateNode;typeof l.componentWillUnmount=="function"&&f1(n,n.return,l),ts(n);break;case 27:sc(n.stateNode);case 26:case 5:dn(n,n.return),ts(n);break;case 22:n.memoizedState===null&&ts(n);break;case 30:ts(n);break;default:ts(n)}r=r.sibling}}function Un(r,n,l){for(l=l&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var o=n.alternate,x=r,g=n,S=g.flags;switch(g.tag){case 0:case 11:case 15:Un(x,g,l),Zl(4,g);break;case 1:if(Un(x,g,l),o=g,x=o.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(xe){Dt(o,o.return,xe)}if(o=g,x=o.updateQueue,x!==null){var F=o.stateNode;try{var te=x.shared.hiddenCallbacks;if(te!==null)for(x.shared.hiddenCallbacks=null,x=0;x<te.length;x++)Qm(te[x],F)}catch(xe){Dt(o,o.return,xe)}}l&&S&64&&o1(g),$l(g,g.return);break;case 27:h1(g);case 26:case 5:Un(x,g,l),l&&o===null&&S&4&&u1(g),$l(g,g.return);break;case 12:Un(x,g,l);break;case 31:Un(x,g,l),l&&S&4&&v1(x,g);break;case 13:Un(x,g,l),l&&S&4&&y1(x,g);break;case 22:g.memoizedState===null&&Un(x,g,l),$l(g,g.return);break;case 30:break;default:Un(x,g,l)}n=n.sibling}}function Fu(r,n){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&Il(l))}function Ou(r,n){r=null,n.alternate!==null&&(r=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==r&&(n.refCount++,r!=null&&Il(r))}function en(r,n,l,o){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)w1(r,n,l,o),n=n.sibling}function w1(r,n,l,o){var x=n.flags;switch(n.tag){case 0:case 11:case 15:en(r,n,l,o),x&2048&&Zl(9,n);break;case 1:en(r,n,l,o);break;case 3:en(r,n,l,o),x&2048&&(r=null,n.alternate!==null&&(r=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==r&&(n.refCount++,r!=null&&Il(r)));break;case 12:if(x&2048){en(r,n,l,o),r=n.stateNode;try{var g=n.memoizedProps,S=g.id,F=g.onPostCommit;typeof F=="function"&&F(S,n.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(te){Dt(n,n.return,te)}}else en(r,n,l,o);break;case 31:en(r,n,l,o);break;case 13:en(r,n,l,o);break;case 23:break;case 22:g=n.stateNode,S=n.alternate,n.memoizedState!==null?g._visibility&2?en(r,n,l,o):Ql(r,n):g._visibility&2?en(r,n,l,o):(g._visibility|=2,Ws(r,n,l,o,(n.subtreeFlags&10256)!==0||!1)),x&2048&&Fu(S,n);break;case 24:en(r,n,l,o),x&2048&&Ou(n.alternate,n);break;default:en(r,n,l,o)}}function Ws(r,n,l,o,x){for(x=x&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var g=r,S=n,F=l,te=o,xe=S.flags;switch(S.tag){case 0:case 11:case 15:Ws(g,S,F,te,x),Zl(8,S);break;case 23:break;case 22:var Ee=S.stateNode;S.memoizedState!==null?Ee._visibility&2?Ws(g,S,F,te,x):Ql(g,S):(Ee._visibility|=2,Ws(g,S,F,te,x)),x&&xe&2048&&Fu(S.alternate,S);break;case 24:Ws(g,S,F,te,x),x&&xe&2048&&Ou(S.alternate,S);break;default:Ws(g,S,F,te,x)}n=n.sibling}}function Ql(r,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var l=r,o=n,x=o.flags;switch(o.tag){case 22:Ql(l,o),x&2048&&Fu(o.alternate,o);break;case 24:Ql(l,o),x&2048&&Ou(o.alternate,o);break;default:Ql(l,o)}n=n.sibling}}var Jl=8192;function qs(r,n,l){if(r.subtreeFlags&Jl)for(r=r.child;r!==null;)S1(r,n,l),r=r.sibling}function S1(r,n,l){switch(r.tag){case 26:qs(r,n,l),r.flags&Jl&&r.memoizedState!==null&&tw(l,Jr,r.memoizedState,r.memoizedProps);break;case 5:qs(r,n,l);break;case 3:case 4:var o=Jr;Jr=io(r.stateNode.containerInfo),qs(r,n,l),Jr=o;break;case 22:r.memoizedState===null&&(o=r.alternate,o!==null&&o.memoizedState!==null?(o=Jl,Jl=16777216,qs(r,n,l),Jl=o):qs(r,n,l));break;default:qs(r,n,l)}}function E1(r){var n=r.alternate;if(n!==null&&(r=n.child,r!==null)){n.child=null;do n=r.sibling,r.sibling=null,r=n;while(r!==null)}}function ec(r){var n=r.deletions;if((r.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var o=n[l];Ta=o,N1(o,r)}E1(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)T1(r),r=r.sibling}function T1(r){switch(r.tag){case 0:case 11:case 15:ec(r),r.flags&2048&&ui(9,r,r.return);break;case 3:ec(r);break;case 12:ec(r);break;case 22:var n=r.stateNode;r.memoizedState!==null&&n._visibility&2&&(r.return===null||r.return.tag!==13)?(n._visibility&=-3,Y0(r)):ec(r);break;default:ec(r)}}function Y0(r){var n=r.deletions;if((r.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var o=n[l];Ta=o,N1(o,r)}E1(r)}for(r=r.child;r!==null;){switch(n=r,n.tag){case 0:case 11:case 15:ui(8,n,n.return),Y0(n);break;case 22:l=n.stateNode,l._visibility&2&&(l._visibility&=-3,Y0(n));break;default:Y0(n)}r=r.sibling}}function N1(r,n){for(;Ta!==null;){var l=Ta;switch(l.tag){case 0:case 11:case 15:ui(8,l,n);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var o=l.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Il(l.memoizedState.cache)}if(o=l.child,o!==null)o.return=l,Ta=o;else e:for(l=r;Ta!==null;){o=Ta;var x=o.sibling,g=o.return;if(p1(o),o===l){Ta=null;break e}if(x!==null){x.return=g,Ta=x;break e}Ta=g}}}var pb={getCacheForType:function(r){var n=ja(ua),l=n.data.get(r);return l===void 0&&(l=r(),n.data.set(r,l)),l},cacheSignal:function(){return ja(ua).controller.signal}},gb=typeof WeakMap=="function"?WeakMap:Map,kt=0,Ut=null,ut=null,pt=0,Ct=0,yr=null,di=!1,Ks=!1,Ru=!1,zn=0,Jt=0,hi=0,as=0,Mu=0,_r=0,Zs=0,tc=null,cr=null,Lu=!1,W0=0,A1=0,q0=1/0,K0=null,mi=null,_a=0,xi=null,$s=null,Pn=0,Iu=0,Bu=null,k1=null,ac=0,Uu=null;function br(){return(kt&2)!==0&&pt!==0?pt&-pt:ee.T!==null?Xu():D()}function C1(){if(_r===0)if((pt&536870912)===0||yt){var r=Kr;Kr<<=1,(Kr&3932160)===0&&(Kr=262144),_r=r}else _r=536870912;return r=gr.current,r!==null&&(r.flags|=32),_r}function or(r,n,l){(r===Ut&&(Ct===2||Ct===9)||r.cancelPendingCommit!==null)&&(Qs(r,0),pi(r,pt,_r,!1)),on(r,l),((kt&2)===0||r!==Ut)&&(r===Ut&&((kt&2)===0&&(as|=l),Jt===4&&pi(r,pt,_r,!1)),hn(r))}function D1(r,n,l){if((kt&6)!==0)throw Error(i(327));var o=!l&&(n&127)===0&&(n&r.expiredLanes)===0||Sn(r,n),x=o?_b(r,n):Pu(r,n,!0),g=o;do{if(x===0){Ks&&!o&&pi(r,n,0,!1);break}else{if(l=r.current.alternate,g&&!vb(l)){x=Pu(r,n,!1),g=!1;continue}if(x===2){if(g=n,r.errorRecoveryDisabledLanes&g)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){n=S;e:{var F=r;x=tc;var te=F.current.memoizedState.isDehydrated;if(te&&(Qs(F,S).flags|=256),S=Pu(F,S,!1),S!==2){if(Ru&&!te){F.errorRecoveryDisabledLanes|=g,as|=g,x=4;break e}g=cr,cr=x,g!==null&&(cr===null?cr=g:cr.push.apply(cr,g))}x=S}if(g=!1,x!==2)continue}}if(x===1){Qs(r,0),pi(r,n,0,!0);break}e:{switch(o=r,g=x,g){case 0:case 1:throw Error(i(345));case 4:if((n&4194048)!==n)break;case 6:pi(o,n,_r,!di);break e;case 2:cr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((n&62914560)===n&&(x=W0+300-bt(),10<x)){if(pi(o,n,_r,!di),ei(o,0,!0)!==0)break e;Pn=n,o.timeoutHandle=lp(j1.bind(null,o,l,cr,K0,Lu,n,_r,as,Zs,di,g,"Throttled",-0,0),x);break e}j1(o,l,cr,K0,Lu,n,_r,as,Zs,di,g,null,-0,0)}}break}while(!0);hn(r)}function j1(r,n,l,o,x,g,S,F,te,xe,Ee,Ce,ge,_e){if(r.timeoutHandle=-1,Ce=n.subtreeFlags,Ce&8192||(Ce&16785408)===16785408){Ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Nn},S1(n,g,Ce);var ze=(g&62914560)===g?W0-bt():(g&4194048)===g?A1-bt():0;if(ze=aw(Ce,ze),ze!==null){Pn=g,r.cancelPendingCommit=ze(U1.bind(null,r,n,g,l,o,x,S,F,te,Ee,Ce,null,ge,_e)),pi(r,g,S,!xe);return}}U1(r,n,g,l,o,x,S,F,te)}function vb(r){for(var n=r;;){var l=n.tag;if((l===0||l===11||l===15)&&n.flags&16384&&(l=n.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var o=0;o<l.length;o++){var x=l[o],g=x.getSnapshot;x=x.value;try{if(!xr(g(),x))return!1}catch{return!1}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function pi(r,n,l,o){n&=~Mu,n&=~as,r.suspendedLanes|=n,r.pingedLanes&=~n,o&&(r.warmLanes|=n),o=r.expirationTimes;for(var x=n;0<x;){var g=31-Zt(x),S=1<<g;o[g]=-1,x&=~S}l!==0&&zi(r,l,n)}function Z0(){return(kt&6)===0?(rc(0),!1):!0}function zu(){if(ut!==null){if(Ct===0)var r=ut.return;else r=ut,Dn=Wi=null,au(r),Hs=null,Ul=0,r=ut;for(;r!==null;)c1(r.alternate,r),r=r.return;ut=null}}function Qs(r,n){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,Bb(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),Pn=0,zu(),Ut=r,ut=l=kn(r.current,null),pt=n,Ct=0,yr=null,di=!1,Ks=Sn(r,n),Ru=!1,Zs=_r=Mu=as=hi=Jt=0,cr=tc=null,Lu=!1,(n&8)!==0&&(n|=n&32);var o=r.entangledLanes;if(o!==0)for(r=r.entanglements,o&=n;0<o;){var x=31-Zt(o),g=1<<x;n|=r[x],o&=~g}return zn=n,g0(),l}function F1(r,n){rt=null,ee.H=Wl,n===Ps||n===T0?(n=qm(),Ct=3):n===Gf?(n=qm(),Ct=4):Ct=n===vu?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,yr=n,ut===null&&(Jt=1,U0(r,Fr(n,r.current)))}function O1(){var r=gr.current;return r===null?!0:(pt&4194048)===pt?Lr===null:(pt&62914560)===pt||(pt&536870912)!==0?r===Lr:!1}function R1(){var r=ee.H;return ee.H=Wl,r===null?Wl:r}function M1(){var r=ee.A;return ee.A=pb,r}function $0(){Jt=4,di||(pt&4194048)!==pt&&gr.current!==null||(Ks=!0),(hi&134217727)===0&&(as&134217727)===0||Ut===null||pi(Ut,pt,_r,!1)}function Pu(r,n,l){var o=kt;kt|=2;var x=R1(),g=M1();(Ut!==r||pt!==n)&&(K0=null,Qs(r,n)),n=!1;var S=Jt;e:do try{if(Ct!==0&&ut!==null){var F=ut,te=yr;switch(Ct){case 8:zu(),S=6;break e;case 3:case 2:case 9:case 6:gr.current===null&&(n=!0);var xe=Ct;if(Ct=0,yr=null,Js(r,F,te,xe),l&&Ks){S=0;break e}break;default:xe=Ct,Ct=0,yr=null,Js(r,F,te,xe)}}yb(),S=Jt;break}catch(Ee){F1(r,Ee)}while(!0);return n&&r.shellSuspendCounter++,Dn=Wi=null,kt=o,ee.H=x,ee.A=g,ut===null&&(Ut=null,pt=0,g0()),S}function yb(){for(;ut!==null;)L1(ut)}function _b(r,n){var l=kt;kt|=2;var o=R1(),x=M1();Ut!==r||pt!==n?(K0=null,q0=bt()+500,Qs(r,n)):Ks=Sn(r,n);e:do try{if(Ct!==0&&ut!==null){n=ut;var g=yr;t:switch(Ct){case 1:Ct=0,yr=null,Js(r,n,g,1);break;case 2:case 9:if(Ym(g)){Ct=0,yr=null,I1(n);break}n=function(){Ct!==2&&Ct!==9||Ut!==r||(Ct=7),hn(r)},g.then(n,n);break e;case 3:Ct=7;break e;case 4:Ct=5;break e;case 7:Ym(g)?(Ct=0,yr=null,I1(n)):(Ct=0,yr=null,Js(r,n,g,7));break;case 5:var S=null;switch(ut.tag){case 26:S=ut.memoizedState;case 5:case 27:var F=ut;if(S?wp(S):F.stateNode.complete){Ct=0,yr=null;var te=F.sibling;if(te!==null)ut=te;else{var xe=F.return;xe!==null?(ut=xe,Q0(xe)):ut=null}break t}}Ct=0,yr=null,Js(r,n,g,5);break;case 6:Ct=0,yr=null,Js(r,n,g,6);break;case 8:zu(),Jt=6;break e;default:throw Error(i(462))}}bb();break}catch(Ee){F1(r,Ee)}while(!0);return Dn=Wi=null,ee.H=o,ee.A=x,kt=l,ut!==null?0:(Ut=null,pt=0,g0(),Jt)}function bb(){for(;ut!==null&&!Ar();)L1(ut)}function L1(r){var n=s1(r.alternate,r,zn);r.memoizedProps=r.pendingProps,n===null?Q0(r):ut=n}function I1(r){var n=r,l=n.alternate;switch(n.tag){case 15:case 0:n=e1(l,n,n.pendingProps,n.type,void 0,pt);break;case 11:n=e1(l,n,n.pendingProps,n.type.render,n.ref,pt);break;case 5:au(n);default:c1(l,n),n=ut=Mm(n,zn),n=s1(l,n,zn)}r.memoizedProps=r.pendingProps,n===null?Q0(r):ut=n}function Js(r,n,l,o){Dn=Wi=null,au(n),Hs=null,Ul=0;var x=n.return;try{if(ob(r,x,n,l,pt)){Jt=1,U0(r,Fr(l,r.current)),ut=null;return}}catch(g){if(x!==null)throw ut=x,g;Jt=1,U0(r,Fr(l,r.current)),ut=null;return}n.flags&32768?(yt||o===1?r=!0:Ks||(pt&536870912)!==0?r=!1:(di=r=!0,(o===2||o===9||o===3||o===6)&&(o=gr.current,o!==null&&o.tag===13&&(o.flags|=16384))),B1(n,r)):Q0(n)}function Q0(r){var n=r;do{if((n.flags&32768)!==0){B1(n,di);return}r=n.return;var l=db(n.alternate,n,zn);if(l!==null){ut=l;return}if(n=n.sibling,n!==null){ut=n;return}ut=n=r}while(n!==null);Jt===0&&(Jt=5)}function B1(r,n){do{var l=hb(r.alternate,r);if(l!==null){l.flags&=32767,ut=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!n&&(r=r.sibling,r!==null)){ut=r;return}ut=r=l}while(r!==null);Jt=6,ut=null}function U1(r,n,l,o,x,g,S,F,te){r.cancelPendingCommit=null;do J0();while(_a!==0);if((kt&6)!==0)throw Error(i(327));if(n!==null){if(n===r.current)throw Error(i(177));if(g=n.lanes|n.childLanes,g|=Cf,Ui(r,l,g,S,F,te),r===Ut&&(ut=Ut=null,pt=0),$s=n,xi=r,Pn=l,Iu=g,Bu=x,k1=o,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Tb(Ue,function(){return G1(),null})):(r.callbackNode=null,r.callbackPriority=0),o=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||o){o=ee.T,ee.T=null,x=G.p,G.p=2,S=kt,kt|=4;try{mb(r,n,l)}finally{kt=S,G.p=x,ee.T=o}}_a=1,z1(),P1(),H1()}}function z1(){if(_a===1){_a=0;var r=xi,n=$s,l=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||l){l=ee.T,ee.T=null;var o=G.p;G.p=2;var x=kt;kt|=4;try{_1(n,r);var g=Ju,S=Nm(r.containerInfo),F=g.focusedElem,te=g.selectionRange;if(S!==F&&F&&F.ownerDocument&&Tm(F.ownerDocument.documentElement,F)){if(te!==null&&Ef(F)){var xe=te.start,Ee=te.end;if(Ee===void 0&&(Ee=xe),"selectionStart"in F)F.selectionStart=xe,F.selectionEnd=Math.min(Ee,F.value.length);else{var Ce=F.ownerDocument||document,ge=Ce&&Ce.defaultView||window;if(ge.getSelection){var _e=ge.getSelection(),ze=F.textContent.length,Ke=Math.min(te.start,ze),Lt=te.end===void 0?Ke:Math.min(te.end,ze);!_e.extend&&Ke>Lt&&(S=Lt,Lt=Ke,Ke=S);var oe=Em(F,Ke),ie=Em(F,Lt);if(oe&&ie&&(_e.rangeCount!==1||_e.anchorNode!==oe.node||_e.anchorOffset!==oe.offset||_e.focusNode!==ie.node||_e.focusOffset!==ie.offset)){var de=Ce.createRange();de.setStart(oe.node,oe.offset),_e.removeAllRanges(),Ke>Lt?(_e.addRange(de),_e.extend(ie.node,ie.offset)):(de.setEnd(ie.node,ie.offset),_e.addRange(de))}}}}for(Ce=[],_e=F;_e=_e.parentNode;)_e.nodeType===1&&Ce.push({element:_e,left:_e.scrollLeft,top:_e.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<Ce.length;F++){var Ae=Ce[F];Ae.element.scrollLeft=Ae.left,Ae.element.scrollTop=Ae.top}}uo=!!Qu,Ju=Qu=null}finally{kt=x,G.p=o,ee.T=l}}r.current=n,_a=2}}function P1(){if(_a===2){_a=0;var r=xi,n=$s,l=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||l){l=ee.T,ee.T=null;var o=G.p;G.p=2;var x=kt;kt|=4;try{x1(r,n.alternate,n)}finally{kt=x,G.p=o,ee.T=l}}_a=3}}function H1(){if(_a===4||_a===3){_a=0,ar();var r=xi,n=$s,l=Pn,o=k1;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?_a=5:(_a=0,$s=xi=null,V1(r,r.pendingLanes));var x=r.pendingLanes;if(x===0&&(mi=null),hr(l),n=n.stateNode,_t&&typeof _t.onCommitFiberRoot=="function")try{_t.onCommitFiberRoot(et,n,void 0,(n.current.flags&128)===128)}catch{}if(o!==null){n=ee.T,x=G.p,G.p=2,ee.T=null;try{for(var g=r.onRecoverableError,S=0;S<o.length;S++){var F=o[S];g(F.value,{componentStack:F.stack})}}finally{ee.T=n,G.p=x}}(Pn&3)!==0&&J0(),hn(r),x=r.pendingLanes,(l&261930)!==0&&(x&42)!==0?r===Uu?ac++:(ac=0,Uu=r):ac=0,rc(0)}}function V1(r,n){(r.pooledCacheLanes&=n)===0&&(n=r.pooledCache,n!=null&&(r.pooledCache=null,Il(n)))}function J0(){return z1(),P1(),H1(),G1()}function G1(){if(_a!==5)return!1;var r=xi,n=Iu;Iu=0;var l=hr(Pn),o=ee.T,x=G.p;try{G.p=32>l?32:l,ee.T=null,l=Bu,Bu=null;var g=xi,S=Pn;if(_a=0,$s=xi=null,Pn=0,(kt&6)!==0)throw Error(i(331));var F=kt;if(kt|=4,T1(g.current),w1(g,g.current,S,l),kt=F,rc(0,!1),_t&&typeof _t.onPostCommitFiberRoot=="function")try{_t.onPostCommitFiberRoot(et,g)}catch{}return!0}finally{G.p=x,ee.T=o,V1(r,n)}}function X1(r,n,l){n=Fr(l,n),n=gu(r.stateNode,n,2),r=ci(r,n,2),r!==null&&(on(r,2),hn(r))}function Dt(r,n,l){if(r.tag===3)X1(r,r,l);else for(;n!==null;){if(n.tag===3){X1(n,r,l);break}else if(n.tag===1){var o=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(mi===null||!mi.has(o))){r=Fr(l,r),l=Yx(2),o=ci(n,l,2),o!==null&&(Wx(l,o,n,r),on(o,2),hn(o));break}}n=n.return}}function Hu(r,n,l){var o=r.pingCache;if(o===null){o=r.pingCache=new gb;var x=new Set;o.set(n,x)}else x=o.get(n),x===void 0&&(x=new Set,o.set(n,x));x.has(l)||(Ru=!0,x.add(l),r=wb.bind(null,r,n,l),n.then(r,r))}function wb(r,n,l){var o=r.pingCache;o!==null&&o.delete(n),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,Ut===r&&(pt&l)===l&&(Jt===4||Jt===3&&(pt&62914560)===pt&&300>bt()-W0?(kt&2)===0&&Qs(r,0):Mu|=l,Zs===pt&&(Zs=0)),hn(r)}function Y1(r,n){n===0&&(n=Zr()),r=Gi(r,n),r!==null&&(on(r,n),hn(r))}function Sb(r){var n=r.memoizedState,l=0;n!==null&&(l=n.retryLane),Y1(r,l)}function Eb(r,n){var l=0;switch(r.tag){case 31:case 13:var o=r.stateNode,x=r.memoizedState;x!==null&&(l=x.retryLane);break;case 19:o=r.stateNode;break;case 22:o=r.stateNode._retryCache;break;default:throw Error(i(314))}o!==null&&o.delete(n),Y1(r,l)}function Tb(r,n){return Kt(r,n)}var eo=null,el=null,Vu=!1,to=!1,Gu=!1,gi=0;function hn(r){r!==el&&r.next===null&&(el===null?eo=el=r:el=el.next=r),to=!0,Vu||(Vu=!0,Ab())}function rc(r,n){if(!Gu&&to){Gu=!0;do for(var l=!1,o=eo;o!==null;){if(r!==0){var x=o.pendingLanes;if(x===0)var g=0;else{var S=o.suspendedLanes,F=o.pingedLanes;g=(1<<31-Zt(42|r)+1)-1,g&=x&~(S&~F),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,Z1(o,g))}else g=pt,g=ei(o,o===Ut?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(g&3)===0||Sn(o,g)||(l=!0,Z1(o,g));o=o.next}while(l);Gu=!1}}function Nb(){W1()}function W1(){to=Vu=!1;var r=0;gi!==0&&Ib()&&(r=gi);for(var n=bt(),l=null,o=eo;o!==null;){var x=o.next,g=q1(o,n);g===0?(o.next=null,l===null?eo=x:l.next=x,x===null&&(el=l)):(l=o,(r!==0||(g&3)!==0)&&(to=!0)),o=x}_a!==0&&_a!==5||rc(r),gi!==0&&(gi=0)}function q1(r,n){for(var l=r.suspendedLanes,o=r.pingedLanes,x=r.expirationTimes,g=r.pendingLanes&-62914561;0<g;){var S=31-Zt(g),F=1<<S,te=x[S];te===-1?((F&l)===0||(F&o)!==0)&&(x[S]=$t(F,n)):te<=n&&(r.expiredLanes|=F),g&=~F}if(n=Ut,l=pt,l=ei(r,r===n?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),o=r.callbackNode,l===0||r===n&&(Ct===2||Ct===9)||r.cancelPendingCommit!==null)return o!==null&&o!==null&&Sa(o),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||Sn(r,l)){if(n=l&-l,n===r.callbackPriority)return n;switch(o!==null&&Sa(o),hr(l)){case 2:case 8:l=Be;break;case 32:l=Ue;break;case 268435456:l=Fe;break;default:l=Ue}return o=K1.bind(null,r),l=Kt(l,o),r.callbackPriority=n,r.callbackNode=l,n}return o!==null&&o!==null&&Sa(o),r.callbackPriority=2,r.callbackNode=null,2}function K1(r,n){if(_a!==0&&_a!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(J0()&&r.callbackNode!==l)return null;var o=pt;return o=ei(r,r===Ut?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),o===0?null:(D1(r,o,n),q1(r,bt()),r.callbackNode!=null&&r.callbackNode===l?K1.bind(null,r):null)}function Z1(r,n){if(J0())return null;D1(r,n,!0)}function Ab(){Ub(function(){(kt&6)!==0?Kt(Pe,Nb):W1()})}function Xu(){if(gi===0){var r=Us;r===0&&(r=kr,kr<<=1,(kr&261888)===0&&(kr=256)),gi=r}return gi}function $1(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:o0(""+r)}function Q1(r,n){var l=n.ownerDocument.createElement("input");return l.name=n.name,l.value=n.value,r.id&&l.setAttribute("form",r.id),n.parentNode.insertBefore(l,n),r=new FormData(r),l.parentNode.removeChild(l),r}function kb(r,n,l,o,x){if(n==="submit"&&l&&l.stateNode===x){var g=$1((x[H]||null).action),S=o.submitter;S&&(n=(n=S[H]||null)?$1(n.formAction):S.getAttribute("formAction"),n!==null&&(g=n,S=null));var F=new h0("action","action",null,o,x);r.push({event:F,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(gi!==0){var te=S?Q1(x,S):new FormData(x);uu(l,{pending:!0,data:te,method:x.method,action:g},null,te)}}else typeof g=="function"&&(F.preventDefault(),te=S?Q1(x,S):new FormData(x),uu(l,{pending:!0,data:te,method:x.method,action:g},g,te))},currentTarget:x}]})}}for(var Yu=0;Yu<kf.length;Yu++){var Wu=kf[Yu],Cb=Wu.toLowerCase(),Db=Wu[0].toUpperCase()+Wu.slice(1);Qr(Cb,"on"+Db)}Qr(Cm,"onAnimationEnd"),Qr(Dm,"onAnimationIteration"),Qr(jm,"onAnimationStart"),Qr("dblclick","onDoubleClick"),Qr("focusin","onFocus"),Qr("focusout","onBlur"),Qr(Y_,"onTransitionRun"),Qr(W_,"onTransitionStart"),Qr(q_,"onTransitionCancel"),Qr(Fm,"onTransitionEnd"),Ua("onMouseEnter",["mouseout","mouseover"]),Ua("onMouseLeave",["mouseout","mouseover"]),Ua("onPointerEnter",["pointerout","pointerover"]),Ua("onPointerLeave",["pointerout","pointerover"]),At("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),At("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),At("onBeforeInput",["compositionend","keypress","textInput","paste"]),At("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),At("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),At("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nc));function J1(r,n){n=(n&4)!==0;for(var l=0;l<r.length;l++){var o=r[l],x=o.event;o=o.listeners;e:{var g=void 0;if(n)for(var S=o.length-1;0<=S;S--){var F=o[S],te=F.instance,xe=F.currentTarget;if(F=F.listener,te!==g&&x.isPropagationStopped())break e;g=F,x.currentTarget=xe;try{g(x)}catch(Ee){p0(Ee)}x.currentTarget=null,g=te}else for(S=0;S<o.length;S++){if(F=o[S],te=F.instance,xe=F.currentTarget,F=F.listener,te!==g&&x.isPropagationStopped())break e;g=F,x.currentTarget=xe;try{g(x)}catch(Ee){p0(Ee)}x.currentTarget=null,g=te}}}}function dt(r,n){var l=n[he];l===void 0&&(l=n[he]=new Set);var o=r+"__bubble";l.has(o)||(ep(n,r,2,!1),l.add(o))}function qu(r,n,l){var o=0;n&&(o|=4),ep(l,r,o,n)}var ao="_reactListening"+Math.random().toString(36).slice(2);function Ku(r){if(!r[ao]){r[ao]=!0,it.forEach(function(l){l!=="selectionchange"&&(jb.has(l)||qu(l,!1,r),qu(l,!0,r))});var n=r.nodeType===9?r:r.ownerDocument;n===null||n[ao]||(n[ao]=!0,qu("selectionchange",!1,n))}}function ep(r,n,l,o){switch(Cp(n)){case 2:var x=iw;break;case 8:x=sw;break;default:x=ud}l=x.bind(null,n,l,r),x=void 0,!xf||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(x=!0),o?x!==void 0?r.addEventListener(n,l,{capture:!0,passive:x}):r.addEventListener(n,l,!0):x!==void 0?r.addEventListener(n,l,{passive:x}):r.addEventListener(n,l,!1)}function Zu(r,n,l,o,x){var g=o;if((n&1)===0&&(n&2)===0&&o!==null)e:for(;;){if(o===null)return;var S=o.tag;if(S===3||S===4){var F=o.stateNode.containerInfo;if(F===x)break;if(S===4)for(S=o.return;S!==null;){var te=S.tag;if((te===3||te===4)&&S.stateNode.containerInfo===x)return;S=S.return}for(;F!==null;){if(S=fe(F),S===null)return;if(te=S.tag,te===5||te===6||te===26||te===27){o=g=S;continue e}F=F.parentNode}}o=o.return}im(function(){var xe=g,Ee=hf(l),Ce=[];e:{var ge=Om.get(r);if(ge!==void 0){var _e=h0,ze=r;switch(r){case"keypress":if(u0(l)===0)break e;case"keydown":case"keyup":_e=E_;break;case"focusin":ze="focus",_e=yf;break;case"focusout":ze="blur",_e=yf;break;case"beforeblur":case"afterblur":_e=yf;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=cm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=d_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=A_;break;case Cm:case Dm:case jm:_e=x_;break;case Fm:_e=C_;break;case"scroll":case"scrollend":_e=f_;break;case"wheel":_e=j_;break;case"copy":case"cut":case"paste":_e=g_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=fm;break;case"toggle":case"beforetoggle":_e=O_}var Ke=(n&4)!==0,Lt=!Ke&&(r==="scroll"||r==="scrollend"),oe=Ke?ge!==null?ge+"Capture":null:ge;Ke=[];for(var ie=xe,de;ie!==null;){var Ae=ie;if(de=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||de===null||oe===null||(Ae=Nl(ie,oe),Ae!=null&&Ke.push(ic(ie,Ae,de))),Lt)break;ie=ie.return}0<Ke.length&&(ge=new _e(ge,ze,null,l,Ee),Ce.push({event:ge,listeners:Ke}))}}if((n&7)===0){e:{if(ge=r==="mouseover"||r==="pointerover",_e=r==="mouseout"||r==="pointerout",ge&&l!==df&&(ze=l.relatedTarget||l.fromElement)&&(fe(ze)||ze[Y]))break e;if((_e||ge)&&(ge=Ee.window===Ee?Ee:(ge=Ee.ownerDocument)?ge.defaultView||ge.parentWindow:window,_e?(ze=l.relatedTarget||l.toElement,_e=xe,ze=ze?fe(ze):null,ze!==null&&(Lt=c(ze),Ke=ze.tag,ze!==Lt||Ke!==5&&Ke!==27&&Ke!==6)&&(ze=null)):(_e=null,ze=xe),_e!==ze)){if(Ke=cm,Ae="onMouseLeave",oe="onMouseEnter",ie="mouse",(r==="pointerout"||r==="pointerover")&&(Ke=fm,Ae="onPointerLeave",oe="onPointerEnter",ie="pointer"),Lt=_e==null?ge:ke(_e),de=ze==null?ge:ke(ze),ge=new Ke(Ae,ie+"leave",_e,l,Ee),ge.target=Lt,ge.relatedTarget=de,Ae=null,fe(Ee)===xe&&(Ke=new Ke(oe,ie+"enter",ze,l,Ee),Ke.target=de,Ke.relatedTarget=Lt,Ae=Ke),Lt=Ae,_e&&ze)t:{for(Ke=Fb,oe=_e,ie=ze,de=0,Ae=oe;Ae;Ae=Ke(Ae))de++;Ae=0;for(var Xe=ie;Xe;Xe=Ke(Xe))Ae++;for(;0<de-Ae;)oe=Ke(oe),de--;for(;0<Ae-de;)ie=Ke(ie),Ae--;for(;de--;){if(oe===ie||ie!==null&&oe===ie.alternate){Ke=oe;break t}oe=Ke(oe),ie=Ke(ie)}Ke=null}else Ke=null;_e!==null&&tp(Ce,ge,_e,Ke,!1),ze!==null&&Lt!==null&&tp(Ce,Lt,ze,Ke,!0)}}e:{if(ge=xe?ke(xe):window,_e=ge.nodeName&&ge.nodeName.toLowerCase(),_e==="select"||_e==="input"&&ge.type==="file")var Et=vm;else if(pm(ge))if(ym)Et=V_;else{Et=P_;var Ge=z_}else _e=ge.nodeName,!_e||_e.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?xe&&uf(xe.elementType)&&(Et=vm):Et=H_;if(Et&&(Et=Et(r,xe))){gm(Ce,Et,l,Ee);break e}Ge&&Ge(r,ge,xe),r==="focusout"&&xe&&ge.type==="number"&&xe.memoizedProps.value!=null&&ff(ge,"number",ge.value)}switch(Ge=xe?ke(xe):window,r){case"focusin":(pm(Ge)||Ge.contentEditable==="true")&&(js=Ge,Tf=xe,Rl=null);break;case"focusout":Rl=Tf=js=null;break;case"mousedown":Nf=!0;break;case"contextmenu":case"mouseup":case"dragend":Nf=!1,Am(Ce,l,Ee);break;case"selectionchange":if(X_)break;case"keydown":case"keyup":Am(Ce,l,Ee)}var st;if(bf)e:{switch(r){case"compositionstart":var gt="onCompositionStart";break e;case"compositionend":gt="onCompositionEnd";break e;case"compositionupdate":gt="onCompositionUpdate";break e}gt=void 0}else Ds?mm(r,l)&&(gt="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(gt="onCompositionStart");gt&&(um&&l.locale!=="ko"&&(Ds||gt!=="onCompositionStart"?gt==="onCompositionEnd"&&Ds&&(st=sm()):(ti=Ee,pf="value"in ti?ti.value:ti.textContent,Ds=!0)),Ge=ro(xe,gt),0<Ge.length&&(gt=new om(gt,r,null,l,Ee),Ce.push({event:gt,listeners:Ge}),st?gt.data=st:(st=xm(l),st!==null&&(gt.data=st)))),(st=M_?L_(r,l):I_(r,l))&&(gt=ro(xe,"onBeforeInput"),0<gt.length&&(Ge=new om("onBeforeInput","beforeinput",null,l,Ee),Ce.push({event:Ge,listeners:gt}),Ge.data=st)),kb(Ce,r,xe,l,Ee)}J1(Ce,n)})}function ic(r,n,l){return{instance:r,listener:n,currentTarget:l}}function ro(r,n){for(var l=n+"Capture",o=[];r!==null;){var x=r,g=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||g===null||(x=Nl(r,l),x!=null&&o.unshift(ic(r,x,g)),x=Nl(r,n),x!=null&&o.push(ic(r,x,g))),r.tag===3)return o;r=r.return}return[]}function Fb(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function tp(r,n,l,o,x){for(var g=n._reactName,S=[];l!==null&&l!==o;){var F=l,te=F.alternate,xe=F.stateNode;if(F=F.tag,te!==null&&te===o)break;F!==5&&F!==26&&F!==27||xe===null||(te=xe,x?(xe=Nl(l,g),xe!=null&&S.unshift(ic(l,xe,te))):x||(xe=Nl(l,g),xe!=null&&S.push(ic(l,xe,te)))),l=l.return}S.length!==0&&r.push({event:n,listeners:S})}var Ob=/\r\n?/g,Rb=/\u0000|\uFFFD/g;function ap(r){return(typeof r=="string"?r:""+r).replace(Ob,`
`).replace(Rb,"")}function rp(r,n){return n=ap(n),ap(r)===n}function Mt(r,n,l,o,x,g){switch(l){case"children":typeof o=="string"?n==="body"||n==="textarea"&&o===""||As(r,o):(typeof o=="number"||typeof o=="bigint")&&n!=="body"&&As(r,""+o);break;case"className":l0(r,"class",o);break;case"tabIndex":l0(r,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":l0(r,l,o);break;case"style":rm(r,o,g);break;case"data":if(n!=="object"){l0(r,"data",o);break}case"src":case"href":if(o===""&&(n!=="a"||l!=="href")){r.removeAttribute(l);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){r.removeAttribute(l);break}o=o0(""+o),r.setAttribute(l,o);break;case"action":case"formAction":if(typeof o=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(n!=="input"&&Mt(r,n,"name",x.name,x,null),Mt(r,n,"formEncType",x.formEncType,x,null),Mt(r,n,"formMethod",x.formMethod,x,null),Mt(r,n,"formTarget",x.formTarget,x,null)):(Mt(r,n,"encType",x.encType,x,null),Mt(r,n,"method",x.method,x,null),Mt(r,n,"target",x.target,x,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){r.removeAttribute(l);break}o=o0(""+o),r.setAttribute(l,o);break;case"onClick":o!=null&&(r.onclick=Nn);break;case"onScroll":o!=null&&dt("scroll",r);break;case"onScrollEnd":o!=null&&dt("scrollend",r);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(l=o.__html,l!=null){if(x.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"multiple":r.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":r.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){r.removeAttribute("xlink:href");break}l=o0(""+o),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?r.setAttribute(l,""+o):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":o===!0?r.setAttribute(l,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?r.setAttribute(l,o):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?r.setAttribute(l,o):r.removeAttribute(l);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?r.removeAttribute(l):r.setAttribute(l,o);break;case"popover":dt("beforetoggle",r),dt("toggle",r),rr(r,"popover",o);break;case"xlinkActuate":Tn(r,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Tn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Tn(r,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Tn(r,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Tn(r,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Tn(r,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Tn(r,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Tn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Tn(r,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":rr(r,"is",o);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=c_.get(l)||l,rr(r,l,o))}}function $u(r,n,l,o,x,g){switch(l){case"style":rm(r,o,g);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(l=o.__html,l!=null){if(x.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"children":typeof o=="string"?As(r,o):(typeof o=="number"||typeof o=="bigint")&&As(r,""+o);break;case"onScroll":o!=null&&dt("scroll",r);break;case"onScrollEnd":o!=null&&dt("scrollend",r);break;case"onClick":o!=null&&(r.onclick=Nn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xt.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(x=l.endsWith("Capture"),n=l.slice(2,x?l.length-7:void 0),g=r[H]||null,g=g!=null?g[l]:null,typeof g=="function"&&r.removeEventListener(n,g,x),typeof o=="function")){typeof g!="function"&&g!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(n,o,x);break e}l in r?r[l]=o:o===!0?r.setAttribute(l,""):rr(r,l,o)}}}function Oa(r,n,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":dt("error",r),dt("load",r);var o=!1,x=!1,g;for(g in l)if(l.hasOwnProperty(g)){var S=l[g];if(S!=null)switch(g){case"src":o=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:Mt(r,n,g,S,l,null)}}x&&Mt(r,n,"srcSet",l.srcSet,l,null),o&&Mt(r,n,"src",l.src,l,null);return;case"input":dt("invalid",r);var F=g=S=x=null,te=null,xe=null;for(o in l)if(l.hasOwnProperty(o)){var Ee=l[o];if(Ee!=null)switch(o){case"name":x=Ee;break;case"type":S=Ee;break;case"checked":te=Ee;break;case"defaultChecked":xe=Ee;break;case"value":g=Ee;break;case"defaultValue":F=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(i(137,n));break;default:Mt(r,n,o,Ee,l,null)}}Jh(r,g,F,te,xe,S,x,!1);return;case"select":dt("invalid",r),o=S=g=null;for(x in l)if(l.hasOwnProperty(x)&&(F=l[x],F!=null))switch(x){case"value":g=F;break;case"defaultValue":S=F;break;case"multiple":o=F;default:Mt(r,n,x,F,l,null)}n=g,l=S,r.multiple=!!o,n!=null?Ns(r,!!o,n,!1):l!=null&&Ns(r,!!o,l,!0);return;case"textarea":dt("invalid",r),g=x=o=null;for(S in l)if(l.hasOwnProperty(S)&&(F=l[S],F!=null))switch(S){case"value":o=F;break;case"defaultValue":x=F;break;case"children":g=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(i(91));break;default:Mt(r,n,S,F,l,null)}tm(r,o,x,g);return;case"option":for(te in l)if(l.hasOwnProperty(te)&&(o=l[te],o!=null))switch(te){case"selected":r.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:Mt(r,n,te,o,l,null)}return;case"dialog":dt("beforetoggle",r),dt("toggle",r),dt("cancel",r),dt("close",r);break;case"iframe":case"object":dt("load",r);break;case"video":case"audio":for(o=0;o<nc.length;o++)dt(nc[o],r);break;case"image":dt("error",r),dt("load",r);break;case"details":dt("toggle",r);break;case"embed":case"source":case"link":dt("error",r),dt("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(xe in l)if(l.hasOwnProperty(xe)&&(o=l[xe],o!=null))switch(xe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:Mt(r,n,xe,o,l,null)}return;default:if(uf(n)){for(Ee in l)l.hasOwnProperty(Ee)&&(o=l[Ee],o!==void 0&&$u(r,n,Ee,o,l,void 0));return}}for(F in l)l.hasOwnProperty(F)&&(o=l[F],o!=null&&Mt(r,n,F,o,l,null))}function Mb(r,n,l,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,g=null,S=null,F=null,te=null,xe=null,Ee=null;for(_e in l){var Ce=l[_e];if(l.hasOwnProperty(_e)&&Ce!=null)switch(_e){case"checked":break;case"value":break;case"defaultValue":te=Ce;default:o.hasOwnProperty(_e)||Mt(r,n,_e,null,o,Ce)}}for(var ge in o){var _e=o[ge];if(Ce=l[ge],o.hasOwnProperty(ge)&&(_e!=null||Ce!=null))switch(ge){case"type":g=_e;break;case"name":x=_e;break;case"checked":xe=_e;break;case"defaultChecked":Ee=_e;break;case"value":S=_e;break;case"defaultValue":F=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(i(137,n));break;default:_e!==Ce&&Mt(r,n,ge,_e,o,Ce)}}of(r,S,F,te,xe,Ee,g,x);return;case"select":_e=S=F=ge=null;for(g in l)if(te=l[g],l.hasOwnProperty(g)&&te!=null)switch(g){case"value":break;case"multiple":_e=te;default:o.hasOwnProperty(g)||Mt(r,n,g,null,o,te)}for(x in o)if(g=o[x],te=l[x],o.hasOwnProperty(x)&&(g!=null||te!=null))switch(x){case"value":ge=g;break;case"defaultValue":F=g;break;case"multiple":S=g;default:g!==te&&Mt(r,n,x,g,o,te)}n=F,l=S,o=_e,ge!=null?Ns(r,!!l,ge,!1):!!o!=!!l&&(n!=null?Ns(r,!!l,n,!0):Ns(r,!!l,l?[]:"",!1));return;case"textarea":_e=ge=null;for(F in l)if(x=l[F],l.hasOwnProperty(F)&&x!=null&&!o.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:Mt(r,n,F,null,o,x)}for(S in o)if(x=o[S],g=l[S],o.hasOwnProperty(S)&&(x!=null||g!=null))switch(S){case"value":ge=x;break;case"defaultValue":_e=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(i(91));break;default:x!==g&&Mt(r,n,S,x,o,g)}em(r,ge,_e);return;case"option":for(var ze in l)if(ge=l[ze],l.hasOwnProperty(ze)&&ge!=null&&!o.hasOwnProperty(ze))switch(ze){case"selected":r.selected=!1;break;default:Mt(r,n,ze,null,o,ge)}for(te in o)if(ge=o[te],_e=l[te],o.hasOwnProperty(te)&&ge!==_e&&(ge!=null||_e!=null))switch(te){case"selected":r.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:Mt(r,n,te,ge,o,_e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in l)ge=l[Ke],l.hasOwnProperty(Ke)&&ge!=null&&!o.hasOwnProperty(Ke)&&Mt(r,n,Ke,null,o,ge);for(xe in o)if(ge=o[xe],_e=l[xe],o.hasOwnProperty(xe)&&ge!==_e&&(ge!=null||_e!=null))switch(xe){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(i(137,n));break;default:Mt(r,n,xe,ge,o,_e)}return;default:if(uf(n)){for(var Lt in l)ge=l[Lt],l.hasOwnProperty(Lt)&&ge!==void 0&&!o.hasOwnProperty(Lt)&&$u(r,n,Lt,void 0,o,ge);for(Ee in o)ge=o[Ee],_e=l[Ee],!o.hasOwnProperty(Ee)||ge===_e||ge===void 0&&_e===void 0||$u(r,n,Ee,ge,o,_e);return}}for(var oe in l)ge=l[oe],l.hasOwnProperty(oe)&&ge!=null&&!o.hasOwnProperty(oe)&&Mt(r,n,oe,null,o,ge);for(Ce in o)ge=o[Ce],_e=l[Ce],!o.hasOwnProperty(Ce)||ge===_e||ge==null&&_e==null||Mt(r,n,Ce,ge,o,_e)}function np(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Lb(){if(typeof performance.getEntriesByType=="function"){for(var r=0,n=0,l=performance.getEntriesByType("resource"),o=0;o<l.length;o++){var x=l[o],g=x.transferSize,S=x.initiatorType,F=x.duration;if(g&&F&&np(S)){for(S=0,F=x.responseEnd,o+=1;o<l.length;o++){var te=l[o],xe=te.startTime;if(xe>F)break;var Ee=te.transferSize,Ce=te.initiatorType;Ee&&np(Ce)&&(te=te.responseEnd,S+=Ee*(te<F?1:(F-xe)/(te-xe)))}if(--o,n+=8*(g+S)/(x.duration/1e3),r++,10<r)break}}if(0<r)return n/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Qu=null,Ju=null;function no(r){return r.nodeType===9?r:r.ownerDocument}function ip(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sp(r,n){if(r===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&n==="foreignObject"?0:r}function ed(r,n){return r==="textarea"||r==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var td=null;function Ib(){var r=window.event;return r&&r.type==="popstate"?r===td?!1:(td=r,!0):(td=null,!1)}var lp=typeof setTimeout=="function"?setTimeout:void 0,Bb=typeof clearTimeout=="function"?clearTimeout:void 0,cp=typeof Promise=="function"?Promise:void 0,Ub=typeof queueMicrotask=="function"?queueMicrotask:typeof cp<"u"?function(r){return cp.resolve(null).then(r).catch(zb)}:lp;function zb(r){setTimeout(function(){throw r})}function vi(r){return r==="head"}function op(r,n){var l=n,o=0;do{var x=l.nextSibling;if(r.removeChild(l),x&&x.nodeType===8)if(l=x.data,l==="/$"||l==="/&"){if(o===0){r.removeChild(x),nl(n);return}o--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")o++;else if(l==="html")sc(r.ownerDocument.documentElement);else if(l==="head"){l=r.ownerDocument.head,sc(l);for(var g=l.firstChild;g;){var S=g.nextSibling,F=g.nodeName;g[ne]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&g.rel.toLowerCase()==="stylesheet"||l.removeChild(g),g=S}}else l==="body"&&sc(r.ownerDocument.body);l=x}while(l);nl(n)}function fp(r,n){var l=r;r=0;do{var o=l.nextSibling;if(l.nodeType===1?n?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(n?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),o&&o.nodeType===8)if(l=o.data,l==="/$"){if(r===0)break;r--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||r++;l=o}while(l)}function ad(r){var n=r.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var l=n;switch(n=n.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":ad(l),P(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function Pb(r,n,l,o){for(;r.nodeType===1;){var x=l;if(r.nodeName.toLowerCase()!==n.toLowerCase()){if(!o&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(o){if(!r[ne])switch(n){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(g=r.getAttribute("rel"),g==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(g!==x.rel||r.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||r.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||r.getAttribute("title")!==(x.title==null?null:x.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(g=r.getAttribute("src"),(g!==(x.src==null?null:x.src)||r.getAttribute("type")!==(x.type==null?null:x.type)||r.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&g&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(n==="input"&&r.type==="hidden"){var g=x.name==null?null:""+x.name;if(x.type==="hidden"&&r.getAttribute("name")===g)return r}else return r;if(r=Ir(r.nextSibling),r===null)break}return null}function Hb(r,n,l){if(n==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=Ir(r.nextSibling),r===null))return null;return r}function up(r,n){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!n||(r=Ir(r.nextSibling),r===null))return null;return r}function rd(r){return r.data==="$?"||r.data==="$~"}function nd(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function Vb(r,n){var l=r.ownerDocument;if(r.data==="$~")r._reactRetry=n;else if(r.data!=="$?"||l.readyState!=="loading")n();else{var o=function(){n(),l.removeEventListener("DOMContentLoaded",o)};l.addEventListener("DOMContentLoaded",o),r._reactRetry=o}}function Ir(r){for(;r!=null;r=r.nextSibling){var n=r.nodeType;if(n===1||n===3)break;if(n===8){if(n=r.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return r}var sd=null;function dp(r){r=r.nextSibling;for(var n=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"||l==="/&"){if(n===0)return Ir(r.nextSibling);n--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||n++}r=r.nextSibling}return null}function hp(r){r=r.previousSibling;for(var n=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(n===0)return r;n--}else l!=="/$"&&l!=="/&"||n++}r=r.previousSibling}return null}function mp(r,n,l){switch(n=no(l),r){case"html":if(r=n.documentElement,!r)throw Error(i(452));return r;case"head":if(r=n.head,!r)throw Error(i(453));return r;case"body":if(r=n.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function sc(r){for(var n=r.attributes;n.length;)r.removeAttributeNode(n[0]);P(r)}var Br=new Map,xp=new Set;function io(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Hn=G.d;G.d={f:Gb,r:Xb,D:Yb,C:Wb,L:qb,m:Kb,X:$b,S:Zb,M:Qb};function Gb(){var r=Hn.f(),n=Z0();return r||n}function Xb(r){var n=be(r);n!==null&&n.tag===5&&n.type==="form"?Fx(n):Hn.r(r)}var tl=typeof document>"u"?null:document;function pp(r,n,l){var o=tl;if(o&&typeof n=="string"&&n){var x=Dr(n);x='link[rel="'+r+'"][href="'+x+'"]',typeof l=="string"&&(x+='[crossorigin="'+l+'"]'),xp.has(x)||(xp.add(x),r={rel:r,crossOrigin:l,href:n},o.querySelector(x)===null&&(n=o.createElement("link"),Oa(n,"link",r),Ie(n),o.head.appendChild(n)))}}function Yb(r){Hn.D(r),pp("dns-prefetch",r,null)}function Wb(r,n){Hn.C(r,n),pp("preconnect",r,n)}function qb(r,n,l){Hn.L(r,n,l);var o=tl;if(o&&r&&n){var x='link[rel="preload"][as="'+Dr(n)+'"]';n==="image"&&l&&l.imageSrcSet?(x+='[imagesrcset="'+Dr(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(x+='[imagesizes="'+Dr(l.imageSizes)+'"]')):x+='[href="'+Dr(r)+'"]';var g=x;switch(n){case"style":g=al(r);break;case"script":g=rl(r)}Br.has(g)||(r=v({rel:"preload",href:n==="image"&&l&&l.imageSrcSet?void 0:r,as:n},l),Br.set(g,r),o.querySelector(x)!==null||n==="style"&&o.querySelector(lc(g))||n==="script"&&o.querySelector(cc(g))||(n=o.createElement("link"),Oa(n,"link",r),Ie(n),o.head.appendChild(n)))}}function Kb(r,n){Hn.m(r,n);var l=tl;if(l&&r){var o=n&&typeof n.as=="string"?n.as:"script",x='link[rel="modulepreload"][as="'+Dr(o)+'"][href="'+Dr(r)+'"]',g=x;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=rl(r)}if(!Br.has(g)&&(r=v({rel:"modulepreload",href:r},n),Br.set(g,r),l.querySelector(x)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(cc(g)))return}o=l.createElement("link"),Oa(o,"link",r),Ie(o),l.head.appendChild(o)}}}function Zb(r,n,l){Hn.S(r,n,l);var o=tl;if(o&&r){var x=Oe(o).hoistableStyles,g=al(r);n=n||"default";var S=x.get(g);if(!S){var F={loading:0,preload:null};if(S=o.querySelector(lc(g)))F.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":n},l),(l=Br.get(g))&&ld(r,l);var te=S=o.createElement("link");Ie(te),Oa(te,"link",r),te._p=new Promise(function(xe,Ee){te.onload=xe,te.onerror=Ee}),te.addEventListener("load",function(){F.loading|=1}),te.addEventListener("error",function(){F.loading|=2}),F.loading|=4,so(S,n,o)}S={type:"stylesheet",instance:S,count:1,state:F},x.set(g,S)}}}function $b(r,n){Hn.X(r,n);var l=tl;if(l&&r){var o=Oe(l).hoistableScripts,x=rl(r),g=o.get(x);g||(g=l.querySelector(cc(x)),g||(r=v({src:r,async:!0},n),(n=Br.get(x))&&cd(r,n),g=l.createElement("script"),Ie(g),Oa(g,"link",r),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(x,g))}}function Qb(r,n){Hn.M(r,n);var l=tl;if(l&&r){var o=Oe(l).hoistableScripts,x=rl(r),g=o.get(x);g||(g=l.querySelector(cc(x)),g||(r=v({src:r,async:!0,type:"module"},n),(n=Br.get(x))&&cd(r,n),g=l.createElement("script"),Ie(g),Oa(g,"link",r),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(x,g))}}function gp(r,n,l,o){var x=(x=le.current)?io(x):null;if(!x)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(n=al(l.href),l=Oe(x).hoistableStyles,o=l.get(n),o||(o={type:"style",instance:null,count:0,state:null},l.set(n,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=al(l.href);var g=Oe(x).hoistableStyles,S=g.get(r);if(S||(x=x.ownerDocument||x,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(r,S),(g=x.querySelector(lc(r)))&&!g._p&&(S.instance=g,S.state.loading=5),Br.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Br.set(r,l),g||Jb(x,r,l,S.state))),n&&o===null)throw Error(i(528,""));return S}if(n&&o!==null)throw Error(i(529,""));return null;case"script":return n=l.async,l=l.src,typeof l=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=rl(l),l=Oe(x).hoistableScripts,o=l.get(n),o||(o={type:"script",instance:null,count:0,state:null},l.set(n,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function al(r){return'href="'+Dr(r)+'"'}function lc(r){return'link[rel="stylesheet"]['+r+"]"}function vp(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function Jb(r,n,l,o){r.querySelector('link[rel="preload"][as="style"]['+n+"]")?o.loading=1:(n=r.createElement("link"),o.preload=n,n.addEventListener("load",function(){return o.loading|=1}),n.addEventListener("error",function(){return o.loading|=2}),Oa(n,"link",l),Ie(n),r.head.appendChild(n))}function rl(r){return'[src="'+Dr(r)+'"]'}function cc(r){return"script[async]"+r}function yp(r,n,l){if(n.count++,n.instance===null)switch(n.type){case"style":var o=r.querySelector('style[data-href~="'+Dr(l.href)+'"]');if(o)return n.instance=o,Ie(o),o;var x=v({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return o=(r.ownerDocument||r).createElement("style"),Ie(o),Oa(o,"style",x),so(o,l.precedence,r),n.instance=o;case"stylesheet":x=al(l.href);var g=r.querySelector(lc(x));if(g)return n.state.loading|=4,n.instance=g,Ie(g),g;o=vp(l),(x=Br.get(x))&&ld(o,x),g=(r.ownerDocument||r).createElement("link"),Ie(g);var S=g;return S._p=new Promise(function(F,te){S.onload=F,S.onerror=te}),Oa(g,"link",o),n.state.loading|=4,so(g,l.precedence,r),n.instance=g;case"script":return g=rl(l.src),(x=r.querySelector(cc(g)))?(n.instance=x,Ie(x),x):(o=l,(x=Br.get(g))&&(o=v({},l),cd(o,x)),r=r.ownerDocument||r,x=r.createElement("script"),Ie(x),Oa(x,"link",o),r.head.appendChild(x),n.instance=x);case"void":return null;default:throw Error(i(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(o=n.instance,n.state.loading|=4,so(o,l.precedence,r));return n.instance}function so(r,n,l){for(var o=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=o.length?o[o.length-1]:null,g=x,S=0;S<o.length;S++){var F=o[S];if(F.dataset.precedence===n)g=F;else if(g!==x)break}g?g.parentNode.insertBefore(r,g.nextSibling):(n=l.nodeType===9?l.head:l,n.insertBefore(r,n.firstChild))}function ld(r,n){r.crossOrigin==null&&(r.crossOrigin=n.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=n.referrerPolicy),r.title==null&&(r.title=n.title)}function cd(r,n){r.crossOrigin==null&&(r.crossOrigin=n.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=n.referrerPolicy),r.integrity==null&&(r.integrity=n.integrity)}var lo=null;function _p(r,n,l){if(lo===null){var o=new Map,x=lo=new Map;x.set(l,o)}else x=lo,o=x.get(l),o||(o=new Map,x.set(l,o));if(o.has(r))return o;for(o.set(r,null),l=l.getElementsByTagName(r),x=0;x<l.length;x++){var g=l[x];if(!(g[ne]||g[U]||r==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var S=g.getAttribute(n)||"";S=r+S;var F=o.get(S);F?F.push(g):o.set(S,[g])}}return o}function bp(r,n,l){r=r.ownerDocument||r,r.head.insertBefore(l,n==="title"?r.querySelector("head > title"):null)}function ew(r,n,l){if(l===1||n.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return r=n.disabled,typeof n.precedence=="string"&&r==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function wp(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function tw(r,n,l,o){if(l.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var x=al(o.href),g=n.querySelector(lc(x));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(r.count++,r=co.bind(r),n.then(r,r)),l.state.loading|=4,l.instance=g,Ie(g);return}g=n.ownerDocument||n,o=vp(o),(x=Br.get(x))&&ld(o,x),g=g.createElement("link"),Ie(g);var S=g;S._p=new Promise(function(F,te){S.onload=F,S.onerror=te}),Oa(g,"link",o),l.instance=g}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(l,n),(n=l.state.preload)&&(l.state.loading&3)===0&&(r.count++,l=co.bind(r),n.addEventListener("load",l),n.addEventListener("error",l))}}var od=0;function aw(r,n){return r.stylesheets&&r.count===0&&fo(r,r.stylesheets),0<r.count||0<r.imgCount?function(l){var o=setTimeout(function(){if(r.stylesheets&&fo(r,r.stylesheets),r.unsuspend){var g=r.unsuspend;r.unsuspend=null,g()}},6e4+n);0<r.imgBytes&&od===0&&(od=62500*Lb());var x=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&fo(r,r.stylesheets),r.unsuspend)){var g=r.unsuspend;r.unsuspend=null,g()}},(r.imgBytes>od?50:800)+n);return r.unsuspend=l,function(){r.unsuspend=null,clearTimeout(o),clearTimeout(x)}}:null}function co(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fo(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var oo=null;function fo(r,n){r.stylesheets=null,r.unsuspend!==null&&(r.count++,oo=new Map,n.forEach(rw,r),oo=null,co.call(r))}function rw(r,n){if(!(n.state.loading&4)){var l=oo.get(r);if(l)var o=l.get(null);else{l=new Map,oo.set(r,l);for(var x=r.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<x.length;g++){var S=x[g];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(l.set(S.dataset.precedence,S),o=S)}o&&l.set(null,o)}x=n.instance,S=x.getAttribute("data-precedence"),g=l.get(S)||o,g===o&&l.set(null,x),l.set(S,x),this.count++,o=co.bind(this),x.addEventListener("load",o),x.addEventListener("error",o),g?g.parentNode.insertBefore(x,g.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(x,r.firstChild)),n.state.loading|=4}}var oc={$$typeof:N,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function nw(r,n,l,o,x,g,S,F,te){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Bi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bi(0),this.hiddenUpdates=Bi(null),this.identifierPrefix=o,this.onUncaughtError=x,this.onCaughtError=g,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=te,this.incompleteTransitions=new Map}function Sp(r,n,l,o,x,g,S,F,te,xe,Ee,Ce){return r=new nw(r,n,l,S,te,xe,Ee,Ce,F),n=1,g===!0&&(n|=24),g=pr(3,null,null,n),r.current=g,g.stateNode=r,n=Pf(),n.refCount++,r.pooledCache=n,n.refCount++,g.memoizedState={element:o,isDehydrated:l,cache:n},Xf(g),r}function Ep(r){return r?(r=Rs,r):Rs}function Tp(r,n,l,o,x,g){x=Ep(x),o.context===null?o.context=x:o.pendingContext=x,o=li(n),o.payload={element:l},g=g===void 0?null:g,g!==null&&(o.callback=g),l=ci(r,o,n),l!==null&&(or(l,r,n),Pl(l,r,n))}function Np(r,n){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<n?l:n}}function fd(r,n){Np(r,n),(r=r.alternate)&&Np(r,n)}function Ap(r){if(r.tag===13||r.tag===31){var n=Gi(r,67108864);n!==null&&or(n,r,67108864),fd(r,67108864)}}function kp(r){if(r.tag===13||r.tag===31){var n=br();n=Ba(n);var l=Gi(r,n);l!==null&&or(l,r,n),fd(r,n)}}var uo=!0;function iw(r,n,l,o){var x=ee.T;ee.T=null;var g=G.p;try{G.p=2,ud(r,n,l,o)}finally{G.p=g,ee.T=x}}function sw(r,n,l,o){var x=ee.T;ee.T=null;var g=G.p;try{G.p=8,ud(r,n,l,o)}finally{G.p=g,ee.T=x}}function ud(r,n,l,o){if(uo){var x=dd(o);if(x===null)Zu(r,n,o,ho,l),Dp(r,o);else if(cw(x,r,n,l,o))o.stopPropagation();else if(Dp(r,o),n&4&&-1<lw.indexOf(r)){for(;x!==null;){var g=be(x);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var S=Ea(g.pendingLanes);if(S!==0){var F=g;for(F.pendingLanes|=2,F.entangledLanes|=2;S;){var te=1<<31-Zt(S);F.entanglements[1]|=te,S&=~te}hn(g),(kt&6)===0&&(q0=bt()+500,rc(0))}}break;case 31:case 13:F=Gi(g,2),F!==null&&or(F,g,2),Z0(),fd(g,2)}if(g=dd(o),g===null&&Zu(r,n,o,ho,l),g===x)break;x=g}x!==null&&o.stopPropagation()}else Zu(r,n,o,null,l)}}function dd(r){return r=hf(r),hd(r)}var ho=null;function hd(r){if(ho=null,r=fe(r),r!==null){var n=c(r);if(n===null)r=null;else{var l=n.tag;if(l===13){if(r=f(n),r!==null)return r;r=null}else if(l===31){if(r=d(n),r!==null)return r;r=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;r=null}else n!==r&&(r=null)}}return ho=r,null}function Cp(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ya()){case Pe:return 2;case Be:return 8;case Ue:case He:return 32;case Fe:return 268435456;default:return 32}default:return 32}}var md=!1,yi=null,_i=null,bi=null,fc=new Map,uc=new Map,wi=[],lw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dp(r,n){switch(r){case"focusin":case"focusout":yi=null;break;case"dragenter":case"dragleave":_i=null;break;case"mouseover":case"mouseout":bi=null;break;case"pointerover":case"pointerout":fc.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":uc.delete(n.pointerId)}}function dc(r,n,l,o,x,g){return r===null||r.nativeEvent!==g?(r={blockedOn:n,domEventName:l,eventSystemFlags:o,nativeEvent:g,targetContainers:[x]},n!==null&&(n=be(n),n!==null&&Ap(n)),r):(r.eventSystemFlags|=o,n=r.targetContainers,x!==null&&n.indexOf(x)===-1&&n.push(x),r)}function cw(r,n,l,o,x){switch(n){case"focusin":return yi=dc(yi,r,n,l,o,x),!0;case"dragenter":return _i=dc(_i,r,n,l,o,x),!0;case"mouseover":return bi=dc(bi,r,n,l,o,x),!0;case"pointerover":var g=x.pointerId;return fc.set(g,dc(fc.get(g)||null,r,n,l,o,x)),!0;case"gotpointercapture":return g=x.pointerId,uc.set(g,dc(uc.get(g)||null,r,n,l,o,x)),!0}return!1}function jp(r){var n=fe(r.target);if(n!==null){var l=c(n);if(l!==null){if(n=l.tag,n===13){if(n=f(l),n!==null){r.blockedOn=n,X(r.priority,function(){kp(l)});return}}else if(n===31){if(n=d(l),n!==null){r.blockedOn=n,X(r.priority,function(){kp(l)});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function mo(r){if(r.blockedOn!==null)return!1;for(var n=r.targetContainers;0<n.length;){var l=dd(r.nativeEvent);if(l===null){l=r.nativeEvent;var o=new l.constructor(l.type,l);df=o,l.target.dispatchEvent(o),df=null}else return n=be(l),n!==null&&Ap(n),r.blockedOn=l,!1;n.shift()}return!0}function Fp(r,n,l){mo(r)&&l.delete(n)}function ow(){md=!1,yi!==null&&mo(yi)&&(yi=null),_i!==null&&mo(_i)&&(_i=null),bi!==null&&mo(bi)&&(bi=null),fc.forEach(Fp),uc.forEach(Fp)}function xo(r,n){r.blockedOn===n&&(r.blockedOn=null,md||(md=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ow)))}var po=null;function Op(r){po!==r&&(po=r,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){po===r&&(po=null);for(var n=0;n<r.length;n+=3){var l=r[n],o=r[n+1],x=r[n+2];if(typeof o!="function"){if(hd(o||l)===null)continue;break}var g=be(l);g!==null&&(r.splice(n,3),n-=3,uu(g,{pending:!0,data:x,method:l.method,action:o},o,x))}}))}function nl(r){function n(te){return xo(te,r)}yi!==null&&xo(yi,r),_i!==null&&xo(_i,r),bi!==null&&xo(bi,r),fc.forEach(n),uc.forEach(n);for(var l=0;l<wi.length;l++){var o=wi[l];o.blockedOn===r&&(o.blockedOn=null)}for(;0<wi.length&&(l=wi[0],l.blockedOn===null);)jp(l),l.blockedOn===null&&wi.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(o=0;o<l.length;o+=3){var x=l[o],g=l[o+1],S=x[H]||null;if(typeof g=="function")S||Op(l);else if(S){var F=null;if(g&&g.hasAttribute("formAction")){if(x=g,S=g[H]||null)F=S.formAction;else if(hd(x)!==null)continue}else F=S.action;typeof F=="function"?l[o+1]=F:(l.splice(o,3),o-=3),Op(l)}}}function Rp(){function r(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(S){return x=S})},focusReset:"manual",scroll:"manual"})}function n(){x!==null&&(x(),x=null),o||setTimeout(l,20)}function l(){if(!o&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,x=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(l,100),function(){o=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),x!==null&&(x(),x=null)}}}function xd(r){this._internalRoot=r}go.prototype.render=xd.prototype.render=function(r){var n=this._internalRoot;if(n===null)throw Error(i(409));var l=n.current,o=br();Tp(l,o,r,n,null,null)},go.prototype.unmount=xd.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var n=r.containerInfo;Tp(r.current,2,null,r,null,null),Z0(),n[Y]=null}};function go(r){this._internalRoot=r}go.prototype.unstable_scheduleHydration=function(r){if(r){var n=D();r={blockedOn:null,target:r,priority:n};for(var l=0;l<wi.length&&n!==0&&n<wi[l].priority;l++);wi.splice(l,0,r),l===0&&jp(r)}};var Mp=a.version;if(Mp!=="19.2.0")throw Error(i(527,Mp,"19.2.0"));G.findDOMNode=function(r){var n=r._reactInternals;if(n===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=m(n),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var fw={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vo.isDisabled&&vo.supportsFiber)try{et=vo.inject(fw),_t=vo}catch{}}return mc.createRoot=function(r,n){if(!s(r))throw Error(i(299));var l=!1,o="",x=Hx,g=Vx,S=Gx;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(x=n.onUncaughtError),n.onCaughtError!==void 0&&(g=n.onCaughtError),n.onRecoverableError!==void 0&&(S=n.onRecoverableError)),n=Sp(r,1,!1,null,null,l,o,null,x,g,S,Rp),r[Y]=n.current,Ku(r),new xd(n)},mc.hydrateRoot=function(r,n,l){if(!s(r))throw Error(i(299));var o=!1,x="",g=Hx,S=Vx,F=Gx,te=null;return l!=null&&(l.unstable_strictMode===!0&&(o=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(S=l.onCaughtError),l.onRecoverableError!==void 0&&(F=l.onRecoverableError),l.formState!==void 0&&(te=l.formState)),n=Sp(r,1,!0,n,l??null,o,x,te,g,S,F,Rp),n.context=Ep(null),l=n.current,o=br(),o=Ba(o),x=li(o),x.callback=null,ci(l,x,o),l=o,n.current.lanes=l,on(n,l),hn(n),r[Y]=n.current,Ku(r),new go(n)},mc.version="19.2.0",mc}var Xp;function _w(){if(Xp)return vd.exports;Xp=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(a){console.error(a)}}return e(),vd.exports=yw(),vd.exports}var bw=_w();const ww=kv(bw),Sw=({items:e})=>!e||!e.length?null:u.jsx("div",{className:"fixed right-4 bottom-6 z-60 flex flex-col gap-2",children:e.map(a=>u.jsx("div",{className:`px-4 py-2 rounded shadow ${a.type==="error"?"bg-red-600 text-white":a.type==="success"?"bg-green-600 text-white":"bg-gray-800 text-white"}`,children:a.message},a.id))}),Cv=ce.createContext(null),Dv=({children:e})=>{const[a,t]=ce.useState([]),i=ce.useCallback((s,c="info",f=2500)=>{const d=String(Date.now())+Math.random().toString(16).slice(2,8),h={id:d,message:s,type:c};t(m=>[...m,h]),setTimeout(()=>t(m=>m.filter(p=>p.id!==d)),f)},[]);return u.jsxs(Cv.Provider,{value:{push:i},children:[e,u.jsx(Sw,{items:a})]})};function jv(){const e=ce.useContext(Cv);if(!e)throw new Error("useToast must be used within ToastProvider");return e}const va={className:"w-6 h-6"},Ew=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})}),Fv=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.653-.122-1.28-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.653.122-1.28.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),Tw=({className:e=va.className})=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 012-2h4a2 2 0 012 2v1m-4 0h4"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21v-1a4 4 0 00-4-4H9a4 4 0 00-4 4v1"})]}),Nw=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",transform:"rotate(90)",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),Yp=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),Aw=({className:e=va.className})=>u.jsxs("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M15.5 2H8.6c-.4 0-.8.2-1.1.5-.3.3-.5.7-.5 1.1V14c0 .8.6 1.4 1.4 1.4h9.8c.8 0 1.4-.6 1.4-1.4V6.9L15.5 2z"}),u.jsx("path",{d:"M3 7.6v12.8c0 .8.6 1.4 1.4 1.4h9.8"}),u.jsx("path",{d:"M15 2v5h5"})]}),kw=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),Cw=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),Fi=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Ov=({className:e="w-5 h-5"})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Dw=({className:e="w-5 h-5"})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),jw=({className:e="w-5 h-5"})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Fw=({className:e="w-5 h-5"})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8",transform:"rotate(45 12 12)"})}),Rv=({className:e="w-4 h-4"})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),Ow=({className:e="w-5 h-5"})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Mv=({className:e="w-4 h-4"})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})}),Lv=({className:e="w-4 h-4"})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})}),Iv=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),cn=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),vn=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"})}),fs=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),us=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),Rw=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),Mw=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M12 4v12m-4-4l4 4 4-4"})}),Lw=({className:e=va.className})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),Iw=({className:e=va.className})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),Xd=({className:e="w-5 h-5"})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"currentColor",viewBox:"0 0 16 16",children:u.jsx("path",{d:"M7 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"})}),yn=({className:e=va.className})=>u.jsx("svg",{className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),Bw=({className:e=va.className})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),Uw=({icon:e,label:a,active:t=!1,onClick:i})=>u.jsxs("button",{onClick:i,className:`flex items-center w-full px-4 py-2.5 text-sm font-medium rounded-lg transition-colors duration-200 text-left ${t?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,children:[u.jsx("span",{className:"mr-3",children:e}),a]}),zw=({activeView:e,setActiveView:a})=>{const t=[{key:"dashboard",icon:u.jsx(Ew,{className:"w-5 h-5"}),label:"Dashboard"},{key:"manage-trip",icon:u.jsx(Ov,{className:"w-5 h-5"}),label:"Manage Trip"},{key:"manage-contacts",icon:u.jsx(Tw,{className:"w-5 h-5"}),label:"Manage Contacts"},{key:"manage-participants",icon:u.jsx(Fv,{className:"w-5 h-5"}),label:"Manage Participants"},{key:"invites",icon:u.jsx(Bw,{className:"w-5 h-5"}),label:"Invites"},{key:"forms",icon:u.jsx(Iw,{className:"w-5 h-5"}),label:"Forms"},{key:"communications",icon:u.jsx(kw,{className:"w-5 h-5"}),label:"Communications"},{key:"useful-informations",icon:u.jsx(Iv,{className:"w-5 h-5"}),label:"Useful Informations"},{key:"privacy-policy",icon:u.jsx(Yp,{className:"w-5 h-5"}),label:"Privacy Policy"},{key:"terms-conditions",icon:u.jsx(Yp,{className:"w-5 h-5"}),label:"Terms & Conditions"},{key:"documents",icon:u.jsx(Aw,{className:"w-5 h-5"}),label:"Documents"},{key:"reports",icon:u.jsx(Cw,{className:"w-5 h-5"}),label:"Reports"}];return u.jsx("aside",{className:"w-64 bg-white flex-shrink-0 border-r border-gray-200",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-8",children:[u.jsx("div",{className:"bg-blue-600 p-2 rounded-lg text-white",children:u.jsx(Nw,{className:"w-6 h-6"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-lg font-bold text-gray-800",children:"IncentiveTravel"}),u.jsx("p",{className:"text-xs text-gray-500",children:"Admin Panel"})]})]}),u.jsx("nav",{className:"space-y-2",children:t.map(i=>u.jsx(Uw,{icon:i.icon,label:i.label,active:e===i.key,onClick:()=>a(i.key)},i.key))})]})})},yo=({title:e,icon:a,children:t})=>u.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm hover:shadow-lg transition-shadow duration-300",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[a,u.jsx("h3",{className:"font-bold text-gray-800 text-xl",children:e})]}),u.jsx("div",{children:t})]}),Pw=({percentage:e,strokeWidth:a=10,sqSize:t=100})=>{const i=(t-a)/2,s=`0 0 ${t} ${t}`,c=i*Math.PI*2,f=c-c*e/100;return u.jsxs("div",{className:"relative",style:{width:t,height:t},children:[u.jsxs("svg",{width:t,height:t,viewBox:s,children:[u.jsx("circle",{className:"stroke-current text-gray-200",cx:t/2,cy:t/2,r:i,strokeWidth:`${a}px`,fill:"none"}),u.jsx("circle",{className:"stroke-current text-blue-500 transition-all duration-300 ease-in-out",cx:t/2,cy:t/2,r:i,strokeWidth:`${a}px`,transform:`rotate(-90 ${t/2} ${t/2})`,style:{strokeDasharray:c,strokeDashoffset:f,strokeLinecap:"round"},fill:"none"})]}),u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx("span",{className:"text-2xl font-bold text-blue-600",children:`${e}%`})})]})},Hw=()=>u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-center mb-1",children:[u.jsx("h4",{className:"font-medium text-gray-700",children:"Trip to Ibiza"}),u.jsxs("div",{className:"flex items-center text-xs bg-red-100 text-red-600 font-semibold px-2 py-1 rounded-full",children:[u.jsx(Rv,{className:"w-4 h-4 mr-1"})," Missing Data"]})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-amber-400 h-2 rounded-full",style:{width:"60%"}})}),u.jsx("span",{className:"text-sm font-medium text-gray-600",children:"60%"})]}),u.jsx("div",{className:"mt-4 flex",children:u.jsx("button",{className:"flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-blue-600 transition",children:"Completa setup"})})]}),u.jsxs("div",{className:"border-t border-gray-100 pt-6",children:[u.jsx("h4",{className:"font-medium text-gray-700 mb-1",children:"Trip to Maldives"}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-amber-400 h-2 rounded-full",style:{width:"25%"}})}),u.jsx("span",{className:"text-sm font-medium text-gray-600",children:"25%"})]}),u.jsx("div",{className:"mt-4 flex",children:u.jsx("button",{className:"flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-blue-600 transition",children:"Completa setup"})})]})]}),Vw=({onSendInvites:e})=>u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-700",children:"Team Retreat Mykonos"}),u.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"150 invitees"}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{onClick:()=>e("Team Retreat Mykonos",150),className:"flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-blue-600 transition",children:"Invia inviti"}),u.jsx("button",{className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-semibold hover:bg-gray-200 transition",children:"Modifica template"})]})]}),u.jsxs("div",{className:"border-t border-gray-100 pt-6",children:[u.jsx("h4",{className:"font-medium text-gray-700",children:"Sales Kick-off Dubai"}),u.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"85 invitees"}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{onClick:()=>e("Sales Kick-off Dubai",85),className:"flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-blue-600 transition",children:"Invia inviti"}),u.jsx("button",{className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-semibold hover:bg-gray-200 transition",children:"Modifica template"})]})]})]}),Gw=({onSendReminder:e})=>u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center space-x-6",children:[u.jsx(Pw,{percentage:75}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-gray-800",children:"President's Club Hawaii"}),u.jsx("p",{className:"text-sm text-gray-600",children:"112 / 150 completed"}),u.jsxs("p",{className:"text-sm text-orange-500 font-medium",children:[38," incomplete"]})]})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx("button",{onClick:()=>e(38),className:"flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-blue-600 transition",children:"Invia Reminder"}),u.jsx("button",{className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-semibold hover:bg-gray-200 transition",children:"Vedi Report"})]})]}),Xw=({onCreateCommunication:e})=>u.jsxs("div",{className:"space-y-4",children:[u.jsx("h4",{className:"font-semibold text-gray-800 text-lg",children:"Ski Trip to Aspen"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[u.jsx(Rv,{className:"w-5 h-5"}),u.jsx("span",{className:"text-sm font-medium",children:"Flight AA123 Delayed"})]}),u.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[u.jsx(Ow,{className:"w-5 h-5"}),u.jsx("span",{className:"text-sm font-medium",children:"Hotel check-in info sent"})]})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx("button",{onClick:()=>e("information"),className:"flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-blue-600 transition",children:"Invia aggiornamenti"}),u.jsx("button",{onClick:()=>e("alert"),className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-red-700 transition",children:"Gestione emergenze"})]})]}),Wp=({onCreateTrip:e,onCreateCommunication:a,onSendReminder:t,onSendInvites:i})=>u.jsxs("div",{className:"p-8",children:[u.jsxs("header",{className:"flex justify-between items-center mb-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Dashboard Principale"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Operational overview of all incentive trips"})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Fi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search participants, flights, hotels...",className:"pl-10 pr-4 py-2 w-72 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]}),u.jsx("button",{onClick:e,className:"bg-blue-500 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Create New Trip"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsx(yo,{title:"Viaggi in Fase di Creazione",icon:u.jsx(Ov,{className:"text-amber-500 w-4 h-4"}),children:u.jsx(Hw,{})}),u.jsx(yo,{title:"Viaggi Pronti per l'Invio",icon:u.jsx(Dw,{className:"text-green-500 w-4 h-4"}),children:u.jsx(Vw,{onSendInvites:i})}),u.jsx(yo,{title:"Registrazioni in Corso",icon:u.jsx(jw,{className:"text-blue-500 w-4 h-4"}),children:u.jsx(Gw,{onSendReminder:t})}),u.jsx(yo,{title:"Viaggi Partiti - Gestione Operativa",icon:u.jsx(Fw,{className:"text-red-500 w-4 h-4"}),children:u.jsx(Xw,{onCreateCommunication:a})})]})]}),qp=[{id:"IBZ2026",name:"Trip to Ibiza",status:"Draft",participants:"0/80",dates:"Mag 05 - Mag 10, 2026",missingDataPercentage:40},{id:"DXB2026",name:"Sales Kick-off Dubai",status:"Ready to Send",participants:"0/85",dates:"Feb 20 - Feb 25, 2026",missingDataPercentage:0},{id:"MYK2025",name:"Team Retreat Mykonos",status:"Completed",participants:"150/150",dates:"Dic 01 - Dic 07, 2025",missingDataPercentage:0},{id:"ASP2025",name:"Ski Trip to Aspen",status:"Departed",participants:"120/120",dates:"Gen 15 - Gen 22, 2025",missingDataPercentage:0}],Yw=e=>{switch(e){case"Draft":return"bg-blue-100 text-blue-800";case"Ready to Send":return"bg-green-100 text-green-800";case"Completed":return"bg-gray-200 text-gray-800";case"Departed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Ww=({status:e,onEdit:a,onCreateCommunication:t})=>{let i=null;switch(e){case"Draft":i=u.jsx("button",{className:"px-3 py-1.5 text-xs font-semibold rounded-md bg-blue-500 text-white hover:bg-blue-600 transition-colors",children:"Completa Setup"});break;case"Ready to Send":i=u.jsx("button",{className:"px-3 py-1.5 text-xs font-semibold rounded-md bg-green-500 text-white hover:bg-green-600 transition-colors",children:"Invia Inviti"});break;case"Completed":i=u.jsx("button",{className:"px-3 py-1.5 text-xs font-semibold rounded-md bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors",children:"Entra"});break;case"Departed":i=u.jsx("button",{onClick:()=>t("information"),className:"px-3 py-1.5 text-xs font-semibold rounded-md bg-blue-500 text-white hover:bg-blue-600 transition-colors",children:"Invia Aggiornamenti"});break}return u.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[i,e!=="Completed"&&e!=="Departed"&&u.jsx("button",{onClick:a,className:"p-1.5 text-gray-500 hover:text-gray-700 rounded-md transition-colors hover:bg-gray-100",children:u.jsx(vn,{className:"w-4 h-4"})})]})},Kp=e=>{const a={Gen:0,Feb:1,Mar:2,Apr:3,Mag:4,Giu:5,Lug:6,Ago:7,Set:8,Ott:9,Nov:10,Dic:11},t=e.split(" - ");if(t.length<2)return 0;const i=t[0],c=t[1].match(/(\d{4})/);if(!c)return 0;const f=parseInt(c[0],10),d=i.split(" "),h=d[0],m=parseInt(d[1],10),p=a[h];return p!==void 0&&!isNaN(m)&&!isNaN(f)?new Date(f,p,m).getTime():0},qw=({onCreateTrip:e,onEditTrip:a,onCreateCommunication:t})=>{const[i,s]=ce.useState({key:"dates",direction:"descending"}),[c,f]=ce.useState(""),[d,h]=ce.useState("all"),m=ce.useMemo(()=>[...new Set(qp.map(_=>_.status))],[]),p=ce.useMemo(()=>{let _=[...qp].filter(w=>d==="all"||w.status===d).filter(w=>w.name.toLowerCase().includes(c.toLowerCase())||w.id.toLowerCase().includes(c.toLowerCase()));return i.key&&_.sort((w,b)=>{let T,C;return i.key==="dates"?(T=Kp(w.dates),C=Kp(b.dates)):i.key==="participants"?(T=parseInt(w.participants,10),C=parseInt(b.participants,10)):i.key==="missingDataPercentage"?(T=w.missingDataPercentage,C=b.missingDataPercentage):(T=w[i.key],C=b[i.key]),T<C?i.direction==="ascending"?-1:1:T>C?i.direction==="ascending"?1:-1:0}),_},[i,c,d]),v=_=>{let w="ascending";i.key===_&&i.direction==="ascending"&&(w="descending"),s({key:_,direction:w})},y=_=>i.key!==_?u.jsx("span",{className:"inline-block w-4 h-4"}):i.direction==="ascending"?u.jsx(Mv,{className:"inline-block ml-1 w-4 h-4"}):u.jsx(Lv,{className:"inline-block ml-1 w-4 h-4"});return u.jsxs("div",{className:"p-8",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Manage Trips"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"View, edit, and create new incentive trips."})]}),u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Fi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search trips...",value:c,onChange:_=>f(_.target.value),className:"pl-10 pr-4 py-2 w-72 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]}),u.jsxs("div",{className:"relative",children:[u.jsxs("select",{value:d,onChange:_=>h(_.target.value),className:"w-48 border border-gray-300 rounded-lg py-2 px-4 text-gray-700 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition appearance-none pr-8",children:[u.jsx("option",{value:"all",children:"All Statuses"}),m.map(_=>u.jsx("option",{value:_,children:_},_))]}),u.jsx(us,{className:"w-5 h-5 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"})]})]}),u.jsx("button",{onClick:e,className:"bg-blue-500 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Create New Trip"})]})}),u.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[u.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-4",children:u.jsxs("button",{onClick:()=>v("name"),className:"flex items-center hover:text-gray-900 transition-colors",children:["Trip Name",y("name")]})}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:u.jsxs("button",{onClick:()=>v("id"),className:"flex items-center hover:text-gray-900 transition-colors",children:["Trip Id",y("id")]})}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:u.jsxs("button",{onClick:()=>v("status"),className:"flex items-center hover:text-gray-900 transition-colors",children:["Status",y("status")]})}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:u.jsxs("button",{onClick:()=>v("participants"),className:"flex items-center hover:text-gray-900 transition-colors",children:["Registrations",y("participants")]})}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:u.jsxs("button",{onClick:()=>v("missingDataPercentage"),className:"flex items-center hover:text-gray-900 transition-colors",children:["Missing Data",y("missingDataPercentage")]})}),u.jsx("th",{scope:"col",className:"px-6 py-4 text-right",children:"Actions"})]})}),u.jsx("tbody",{children:p.map(_=>u.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[u.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap",children:u.jsxs("div",{children:[u.jsx("div",{className:"text-base font-semibold",children:_.name}),u.jsx("div",{className:"text-sm text-gray-500 font-normal",children:_.dates})]})}),u.jsx("td",{className:"px-6 py-4",children:_.id}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-2 py-1.5 text-xs font-semibold rounded-full ${Yw(_.status)}`,children:_.status})}),u.jsx("td",{className:"px-6 py-4",children:_.participants}),u.jsx("td",{className:"px-6 py-4",children:_.missingDataPercentage>0?u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mr-2",children:u.jsx("div",{className:"bg-amber-400 h-2 rounded-full",style:{width:`${100-_.missingDataPercentage}%`}})}),u.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[100-_.missingDataPercentage,"%"]})]}):u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mr-2",children:u.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"100%"}})}),u.jsx("span",{className:"text-sm font-medium text-gray-600",children:"100%"})]})}),u.jsx("td",{className:"px-6 py-4 text-right",children:u.jsx(Ww,{status:_.status,onEdit:a,onCreateCommunication:t})})]},_.id))})]})})})]})},Kw=({initial:e={},settings:a,onSaved:t})=>{const[i,s]=ce.useState(e.clientName||""),[c,f]=ce.useState(e.name||""),[d,h]=ce.useState(e.subtitle||""),[m,p]=ce.useState(e.description||""),[v,y]=ce.useState(e.startDate||""),[_,w]=ce.useState(e.endDate||""),[b,T]=ce.useState(!1),C=i.trim().length>0&&c.trim().length>=3&&d.trim().length>0&&v&&_&&v<=_,L=async()=>{if(!C)return null;T(!0);try{const N={clientName:i,name:c,subtitle:d,description:m,startDate:v,endDate:_,status:"draft"};a&&(N.settings=a);const j=await fetch("/api/trips",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(!j.ok){const k=await j.text();throw new Error(k||`HTTP ${j.status}`)}const V=await j.json(),M={...V||{},tripId:V&&(V.tripId||V._id)};return t(M),M}catch(N){return console.error(N),alert("Errore salvataggio bozza"),null}finally{T(!1)}};return ce.useEffect(()=>{},[C,i,c,d,m,v,_,a]),u.jsxs("div",{className:"p-6 bg-white rounded-lg border","aria-labelledby":"section1-title",children:[u.jsx("h3",{id:"section1-title",className:"font-bold",children:"Sezione 1  Informazioni Viaggio"}),u.jsxs("div",{className:"grid grid-cols-1 gap-4 mt-4",children:[u.jsxs("label",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium",children:"Nome Cliente *"}),u.jsx("input",{"data-testid":"trip-client",value:i,onChange:N=>s(N.target.value),className:"mt-1 p-2 border rounded",placeholder:"Nome Cliente (e.g. Azienda S.p.A.)"})]}),u.jsxs("label",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium",children:"Nome del Viaggio *"}),u.jsx("input",{"data-testid":"trip-name",value:c,onChange:N=>f(N.target.value),className:"mt-1 p-2 border rounded",placeholder:"Inserisci il nome del viaggio"})]}),u.jsxs("label",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium",children:"Sottotitolo del Viaggio *"}),u.jsx("input",{"data-testid":"trip-subtitle",value:d,onChange:N=>h(N.target.value),className:"mt-1 p-2 border rounded",placeholder:"Sottotitolo del viaggio"})]}),u.jsxs("label",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium",children:"Descrizione"}),u.jsx("textarea",{"data-testid":"trip-description",value:m,onChange:N=>p(N.target.value),className:"mt-1 p-2 border rounded",placeholder:"Descrizione del viaggio",rows:3})]}),u.jsxs("label",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium",children:"Data di Inizio *"}),u.jsx("input",{"data-testid":"trip-start-date",type:"date",value:v,onChange:N=>y(N.target.value),className:"mt-1 p-2 border rounded"})]}),u.jsxs("label",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium",children:"Data di Fine *"}),u.jsx("input",{"data-testid":"trip-end-date",type:"date",value:_,onChange:N=>w(N.target.value),className:"mt-1 p-2 border rounded"})]})]}),u.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[u.jsx("button",{"data-testid":"save-section-1",onClick:L,disabled:!C||b,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50",children:b?"Salvataggio...":"Salva bozza"}),u.jsx("button",{"data-testid":"reset-section-1",onClick:()=>{f(e.name||""),y(e.startDate||""),w(e.endDate||"")},className:"px-3 py-2 rounded border",children:"Annulla"}),!C&&u.jsx("div",{className:"text-sm text-red-600","data-testid":"section1-error",children:"Controlla i campi obbligatori"})]})]})},Bv={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};async function Yd(e=""){const a=e?`${e.replace(/\/$/,"")}/api/useful-informations`:"/api/useful-informations";let t=null;try{console.debug("[E2E] fetchDocumentOptions trying useful-informations",a);let i=await fetch(a).catch(()=>null);if((!i||!i.ok)&&(t||(i=null)),console.debug("[E2E] fetchDocumentOptions status",i&&i.status),!i||!i.ok)return[];const s=await i.json();return(Array.isArray(s)?s:s&&Array.isArray(s.items)?s.items:[]).map(f=>({value:f.value??f.id??f._id??"",label:f.label??f.title??f.name??f.filename??""}))}catch{return[]}}async function Zp(e=""){const a=e?`${e.replace(/\/$/,"")}/api/privacy-policies`:"/api/privacy-policies";try{console.debug("[E2E] fetchPrivacyPolicyOptions url",a);const t=await fetch(a);if(console.debug("[E2E] fetchPrivacyPolicyOptions status",t&&t.status),!t.ok)return[];const i=await t.json();return(Array.isArray(i)?i:i&&Array.isArray(i.items)?i.items:[]).map(c=>({value:c._id??c.id??c.value??"",label:c.title??c.label??c.name??""}))}catch{return[]}}async function Zw(e,a=""){const t=a?`${a.replace(/\/$/,"")}/api/privacy-policies`:"/api/privacy-policies";try{console.debug("[E2E] createPrivacyPolicy url",t,"payload",e);const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.debug("[E2E] createPrivacyPolicy response status",i&&i.status),!i.ok)return null;const s=await i.json(),c={value:s.id??s._id??s.value??"",label:s.title??s.label??""};try{window.__E2E_lastCreatePrivacyResult=c}catch{}return c}catch(i){return console.error("createPrivacyPolicy error",i),null}}async function $p(e,a=""){const t=a?`${a.replace(/\/$/,"")}/api/useful-informations`:"/api/useful-informations";let i=null;const s=e&&e.usefulInfo||!i?t:i;try{console.debug("[E2E] createDocument url",s,"payload",e);const c=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.debug("[E2E] createDocument response status",c&&c.status),!c||!c.ok)return null;const f=await c.json();return{value:f.id??f._id??f.value??"",label:f.title??f.label??f.name??""}}catch{return null}}async function Wd(e,a=""){const t=a?`${a.replace(/\/$/,"")}/api/useful-informations`:"/api/useful-informations";try{console.debug("[E2E] createUsefulInfo url",t,"payload",e);const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.debug("[E2E] createUsefulInfo response status",i&&i.status),!i.ok)return null;const s=await i.json();return{value:s.id??s._id??s.value??"",label:s.title??s.label??""}}catch(i){return console.error("createUsefulInfo error",i),null}}async function Lo(e=""){const a=e?`${e.replace(/\/$/,"")}/api/terms-documents`:"/api/terms-documents";try{const t=await fetch(a);if(!t.ok)return[];const i=await t.json();return Array.isArray(i)?i:i&&Array.isArray(i.items)?i.items:[]}catch{return[]}}async function Uv(e,a=""){const t=a?`${a.replace(/\/$/,"")}/api/terms-documents`:"/api/terms-documents";try{const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!i.ok)return null;const s=await i.json();return{value:s.id??s._id??s.value??"",label:s.title??s.label??""}}catch{return null}}async function $w(e,a,t=""){try{const i=await fetch(t?`${t.replace(/\/$/,"")}/api/terms-documents/${e}`:`/api/terms-documents/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return i.ok?await i.json():null}catch{return null}}async function Qw(e,a=""){try{return(await fetch(a?`${a.replace(/\/$/,"")}/api/terms-documents/${e}`:`/api/terms-documents/${e}`,{method:"DELETE"})).ok}catch{return!1}}async function Jw(e,a=""){try{const t=a?`${a.replace(/\/$/,"")}/api/useful-informations/${e}`:`/api/useful-informations/${e}`,i=typeof import.meta<"u"&&Bv&&!1;let s=null,c=await fetch(t).catch(()=>null);return(!c||!c.ok)&&s&&(c=await fetch(s).catch(()=>null)),!c||!c.ok?null:await c.json()}catch{return null}}async function eS(e,a=""){try{const t=typeof import.meta<"u"&&Bv&&!1;let i=null;const s=a?`${a.replace(/\/$/,"")}/api/useful-informations/${e}`:`/api/useful-informations/${e}`;let c=await fetch(s,{method:"DELETE"}).catch(()=>null);return(!c||!c.ok)&&i&&(c=await fetch(i,{method:"DELETE"}).catch(()=>null)),!!(c&&c.ok)}catch{return!1}}const zv=({open:e,onCreated:a,onClose:t})=>{const[i,s]=ce.useState(""),[c,f]=ce.useState(""),[d,h]=ce.useState(""),[m,p]=ce.useState(""),[v,y]=ce.useState(""),[_,w]=ce.useState(""),[b,T]=ce.useState(""),[C,L]=ce.useState(""),[N,j]=ce.useState(""),[V,M]=ce.useState(""),[k,W]=ce.useState(!1),[K,J]=ce.useState(null),Z=jv();if(Ia.useEffect(()=>{let re;try{re=import.meta}catch{re=void 0}if(!(!re||!re.env||!re.env.DEV)){try{window.__E2E_forceCreateDocument=async ue=>{try{const{title:ve="",content:ee="",usefulInfo:G={}}=ue||{};if(console.debug("[E2E] __E2E_forceCreateDocument called",{payload:ue}),!ve||!ve.trim())return{ok:!1,reason:"title_required"};let ae=null;G&&Object.keys(G).length>0?ae=await Wd({title:ve.trim(),content:ee,usefulInfo:G}):ae=await $p({title:ve.trim(),content:ee,usefulInfo:G}),console.debug("[E2E] __E2E_forceCreateDocument createDocument result",ae);try{window.__E2E_lastCreateResult=ae||null}catch{}if(!ae)return{ok:!1,reason:"create_failed"};try{Z.push("Documento creato con successo","success")}catch{}try{window.dispatchEvent(new CustomEvent("documents:changed",{detail:{action:"create",doc:ae}}))}catch{}return{ok:!0,doc:ae}}catch(ve){return{ok:!1,reason:ve&&ve.message}}}}catch{}return()=>{try{delete window.__E2E_forceCreateDocument}catch{}}}},[]),Ia.useEffect(()=>{let re;try{re=import.meta}catch{re=void 0}if(!(!re||!re.env||!re.env.DEV)){try{window.__E2E_setDocCreatorFields=ue=>{try{if(!ue)return{ok:!1,reason:"no-payload"};ue.title!==void 0&&s(ue.title),ue.content!==void 0&&f(ue.content),ue.destinationName!==void 0&&h(ue.destinationName),ue.country!==void 0&&p(ue.country),ue.documents!==void 0&&y(ue.documents),ue.timeZone!==void 0&&w(ue.timeZone),ue.currency!==void 0&&T(ue.currency),ue.language!==void 0&&L(ue.language),ue.climate!==void 0&&j(ue.climate),ue.vaccinationsHealth!==void 0&&M(ue.vaccinationsHealth),console.debug("[E2E] __E2E_setDocCreatorFields applied",ue);try{window.__E2E_lastSetPayload=ue}catch{}return{ok:!0}}catch(ve){return{ok:!1,reason:ve&&ve.message}}},window.__E2E_invokeCreate=async ue=>{try{let ve;if(ue&&(ue.title||ue.content||ue.usefulInfo)&&(ve={title:ue.title,content:ue.content,usefulInfo:ue.usefulInfo}),!ve)try{ve=window.__E2E_lastSetPayload||void 0}catch{ve=void 0}await Q(ve);const ee=Date.now();let G=window.__E2E_lastCreateResult||null;for(;!G&&Date.now()-ee<3e3;)await new Promise(ae=>setTimeout(ae,100)),G=window.__E2E_lastCreateResult||null;return{ok:!!G,doc:G}}catch(ve){return{ok:!1,reason:ve&&ve.message}}}}catch{}return()=>{try{delete window.__E2E_setDocCreatorFields}catch{}try{delete window.__E2E_invokeCreate}catch{}}}},[]),Ia.useEffect(()=>{if(console.debug("[E2E] DocumentCreator mounted, open=",e),!e)return;let re=!1;const ue=()=>{try{const ee=document.querySelector('[data-testid="doc-creator-create"]');ee&&!re&&(re=!0,ee.addEventListener("click",G=>{try{const ae=ee;console.debug("[E2E] capturing click on doc-creator-create",{disabled:ae?ae.disabled:void 0})}catch{}},!0))}catch{}};ue();const ve=setTimeout(ue,200);return()=>{clearTimeout(ve),console.debug("[E2E] DocumentCreator unmounted")}},[e]),!e)return null;async function Q(re){try{window.__E2E_lastCreateAttempt=Date.now()}catch{}const ue=re&&re.title!==void 0?String(re.title||""):i,ve=re&&re.content!==void 0?re.content:c,ee=re&&re.usefulInfo!==void 0?re.usefulInfo:{destinationName:d,country:m,documents:v,timeZone:_,currency:b,language:C,climate:N,vaccinationsHealth:V};if(!ue||!String(ue).trim())return J("Titolo richiesto");W(!0),J(null);const G={title:String(ue).trim(),content:ve,usefulInfo:ee};console.debug("[E2E] DocumentCreator.doCreate payload",G);let ae=null;G&&G.usefulInfo&&Object.keys(G.usefulInfo).length>0?ae=await Wd(G):ae=await $p(G),console.debug("[E2E] DocumentCreator.doCreate result",ae);try{window.__E2E_lastCreateResult=ae||null}catch{}if(W(!1),!ae)return console.debug("[E2E] DocumentCreator.doCreate failed to create"),J("Errore durante la creazione");Z.push("Documento creato con successo","success");try{window.dispatchEvent(new CustomEvent("documents:changed",{detail:{action:"create",doc:ae}}))}catch{}setTimeout(()=>a(ae),250)}return u.jsx("div",{"data-testid":"doc-creator-root",className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl p-6",children:[u.jsxs("header",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold",children:"Create New Document"}),u.jsx("button",{onClick:t,children:u.jsx(yn,{className:"w-5 h-5 text-gray-600"})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium",children:"Destination Name"}),u.jsx("input",{"data-testid":"doc-creator-destinationName",value:d,onChange:re=>h(re.target.value),className:"mt-1 p-2 border rounded w-full"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium",children:"Country"}),u.jsx("input",{"data-testid":"doc-creator-country",value:m,onChange:re=>p(re.target.value),className:"mt-1 p-2 border rounded w-full"})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"text-sm font-medium",children:"Title"}),u.jsx("input",{"data-testid":"doc-creator-title",value:i,onChange:re=>s(re.target.value),className:"mt-1 p-2 border rounded w-full"})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"text-sm font-medium",children:"Content"}),u.jsx("textarea",{"data-testid":"doc-creator-content",value:c,onChange:re=>f(re.target.value),className:"mt-1 p-2 border rounded w-full",rows:4})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"text-sm font-medium",children:"Documents"}),u.jsx("textarea",{"data-testid":"doc-creator-documents",value:v,onChange:re=>y(re.target.value),className:"mt-1 p-2 border rounded w-full",rows:2})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium",children:"Time Zone"}),u.jsx("input",{"data-testid":"doc-creator-timeZone",value:_,onChange:re=>w(re.target.value),className:"mt-1 p-2 border rounded w-full"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium",children:"Currency"}),u.jsx("input",{"data-testid":"doc-creator-currency",value:b,onChange:re=>T(re.target.value),className:"mt-1 p-2 border rounded w-full"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium",children:"Language"}),u.jsx("input",{"data-testid":"doc-creator-language",value:C,onChange:re=>L(re.target.value),className:"mt-1 p-2 border rounded w-full"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm font-medium",children:"Climate"}),u.jsx("input",{"data-testid":"doc-creator-climate",value:N,onChange:re=>j(re.target.value),className:"mt-1 p-2 border rounded w-full"})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"text-sm font-medium",children:"Vaccinations & Health"}),u.jsx("textarea",{"data-testid":"doc-creator-vaccinations",value:V,onChange:re=>M(re.target.value),className:"mt-1 p-2 border rounded w-full",rows:2})]})]}),K&&u.jsx("div",{className:"text-sm text-red-600 mt-3",children:K}),u.jsxs("footer",{className:"flex justify-end gap-3 mt-4",children:[u.jsx("button",{"data-testid":"doc-creator-cancel",onClick:t,className:"px-4 py-2 border rounded",children:"Cancel"}),u.jsx("button",{"data-testid":"doc-creator-create",onClick:()=>{Q()},disabled:k,className:"px-4 py-2 bg-blue-600 text-white rounded",children:k?"Creating...":"Create"})]})]})})},_n=({open:e,title:a,message:t,confirmLabel:i="Ok",cancelLabel:s="Annulla",onConfirm:c,onCancel:f,variant:d="info"})=>{if(!e)return null;const h=d==="success"?"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700":d==="danger"?"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700":"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700";return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-lg w-full p-6",children:[a&&u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:a}),u.jsx("div",{className:"text-sm text-gray-700 mb-4",children:t}),u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{onClick:f,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:s}),u.jsx("button",{onClick:c,className:h,children:i})]})]})})};/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:Pv,setPrototypeOf:Qp,isFrozen:tS,getPrototypeOf:aS,getOwnPropertyDescriptor:rS}=Object;let{freeze:er,seal:Yr,create:qd}=Object,{apply:Kd,construct:Zd}=typeof Reflect<"u"&&Reflect;er||(er=function(a){return a});Yr||(Yr=function(a){return a});Kd||(Kd=function(a,t){for(var i=arguments.length,s=new Array(i>2?i-2:0),c=2;c<i;c++)s[c-2]=arguments[c];return a.apply(t,s)});Zd||(Zd=function(a){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return new a(...i)});const _o=tr(Array.prototype.forEach),nS=tr(Array.prototype.lastIndexOf),Jp=tr(Array.prototype.pop),xc=tr(Array.prototype.push),iS=tr(Array.prototype.splice),Mo=tr(String.prototype.toLowerCase),wd=tr(String.prototype.toString),Sd=tr(String.prototype.match),pc=tr(String.prototype.replace),sS=tr(String.prototype.indexOf),lS=tr(String.prototype.trim),an=tr(Object.prototype.hasOwnProperty),Za=tr(RegExp.prototype.test),gc=cS(TypeError);function tr(e){return function(a){a instanceof RegExp&&(a.lastIndex=0);for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return Kd(e,a,i)}}function cS(e){return function(){for(var a=arguments.length,t=new Array(a),i=0;i<a;i++)t[i]=arguments[i];return Zd(e,t)}}function ht(e,a){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Mo;Qp&&Qp(e,null);let i=a.length;for(;i--;){let s=a[i];if(typeof s=="string"){const c=t(s);c!==s&&(tS(a)||(a[i]=c),s=c)}e[s]=!0}return e}function oS(e){for(let a=0;a<e.length;a++)an(e,a)||(e[a]=null);return e}function Vn(e){const a=qd(null);for(const[t,i]of Pv(e))an(e,t)&&(Array.isArray(i)?a[t]=oS(i):i&&typeof i=="object"&&i.constructor===Object?a[t]=Vn(i):a[t]=i);return a}function vc(e,a){for(;e!==null;){const i=rS(e,a);if(i){if(i.get)return tr(i.get);if(typeof i.value=="function")return tr(i.value)}e=aS(e)}function t(){return null}return t}const eg=er(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ed=er(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Td=er(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),fS=er(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Nd=er(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),uS=er(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tg=er(["#text"]),ag=er(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ad=er(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),rg=er(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),bo=er(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),dS=Yr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),hS=Yr(/<%[\w\W]*|[\w\W]*%>/gm),mS=Yr(/\$\{[\w\W]*/gm),xS=Yr(/^data-[\-\w.\u00B7-\uFFFF]+$/),pS=Yr(/^aria-[\-\w]+$/),Hv=Yr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),gS=Yr(/^(?:\w+script|data):/i),vS=Yr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Vv=Yr(/^html$/i),yS=Yr(/^[a-z][.\w]*(-[.\w]+)+$/i);var ng=Object.freeze({__proto__:null,ARIA_ATTR:pS,ATTR_WHITESPACE:vS,CUSTOM_ELEMENT:yS,DATA_ATTR:xS,DOCTYPE_NAME:Vv,ERB_EXPR:hS,IS_ALLOWED_URI:Hv,IS_SCRIPT_OR_DATA:gS,MUSTACHE_EXPR:dS,TMPLIT_EXPR:mS});const yc={element:1,text:3,progressingInstruction:7,comment:8,document:9},_S=function(){return typeof window>"u"?null:window},bS=function(a,t){if(typeof a!="object"||typeof a.createPolicy!="function")return null;let i=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(i=t.getAttribute(s));const c="dompurify"+(i?"#"+i:"");try{return a.createPolicy(c,{createHTML(f){return f},createScriptURL(f){return f}})}catch{return console.warn("TrustedTypes policy "+c+" could not be created."),null}},ig=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Gv(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_S();const a=ne=>Gv(ne);if(a.version="3.3.0",a.removed=[],!e||!e.document||e.document.nodeType!==yc.document||!e.Element)return a.isSupported=!1,a;let{document:t}=e;const i=t,s=i.currentScript,{DocumentFragment:c,HTMLTemplateElement:f,Node:d,Element:h,NodeFilter:m,NamedNodeMap:p=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:v,DOMParser:y,trustedTypes:_}=e,w=h.prototype,b=vc(w,"cloneNode"),T=vc(w,"remove"),C=vc(w,"nextSibling"),L=vc(w,"childNodes"),N=vc(w,"parentNode");if(typeof f=="function"){const ne=t.createElement("template");ne.content&&ne.content.ownerDocument&&(t=ne.content.ownerDocument)}let j,V="";const{implementation:M,createNodeIterator:k,createDocumentFragment:W,getElementsByTagName:K}=t,{importNode:J}=i;let Z=ig();a.isSupported=typeof Pv=="function"&&typeof N=="function"&&M&&M.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Q,ERB_EXPR:re,TMPLIT_EXPR:ue,DATA_ATTR:ve,ARIA_ATTR:ee,IS_SCRIPT_OR_DATA:G,ATTR_WHITESPACE:ae,CUSTOM_ELEMENT:R}=ng;let{IS_ALLOWED_URI:se}=ng,A=null;const E=ht({},[...eg,...Ed,...Td,...Nd,...tg]);let O=null;const B=ht({},[...ag,...Ad,...rg,...bo]);let z=Object.seal(qd(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),le=null,ye=null;const Ne=Object.seal(qd(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Te=!0,De=!0,Ve=!1,q=!0,ct=!1,We=!0,tt=!1,qe=!1,Re=!1,vt=!1,Bt=!1,Kt=!1,Sa=!0,Ar=!1;const ar="user-content-";let bt=!0,ya=!1,Pe={},Be=null;const Ue=ht({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let He=null;const Fe=ht({},["audio","video","img","source","image","track"]);let Je=null;const mt=ht({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),et="http://www.w3.org/1998/Math/MathML",_t="http://www.w3.org/2000/svg",na="http://www.w3.org/1999/xhtml";let Zt=na,Ii=!1,Qn=null;const Es=ht({},[et,_t,na],wd);let kr=ht({},["mi","mo","mn","ms","mtext"]),Kr=ht({},["annotation-xml"]);const Jn=ht({},["title","style","font","a","script"]);let Ea=null;const ei=["application/xhtml+xml","text/html"],Sn="text/html";let $t=null,Zr=null;const Bi=t.createElement("form"),on=function(P){return P instanceof RegExp||P instanceof Function},Ui=function(){let P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Zr&&Zr===P)){if((!P||typeof P!="object")&&(P={}),P=Vn(P),Ea=ei.indexOf(P.PARSER_MEDIA_TYPE)===-1?Sn:P.PARSER_MEDIA_TYPE,$t=Ea==="application/xhtml+xml"?wd:Mo,A=an(P,"ALLOWED_TAGS")?ht({},P.ALLOWED_TAGS,$t):E,O=an(P,"ALLOWED_ATTR")?ht({},P.ALLOWED_ATTR,$t):B,Qn=an(P,"ALLOWED_NAMESPACES")?ht({},P.ALLOWED_NAMESPACES,wd):Es,Je=an(P,"ADD_URI_SAFE_ATTR")?ht(Vn(mt),P.ADD_URI_SAFE_ATTR,$t):mt,He=an(P,"ADD_DATA_URI_TAGS")?ht(Vn(Fe),P.ADD_DATA_URI_TAGS,$t):Fe,Be=an(P,"FORBID_CONTENTS")?ht({},P.FORBID_CONTENTS,$t):Ue,le=an(P,"FORBID_TAGS")?ht({},P.FORBID_TAGS,$t):Vn({}),ye=an(P,"FORBID_ATTR")?ht({},P.FORBID_ATTR,$t):Vn({}),Pe=an(P,"USE_PROFILES")?P.USE_PROFILES:!1,Te=P.ALLOW_ARIA_ATTR!==!1,De=P.ALLOW_DATA_ATTR!==!1,Ve=P.ALLOW_UNKNOWN_PROTOCOLS||!1,q=P.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ct=P.SAFE_FOR_TEMPLATES||!1,We=P.SAFE_FOR_XML!==!1,tt=P.WHOLE_DOCUMENT||!1,vt=P.RETURN_DOM||!1,Bt=P.RETURN_DOM_FRAGMENT||!1,Kt=P.RETURN_TRUSTED_TYPE||!1,Re=P.FORCE_BODY||!1,Sa=P.SANITIZE_DOM!==!1,Ar=P.SANITIZE_NAMED_PROPS||!1,bt=P.KEEP_CONTENT!==!1,ya=P.IN_PLACE||!1,se=P.ALLOWED_URI_REGEXP||Hv,Zt=P.NAMESPACE||na,kr=P.MATHML_TEXT_INTEGRATION_POINTS||kr,Kr=P.HTML_INTEGRATION_POINTS||Kr,z=P.CUSTOM_ELEMENT_HANDLING||{},P.CUSTOM_ELEMENT_HANDLING&&on(P.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(z.tagNameCheck=P.CUSTOM_ELEMENT_HANDLING.tagNameCheck),P.CUSTOM_ELEMENT_HANDLING&&on(P.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(z.attributeNameCheck=P.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),P.CUSTOM_ELEMENT_HANDLING&&typeof P.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(z.allowCustomizedBuiltInElements=P.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ct&&(De=!1),Bt&&(vt=!0),Pe&&(A=ht({},tg),O=[],Pe.html===!0&&(ht(A,eg),ht(O,ag)),Pe.svg===!0&&(ht(A,Ed),ht(O,Ad),ht(O,bo)),Pe.svgFilters===!0&&(ht(A,Td),ht(O,Ad),ht(O,bo)),Pe.mathMl===!0&&(ht(A,Nd),ht(O,rg),ht(O,bo))),P.ADD_TAGS&&(typeof P.ADD_TAGS=="function"?Ne.tagCheck=P.ADD_TAGS:(A===E&&(A=Vn(A)),ht(A,P.ADD_TAGS,$t))),P.ADD_ATTR&&(typeof P.ADD_ATTR=="function"?Ne.attributeCheck=P.ADD_ATTR:(O===B&&(O=Vn(O)),ht(O,P.ADD_ATTR,$t))),P.ADD_URI_SAFE_ATTR&&ht(Je,P.ADD_URI_SAFE_ATTR,$t),P.FORBID_CONTENTS&&(Be===Ue&&(Be=Vn(Be)),ht(Be,P.FORBID_CONTENTS,$t)),bt&&(A["#text"]=!0),tt&&ht(A,["html","head","body"]),A.table&&(ht(A,["tbody"]),delete le.tbody),P.TRUSTED_TYPES_POLICY){if(typeof P.TRUSTED_TYPES_POLICY.createHTML!="function")throw gc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof P.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw gc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');j=P.TRUSTED_TYPES_POLICY,V=j.createHTML("")}else j===void 0&&(j=bS(_,s)),j!==null&&typeof V=="string"&&(V=j.createHTML(""));er&&er(P),Zr=P}},zi=ht({},[...Ed,...Td,...fS]),En=ht({},[...Nd,...uS]),Ts=function(P){let fe=N(P);(!fe||!fe.tagName)&&(fe={namespaceURI:Zt,tagName:"template"});const be=Mo(P.tagName),ke=Mo(fe.tagName);return Qn[P.namespaceURI]?P.namespaceURI===_t?fe.namespaceURI===na?be==="svg":fe.namespaceURI===et?be==="svg"&&(ke==="annotation-xml"||kr[ke]):!!zi[be]:P.namespaceURI===et?fe.namespaceURI===na?be==="math":fe.namespaceURI===_t?be==="math"&&Kr[ke]:!!En[be]:P.namespaceURI===na?fe.namespaceURI===_t&&!Kr[ke]||fe.namespaceURI===et&&!kr[ke]?!1:!En[be]&&(Jn[be]||!zi[be]):!!(Ea==="application/xhtml+xml"&&Qn[P.namespaceURI]):!1},Ba=function(P){xc(a.removed,{element:P});try{N(P).removeChild(P)}catch{T(P)}},hr=function(P,fe){try{xc(a.removed,{attribute:fe.getAttributeNode(P),from:fe})}catch{xc(a.removed,{attribute:null,from:fe})}if(fe.removeAttribute(P),P==="is")if(vt||Bt)try{Ba(fe)}catch{}else try{fe.setAttribute(P,"")}catch{}},D=function(P){let fe=null,be=null;if(Re)P="<remove></remove>"+P;else{const Ie=Sd(P,/^[\r\n\t ]+/);be=Ie&&Ie[0]}Ea==="application/xhtml+xml"&&Zt===na&&(P='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+P+"</body></html>");const ke=j?j.createHTML(P):P;if(Zt===na)try{fe=new y().parseFromString(ke,Ea)}catch{}if(!fe||!fe.documentElement){fe=M.createDocument(Zt,"template",null);try{fe.documentElement.innerHTML=Ii?V:ke}catch{}}const Oe=fe.body||fe.documentElement;return P&&be&&Oe.insertBefore(t.createTextNode(be),Oe.childNodes[0]||null),Zt===na?K.call(fe,tt?"html":"body")[0]:tt?fe.documentElement:Oe},X=function(P){return k.call(P.ownerDocument||P,P,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},I=function(P){return P instanceof v&&(typeof P.nodeName!="string"||typeof P.textContent!="string"||typeof P.removeChild!="function"||!(P.attributes instanceof p)||typeof P.removeAttribute!="function"||typeof P.setAttribute!="function"||typeof P.namespaceURI!="string"||typeof P.insertBefore!="function"||typeof P.hasChildNodes!="function")},U=function(P){return typeof d=="function"&&P instanceof d};function H(ne,P,fe){_o(ne,be=>{be.call(a,P,fe,Zr)})}const Y=function(P){let fe=null;if(H(Z.beforeSanitizeElements,P,null),I(P))return Ba(P),!0;const be=$t(P.nodeName);if(H(Z.uponSanitizeElement,P,{tagName:be,allowedTags:A}),We&&P.hasChildNodes()&&!U(P.firstElementChild)&&Za(/<[/\w!]/g,P.innerHTML)&&Za(/<[/\w!]/g,P.textContent)||P.nodeType===yc.progressingInstruction||We&&P.nodeType===yc.comment&&Za(/<[/\w]/g,P.data))return Ba(P),!0;if(!(Ne.tagCheck instanceof Function&&Ne.tagCheck(be))&&(!A[be]||le[be])){if(!le[be]&&Se(be)&&(z.tagNameCheck instanceof RegExp&&Za(z.tagNameCheck,be)||z.tagNameCheck instanceof Function&&z.tagNameCheck(be)))return!1;if(bt&&!Be[be]){const ke=N(P)||P.parentNode,Oe=L(P)||P.childNodes;if(Oe&&ke){const Ie=Oe.length;for(let it=Ie-1;it>=0;--it){const xt=b(Oe[it],!0);xt.__removalCount=(P.__removalCount||0)+1,ke.insertBefore(xt,C(P))}}}return Ba(P),!0}return P instanceof h&&!Ts(P)||(be==="noscript"||be==="noembed"||be==="noframes")&&Za(/<\/no(script|embed|frames)/i,P.innerHTML)?(Ba(P),!0):(ct&&P.nodeType===yc.text&&(fe=P.textContent,_o([Q,re,ue],ke=>{fe=pc(fe,ke," ")}),P.textContent!==fe&&(xc(a.removed,{element:P.cloneNode()}),P.textContent=fe)),H(Z.afterSanitizeElements,P,null),!1)},he=function(P,fe,be){if(Sa&&(fe==="id"||fe==="name")&&(be in t||be in Bi))return!1;if(!(De&&!ye[fe]&&Za(ve,fe))){if(!(Te&&Za(ee,fe))){if(!(Ne.attributeCheck instanceof Function&&Ne.attributeCheck(fe,P))){if(!O[fe]||ye[fe]){if(!(Se(P)&&(z.tagNameCheck instanceof RegExp&&Za(z.tagNameCheck,P)||z.tagNameCheck instanceof Function&&z.tagNameCheck(P))&&(z.attributeNameCheck instanceof RegExp&&Za(z.attributeNameCheck,fe)||z.attributeNameCheck instanceof Function&&z.attributeNameCheck(fe,P))||fe==="is"&&z.allowCustomizedBuiltInElements&&(z.tagNameCheck instanceof RegExp&&Za(z.tagNameCheck,be)||z.tagNameCheck instanceof Function&&z.tagNameCheck(be))))return!1}else if(!Je[fe]){if(!Za(se,pc(be,ae,""))){if(!((fe==="src"||fe==="xlink:href"||fe==="href")&&P!=="script"&&sS(be,"data:")===0&&He[P])){if(!(Ve&&!Za(G,pc(be,ae,"")))){if(be)return!1}}}}}}}return!0},Se=function(P){return P!=="annotation-xml"&&Sd(P,R)},me=function(P){H(Z.beforeSanitizeAttributes,P,null);const{attributes:fe}=P;if(!fe||I(P))return;const be={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:O,forceKeepAttr:void 0};let ke=fe.length;for(;ke--;){const Oe=fe[ke],{name:Ie,namespaceURI:it,value:xt}=Oe,At=$t(Ie),Ua=xt;let zt=Ie==="value"?Ua:lS(Ua);if(be.attrName=At,be.attrValue=zt,be.keepAttr=!0,be.forceKeepAttr=void 0,H(Z.uponSanitizeAttribute,P,be),zt=be.attrValue,Ar&&(At==="id"||At==="name")&&(hr(Ie,P),zt=ar+zt),We&&Za(/((--!?|])>)|<\/(style|title|textarea)/i,zt)){hr(Ie,P);continue}if(At==="attributename"&&Sd(zt,"href")){hr(Ie,P);continue}if(be.forceKeepAttr)continue;if(!be.keepAttr){hr(Ie,P);continue}if(!q&&Za(/\/>/i,zt)){hr(Ie,P);continue}ct&&_o([Q,re,ue],mr=>{zt=pc(zt,mr," ")});const $r=$t(P.nodeName);if(!he($r,At,zt)){hr(Ie,P);continue}if(j&&typeof _=="object"&&typeof _.getAttributeType=="function"&&!it)switch(_.getAttributeType($r,At)){case"TrustedHTML":{zt=j.createHTML(zt);break}case"TrustedScriptURL":{zt=j.createScriptURL(zt);break}}if(zt!==Ua)try{it?P.setAttributeNS(it,Ie,zt):P.setAttribute(Ie,zt),I(P)?Ba(P):Jp(a.removed)}catch{hr(Ie,P)}}H(Z.afterSanitizeAttributes,P,null)},pe=function ne(P){let fe=null;const be=X(P);for(H(Z.beforeSanitizeShadowDOM,P,null);fe=be.nextNode();)H(Z.uponSanitizeShadowNode,fe,null),Y(fe),me(fe),fe.content instanceof c&&ne(fe.content);H(Z.afterSanitizeShadowDOM,P,null)};return a.sanitize=function(ne){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},fe=null,be=null,ke=null,Oe=null;if(Ii=!ne,Ii&&(ne="<!-->"),typeof ne!="string"&&!U(ne))if(typeof ne.toString=="function"){if(ne=ne.toString(),typeof ne!="string")throw gc("dirty is not a string, aborting")}else throw gc("toString is not a function");if(!a.isSupported)return ne;if(qe||Ui(P),a.removed=[],typeof ne=="string"&&(ya=!1),ya){if(ne.nodeName){const xt=$t(ne.nodeName);if(!A[xt]||le[xt])throw gc("root node is forbidden and cannot be sanitized in-place")}}else if(ne instanceof d)fe=D("<!---->"),be=fe.ownerDocument.importNode(ne,!0),be.nodeType===yc.element&&be.nodeName==="BODY"||be.nodeName==="HTML"?fe=be:fe.appendChild(be);else{if(!vt&&!ct&&!tt&&ne.indexOf("<")===-1)return j&&Kt?j.createHTML(ne):ne;if(fe=D(ne),!fe)return vt?null:Kt?V:""}fe&&Re&&Ba(fe.firstChild);const Ie=X(ya?ne:fe);for(;ke=Ie.nextNode();)Y(ke),me(ke),ke.content instanceof c&&pe(ke.content);if(ya)return ne;if(vt){if(Bt)for(Oe=W.call(fe.ownerDocument);fe.firstChild;)Oe.appendChild(fe.firstChild);else Oe=fe;return(O.shadowroot||O.shadowrootmode)&&(Oe=J.call(i,Oe,!0)),Oe}let it=tt?fe.outerHTML:fe.innerHTML;return tt&&A["!doctype"]&&fe.ownerDocument&&fe.ownerDocument.doctype&&fe.ownerDocument.doctype.name&&Za(Vv,fe.ownerDocument.doctype.name)&&(it="<!DOCTYPE "+fe.ownerDocument.doctype.name+`>
`+it),ct&&_o([Q,re,ue],xt=>{it=pc(it,xt," ")}),j&&Kt?j.createHTML(it):it},a.setConfig=function(){let ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ui(ne),qe=!0},a.clearConfig=function(){Zr=null,qe=!1},a.isValidAttribute=function(ne,P,fe){Zr||Ui({});const be=$t(ne),ke=$t(P);return he(be,ke,fe)},a.addHook=function(ne,P){typeof P=="function"&&xc(Z[ne],P)},a.removeHook=function(ne,P){if(P!==void 0){const fe=nS(Z[ne],P);return fe===-1?void 0:iS(Z[ne],fe,1)[0]}return Jp(Z[ne])},a.removeHooks=function(ne){Z[ne]=[]},a.removeAllHooks=function(){Z=ig()},a}var wS=Gv();const _c=({command:e,title:a,children:t,applyFormat:i})=>u.jsx("button",{type:"button",onMouseDown:s=>s.preventDefault(),onClick:()=>i(e),className:"p-2 rounded hover:bg-gray-200",title:a,children:t}),SS=({editorRef:e})=>{const a=(t,i=null)=>{e.current&&e.current.focus(),document.execCommand(t,!1,i)};return u.jsxs("div",{className:"flex items-center space-x-1 p-2 bg-gray-100 border border-b-0 border-gray-300 rounded-t-lg text-gray-700",children:[u.jsx(_c,{command:"bold",title:"Bold",applyFormat:a,children:u.jsx("strong",{className:"font-bold w-5 text-center",children:"B"})}),u.jsx(_c,{command:"italic",title:"Italic",applyFormat:a,children:u.jsx("em",{className:"italic w-5 text-center",children:"I"})}),u.jsx(_c,{command:"underline",title:"Underline",applyFormat:a,children:u.jsx("u",{className:"underline w-5 text-center",children:"U"})}),u.jsx("span",{className:"w-px h-5 bg-gray-300 mx-2"}),u.jsx(_c,{command:"insertUnorderedList",title:"Bulleted List",applyFormat:a,children:u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})}),u.jsx(_c,{command:"insertOrderedList",title:"Numbered List",applyFormat:a,children:u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{d:"M10 3a1 1 0 00-1 1v1.333H5.333a1 1 0 100 1.334h3.667v1.333H5.333a1 1 0 100 1.334h3.667v1.333H5.333a1 1 0 100 1.334H9V16a1 1 0 102 0v-1.333h3.667a1 1 0 100-1.334h-3.667v-1.333h3.667a1 1 0 100-1.334h-3.667V8.667h3.667a1 1 0 100-1.334H11V4a1 1 0 00-1-1z",clipRule:"evenodd",fillRule:"evenodd"})})})]})},Xv=({isOpen:e,documentToEdit:a,onClose:t,onSave:i,globalDocExists:s})=>{const[c,f]=ce.useState(""),d=ce.useRef(null);ce.useEffect(()=>{f(a?a.title:!s?"Global Privacy Policy":"Privacy Policy")},[a,s,e]),ce.useEffect(()=>{e&&setTimeout(()=>{var p;if(d.current){d.current.focus();const v=window.getSelection();if(v&&((p=d.current)!=null&&p.lastChild)){const y=document.createRange();y.selectNodeContents(d.current),y.collapse(!1),v.removeAllRanges(),v.addRange(y)}}},50)},[e]);const h=()=>{var y;if(!c.trim()){alert("Il titolo non pu essere vuoto.");return}const p=((y=d.current)==null?void 0:y.innerHTML)||"",v=wS.sanitize(p,{ALLOWED_TAGS:["a","p","br","strong","b","em","i","u","ul","ol","li","img"],ALLOWED_ATTR:["href","target","rel","src","alt"]});i({id:a==null?void 0:a.id,title:c.trim(),trip:null,content:v})},m=`w-full p-4 text-gray-800 leading-relaxed 
        [&_p]:mb-4 [&_a]:text-blue-600 [&_a:hover]:underline
        [&_ul]:list-disc [&_ul]:pl-8 [&_ol]:list-decimal [&_ol]:pl-8`;return e?u.jsxs("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300 animate-fade-in",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale",children:[u.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:a?"Modifica Documento Privacy":"Crea Nuovo Documento Privacy"}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(yn,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto space-y-6",children:[u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titolo Documento"}),u.jsx("input",{type:"text",value:c,onChange:p=>f(p.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]})}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contenuto"}),u.jsx(SS,{editorRef:d}),u.jsx("div",{ref:d,contentEditable:!0,role:"textbox","aria-multiline":"true","aria-label":"Contenuto privacy",dangerouslySetInnerHTML:{__html:(a==null?void 0:a.content)||""},className:`${m} border border-gray-300 rounded-b-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition bg-white min-h-[250px]`})]})]}),u.jsxs("footer",{className:"flex justify-end items-center space-x-4 p-5 bg-gray-50 border-t border-gray-200 rounded-b-xl",children:[u.jsx("button",{onClick:t,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Annulla"}),u.jsx("button",{onClick:h,className:"bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Salva Documento"})]})]}),u.jsx("style",{children:`
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                @keyframes fadeInScale { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
                .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; }
                .animate-fade-in-scale { animation: fadeInScale 0.2s ease-out forwards; }
            `})]}):null},ES=({documents:e,setDocuments:a})=>{const[t,i]=ce.useState(!1),[s,c]=ce.useState(null),f=ce.useMemo(()=>e.some(L=>L.trip===null),[e]),d=()=>{c(null),i(!0)},h=L=>{c(L),i(!0)},m=async L=>{w(L)},[p,v]=ce.useState(!1),[y,_]=ce.useState(null),w=L=>{_(L),v(!0)},b=async()=>{if(y)try{if(!(await fetch(`/api/privacy-policies/${y}`,{method:"DELETE"})).ok)throw new Error("Delete failed");a(N=>N.filter(j=>j.id!==y))}catch(L){console.error(L),alert("Errore durante l'eliminazione del documento")}finally{v(!1),_(null)}},T=()=>{v(!1),_(null)},C=async L=>{try{if(L.id){const N=await fetch(`/api/privacy-policies/${L.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:L.title,content:L.content,trip:L.trip})});if(!N.ok)throw new Error("Failed to update policy");const j=await N.json();a(V=>V.map(M=>M.id===L.id?{...M,...j}:M))}else{const N=await fetch("/api/privacy-policies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:L.title,content:L.content,trip:null})});if(!N.ok)throw new Error("Failed to create policy");const j=await N.json(),V={...L,id:j.id};a(M=>[...M,V])}i(!1),c(null)}catch(N){console.error(N),alert("Errore durante il salvataggio del documento. Controlla la console.")}};return u.jsxs(u.Fragment,{children:[u.jsx(Xv,{isOpen:t,documentToEdit:s,onClose:()=>i(!1),onSave:C,globalDocExists:f}),u.jsx(_n,{open:p,title:"Conferma eliminazione",message:"Sei sicuro di voler eliminare questo documento? Questa azione non pu essere annullata.",confirmLabel:"Elimina",cancelLabel:"Annulla",variant:"danger",onConfirm:b,onCancel:T}),u.jsxs("div",{className:"p-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Privacy Policy"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Gestisci le privacy policy globali e specifiche per viaggio."})]}),u.jsxs("button",{onClick:d,className:"bg-blue-500 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center",children:[u.jsx(fs,{className:"w-5 h-5 mr-2"}),"Crea Nuovo Documento"]})]}),u.jsxs("div",{className:"space-y-4",children:[e.map((L,N)=>u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:L.title}),u.jsx("p",{className:`text-sm ${L.trip?"text-gray-500":"text-blue-600 font-medium"}`,children:L.trip?`Specifico per: ${L.trip}`:null})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("button",{onClick:()=>h(L),className:"p-2 text-gray-500 hover:text-gray-700 rounded-md transition-colors hover:bg-gray-100","aria-label":"Edit document",children:u.jsx(vn,{className:"w-5 h-5"})}),u.jsx("button",{onClick:()=>m(L.id),className:"p-2 text-red-500 hover:text-red-700 rounded-md transition-colors hover:bg-red-100","aria-label":"Elimina documento",title:"Elimina documento",children:u.jsx(cn,{className:"w-5 h-5"})})]})]},L.id||`privacy-${N}`)),e.length===0&&u.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl shadow-sm",children:[u.jsx("h3",{className:"text-xl font-medium text-gray-700",children:"Nessun documento trovato."}),u.jsx("p",{className:"text-gray-500 mt-2",children:"Inizia creando un nuovo documento."})]})]})]})]})},TS=["Trip to Ibiza","Sales Kick-off Dubai","Team Retreat Mykonos"],bc=({command:e,title:a,children:t,applyFormat:i})=>u.jsx("button",{type:"button",onMouseDown:s=>s.preventDefault(),onClick:()=>i(e),className:"p-2 rounded hover:bg-gray-200",title:a,children:t}),NS=({editorRef:e})=>{const a=(t,i=null)=>{e.current&&e.current.focus(),document.execCommand(t,!1,i)};return u.jsxs("div",{className:"flex items-center space-x-1 p-2 bg-gray-100 border border-b-0 border-gray-300 rounded-t-lg text-gray-700",children:[u.jsx(bc,{command:"bold",title:"Bold",applyFormat:a,children:u.jsx("strong",{className:"font-bold w-5 text-center",children:"B"})}),u.jsx(bc,{command:"italic",title:"Italic",applyFormat:a,children:u.jsx("em",{className:"italic w-5 text-center",children:"I"})}),u.jsx(bc,{command:"underline",title:"Underline",applyFormat:a,children:u.jsx("u",{className:"underline w-5 text-center",children:"U"})}),u.jsx("span",{className:"w-px h-5 bg-gray-300 mx-2"}),u.jsx(bc,{command:"insertUnorderedList",title:"Bulleted List",applyFormat:a,children:u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})}),u.jsx(bc,{command:"insertOrderedList",title:"Numbered List",applyFormat:a,children:u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{d:"M10 3a1 1 0 00-1 1v1.333H5.333a1 1 0 100 1.334h3.667v1.333H5.333a1 1 0 100 1.334h3.667v1.333H5.333a1 1 0 100 1.334H9V16a1 1 0 102 0v-1.333h3.667a1 1 0 100-1.334h-3.667v-1.333h3.667a1 1 0 100-1.334h-3.667V8.667h3.667a1 1 0 100-1.334H11V4a1 1 0 00-1-1z",clipRule:"evenodd",fillRule:"evenodd"})})})]})},AS=({documentToEdit:e,onClose:a,onSave:t,globalDocExists:i})=>{const[s,c]=ce.useState(""),[f,d]=ce.useState(null),h=ce.useRef(null);ce.useEffect(()=>{if(e)c(e.title),d(e.trip);else{const v=!i,y=v?null:TS[0];c("Termini e Condizioni"),d(y)}},[e,i]);const m=()=>{var y;const v=((y=h.current)==null?void 0:y.innerHTML)||"";t({id:e==null?void 0:e.id,title:s,trip:f,content:v})};return u.jsxs("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300 animate-fade-in",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale",children:[u.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:e?"Modifica Documento":"Crea Nuovo Documento"}),u.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(yn,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto space-y-6",children:[u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titolo Documento"}),u.jsx("input",{type:"text",value:s,onChange:v=>c(v.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]})}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contenuto"}),u.jsx(NS,{editorRef:h}),u.jsx("div",{ref:h,contentEditable:!0,dangerouslySetInnerHTML:{__html:(e==null?void 0:e.content)||""},className:`w-full p-4 text-gray-800 leading-relaxed 
        [&_p]:mb-4 [&_a]:text-blue-600 [&_a:hover]:underline
        [&_ul]:list-disc [&_ul]:pl-8 [&_ol]:list-decimal [&_ol]:pl-8 border border-gray-300 rounded-b-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition bg-white min-h-[250px]`})]})]}),u.jsxs("footer",{className:"flex justify-end items-center space-x-4 p-5 bg-gray-50 border-t border-gray-200 rounded-b-xl",children:[u.jsx("button",{onClick:a,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Annulla"}),u.jsx("button",{onClick:m,className:"bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Salva Documento"})]})]}),u.jsx("style",{children:`
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                @keyframes fadeInScale { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
                .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; }
                .animate-fade-in-scale { animation: fadeInScale 0.2s ease-out forwards; }
            `})]})},Ei=({label:e,children:a,className:t})=>u.jsxs("div",{className:t,children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),a]}),sg=e=>u.jsx("input",{...e,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}),il=e=>u.jsx("textarea",{...e,rows:3,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}),kd={destinationName:"",country:"",documents:"",timeZone:"",currency:"",language:"",climate:"",vaccinationsHealth:""},Yv=({isOpen:e,onClose:a,onSave:t,infoToEdit:i})=>{const[s,c]=ce.useState(kd);if(ce.useEffect(()=>{e&&c(i?{...kd,...i}:kd)},[i,e]),!e)return null;const f=m=>{const{name:p,value:v}=m.target;c(y=>({...y,[p]:v}))},d=()=>{t(s)},h=!s.destinationName||!String(s.destinationName).trim();return u.jsxs("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300 animate-fade-in",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale",children:[u.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:i?"Edit Useful Information":"Create New Useful Information"}),u.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(yn,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs(Ei,{label:"Destination Name",children:[u.jsx(sg,{name:"destinationName",value:s.destinationName,onChange:f}),h&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Please provide a destination name before saving."})]}),u.jsx(Ei,{label:"Country",children:u.jsx(sg,{name:"country",value:s.country,onChange:f})})]}),u.jsx(Ei,{label:"Documents",children:u.jsx(il,{name:"documents",value:s.documents,onChange:f})}),u.jsx(Ei,{label:"Time Zone",children:u.jsx(il,{name:"timeZone",value:s.timeZone,onChange:f})}),u.jsx(Ei,{label:"Currency",children:u.jsx(il,{name:"currency",value:s.currency,onChange:f})}),u.jsx(Ei,{label:"Language",children:u.jsx(il,{name:"language",value:s.language,onChange:f})}),u.jsx(Ei,{label:"Climate",children:u.jsx(il,{name:"climate",value:s.climate,onChange:f})}),u.jsx(Ei,{label:"Vaccinations & Health",children:u.jsx(il,{name:"vaccinationsHealth",value:s.vaccinationsHealth,onChange:f})})]}),u.jsxs("footer",{className:"flex justify-end items-center space-x-4 p-5 bg-gray-50 border-t border-gray-200 rounded-b-xl",children:[u.jsx("button",{onClick:a,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Cancel"}),u.jsx("button",{onClick:d,disabled:h,className:`bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg transition-colors ${h?"opacity-60 cursor-not-allowed hover:bg-blue-600":"hover:bg-blue-700"}`,children:"Save"})]})]}),u.jsx("style",{children:`
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                @keyframes fadeInScale { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
                .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; }
                .animate-fade-in-scale { animation: fadeInScale 0.2s ease-out forwards; }
            `})]})},kS=({id:e,label:a,value:t="",options:i,onChange:s,disabled:c=!1,testId:f})=>{const[d,h]=ce.useState(!1),[m,p]=ce.useState(!1);return ce.useEffect(()=>{},[f]),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("label",{htmlFor:e,className:"text-sm font-medium mb-1",children:a}),u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsxs("select",{id:e,"data-testid":f,value:t,onChange:v=>s(v.target.value),disabled:c,"aria-disabled":c,"aria-label":a,className:`mt-1 p-2 border rounded ${c?"bg-gray-100":"bg-white"}`,children:[u.jsx("option",{"data-testid":`${f}-option-empty`,value:"",children:"-- Seleziona --"}),i.map(v=>u.jsx("option",{"data-testid":`${f}-option-${v.value}`,value:v.value,children:v.label},v.value))]}),u.jsxs("div",{className:"flex flex-col ml-2",children:[u.jsx("button",{"data-testid":`${f}-create`,type:"button",onClick:()=>{e==="doc-privacyPolicy"?p(!0):h(!0)},disabled:c,className:"text-sm text-green-600 hover:underline",children:"Crea nuovo"}),u.jsx("button",{"data-testid":`${f}-remove`,type:"button",onClick:()=>s(""),disabled:c||!t,className:"text-sm text-red-600 hover:underline",children:"Rimuovi"})]})]}),e==="doc-privacyPolicy"?u.jsx(Xv,{isOpen:m,documentToEdit:null,onClose:()=>p(!1),onSave:async v=>{try{const y=await Zw({title:v.title,content:v.content,trip:null});if(y){try{window.__E2E_lastCreatePrivacyResult=y}catch{}try{window.dispatchEvent(new CustomEvent("documents:changed",{detail:{created:y}}))}catch{}p(!1),s(String(y.value))}else console.error("createPrivacyPolicy returned null"),alert("Errore durante la creazione della privacy policy. Controlla la console per dettagli.")}catch(y){console.error("Error creating privacy policy",y),alert("Errore durante la creazione della privacy policy. Controlla la console per dettagli.")}},globalDocExists:!1}):e==="doc-terms"?d?u.jsx(AS,{documentToEdit:null,onClose:()=>h(!1),onSave:async v=>{try{const y=await Uv({title:v.title,content:v.content,trip:v.trip});if(y){try{window.dispatchEvent(new CustomEvent("documents:changed",{detail:{created:y}}))}catch{}h(!1),s(String(y.value??y.id??y._id??""))}else console.error("createTermsDocument returned null"),alert("Errore durante la creazione del documento Terms. Controlla la console.")}catch(y){console.error("Error creating terms document",y),alert("Errore durante la creazione del documento Terms. Controlla la console.")}},globalDocExists:!1}):null:e==="doc-usefulInformations"?d?u.jsx(Yv,{isOpen:d,infoToEdit:null,onClose:()=>h(!1),onSave:async v=>{try{const _={title:v.destinationName&&String(v.destinationName).trim()||v.country&&String(v.country).trim()||v.documents&&String(v.documents).split(`
`)[0].slice(0,60)||"Untitled Useful Information",usefulInfo:v,content:""},w=await Wd(_);if(w){try{window.dispatchEvent(new CustomEvent("documents:changed",{detail:{created:w}}))}catch{}h(!1),s(String(w.value??w.id??w._id??""))}else console.error("createUsefulInfo returned null"),alert("Errore durante la creazione della Useful Information. Controlla la console.")}catch(y){console.error("Error creating useful information",y),alert("Errore durante la creazione della Useful Information. Controlla la console.")}}}):null:u.jsx(zv,{open:d,onCreated:v=>{h(!1);try{window.dispatchEvent(new CustomEvent("documents:changed"))}catch{}s(v.value)},onClose:()=>h(!1)})]})};async function Cd(e=""){const a=e?`${e.replace(/\/$/,"")}/api/forms`:"/api/forms";try{const t=await fetch(a);if(!t.ok)return[];const i=await t.json();return(Array.isArray(i)?i:i&&Array.isArray(i.items)?i.items:[]).map(c=>({value:c._id??c.id??"",label:c.title??c.name??""}))}catch{return[]}}async function lg(e,a=""){const t=a?`${a.replace(/\/$/,"")}/api/forms`:"/api/forms";try{const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return i.ok?await i.json():null}catch(i){return console.error("createForm error",i),null}}async function cg(e,a,t=""){try{const i=t?`${t.replace(/\/$/,"")}/api/forms/${e}`:`/api/forms/${e}`,s=await fetch(i,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return s.ok?await s.json():null}catch{return null}}const CS=({values:e={},onChange:a,disabled:t=!0})=>{const i=[{key:"usefulInformations",label:"Useful Informations"},{key:"privacyPolicy",label:"Privacy Policy"},{key:"terms",label:"Terms & Conditions"},{key:"registrationForm",label:"Form di Registrazione"}],s=[{value:"doc-1",label:"Documento 1"},{value:"doc-2",label:"Documento 2"}],[c,f]=ce.useState(s),[d,h]=ce.useState([]),[m,p]=ce.useState([]),[v,y]=ce.useState([]),[_,w]=ce.useState([]),[b,T]=ce.useState(!1);return ce.useEffect(()=>{let C=!0;T(!0),Cd().then(j=>{C&&j&&j.length&&w(j.map(V=>({value:V.value,label:V.label})))}).catch(j=>{console.debug("[E2E] initial fetchFormOptions error",j)}),Yd().then(j=>{console.debug("[E2E] initial fetchDocumentOptions",j),C&&j&&j.length&&(f(j),h(j))}).catch(j=>{console.debug("[E2E] initial fetchDocumentOptions error",j)}).finally(()=>{C&&T(!1)}),Zp().then(j=>{C&&j&&j.length&&p(j)}).catch(j=>{console.debug("[E2E] initial fetchPrivacyPolicyOptions error",j)}),Lo().then(j=>{C&&j&&Array.isArray(j)&&j.length&&y(j.map(V=>({value:V._id??V.id??V.value??"",label:V.title??V.label??V.name??V.filename??""})))}).catch(j=>{console.debug("[E2E] initial fetchTermsDocuments error",j)});const L=async j=>{try{console.debug("[E2E] documents:changed handler triggered - event detail",j==null?void 0:j.detail)}catch{}console.debug("[E2E] documents:changed handler triggered - refreshing options"),T(!0);try{const[V,M,k]=await Promise.all([Yd(),Zp(),Lo()]);console.debug("[E2E] documents:changed fetch results",{dRes:V,pRes:M,tRes:k}),C&&V&&V.length&&(f(V),h(V)),C&&M&&M.length&&p(M),C&&k&&Array.isArray(k)&&k.length&&y(k.map(W=>({value:W._id??W.id??W.value??"",label:W.title??W.label??W.name??W.filename??""})));try{const W=await Cd();C&&W&&W.length&&w(W.map(K=>({value:K.value,label:K.label})))}catch(W){console.debug("[E2E] documents:changed fetchFormOptions error",W)}}catch(V){console.debug("[E2E] documents:changed fetch error",V)}T(!1)};window.addEventListener("documents:changed",L);const N=async j=>{try{const V=await Cd();C&&V&&V.length&&w(V.map(M=>({value:M.value,label:M.label})))}catch(V){console.debug("[E2E] forms:changed handler error",V)}};return window.addEventListener("forms:changed",N),()=>{C=!1,window.removeEventListener("documents:changed",L),window.removeEventListener("forms:changed",N)}},[]),u.jsxs("div",{className:"p-6 bg-white rounded-lg border","aria-labelledby":"section-documents-title",children:[u.jsx("h3",{id:"section-documents-title",className:"font-bold",children:"Sezione 3  Documenti"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:i.map(C=>u.jsx(kS,{id:`doc-${C.key}`,label:C.label,value:e[C.key]||"",options:C.key==="privacyPolicy"?m:C.key==="terms"?v:C.key==="registrationForm"?_:C.key==="usefulInformations"?d:c,onChange:L=>a(C.key,L),disabled:t,testId:`doc-selector-${C.key}`},C.key))})]})},og=e=>e.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-_]/g,"").toLowerCase(),DS=({value:e=[],onChange:a,placeholder:t="Aggiungi gruppo",testid:i})=>{const[s,c]=ce.useState(""),f=ce.useRef(null);ce.useEffect(()=>{c("")},[e.length]);const d=m=>{const p=s.trim();if(!p)return;if(e.some(y=>(y||"").toString().trim().toLowerCase()===p.toLowerCase())){c("");return}a([...e,p]),c("")},h=m=>a(e.filter(p=>p!==m));return u.jsxs("div",{className:"flex flex-col","data-testid":i,children:[u.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:e.map(m=>u.jsxs("span",{"data-testid":`trip-group-${og(m)}`,className:"inline-flex items-center bg-gray-100 px-3 py-1 rounded-full text-sm",children:[u.jsx("span",{className:"mr-2",children:m}),u.jsx("button",{"data-testid":`trip-group-remove-${og(m)}`,onClick:()=>h(m),className:"text-xs text-gray-500 hover:text-gray-700",children:""})]},m))}),u.jsxs("div",{className:"mt-2 flex gap-2",children:[u.jsx("input",{"data-testid":i?`${i}-input`:"trip-groups-input-input",ref:f,value:s,onChange:m=>c(m.target.value),onKeyDown:m=>{m.key==="Enter"&&(m.preventDefault(),d())},placeholder:t,className:"p-2 border rounded flex-1"}),u.jsx("button",{"data-testid":i?`${i}-add`:"trip-groups-add",onClick:()=>d(),className:"px-3 py-2 bg-blue-600 text-white rounded",children:"Aggiungi"})]})]})},fg=({checked:e,onChange:a,label:t,testid:i})=>u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{role:"switch","aria-checked":e,"data-testid":i,onClick:()=>a(!e),className:`w-11 h-6 flex items-center bg-${e?"green-600":"gray-300"} rounded-full p-1 cursor-pointer transition-colors`,children:u.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow transform ${e?"translate-x-5":""}`})}),t&&u.jsx("div",{className:"text-sm",children:t})]}),jS=({values:e={},onChange:a,onSave:t,disabled:i=!0})=>{const[s,c]=ce.useState(e.imageUrl||""),[f,d]=ce.useState(e.logoUrl||""),h=p=>{a("imageUrl",p),c(p)},m=p=>{a("logoUrl",p),d(p)};return u.jsxs("div",{"data-disabled":i?"true":"false",className:`p-6 bg-white rounded-lg border ${i?"opacity-60 pointer-events-none":""}`,"aria-labelledby":"section-settings-title",children:[u.jsx("h3",{id:"section-settings-title",className:"font-bold",children:"Sezione 2  Impostazioni"}),u.jsxs("div",{className:"mt-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium",children:"Gruppi"}),u.jsx("div",{className:"mt-2",children:u.jsx(DS,{testid:"trip-groups-input",value:e.groups||[],onChange:p=>a("groups",p),placeholder:"Aggiungi gruppo"})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium",children:"Aggiungi accompagnatore"}),u.jsx("div",{className:"mt-2",children:u.jsx(fg,{testid:"trip-add-accompany-toggle",checked:!!e.addAccompany,onChange:p=>a("addAccompany",p),label:e.addAccompany?"S":"No"})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium",children:"Voli Business"}),u.jsx("div",{className:"mt-2",children:u.jsx(fg,{testid:"trip-business-flights-toggle",checked:!!e.businessFlights,onChange:p=>a("businessFlights",p),label:e.businessFlights?"S":"No"})})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("label",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium",children:"Immagine del Viaggio"}),u.jsx("input",{"data-testid":"trip-image-url",value:e.imageUrl||"",onChange:p=>h(p.target.value),placeholder:"Incolla l'URL dell'immagine",className:"mt-1 p-2 border rounded"}),s?u.jsx("img",{"data-testid":"trip-image-preview",src:s,alt:"preview",className:"mt-2 w-40 h-24 object-cover rounded"}):null]}),u.jsxs("label",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium",children:"Logo del Viaggio"}),u.jsx("input",{"data-testid":"trip-logo-url",value:e.logoUrl||"",onChange:p=>m(p.target.value),placeholder:"Incolla l'URL dell'immagine",className:"mt-1 p-2 border rounded"}),f?u.jsx("img",{"data-testid":"trip-logo-preview",src:f,alt:"preview",className:"mt-2 w-24 h-24 object-contain rounded"}):null]})]}),u.jsx("div",{className:"mt-4 flex items-center gap-3",children:t?u.jsx("button",{"data-testid":"save-section-2",onClick:t,disabled:i,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Salva bozza"}):null})]})]})},FS=({groups:e=[],disabled:a=!1,initial:t=[],onChange:i})=>{const[s,c]=ce.useState(t),[f,d]=ce.useState([]);ce.useEffect(()=>{let v=!0;return(async()=>{try{const y=await fetch("/api/contacts");if(!y.ok)throw new Error("no-contacts");const _=await y.json();if(!v)return;d((_||[]).map(w=>({id:w.id||w._id||w.contactId||String(w.id),name:w.name||w.fullName||w.displayName||w.firstName,category:w.category||w.role||w.type})).sort((w,b)=>(w.name||"").toLowerCase()>(b.name||"").toLowerCase()?1:-1))}catch{d([])}})(),()=>{v=!1}},[]),ce.useEffect(()=>{i&&i(s)},[s]);const h=()=>c(v=>[...v,{group:"",contactId:""}]),m=v=>c(y=>y.filter((_,w)=>w!==v)),p=(v,y)=>c(_=>_.map((w,b)=>b===v?{...w,...y}:w));return u.jsxs("div",{className:`p-6 bg-white rounded-lg border ${a?"opacity-60 pointer-events-none":""}`,children:[u.jsx("h3",{className:"font-bold",children:"Sezione 5: Contatti di Emergenza e Sicurezza"}),u.jsxs("div",{className:"mt-4 space-y-3",children:[s.map((v,y)=>u.jsxs("div",{className:"flex items-center gap-4 p-3 border rounded",children:[e&&e.length?u.jsxs("label",{className:"flex-1",children:[u.jsx("div",{className:"text-sm font-medium",children:"Gruppo Partenza"}),u.jsxs("select",{value:v.group||"",onChange:_=>p(y,{group:_.target.value||void 0}),className:"mt-1 w-full p-2 border rounded",children:[u.jsx("option",{value:"",children:"-- Seleziona Gruppo --"}),e.map(_=>u.jsx("option",{value:_,children:_},_))]})]}):null,u.jsxs("label",{className:"flex-1",children:[u.jsx("div",{className:"text-sm font-medium",children:"Seleziona Contatto"}),u.jsxs("select",{value:v.contactId||"",onChange:_=>p(y,{contactId:_.target.value||void 0}),className:"mt-1 w-full p-2 border rounded",children:[u.jsx("option",{value:"",children:"-- Seleziona Contatto --"}),f.map(_=>u.jsx("option",{value:_.id,children:`${_.name}${_.category?` (${_.category})`:""}`},_.id))]})]}),u.jsx("button",{type:"button",onClick:()=>m(y),"aria-label":"Rimuovi contatto",className:"text-red-600 px-2 py-1",children:""})]},y)),u.jsx("div",{children:u.jsx("button",{type:"button",onClick:h,className:"text-blue-600 bg-blue-50 px-3 py-2 rounded",children:"+ Aggiungi Contatto"})})]})]})},Wv=ce.createContext(void 0),OS=({children:e})=>{const[a,t]=ce.useState([]),i=ce.useCallback((c,f="info",d=4e3)=>{const h=String(Date.now())+Math.random().toString(36).slice(2,8),m={id:h,type:f,message:c};console.log("[Toast] showToast",{message:c,type:f,id:h}),t(p=>[m,...p]);try{typeof window<"u"}catch{}setTimeout(()=>{t(p=>p.filter(v=>v.id!==h))},d)},[]),s=ce.useMemo(()=>({showToast:i}),[i]);return u.jsxs(Wv.Provider,{value:s,children:[e,u.jsx("div",{"aria-live":"polite",className:"fixed bottom-6 right-6 z-50 flex flex-col gap-3",style:{position:"fixed",bottom:24,right:24,zIndex:9999,display:"flex",flexDirection:"column",gap:"12px"},children:a.map(c=>{const h={backgroundColor:c.type==="success"?"#16a34a":c.type==="error"?"#dc2626":"#1f2937",color:"#ffffff",padding:"12px 16px",borderRadius:8,boxShadow:"0 6px 18px rgba(0,0,0,0.08)",maxWidth:320,fontSize:14};return u.jsx("div",{style:h,className:"max-w-xs w-full px-4 py-3 rounded shadow-lg text-sm",children:c.message},c.id)})})]})},Oi=()=>{const e=ce.useContext(Wv);if(!e)throw new Error("useToast must be used within ToastProvider");return e},Io={"dati-partecipante":[{id:"ragione-sociale",name:"Ragione Sociale",enabled:!0,required:!0},{id:"nome",name:"Nome",enabled:!0,required:!0},{id:"cognome",name:"Cognome",enabled:!0,required:!0},{id:"data-di-nascita",name:"Data di Nascita",enabled:!0,required:!0},{id:"nazionalita",name:"Nazionalit",enabled:!0,required:!0},{id:"n-tel-cellulare",name:"N. Tel. Cellulare",enabled:!0,required:!0},{id:"email",name:"E-mail",enabled:!0,required:!0},{id:"passaporto",name:"Passaporto",enabled:!0,required:!0},{id:"esigenze-alimentari",name:"Esigenze Alimentari",enabled:!0,required:!1}],logistica:[{id:"tipologia-camera",name:"Tipologia Camera",enabled:!0,required:!0},{id:"aeroporto-di-partenza",name:"Aeroporto di Partenza",enabled:!0,required:!0},{id:"viaggio-in-business",name:"Viaggio in Business",enabled:!0,required:!0}],consensi:[{id:"informativa-sulla-privacy",name:"Informativa sulla Privacy",enabled:!0,required:!0},{id:"termini-e-condizioni",name:"Termini e Condizioni",enabled:!0,required:!0}],accompagnatore:[{id:"nome-accompagnatore",name:"Nome",enabled:!0,required:!0},{id:"cognome-accompagnatore",name:"Cognome",enabled:!0,required:!0},{id:"data-di-nascita-accompagnatore",name:"Data di Nascita",enabled:!0,required:!0},{id:"nazionalita-accompagnatore",name:"Nazionalit",enabled:!0,required:!0},{id:"passaporto-accompagnatore",name:"Passaporto",enabled:!0,required:!0},{id:"esigenze-alimentari-accompagnatore",name:"Esigenze Alimentari",enabled:!0,required:!1},{id:"partecipazione-meeting",name:"Partecipazione Meeting",enabled:!0,required:!1}],fatturazione:[{id:"intestatario-fattura",name:"Intestatario Fattura",enabled:!0,required:!0},{id:"indirizzo-di-fatturazione",name:"Indirizzo di Fatturazione",enabled:!0,required:!0},{id:"partita-iva",name:"Partita IVA",enabled:!0,required:!0},{id:"codice-sdi",name:"Codice SDI",enabled:!0,required:!0}]},RS=({section:e,onClose:a,onSave:t,initialFields:i})=>{const s=e&&Io[e.id]?Io[e.id]:[],[c,f]=ce.useState(()=>i&&i.length?i:s);Ia.useEffect(()=>{i&&i.length?f(i):f(s)},[i,e==null?void 0:e.id]);const[d,h]=ce.useState(""),m=(()=>{try{return Oi()}catch{return null}})(),p=ce.useRef(null),v=ce.useRef(null),y=(N,j)=>{f(V=>V.map(M=>{if(M.id===N){const k={...M,[j]:!M[j]};return j==="enabled"&&!k.enabled&&(k.required=!1),k}return M}))},_=()=>{if(d.trim()==="")return;const N={id:`${d.trim().toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`,name:d.trim(),enabled:!0,required:!1};f([...c,N]),h("");try{m&&m.showToast("Campo aggiunto","success")}catch{}},w=()=>{try{t(e.id,c);try{m&&m.showToast("Campi salvati","success")}catch{}}catch{try{m&&m.showToast("Errore salvataggio campi","error")}catch{}}},b=(N,j)=>{p.current=j},T=(N,j)=>{v.current=j},C=()=>{p.current=null,v.current=null},L=()=>{if(p.current===null||v.current===null)return;const N=p.current,j=v.current;if(N===j){C();return}const V=[...c],[M]=V.splice(N,1);V.splice(j,0,M),f(V),C()};return u.jsxs("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale",children:[u.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["Personalizza Campi: ",e.title]}),u.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(yn,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4 px-4 pb-2",children:[u.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"CAMPO"}),u.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider justify-self-end",children:"OBBLIGATORIO"})]}),u.jsx("div",{className:"space-y-1 max-h-[40vh] overflow-y-auto pr-2",onDrop:L,onDragOver:N=>N.preventDefault(),children:c.map((N,j)=>u.jsxs("div",{draggable:!0,onDragStart:V=>b(V,j),onDragEnter:V=>T(V,j),onDragEnd:C,onDragOver:V=>V.preventDefault(),className:"flex items-center justify-between p-4 rounded-lg hover:bg-gray-100 transition-colors group",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"cursor-grab active:cursor-grabbing text-gray-400 group-hover:text-gray-600",children:u.jsx(Xd,{className:"w-5 h-5 mr-3"})}),u.jsxs("label",{className:"flex items-center cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:N.enabled,onChange:()=>y(N.id,"enabled"),className:"h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),u.jsx("span",{className:`ml-3 text-sm font-medium ${N.enabled?"text-gray-800":"text-gray-400"}`,children:N.name})]})]}),u.jsx("label",{className:"flex items-center cursor-pointer",children:u.jsx("input",{type:"checkbox",checked:N.required,disabled:!N.enabled,onChange:()=>y(N.id,"required"),className:"h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 disabled:bg-gray-200 disabled:cursor-not-allowed"})})]},N.id))}),u.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("input",{type:"text",value:d,onChange:N=>h(N.target.value),placeholder:"Aggiungi nuovo campo",className:"flex-grow w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",onKeyPress:N=>N.key==="Enter"&&_()}),u.jsxs("button",{onClick:_,className:"bg-gray-100 text-gray-700 font-semibold px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center",children:[u.jsx(fs,{className:"w-5 h-5 mr-1.5"})," Aggiungi"]})]})})]}),u.jsxs("footer",{className:"flex justify-end items-center space-x-4 p-5 bg-gray-50 border-t border-gray-200 rounded-b-xl",children:[u.jsx("button",{onClick:a,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Annulla"}),u.jsx("button",{onClick:w,className:"bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Salva Campi"})]})]}),u.jsx("style",{children:`
                @keyframes fadeInScale {
                    from { transform: scale(0.95); opacity: 0; }
                    to { transform: scale(1); opacity: 1; }
                }
                .animate-fade-in-scale {
                    animation: fadeInScale 0.2s ease-out forwards;
                }
            `})]})},wc=[{id:"dati-partecipante",title:"Dati Partecipante"},{id:"logistica",title:"Logistica"},{id:"accompagnatore",title:"Accompagnatore"},{id:"consensi",title:"Consensi"},{id:"fatturazione",title:"Fatturazione"}],la=({label:e,required:a,children:t,className:i})=>u.jsxs("div",{className:i,children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e," ",a&&u.jsx("span",{className:"text-red-500",children:"*"})]}),t]}),Na=Ia.forwardRef((e,a)=>u.jsx("input",{ref:a,...e,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}));Na.displayName="Input";const Bo=Ia.forwardRef((e,a)=>u.jsx("textarea",{ref:a,...e,rows:2,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}));Bo.displayName="Textarea";const MS=({onCancel:e,onSave:a,isEditing:t=!1,initialData:i})=>{const s=[],[c,f]=ce.useState(()=>s),[d,h]=ce.useState(()=>wc.filter(R=>!s.some(se=>se.id===R.id))),[m,p]=ce.useState(""),[v,y]=ce.useState(""),[_,w]=ce.useState(!1),[b,T]=ce.useState(!1),[C,L]=ce.useState({}),N=Oi(),[j,V]=ce.useState(null),[M,k]=ce.useState(()=>Object.keys(Io).reduce((R,se)=>(R[se]=Io[se].map((A,E)=>({...A,order:E})),R),{}));Ia.useEffect(()=>{if(i){const R=i;if(p(R.title||R.name||""),y(R.description||R.desc||""),Array.isArray(R.sections)){f(R.sections.map(E=>({id:E.id,title:E.title})));const se={};R.sections.forEach(E=>{se[E.id]=Array.isArray(E.fields)?E.fields.map((O,B)=>({...O,order:B})):M[E.id]||[]}),k(E=>({...E,...se}));const A=new Set(R.sections.map(E=>E.id));h(wc.filter(E=>!A.has(E.id)))}}},[i]);const W=Ia.useRef(null),K=Ia.useRef(null),J=R=>{V(R),w(!0)},Z=()=>{w(!1),V(null)},Q=(R,se)=>{console.log("Saving fields for",R,se),k(A=>({...A,[R]:se.map((E,O)=>({...E,order:O}))})),Z()},re=Ia.useRef(null),ue=()=>{const R={};return!m||m.trim()===""?R.title="Il titolo del form  obbligatorio.":m.length>200&&(R.title="Il titolo non pu superare 200 caratteri."),L(R),R.title&&setTimeout(()=>re.current&&re.current.focus(),0),Object.keys(R).length===0},ve=(R,se,A,E)=>{W.current={item:se,source:A,index:E},R.dataTransfer.effectAllowed="move"},ee=(R,se)=>{K.current=se},G=R=>{R.preventDefault();const se=W.current,A=K.current;if(!se)return;const{item:E,source:O,index:B}=se;if(O==="available"){if(c.some(le=>le.id===E.id))return;const z=[...c];A!=null?z.splice(A,0,E):z.push(E),f(z),h(le=>le.filter(ye=>ye.id!==E.id))}else if(O==="active"){if(B===null||A===null||B===A){W.current=null,K.current=null;return}const z=[...c],[le]=z.splice(B,1);z.splice(A,0,le),f(z)}W.current=null,K.current=null},ae=R=>{const se=c.find(A=>A.id===R);if(se){f(E=>E.filter(O=>O.id!==R));const A=[...d,{id:se.id,title:se.title}];A.sort((E,O)=>wc.findIndex(B=>B.id===E.id)-wc.findIndex(B=>B.id===O.id)),h(A)}};return u.jsxs(u.Fragment,{children:[_&&j&&u.jsx(RS,{section:j,onClose:Z,onSave:Q,initialFields:M[j.id]}),u.jsxs("div",{className:"p-8",children:[u.jsxs("header",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Create New Form"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Design a form to collect information from participants."})]}),u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm space-y-6",children:[u.jsxs(la,{label:"Form Title",required:!0,children:[u.jsx(Na,{ref:re,placeholder:"e.g., Dietary Restrictions & Allergies",value:m,onChange:R=>p(R.target.value)}),C.title&&u.jsx("p",{className:"text-red-600 text-sm mt-1",children:C.title})]}),u.jsx(la,{label:"Form Description",children:u.jsx(Bo,{placeholder:"Provide a brief description or instructions for this form.",value:v,onChange:R=>y(R.target.value)})})]}),u.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-8",children:[u.jsxs("div",{className:"md:col-span-1",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Sezioni Disponibili"}),u.jsx("div",{className:"space-y-3",children:d.map(R=>u.jsxs("div",{draggable:!0,onDragStart:se=>ve(se,R,"available",null),className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 flex items-center cursor-grab active:cursor-grabbing",children:[u.jsx(Xd,{className:"w-5 h-5 text-gray-400 mr-3"}),u.jsx("span",{className:"font-medium text-gray-700",children:R.title})]},R.id))})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Anteprima Form del Viaggio"}),u.jsx("button",{type:"button",onClick:()=>{f(wc.map(R=>({id:R.id,title:R.title}))),h([])},className:"text-sm bg-blue-50 text-blue-700 hover:bg-blue-100 px-3 py-1.5 rounded-md font-semibold",children:"Aggiungi tutte le sezioni"})]}),u.jsxs("div",{onDrop:G,onDragOver:R=>R.preventDefault(),className:"p-6 border-2 border-dashed border-gray-300 rounded-lg min-h-[300px] space-y-4 bg-gray-50/50",children:[c.map((R,se)=>u.jsxs("div",{draggable:!0,onDragStart:A=>ve(A,R,"active",se),onDragEnter:A=>ee(A,se),onDragOver:A=>A.preventDefault(),className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Xd,{className:"w-5 h-5 text-gray-400 mr-3 cursor-grab active:cursor-grabbing"}),u.jsx("span",{className:"font-bold text-gray-800",children:R.title})]}),u.jsx("div",{className:"flex items-center space-x-4",children:u.jsx("button",{type:"button",onClick:()=>ae(R.id),className:"text-gray-500 hover:text-red-600",children:u.jsx(cn,{className:"w-5 h-5"})})})]}),u.jsx("div",{className:"mt-4 pl-8",children:u.jsxs("button",{onClick:()=>J(R),className:"flex items-center text-sm font-semibold bg-blue-50 text-blue-700 hover:bg-blue-100 px-3 py-1.5 rounded-md transition-colors",children:[u.jsx(vn,{className:"w-4 h-4 mr-2"}),"Modifica Campi"]})})]},R.id)),c.length===0&&u.jsx("div",{className:"flex items-center justify-center h-full pointer-events-none",children:u.jsx("p",{className:"text-gray-500",children:"Trascina le sezioni qui"})})]})]})]})]}),u.jsxs("footer",{className:"mt-8 pt-6 border-t border-gray-200 flex justify-end items-center space-x-4",children:[t&&u.jsx("button",{onClick:()=>e(),className:"bg-gray-200 text-gray-800 font-semibold px-6 py-2.5 rounded-lg hover:bg-gray-300 transition-colors",children:"Annulla"}),u.jsx("button",{onClick:async()=>{if(!ue())return;T(!0);const R={title:m,description:v,sections:c.map((se,A)=>({id:se.id,title:se.title,order:A,fields:M[se.id]||[]})),status:"draft"};try{if(t&&i&&(i._id||i.id)){const se=String(i._id??i.id),A=await cg(se,R);if(A){try{window.dispatchEvent(new CustomEvent("forms:changed",{detail:{updated:A}}))}catch{}try{N.showToast("Bozza aggiornata.","success")}catch{}a&&a(A)}}else{const se=await lg(R);if(se){try{window.dispatchEvent(new CustomEvent("forms:changed",{detail:{created:se}}))}catch{}try{N.showToast("Bozza salvata.","success")}catch{}a&&a(se)}}}catch(se){console.error("Failed saving draft",se);try{N.showToast("Salvataggio bozza fallito.","error")}catch{}}T(!1)},disabled:b,className:`bg-gray-200 text-gray-800 font-semibold px-6 py-2.5 rounded-lg hover:bg-gray-300 transition-colors ${b?"opacity-60 cursor-not-allowed":""}`,children:b?"Saving":"Save Draft"}),u.jsx("button",{onClick:async()=>{if(!ue())return;T(!0);const R={title:m,description:v,sections:c.map((se,A)=>({id:se.id,title:se.title,order:A,fields:M[se.id]||[]})),status:"published"};try{if(t&&i&&(i._id||i.id)){const se=String(i._id??i.id),A=await cg(se,R);if(A){try{window.dispatchEvent(new CustomEvent("forms:changed",{detail:{updated:A}}))}catch{}try{N.showToast("Form aggiornato.","success")}catch{}a&&a(A)}}else{const se=await lg(R);if(se){try{window.dispatchEvent(new CustomEvent("forms:changed",{detail:{created:se}}))}catch{}try{N.showToast("Form pubblicato.","success")}catch{}a&&a(se)}}}catch(se){console.error("Failed publishing form",se);try{N.showToast("Publish fallito.","error")}catch{}}T(!1)},disabled:b,className:`bg-blue-600 text-white font-semibold px-6 py-2.5 rounded-lg hover:bg-blue-700 transition-colors ${b?"opacity-60 cursor-not-allowed":""}`,children:b?"Publishing":"Publish Form"})]})]})]})},rs=({title:e,children:a,actions:t,isOpen:i,onClick:s,disabled:c,disabledMessage:f})=>u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:[u.jsxs("div",{role:"button",tabIndex:0,onClick:s,onKeyDown:d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),s())},className:"w-full flex justify-between items-start p-6 text-left hover:bg-gray-50 transition-colors cursor-pointer","aria-expanded":i,children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:e}),c&&f?u.jsx("div",{className:"mt-1 text-sm text-red-600","aria-hidden":!0,children:f}):null]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[t&&u.jsx("div",{onClick:d=>d.stopPropagation(),children:t}),u.jsx(us,{className:`w-6 h-6 text-gray-400 transition-transform duration-300 ${i?"rotate-180":""}`})]})]}),u.jsx("div",{className:`transition-[max-height,opacity] duration-500 ease-in-out overflow-hidden ${i?"max-h-[9999px] opacity-100":"max-h-0 opacity-0"}`,children:u.jsx("div",{className:"p-6 pt-0",children:a})})]}),ea={INFO:1,SETTINGS:2,DOCUMENTS:3,FLIGHTS:4,EMERGENCY_CONTACTS:5,AGENDA:6,PARTICIPANTS:7},LS=({onCancel:e,onSave:a,isEditing:t=!1})=>{const[i,s]=ce.useState([ea.INFO]),[c,f]=ce.useState("andata"),[d,h]=ce.useState([]),[m,p]=ce.useState({}),[v,y]=ce.useState({}),[_,w]=ce.useState({}),[b,T]=ce.useState({}),[C,L]=ce.useState([]),[N,j]=ce.useState(!1),[V,M]=ce.useState(!1),[k,W]=ce.useState(!1),[K,J]=ce.useState(void 0),Z=Oi();ce.useEffect(()=>{try{const G=v||{};Array.isArray(G.flights)&&h(G.flights.map(ae=>({...ae||{},id:ae._id||ae.id}))),G.flightsMeta&&p(G.flightsMeta||{})}catch{}},[v]);const Q=G=>{const ae=`temp-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,R={id:ae,direction:G,title:"",notes:""};h(se=>[...se,R]),(async()=>{if(!(!v||!v.tripId))try{const se=await fetch(`/api/trips/${v.tripId}/flights`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({direction:G})});if(!se.ok){const E=await se.text();throw new Error(E||`HTTP ${se.status}`)}const A=await se.json();h(E=>E.map(O=>O.id===ae?{...A||{},id:A._id||A.id}:O))}catch(se){console.error("Failed creating flight",se),h(A=>A.filter(E=>E.id!==ae));try{Z.showToast("Errore creando volo","error")}catch{}}})()},re=(G,ae)=>{h(R=>R.map((se,A)=>A===G?{...se,...ae}:se)),(async()=>{const R=d[G],se=R&&(R.id||R._id);if(!(!se||!v||!v.tripId))try{const A={},E=["direction","title","notes","group","airline","flightNumber","from","to","date","timeDeparture","timeArrival"];for(const z of E)ae[z]!==void 0&&(A[z]=ae[z]);const O=await fetch(`/api/trips/${v.tripId}/flights/${se}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)});if(!O.ok){const z=await O.text();throw new Error(z||`HTTP ${O.status}`)}const B=await O.json();h(z=>z.map((le,ye)=>ye===G?{...B||{},id:B._id||B.id}:le))}catch(A){console.error("Failed updating flight",A);try{Z.showToast("Errore aggiornando volo","error")}catch{}}})()},ue=G=>{const ae=d[G],R=ae&&(ae.id||ae._id);h(se=>se.filter((A,E)=>E!==G)),!(!R||!v||!v.tripId)&&(async()=>{try{const se=await fetch(`/api/trips/${v.tripId}/flights/${R}`,{method:"DELETE"});if(!se.ok){const E=await se.text();throw new Error(E||`HTTP ${se.status}`)}const A=await se.json().catch(()=>null);A&&Array.isArray(A.flights)&&h(A.flights.map(E=>({...E||{},id:E._id})))}catch(se){console.error("Failed deleting flight",se);try{Z.showToast("Errore eliminando volo","error")}catch{}try{const A=await fetch(`/api/trips/${v.tripId}`);if(A.ok){const E=await A.json();Array.isArray(E.flights)&&h(E.flights.map(O=>({...O||{},id:O._id})))}}catch{}}})()},ve=async()=>{if(!(!v||!v.tripId))try{const G={flights:d,flightsMeta:m},ae=await fetch(`/api/trips/${v.tripId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)});if(!ae.ok){const A=await ae.text();throw new Error(A||`HTTP ${ae.status}`)}const R=await ae.json(),se={...R||{},tripId:R&&(R.tripId||R._id||v.tripId)};y(A=>({...A||{},...se})),Array.isArray(R.flights)&&h(R.flights);try{Z.showToast("Voli salvati","success")}catch{}}catch(G){console.error(G);try{Z.showToast("Errore durante il salvataggio dei voli","error")}catch{}}};ce.useEffect(()=>{},[]),ce.useEffect(()=>{},[v,b]),ce.useEffect(()=>{},[v,b]),ce.useEffect(()=>{},[v,_,b]),ce.useEffect(()=>{},[]);const ee=G=>{G!==ea.INFO&&!(v&&v.tripId)&&s(ae=>ae.includes(ea.INFO)?ae:[...ae,ea.INFO]),s(ae=>ae.includes(G)?ae.filter(R=>R!==G):[...ae,G])};return u.jsxs("div",{className:"p-8",children:[u.jsxs("header",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:t?"Modifica Viaggio":"Crea Nuovo Viaggio"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Compila le sezioni per creare o modificare il viaggio."})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx(rs,{title:"Sezione 1: Informazioni Base del Viaggio",isOpen:i.includes(ea.INFO),onClick:()=>ee(ea.INFO),children:u.jsx(Kw,{initial:{clientName:v.clientName,name:v.name,subtitle:v.subtitle,description:v.description,startDate:v.startDate,endDate:v.endDate},settings:b,onSaved:G=>{y(G),J(G.name),W(!0),s(ae=>ae.includes(ea.SETTINGS)?ae:[...ae,ea.SETTINGS]),setTimeout(()=>{W(!1),s(ae=>ae.includes(ea.SETTINGS)?ae:[...ae,ea.SETTINGS]),setTimeout(()=>{const ae=document.querySelector('[data-testid="trip-image-url"]');ae&&ae.focus()},120)},700);try{Z.showToast("Bozza salvata con successo","success")}catch{}}})}),u.jsx(rs,{title:"Sezione 2: Impostazioni",isOpen:i.includes(ea.SETTINGS),onClick:()=>ee(ea.SETTINGS),disabled:!v.tripId,disabledMessage:"Questa sezione  disattivata fino al salvataggio della Sezione 1.",children:u.jsx("div",{className:`relative ${v.tripId?"":"pointer-events-none opacity-80"}`,children:u.jsx(jS,{values:b,onChange:(G,ae)=>T(R=>({...R,[G]:ae})),disabled:!v.tripId,onSave:async()=>{if(v.tripId){j(!0);try{const G=await fetch(`/api/trips/${v.tripId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({settings:b})});if(!G.ok){const se=await G.text();throw new Error(se||`HTTP ${G.status}`)}const ae=await G.json();try{Z.showToast("Impostazioni salvate","success")}catch{}const R={...ae||{},tripId:ae&&(ae.tripId||ae._id||v.tripId)};y(se=>({...se||{},...R}))}catch(G){console.error(G);try{Z.showToast("Errore durante il salvataggio","error")}catch{}}finally{j(!1)}}}})})}),u.jsx(rs,{title:"Sezione 3: Documenti",isOpen:i.includes(ea.DOCUMENTS),onClick:()=>ee(ea.DOCUMENTS),disabled:!v.tripId,disabledMessage:"I Documenti sono bloccati fino al salvataggio della Sezione 1.",children:u.jsxs("div",{className:`relative ${v.tripId?"":"pointer-events-none opacity-80"}`,children:[u.jsx(CS,{values:_,onChange:(G,ae)=>w(R=>({...R,[G]:ae})),disabled:!v.tripId}),u.jsx("div",{className:"mt-3 flex justify-end",children:u.jsx("button",{type:"button","data-testid":"save-section-3",onClick:async()=>{if(console.debug("[E2E] Save Documents button clicked",{tripDraft:v,docValues:_,settingsValues:b}),!(!v||!v.tripId)){M(!0);try{const ae={documents:Object.values(_||{}).filter(Boolean)};Object.keys(b||{}).length&&(ae.settings=b),console.debug("[E2E] Save Documents payload",ae);const R=await fetch(`/api/trips/${v.tripId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!R.ok){const E=await R.text();throw console.debug("[E2E] Save Documents response-not-ok",{status:R.status,text:E}),new Error(E||`HTTP ${R.status}`)}const se=await R.json();console.debug("[E2E] Save Documents response-json",se);const A={...se||{},tripId:se&&(se.tripId||se._id||v.tripId)};y(E=>({...E||{},...A}));try{Z.showToast("Documenti salvati","success")}catch{}}catch(G){console.error(G);try{Z.showToast("Errore durante il salvataggio dei documenti","error")}catch{}}finally{M(!1)}}},disabled:!v.tripId||V,className:"bg-white border border-gray-300 text-gray-700 font-semibold px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors",children:V?"Salvando...":"Salva Documenti"})})]})}),u.jsx(rs,{title:"Sezione 4: Dettagli Voli e Trasporti",isOpen:i.includes(ea.FLIGHTS),onClick:()=>ee(ea.FLIGHTS),disabled:!v.tripId,disabledMessage:"Dettagli voli disattivati fino al salvataggio della Sezione 1.",children:u.jsx("div",{className:`relative ${v.tripId?"":"pointer-events-none opacity-80"}`,children:u.jsxs("div",{children:[u.jsx("div",{className:"border-b border-gray-200",children:u.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[u.jsx("button",{onClick:()=>f("andata"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition-colors ${c==="andata"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Voli di Andata"}),u.jsx("button",{onClick:()=>f("ritorno"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition-colors ${c==="ritorno"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Voli di Ritorno"})]})}),u.jsx("div",{className:"pt-6",children:c==="andata"?u.jsxs("div",{children:[u.jsx(la,{label:"Titolo (Voli di Andata)",className:"mb-6",children:u.jsx(Na,{value:m.andataTitle||"",onChange:G=>p(ae=>({...ae||{},andataTitle:G.target.value})),placeholder:"Titolo sezione (opzionale)"})}),u.jsx(la,{label:"Note Importanti (Voli di Andata)",className:"mb-6",children:u.jsx(Bo,{rows:2,placeholder:"Note generali per i voli di andata",value:m.andataNotes||"",onChange:G=>p(ae=>({...ae||{},andataNotes:G.target.value}))})}),u.jsx("div",{className:"space-y-4",children:d.filter(G=>G.direction==="andata").map((G,ae)=>u.jsxs("div",{className:"relative p-4 border border-gray-200 rounded-lg bg-gray-50/50",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4",children:[u.jsx(la,{label:"Gruppo Partenza",children:u.jsxs("div",{className:"relative",children:[u.jsxs("select",{value:G.group||"",onChange:R=>re(ae,{group:R.target.value}),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition appearance-none pr-8",children:[u.jsx("option",{value:"",disabled:!0,children:"-- Seleziona Gruppo --"}),(b&&b.groups?b.groups:[]).map(R=>u.jsx("option",{value:R,children:R},R))]}),u.jsx(us,{className:"w-5 h-5 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"})]})}),u.jsx(la,{label:"Compagnia Aerea",children:u.jsx(Na,{value:G.airline||"",onChange:R=>re(ae,{airline:R.target.value}),placeholder:"e.g. Etihad Airways"})}),u.jsx(la,{label:"Numero Volo",children:u.jsx(Na,{value:G.flightNumber||"",onChange:R=>re(ae,{flightNumber:R.target.value}),placeholder:"e.g. EY 82"})})]}),u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-4 items-end",children:[u.jsx(la,{label:"Aeroporto Partenza",children:u.jsx(Na,{value:G.from||"",onChange:R=>re(ae,{from:R.target.value}),placeholder:"e.g. Malpensa"})}),u.jsx(la,{label:"Aeroporto Arrivo",children:u.jsx(Na,{value:G.to||"",onChange:R=>re(ae,{to:R.target.value}),placeholder:"e.g. Abu Dhabi"})}),u.jsx(la,{label:"Data Partenza",children:u.jsx(Na,{value:G.date||"",onChange:R=>re(ae,{date:R.target.value}),placeholder:"gg/mm/aaaa"})}),u.jsx(la,{label:"Ora Partenza",children:u.jsx(Na,{value:G.timeDeparture||"",onChange:R=>re(ae,{timeDeparture:R.target.value}),placeholder:"--:--"})}),u.jsx(la,{label:"Ora Arrivo",children:u.jsx(Na,{value:G.timeArrival||"",onChange:R=>re(ae,{timeArrival:R.target.value}),placeholder:"--:--"})})]}),u.jsx("div",{className:"absolute top-3 right-3",children:u.jsx("button",{onClick:()=>ue(ae),className:"p-1.5 text-gray-500 hover:text-gray-700 rounded-md transition-colors hover:bg-gray-100",children:u.jsx(cn,{className:"w-5 h-5"})})})]},ae))}),u.jsxs("div",{className:"mt-4 flex items-center space-x-3",children:[u.jsxs("button",{onClick:()=>Q("andata"),className:"text-sm font-semibold text-blue-600 hover:text-blue-800 flex items-center bg-blue-100 hover:bg-blue-200 px-3 py-1.5 rounded-lg transition-colors",children:[u.jsx(fs,{className:"w-4 h-4 mr-1"})," Aggiungi Volo di Andata"]}),u.jsx("button",{onClick:ve,className:"bg-white border border-gray-300 text-gray-700 font-semibold px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors",children:"Salva Voli"})]})]}):u.jsxs("div",{children:[u.jsx(la,{label:"Titolo (Voli di Ritorno)",className:"mb-6",children:u.jsx(Na,{value:m.ritornoTitle||"",onChange:G=>p(ae=>({...ae||{},ritornoTitle:G.target.value})),placeholder:"Titolo sezione (opzionale)"})}),u.jsx(la,{label:"Note Importanti (Voli di Ritorno)",className:"mb-6",children:u.jsx(Bo,{rows:2,placeholder:"Note generali per i voli di ritorno",value:m.ritornoNotes||"",onChange:G=>p(ae=>({...ae||{},ritornoNotes:G.target.value}))})}),u.jsx("div",{className:"space-y-4",children:d.filter(G=>G.direction==="ritorno").map((G,ae)=>u.jsxs("div",{className:"relative p-4 border border-gray-200 rounded-lg bg-gray-50/50",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[u.jsx(la,{label:"Compagnia Aerea",children:u.jsx(Na,{value:G.airline||"",onChange:R=>re(ae,{airline:R.target.value}),placeholder:"e.g. Etihad Airways"})}),u.jsx(la,{label:"Numero Volo",children:u.jsx(Na,{value:G.flightNumber||"",onChange:R=>re(ae,{flightNumber:R.target.value}),placeholder:"e.g. EY 83"})})]}),u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-4 items-end",children:[u.jsx(la,{label:"Aeroporto Partenza",children:u.jsx(Na,{value:G.from||"",onChange:R=>re(ae,{from:R.target.value}),placeholder:"e.g. Abu Dhabi"})}),u.jsx(la,{label:"Aeroporto Arrivo",children:u.jsx(Na,{value:G.to||"",onChange:R=>re(ae,{to:R.target.value}),placeholder:"e.g. Malpensa"})}),u.jsx(la,{label:"Data Partenza",children:u.jsx(Na,{value:G.date||"",onChange:R=>re(ae,{date:R.target.value}),placeholder:"gg/mm/aaaa"})}),u.jsx(la,{label:"Ora Partenza",children:u.jsx(Na,{value:G.timeDeparture||"",onChange:R=>re(ae,{timeDeparture:R.target.value}),placeholder:"--:--"})}),u.jsx(la,{label:"Ora Arrivo",children:u.jsx(Na,{value:G.timeArrival||"",onChange:R=>re(ae,{timeArrival:R.target.value}),placeholder:"--:--"})})]}),u.jsx("div",{className:"absolute top-3 right-3",children:u.jsx("button",{onClick:()=>ue(ae),className:"p-1.5 text-gray-500 hover:text-gray-700 rounded-md transition-colors hover:bg-gray-100",children:u.jsx(cn,{className:"w-5 h-5"})})})]},ae))}),u.jsxs("div",{className:"mt-4 flex items-center space-x-3",children:[u.jsxs("button",{onClick:()=>Q("ritorno"),className:"text-sm font-semibold text-blue-600 hover:text-blue-800 flex items-center bg-blue-100 hover:bg-blue-200 px-3 py-1.5 rounded-lg transition-colors",children:[u.jsx(fs,{className:"w-4 h-4 mr-1"})," Aggiungi Volo di Ritorno"]}),u.jsx("button",{onClick:ve,className:"bg-white border border-gray-300 text-gray-700 font-semibold px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors",children:"Salva Voli"})]})]})})]})})}),u.jsx(rs,{title:"Sezione 5: Contatti di Emergenza e Sicurezza",isOpen:i.includes(ea.EMERGENCY_CONTACTS),onClick:()=>ee(ea.EMERGENCY_CONTACTS),disabled:!v.tripId,disabledMessage:"Contatti di emergenza disattivati fino al salvataggio della Sezione 1.",children:u.jsx("div",{className:`relative ${v.tripId?"":"pointer-events-none opacity-80"}`,children:u.jsxs("div",{className:"p-4",children:[u.jsx(FS,{groups:b&&b.groups||[],initial:C,disabled:!v.tripId,onChange:G=>L(G)}),u.jsx("div",{className:"mt-3 flex justify-end",children:u.jsx("button",{type:"button","data-testid":"save-section-5",onClick:async()=>{if(!(!v||!v.tripId))try{const G={emergencyContacts:C.filter(Boolean)};Object.keys(b||{}).length&&(G.settings=b);const ae=await fetch(`/api/trips/${v.tripId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)});if(!ae.ok){const A=await ae.text();throw new Error(A||`HTTP ${ae.status}`)}const R=await ae.json(),se={...R||{},tripId:R&&(R.tripId||R._id||v.tripId)};y(A=>({...A||{},...se}));try{Z.showToast("Contatti di emergenza salvati","success")}catch{}}catch(G){console.error(G);try{Z.showToast("Errore durante il salvataggio contatti","error")}catch{}}},disabled:!v.tripId,className:"bg-white border border-gray-300 text-gray-700 font-semibold px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors",children:"Salva Contatti"})})]})})}),u.jsx(rs,{title:"Sezione 6: Agenda e Eventi",isOpen:i.includes(ea.AGENDA),onClick:()=>ee(ea.AGENDA),disabled:!v.tripId,disabledMessage:"Agenda disattivata fino al salvataggio della Sezione 1.",children:u.jsx("div",{className:`relative ${v.tripId?"":"pointer-events-none opacity-80"}`,children:u.jsx("div",{className:"p-4",children:"Agenda (placeholder)"})})}),u.jsx(rs,{title:"Sezione 7: Gestione Partecipanti",isOpen:i.includes(ea.PARTICIPANTS),onClick:()=>ee(ea.PARTICIPANTS),actions:u.jsxs("button",{className:"text-sm font-semibold text-white bg-green-600 hover:bg-green-700 flex items-center px-3 py-1.5 rounded-lg transition-colors",children:[u.jsx(Lw,{className:"w-4 h-4 mr-1.5"})," Importa da Google Sheets"]}),disabled:!v.tripId,disabledMessage:"Gestione partecipanti disattivata fino al salvataggio della Sezione 1.",children:u.jsx("div",{className:`relative ${v.tripId?"":"pointer-events-none opacity-80"}`,children:v.tripId?u.jsxs("div",{className:"p-4 flex items-center justify-between",children:[u.jsx("div",{children:"Gestisci i partecipanti per questo viaggio."}),u.jsx("a",{href:`/manage-participants?tripId=${v.tripId}`,className:"text-white bg-blue-600 px-3 py-2 rounded font-semibold",children:"Apri Manage Participants"})]}):u.jsx("div",{className:"p-4",children:"Partecipanti (placeholder)"})})})]}),u.jsxs("footer",{className:"mt-8 pt-6 border-t border-gray-200 flex justify-end items-center space-x-4",children:[u.jsx("button",{onClick:e,className:"bg-gray-200 text-gray-800 font-semibold px-6 py-2.5 rounded-lg hover:bg-gray-300 transition-colors",children:"Annulla"}),u.jsx("button",{type:"button",onClick:()=>{},className:"bg-white border border-gray-300 text-gray-700 font-semibold px-6 py-2.5 rounded-lg hover:bg-gray-50 transition-colors",children:"Salva Bozza"}),u.jsx("button",{onClick:a,className:"bg-blue-600 text-white font-semibold px-6 py-2.5 rounded-lg hover:bg-blue-700 transition-colors",children:t?"Aggiorna":"Salva e Pubblica"})]}),u.jsx(_n,{open:k,variant:"success",title:K?`Viaggio "${K}" creato`:"Viaggio creato",message:"La bozza  stata salvata con successo. Puoi procedere con la compilazione delle altre sezioni.",confirmLabel:"Procedi",cancelLabel:"Chiudi",onConfirm:()=>{W(!1),s(G=>G.includes(2)?G:[...G,2]),setTimeout(()=>{const G=document.querySelector('[data-testid="trip-image-url"]');G&&G.focus()},120)},onCancel:()=>W(!1)})]})},IS=[{title:"Cambio location per il Welcome Drink",type:"Information",trip:"Trip to Ibiza",group:"Tutti i gruppi",date:"20 Lug, 2026"},{title:"Ritardo Volo EY 82",type:"Alert",trip:"Sales Kick-off Dubai",group:"Milano",date:"19 Feb, 2026"},{title:"Dettagli per il check-in in Hotel",type:"Information",trip:"Team Retreat Mykonos",group:"Tutti i gruppi",date:"01 Dic, 2025"}],BS=e=>{switch(e){case"Information":return"bg-blue-100 text-blue-800";case"Alert":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},US=({onCreateCommunication:e})=>u.jsxs("div",{className:"p-8",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Communications"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Send information and alerts to trip participants."})]}),u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Fi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search communications...",className:"pl-10 pr-4 py-2 w-72 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]}),u.jsx("button",{onClick:()=>e(),className:"bg-blue-500 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Create New Communication"})]})}),u.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[u.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Title"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Type"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Trip"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Audience"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Date Sent"}),u.jsx("th",{scope:"col",className:"px-6 py-4 text-right",children:"Actions"})]})}),u.jsx("tbody",{children:IS.map((a,t)=>u.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[u.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap",children:a.title}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`inline-flex items-center px-2.5 py-1 text-xs font-medium rounded-full ${BS(a.type)}`,children:a.type})}),u.jsx("td",{className:"px-6 py-4",children:a.trip}),u.jsx("td",{className:"px-6 py-4",children:a.group}),u.jsx("td",{className:"px-6 py-4",children:a.date}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[u.jsx("button",{className:"p-1.5 text-gray-500 hover:text-gray-700 rounded-md transition-colors hover:bg-gray-100","aria-label":"Edit communication",children:u.jsx(vn,{className:"w-4 h-4"})}),u.jsx("button",{className:"p-1.5 text-red-500 hover:text-red-700 rounded-md transition-colors hover:bg-red-100","aria-label":"Delete communication",children:u.jsx(cn,{className:"w-4 h-4"})})]})})]},t))})]})})})]}),Sc=({label:e,required:a,children:t,className:i})=>u.jsxs("div",{className:i,children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e," ",a&&u.jsx("span",{className:"text-red-500",children:"*"})]}),t]}),zS=e=>u.jsx("input",{...e,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}),PS=e=>u.jsx("textarea",{...e,rows:6,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}),ug=({children:e,defaultValue:a})=>u.jsxs("div",{className:"relative",children:[u.jsx("select",{defaultValue:a,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition appearance-none pr-8",children:e}),u.jsx(us,{className:"w-5 h-5 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"})]}),HS=({onCancel:e,onSave:a,initialType:t})=>{const[i,s]=ce.useState(t||"information");return u.jsxs("div",{className:"p-8",children:[u.jsxs("header",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Create New Communication"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Compose a new message to send to participants."})]}),u.jsx("div",{className:"max-w-4xl mx-auto",children:u.jsx("div",{className:"bg-white p-8 rounded-2xl shadow-sm",children:u.jsxs("div",{className:"space-y-6",children:[u.jsx(Sc,{label:"Tipo di Comunicazione",required:!0,children:u.jsxs("div",{className:"flex items-center space-x-6 pt-1",children:[u.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[u.jsx("input",{type:"radio",name:"comm-type",value:"information",checked:i==="information",onChange:()=>s("information"),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),u.jsx("span",{className:"text-sm text-gray-700",children:"Information"})]}),u.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[u.jsx("input",{type:"radio",name:"comm-type",value:"alert",checked:i==="alert",onChange:()=>s("alert"),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),u.jsx("span",{className:"text-sm text-gray-700",children:"Alert"})]})]})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsx(Sc,{label:"Seleziona Viaggio",required:!0,children:u.jsxs(ug,{defaultValue:"",children:[u.jsx("option",{value:"",disabled:!0,children:"-- Seleziona un viaggio --"}),u.jsx("option",{children:"Trip to Ibiza"}),u.jsx("option",{children:"Sales Kick-off Dubai"}),u.jsx("option",{children:"Team Retreat Mykonos"})]})}),u.jsx(Sc,{label:"Seleziona Gruppo",required:!0,children:u.jsxs(ug,{defaultValue:"all",children:[u.jsx("option",{value:"all",children:"Tutti i gruppi"}),u.jsx("option",{children:"Milano"}),u.jsx("option",{children:"Roma"}),u.jsx("option",{children:"Venezia"}),u.jsx("option",{children:"Vip"})]})})]}),u.jsx(Sc,{label:"Titolo",required:!0,children:u.jsx(zS,{placeholder:"e.g. Flight Delay Information"})}),u.jsx(Sc,{label:"Messaggio",required:!0,children:u.jsx(PS,{placeholder:"Write your message here..."})})]})})}),u.jsxs("footer",{className:"mt-8 pt-6 border-t border-gray-200 flex justify-end items-center space-x-4",children:[u.jsx("button",{onClick:e,className:"bg-gray-200 text-gray-800 font-semibold px-6 py-2.5 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),u.jsx("button",{onClick:a,className:"bg-blue-600 text-white font-semibold px-6 py-2.5 rounded-lg hover:bg-blue-700 transition-colors",children:"Send Communication"})]})]})},VS=({onCreateForm:e,onEditForm:a,onDeleteForm:t,onCloneForm:i,forms:s})=>{const[c,f]=Ia.useState(!1),[d,h]=Ia.useState(null),[m,p]=Ia.useState([]),v=T=>{p(C=>C.includes(T)?C.filter(L=>L!==T):[...C,T])},y=()=>p([]),_=T=>{h(T),f(!0)},w=()=>{d!==null&&t&&t(d),f(!1),h(null)},b=()=>{f(!1),h(null)};return u.jsxs("div",{className:"p-8",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Forms"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Create and manage forms to collect information from participants."})]}),u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Fi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search forms...",className:"pl-10 pr-4 py-2 w-72 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[m.length>0&&u.jsx("button",{onClick:()=>{i&&i(m[0]),y()},className:"bg-blue-100 text-blue-700 font-semibold px-4 py-2 rounded-lg hover:bg-blue-200 transition-colors",children:"Clona Form"}),u.jsx("button",{onClick:e,className:"bg-blue-500 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Create New Form"})]})]})}),u.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[u.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-4 py-4",children:u.jsx("span",{className:"sr-only",children:"Select"})}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Form Name"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Trip"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Registrations"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Status"}),u.jsx("th",{scope:"col",className:"px-6 py-4 text-right",children:"Actions"})]})}),u.jsx("tbody",{children:s.map(T=>u.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-4",children:u.jsx("input",{type:"checkbox",checked:m.includes(T.id),onChange:()=>v(T.id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded"})}),u.jsxs("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900",children:[u.jsx("div",{className:"text-gray-900 font-semibold",children:T.name}),u.jsx("div",{className:"text-sm text-gray-500 mt-1",children:T.description||""})]}),u.jsx("td",{className:"px-6 py-4",children:T.trip}),u.jsx("td",{className:"px-6 py-4",children:T.responses}),u.jsx("td",{className:"px-6 py-4",children:(()=>{const C=(T.status||"").toString().toLowerCase();return C==="published"||C==="publish"?u.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-green-100 text-green-800",children:"Published"}):C==="draft"||C==="drafts"?u.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gray-100 text-gray-800",children:"Draft"}):u.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gray-50 text-gray-600",children:""})})()}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[u.jsx("button",{onClick:()=>a&&a(T.id),className:"p-1.5 text-gray-500 hover:text-gray-700 rounded-md transition-colors hover:bg-gray-100","aria-label":"Edit form",children:u.jsx(vn,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>_(T.id),className:"p-1.5 text-red-500 hover:text-red-700 rounded-md transition-colors hover:bg-red-100","aria-label":"Delete form",children:u.jsx(cn,{className:"w-4 h-4"})})]})})]},T.id))})]})})}),u.jsx(_n,{open:c,title:"Conferma eliminazione",message:"Sei sicuro di voler eliminare questo form? Questa azione  irreversibile.",confirmLabel:"Elimina",cancelLabel:"Annulla",variant:"danger",onConfirm:w,onCancel:b})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Uo={};Uo.version="0.18.5";var qv=1252,GS=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},uh=function(e){GS.indexOf(e)!=-1&&(qv=fh[0]=e)};function XS(){uh(1252)}var rn=function(e){uh(e)};function dh(){rn(1200),XS()}function dg(e){for(var a=[],t=0,i=e.length;t<i;++t)a[t]=e.charCodeAt(t);return a}function YS(e){for(var a=[],t=0;t<e.length>>1;++t)a[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return a.join("")}function Kv(e){for(var a=[],t=0;t<e.length>>1;++t)a[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return a.join("")}var Ac=function(e){var a=e.charCodeAt(0),t=e.charCodeAt(1);return a==255&&t==254?YS(e.slice(2)):a==254&&t==255?Kv(e.slice(2)):a==65279?e.slice(1):e},wo=function(a){return String.fromCharCode(a)},hg=function(a){return String.fromCharCode(a)},Uc,Ni="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zc(e){for(var a="",t=0,i=0,s=0,c=0,f=0,d=0,h=0,m=0;m<e.length;)t=e.charCodeAt(m++),c=t>>2,i=e.charCodeAt(m++),f=(t&3)<<4|i>>4,s=e.charCodeAt(m++),d=(i&15)<<2|s>>6,h=s&63,isNaN(i)?d=h=64:isNaN(s)&&(h=64),a+=Ni.charAt(c)+Ni.charAt(f)+Ni.charAt(d)+Ni.charAt(h);return a}function Nr(e){var a="",t=0,i=0,s=0,c=0,f=0,d=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)c=Ni.indexOf(e.charAt(m++)),f=Ni.indexOf(e.charAt(m++)),t=c<<2|f>>4,a+=String.fromCharCode(t),d=Ni.indexOf(e.charAt(m++)),i=(f&15)<<4|d>>2,d!==64&&(a+=String.fromCharCode(i)),h=Ni.indexOf(e.charAt(m++)),s=(d&3)<<6|h,h!==64&&(a+=String.fromCharCode(s));return a}var ot=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Kn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(a,t){return t?new Buffer(a,t):new Buffer(a)}:Buffer.from.bind(Buffer)}return function(){}})();function ki(e){return ot?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function mg(e){return ot?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Er=function(a){return ot?Kn(a,"binary"):a.split("").map(function(t){return t.charCodeAt(0)&255})};function Qo(e){if(typeof ArrayBuffer>"u")return Er(e);for(var a=new ArrayBuffer(e.length),t=new Uint8Array(a),i=0;i!=e.length;++i)t[i]=e.charCodeAt(i)&255;return a}function Ri(e){if(Array.isArray(e))return e.map(function(i){return String.fromCharCode(i)}).join("");for(var a=[],t=0;t<e.length;++t)a[t]=String.fromCharCode(e[t]);return a.join("")}function WS(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function hh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return hh(new Uint8Array(e));for(var a=new Array(e.length),t=0;t<e.length;++t)a[t]=e[t];return a}var ka=ot?function(e){return Buffer.concat(e.map(function(a){return Buffer.isBuffer(a)?a:Kn(a)}))}:function(e){if(typeof Uint8Array<"u"){var a=0,t=0;for(a=0;a<e.length;++a)t+=e[a].length;var i=new Uint8Array(t),s=0;for(a=0,t=0;a<e.length;t+=s,++a)if(s=e[a].length,e[a]instanceof Uint8Array)i.set(e[a],t);else{if(typeof e[a]=="string")throw"wtf";i.set(new Uint8Array(e[a]),t)}return i}return[].concat.apply([],e.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function qS(e){for(var a=[],t=0,i=e.length+250,s=ki(e.length+255),c=0;c<e.length;++c){var f=e.charCodeAt(c);if(f<128)s[t++]=f;else if(f<2048)s[t++]=192|f>>6&31,s[t++]=128|f&63;else if(f>=55296&&f<57344){f=(f&1023)+64;var d=e.charCodeAt(++c)&1023;s[t++]=240|f>>8&7,s[t++]=128|f>>2&63,s[t++]=128|d>>6&15|(f&3)<<4,s[t++]=128|d&63}else s[t++]=224|f>>12&15,s[t++]=128|f>>6&63,s[t++]=128|f&63;t>i&&(a.push(s.slice(0,t)),t=0,s=ki(65535),i=65530)}return a.push(s.slice(0,t)),ka(a)}var Ja=/\u0000/g,kc=/[\u0001-\u0006]/g;function hl(e){for(var a="",t=e.length-1;t>=0;)a+=e.charAt(t--);return a}function nn(e,a){var t=""+e;return t.length>=a?t:ta("0",a-t.length)+t}function mh(e,a){var t=""+e;return t.length>=a?t:ta(" ",a-t.length)+t}function zo(e,a){var t=""+e;return t.length>=a?t:t+ta(" ",a-t.length)}function KS(e,a){var t=""+Math.round(e);return t.length>=a?t:ta("0",a-t.length)+t}function ZS(e,a){var t=""+e;return t.length>=a?t:ta("0",a-t.length)+t}var xg=Math.pow(2,32);function sl(e,a){if(e>xg||e<-xg)return KS(e,a);var t=Math.round(e);return ZS(t,a)}function Po(e,a){return a=a||0,e.length>=7+a&&(e.charCodeAt(a)|32)===103&&(e.charCodeAt(a+1)|32)===101&&(e.charCodeAt(a+2)|32)===110&&(e.charCodeAt(a+3)|32)===101&&(e.charCodeAt(a+4)|32)===114&&(e.charCodeAt(a+5)|32)===97&&(e.charCodeAt(a+6)|32)===108}var pg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Dd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $S(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},gg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},QS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ho(e,a,t){for(var i=e<0?-1:1,s=e*i,c=0,f=1,d=0,h=1,m=0,p=0,v=Math.floor(s);m<a&&(v=Math.floor(s),d=v*f+c,p=v*m+h,!(s-v<5e-8));)s=1/(s-v),c=f,f=d,h=m,m=p;if(p>a&&(m>a?(p=h,d=c):(p=m,d=f)),!t)return[0,i*d,p];var y=Math.floor(i*d/p);return[y,i*d-y*p,p]}function is(e,a,t){if(e>2958465||e<0)return null;var i=e|0,s=Math.floor(86400*(e-i)),c=0,f=[],d={D:i,T:s,u:86400*(e-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),a&&a.date1904&&(i+=1462),d.u>.9999&&(d.u=0,++s==86400&&(d.T=s=0,++i,++d.D)),i===60)f=t?[1317,10,29]:[1900,2,29],c=3;else if(i===0)f=t?[1317,8,29]:[1900,1,0],c=6;else{i>60&&--i;var h=new Date(1900,0,1);h.setDate(h.getDate()+i-1),f=[h.getFullYear(),h.getMonth()+1,h.getDate()],c=h.getDay(),i<60&&(c=(c+6)%7),t&&(c=n4(h,f))}return d.y=f[0],d.m=f[1],d.d=f[2],d.S=s%60,s=Math.floor(s/60),d.M=s%60,s=Math.floor(s/60),d.H=s,d.q=c,d}var Zv=new Date(1899,11,31,0,0,0),JS=Zv.getTime(),e4=new Date(1900,2,1,0,0,0);function $v(e,a){var t=e.getTime();return a?t-=1461*24*60*60*1e3:e>=e4&&(t+=1440*60*1e3),(t-(JS+(e.getTimezoneOffset()-Zv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function xh(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function t4(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function a4(e){var a=e<0?12:11,t=xh(e.toFixed(12));return t.length<=a||(t=e.toPrecision(10),t.length<=a)?t:e.toExponential(5)}function r4(e){var a=xh(e.toFixed(11));return a.length>(e<0?12:11)||a==="0"||a==="-0"?e.toPrecision(6):a}function Pc(e){var a=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return a>=-4&&a<=-1?t=e.toPrecision(10+a):Math.abs(a)<=9?t=a4(e):a===10?t=e.toFixed(10).substr(0,12):t=r4(e),xh(t4(t.toUpperCase()))}function ds(e,a){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Pc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Wr(14,$v(e,a&&a.date1904),a)}throw new Error("unsupported value in General format: "+e)}function n4(e,a){a[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function i4(e,a,t,i){var s="",c=0,f=0,d=t.y,h,m=0;switch(e){case 98:d=t.y+543;case 121:switch(a.length){case 1:case 2:h=d%100,m=2;break;default:h=d%1e4,m=4;break}break;case 109:switch(a.length){case 1:case 2:h=t.m,m=a.length;break;case 3:return Dd[t.m-1][1];case 5:return Dd[t.m-1][0];default:return Dd[t.m-1][2]}break;case 100:switch(a.length){case 1:case 2:h=t.d,m=a.length;break;case 3:return pg[t.q][0];default:return pg[t.q][1]}break;case 104:switch(a.length){case 1:case 2:h=1+(t.H+11)%12,m=a.length;break;default:throw"bad hour format: "+a}break;case 72:switch(a.length){case 1:case 2:h=t.H,m=a.length;break;default:throw"bad hour format: "+a}break;case 77:switch(a.length){case 1:case 2:h=t.M,m=a.length;break;default:throw"bad minute format: "+a}break;case 115:if(a!="s"&&a!="ss"&&a!=".0"&&a!=".00"&&a!=".000")throw"bad second format: "+a;return t.u===0&&(a=="s"||a=="ss")?nn(t.S,a.length):(i>=2?f=i===3?1e3:100:f=i===1?10:1,c=Math.round(f*(t.S+t.u)),c>=60*f&&(c=0),a==="s"?c===0?"0":""+c/f:(s=nn(c,2+i),a==="ss"?s.substr(0,2):"."+s.substr(2,a.length-1)));case 90:switch(a){case"[h]":case"[hh]":h=t.D*24+t.H;break;case"[m]":case"[mm]":h=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":h=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+a}m=a.length===3?1:2;break;case 101:h=d,m=1;break}var p=m>0?nn(h,m):"";return p}function Ai(e){var a=3;if(e.length<=a)return e;for(var t=e.length%a,i=e.substr(0,t);t!=e.length;t+=a)i+=(i.length>0?",":"")+e.substr(t,a);return i}var Qv=/%/g;function s4(e,a,t){var i=a.replace(Qv,""),s=a.length-i.length;return Xn(e,i,t*Math.pow(10,2*s))+ta("%",s)}function l4(e,a,t){for(var i=a.length-1;a.charCodeAt(i-1)===44;)--i;return Xn(e,a.substr(0,i),t/Math.pow(10,3*(a.length-i)))}function Jv(e,a){var t,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+Jv(e,-a);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var c=Math.floor(Math.log(a)*Math.LOG10E)%s;if(c<0&&(c+=s),t=(a/Math.pow(10,c)).toPrecision(i+1+(s+c)%s),t.indexOf("e")===-1){var f=Math.floor(Math.log(a)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(f-t.length+c):t+="E+"+(f-c);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,h,m,p){return h+m+p.substr(0,(s+c)%s)+"."+p.substr(c)+"E"})}else t=a.toExponential(i);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var e2=/# (\?+)( ?)\/( ?)(\d+)/;function c4(e,a,t){var i=parseInt(e[4],10),s=Math.round(a*i),c=Math.floor(s/i),f=s-c*i,d=i;return t+(c===0?"":""+c)+" "+(f===0?ta(" ",e[1].length+1+e[4].length):mh(f,e[1].length)+e[2]+"/"+e[3]+nn(d,e[4].length))}function o4(e,a,t){return t+(a===0?"":""+a)+ta(" ",e[1].length+2+e[4].length)}var t2=/^#*0*\.([0#]+)/,a2=/\).*[0#]/,r2=/\(###\) ###\\?-####/;function $a(e){for(var a="",t,i=0;i!=e.length;++i)switch(t=e.charCodeAt(i)){case 35:break;case 63:a+=" ";break;case 48:a+="0";break;default:a+=String.fromCharCode(t)}return a}function vg(e,a){var t=Math.pow(10,a);return""+Math.round(e*t)/t}function yg(e,a){var t=e-Math.floor(e),i=Math.pow(10,a);return a<(""+Math.round(t*i)).length?0:Math.round(t*i)}function f4(e,a){return a<(""+Math.round((e-Math.floor(e))*Math.pow(10,a))).length?1:0}function u4(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function zr(e,a,t){if(e.charCodeAt(0)===40&&!a.match(a2)){var i=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?zr("n",i,t):"("+zr("n",i,-t)+")"}if(a.charCodeAt(a.length-1)===44)return l4(e,a,t);if(a.indexOf("%")!==-1)return s4(e,a,t);if(a.indexOf("E")!==-1)return Jv(a,t);if(a.charCodeAt(0)===36)return"$"+zr(e,a.substr(a.charAt(1)==" "?2:1),t);var s,c,f,d,h=Math.abs(t),m=t<0?"-":"";if(a.match(/^00+$/))return m+sl(h,a.length);if(a.match(/^[#?]+$/))return s=sl(t,0),s==="0"&&(s=""),s.length>a.length?s:$a(a.substr(0,a.length-s.length))+s;if(c=a.match(e2))return c4(c,h,m);if(a.match(/^#+0+$/))return m+sl(h,a.length-a.indexOf("0"));if(c=a.match(t2))return s=vg(t,c[1].length).replace(/^([^\.]+)$/,"$1."+$a(c[1])).replace(/\.$/,"."+$a(c[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+ta("0",$a(c[1]).length-b.length)}),a.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),c=a.match(/^(0*)\.(#*)$/))return m+vg(h,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=a.match(/^#{1,3},##0(\.?)$/))return m+Ai(sl(h,0));if(c=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+zr(e,a,-t):Ai(""+(Math.floor(t)+f4(t,c[1].length)))+"."+nn(yg(t,c[1].length),c[1].length);if(c=a.match(/^#,#*,#0/))return zr(e,a.replace(/^#,#*,/,""),t);if(c=a.match(/^([0#]+)(\\?-([0#]+))+$/))return s=hl(zr(e,a.replace(/[\\-]/g,""),t)),f=0,hl(hl(a.replace(/\\/g,"")).replace(/[0#]/g,function(w){return f<s.length?s.charAt(f++):w==="0"?"0":""}));if(a.match(r2))return s=zr(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(c=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(c[4].length,7),d=Ho(h,Math.pow(10,f)-1,!1),s=""+m,p=Xn("n",c[1],d[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+c[2]+"/"+c[3],p=zo(d[2],f),p.length<c[4].length&&(p=$a(c[4].substr(c[4].length-p.length))+p),s+=p,s;if(c=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(c[1].length,c[4].length),7),d=Ho(h,Math.pow(10,f)-1,!0),m+(d[0]||(d[1]?"":"0"))+" "+(d[1]?mh(d[1],f)+c[2]+"/"+c[3]+zo(d[2],f):ta(" ",2*f+1+c[2].length+c[3].length));if(c=a.match(/^[#0?]+$/))return s=sl(t,0),a.length<=s.length?s:$a(a.substr(0,a.length-s.length))+s;if(c=a.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),f=s.indexOf(".");var v=a.indexOf(".")-f,y=a.length-s.length-v;return $a(a.substr(0,v)+s+a.substr(a.length-y))}if(c=a.match(/^00,000\.([#0]*0)$/))return f=yg(t,c[1].length),t<0?"-"+zr(e,a,-t):Ai(u4(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?nn(0,3-w.length):"")+w})+"."+nn(f,c[1].length);switch(a){case"###,##0.00":return zr(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var _=Ai(sl(h,0));return _!=="0"?m+_:"";case"###,###.00":return zr(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return zr(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+a+"|")}function d4(e,a,t){for(var i=a.length-1;a.charCodeAt(i-1)===44;)--i;return Xn(e,a.substr(0,i),t/Math.pow(10,3*(a.length-i)))}function h4(e,a,t){var i=a.replace(Qv,""),s=a.length-i.length;return Xn(e,i,t*Math.pow(10,2*s))+ta("%",s)}function n2(e,a){var t,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+n2(e,-a);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var c=Math.floor(Math.log(a)*Math.LOG10E)%s;if(c<0&&(c+=s),t=(a/Math.pow(10,c)).toPrecision(i+1+(s+c)%s),!t.match(/[Ee]/)){var f=Math.floor(Math.log(a)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(f-t.length+c):t+="E+"+(f-c),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,h,m,p){return h+m+p.substr(0,(s+c)%s)+"."+p.substr(c)+"E"})}else t=a.toExponential(i);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function xn(e,a,t){if(e.charCodeAt(0)===40&&!a.match(a2)){var i=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?xn("n",i,t):"("+xn("n",i,-t)+")"}if(a.charCodeAt(a.length-1)===44)return d4(e,a,t);if(a.indexOf("%")!==-1)return h4(e,a,t);if(a.indexOf("E")!==-1)return n2(a,t);if(a.charCodeAt(0)===36)return"$"+xn(e,a.substr(a.charAt(1)==" "?2:1),t);var s,c,f,d,h=Math.abs(t),m=t<0?"-":"";if(a.match(/^00+$/))return m+nn(h,a.length);if(a.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>a.length?s:$a(a.substr(0,a.length-s.length))+s;if(c=a.match(e2))return o4(c,h,m);if(a.match(/^#+0+$/))return m+nn(h,a.length-a.indexOf("0"));if(c=a.match(t2))return s=(""+t).replace(/^([^\.]+)$/,"$1."+$a(c[1])).replace(/\.$/,"."+$a(c[1])),s=s.replace(/\.(\d*)$/,function(w,b){return"."+b+ta("0",$a(c[1]).length-b.length)}),a.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),c=a.match(/^(0*)\.(#*)$/))return m+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=a.match(/^#{1,3},##0(\.?)$/))return m+Ai(""+h);if(c=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+xn(e,a,-t):Ai(""+t)+"."+ta("0",c[1].length);if(c=a.match(/^#,#*,#0/))return xn(e,a.replace(/^#,#*,/,""),t);if(c=a.match(/^([0#]+)(\\?-([0#]+))+$/))return s=hl(xn(e,a.replace(/[\\-]/g,""),t)),f=0,hl(hl(a.replace(/\\/g,"")).replace(/[0#]/g,function(w){return f<s.length?s.charAt(f++):w==="0"?"0":""}));if(a.match(r2))return s=xn(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(c=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(c[4].length,7),d=Ho(h,Math.pow(10,f)-1,!1),s=""+m,p=Xn("n",c[1],d[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+c[2]+"/"+c[3],p=zo(d[2],f),p.length<c[4].length&&(p=$a(c[4].substr(c[4].length-p.length))+p),s+=p,s;if(c=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(c[1].length,c[4].length),7),d=Ho(h,Math.pow(10,f)-1,!0),m+(d[0]||(d[1]?"":"0"))+" "+(d[1]?mh(d[1],f)+c[2]+"/"+c[3]+zo(d[2],f):ta(" ",2*f+1+c[2].length+c[3].length));if(c=a.match(/^[#0?]+$/))return s=""+t,a.length<=s.length?s:$a(a.substr(0,a.length-s.length))+s;if(c=a.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),f=s.indexOf(".");var v=a.indexOf(".")-f,y=a.length-s.length-v;return $a(a.substr(0,v)+s+a.substr(a.length-y))}if(c=a.match(/^00,000\.([#0]*0)$/))return t<0?"-"+xn(e,a,-t):Ai(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?nn(0,3-w.length):"")+w})+"."+nn(0,c[1].length);switch(a){case"###,###":case"##,###":case"#,###":var _=Ai(""+h);return _!=="0"?m+_:"";default:if(a.match(/\.[0#?]*$/))return xn(e,a.slice(0,a.lastIndexOf(".")),t)+$a(a.slice(a.lastIndexOf(".")))}throw new Error("unsupported format |"+a+"|")}function Xn(e,a,t){return(t|0)===t?xn(e,a,t):zr(e,a,t)}function m4(e){for(var a=[],t=!1,i=0,s=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:a[a.length]=e.substr(s,i-s),s=i+1}if(a[a.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return a}var i2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function bl(e){for(var a=0,t="",i="";a<e.length;)switch(t=e.charAt(a)){case"G":Po(e,a)&&(a+=6),a++;break;case'"':for(;e.charCodeAt(++a)!==34&&a<e.length;);++a;break;case"\\":a+=2;break;case"_":a+=2;break;case"@":++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(a,3).toUpperCase()==="A/P"||e.substr(a,5).toUpperCase()==="AM/PM"||e.substr(a,5).toUpperCase()==="/")return!0;++a;break;case"[":for(i=t;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.match(i2))return!0;break;case".":case"0":case"#":for(;a<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++a))>-1||t=="\\"&&e.charAt(a+1)=="-"&&"0#".indexOf(e.charAt(a+2))>-1););break;case"?":for(;e.charAt(++a)===t;);break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;);break;case" ":++a;break;default:++a;break}return!1}function x4(e,a,t,i){for(var s=[],c="",f=0,d="",h="t",m,p,v,y="H";f<e.length;)switch(d=e.charAt(f)){case"G":if(!Po(e,f))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"G",v:"General"},f+=7;break;case'"':for(c="";(v=e.charCodeAt(++f))!==34&&f<e.length;)c+=String.fromCharCode(v);s[s.length]={t:"t",v:c},++f;break;case"\\":var _=e.charAt(++f),w=_==="("||_===")"?_:"t";s[s.length]={t:w,v:_},++f;break;case"_":s[s.length]={t:"t",v:" "},f+=2;break;case"@":s[s.length]={t:"T",v:a},++f;break;case"B":case"b":if(e.charAt(f+1)==="1"||e.charAt(f+1)==="2"){if(m==null&&(m=is(a,t,e.charAt(f+1)==="2"),m==null))return"";s[s.length]={t:"X",v:e.substr(f,2)},h=d,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(a<0||m==null&&(m=is(a,t),m==null))return"";for(c=d;++f<e.length&&e.charAt(f).toLowerCase()===d;)c+=d;d==="m"&&h.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=y),s[s.length]={t:d,v:c},h=d;break;case"A":case"a":case"":var b={t:d,v:d};if(m==null&&(m=is(a,t)),e.substr(f,3).toUpperCase()==="A/P"?(m!=null&&(b.v=m.H>=12?"P":"A"),b.t="T",y="h",f+=3):e.substr(f,5).toUpperCase()==="AM/PM"?(m!=null&&(b.v=m.H>=12?"PM":"AM"),b.t="T",f+=5,y="h"):e.substr(f,5).toUpperCase()==="/"?(m!=null&&(b.v=m.H>=12?"":""),b.t="T",f+=5,y="h"):(b.t="t",++f),m==null&&b.t==="T")return"";s[s.length]=b,h=d;break;case"[":for(c=d;e.charAt(f++)!=="]"&&f<e.length;)c+=e.charAt(f);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(i2)){if(m==null&&(m=is(a,t),m==null))return"";s[s.length]={t:"Z",v:c.toLowerCase()},h=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",bl(e)||(s[s.length]={t:"t",v:c}));break;case".":if(m!=null){for(c=d;++f<e.length&&(d=e.charAt(f))==="0";)c+=d;s[s.length]={t:"s",v:c};break}case"0":case"#":for(c=d;++f<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(f))>-1;)c+=d;s[s.length]={t:"n",v:c};break;case"?":for(c=d;e.charAt(++f)===d;)c+=d;s[s.length]={t:d,v:c},h=d;break;case"*":++f,(e.charAt(f)==" "||e.charAt(f)=="*")&&++f;break;case"(":case")":s[s.length]={t:i===1?"t":d,v:d},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=d;f<e.length&&"0123456789".indexOf(e.charAt(++f))>-1;)c+=e.charAt(f);s[s.length]={t:"D",v:c};break;case" ":s[s.length]={t:d,v:d},++f;break;case"$":s[s.length]={t:"t",v:"$"},++f;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"t",v:d},++f;break}var T=0,C=0,L;for(f=s.length-1,h="t";f>=0;--f)switch(s[f].t){case"h":case"H":s[f].t=y,h="h",T<1&&(T=1);break;case"s":(L=s[f].v.match(/\.0+$/))&&(C=Math.max(C,L[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":h=s[f].t;break;case"m":h==="s"&&(s[f].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&s[f].v.match(/[Hh]/)&&(T=1),T<2&&s[f].v.match(/[Mm]/)&&(T=2),T<3&&s[f].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var N="",j;for(f=0;f<s.length;++f)switch(s[f].t){case"t":case"T":case" ":case"D":break;case"X":s[f].v="",s[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[f].v=i4(s[f].t.charCodeAt(0),s[f].v,m,C),s[f].t="t";break;case"n":case"?":for(j=f+1;s[j]!=null&&((d=s[j].t)==="?"||d==="D"||(d===" "||d==="t")&&s[j+1]!=null&&(s[j+1].t==="?"||s[j+1].t==="t"&&s[j+1].v==="/")||s[f].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(s[j].v==="/"||s[j].v===" "&&s[j+1]!=null&&s[j+1].t=="?"));)s[f].v+=s[j].v,s[j]={v:"",t:";"},++j;N+=s[f].v,f=j-1;break;case"G":s[f].t="t",s[f].v=ds(a,t);break}var V="",M,k;if(N.length>0){N.charCodeAt(0)==40?(M=a<0&&N.charCodeAt(0)===45?-a:a,k=Xn("n",N,M)):(M=a<0&&i>1?-a:a,k=Xn("n",N,M),M<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),j=k.length-1;var W=s.length;for(f=0;f<s.length;++f)if(s[f]!=null&&s[f].t!="t"&&s[f].v.indexOf(".")>-1){W=f;break}var K=s.length;if(W===s.length&&k.indexOf("E")===-1){for(f=s.length-1;f>=0;--f)s[f]==null||"n?".indexOf(s[f].t)===-1||(j>=s[f].v.length-1?(j-=s[f].v.length,s[f].v=k.substr(j+1,s[f].v.length)):j<0?s[f].v="":(s[f].v=k.substr(0,j+1),j=-1),s[f].t="t",K=f);j>=0&&K<s.length&&(s[K].v=k.substr(0,j+1)+s[K].v)}else if(W!==s.length&&k.indexOf("E")===-1){for(j=k.indexOf(".")-1,f=W;f>=0;--f)if(!(s[f]==null||"n?".indexOf(s[f].t)===-1)){for(p=s[f].v.indexOf(".")>-1&&f===W?s[f].v.indexOf(".")-1:s[f].v.length-1,V=s[f].v.substr(p+1);p>=0;--p)j>=0&&(s[f].v.charAt(p)==="0"||s[f].v.charAt(p)==="#")&&(V=k.charAt(j--)+V);s[f].v=V,s[f].t="t",K=f}for(j>=0&&K<s.length&&(s[K].v=k.substr(0,j+1)+s[K].v),j=k.indexOf(".")+1,f=W;f<s.length;++f)if(!(s[f]==null||"n?(".indexOf(s[f].t)===-1&&f!==W)){for(p=s[f].v.indexOf(".")>-1&&f===W?s[f].v.indexOf(".")+1:0,V=s[f].v.substr(0,p);p<s[f].v.length;++p)j<k.length&&(V+=k.charAt(j++));s[f].v=V,s[f].t="t",K=f}}}for(f=0;f<s.length;++f)s[f]!=null&&"n?".indexOf(s[f].t)>-1&&(M=i>1&&a<0&&f>0&&s[f-1].v==="-"?-a:a,s[f].v=Xn(s[f].t,s[f].v,M),s[f].t="t");var J="";for(f=0;f!==s.length;++f)s[f]!=null&&(J+=s[f].v);return J}var _g=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bg(e,a){if(a==null)return!1;var t=parseFloat(a[2]);switch(a[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function p4(e,a){var t=m4(e),i=t.length,s=t[i-1].indexOf("@");if(i<4&&s>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof a!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var c=a>0?t[0]:a<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,c];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var f=t[0].match(_g),d=t[1].match(_g);return bg(a,f)?[i,t[0]]:bg(a,d)?[i,t[1]]:[i,t[f!=null&&d!=null?2:1]]}return[i,c]}function Wr(e,a,t){t==null&&(t={});var i="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?i=t.dateNF:i=e;break;case"number":e==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:Ze)[e],i==null&&(i=t.table&&t.table[gg[e]]||Ze[gg[e]]),i==null&&(i=QS[e]||"General");break}if(Po(i,0))return ds(a,t);a instanceof Date&&(a=$v(a,t.date1904));var s=p4(i,a);if(Po(s[1]))return ds(a,t);if(a===!0)a="TRUE";else if(a===!1)a="FALSE";else if(a===""||a==null)return"";return x4(s[1],a,t,s[0])}function Yn(e,a){if(typeof a!="number"){a=+a||-1;for(var t=0;t<392;++t){if(Ze[t]==null){a<0&&(a=t);continue}if(Ze[t]==e){a=t;break}}a<0&&(a=391)}return Ze[a]=e,a}function Jo(e){for(var a=0;a!=392;++a)e[a]!==void 0&&Yn(e[a],a)}function wl(){Ze=$S()}var g4={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},s2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function v4(e){var a=typeof e=="number"?Ze[e]:e;return a=a.replace(s2,"(\\d+)"),new RegExp("^"+a+"$")}function y4(e,a,t){var i=-1,s=-1,c=-1,f=-1,d=-1,h=-1;(a.match(s2)||[]).forEach(function(v,y){var _=parseInt(t[y+1],10);switch(v.toLowerCase().charAt(0)){case"y":i=_;break;case"d":c=_;break;case"h":f=_;break;case"s":h=_;break;case"m":f>=0?d=_:s=_;break}}),h>=0&&d==-1&&s>=0&&(d=s,s=-1);var m=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return f==-1&&d==-1&&h==-1?m:i==-1&&s==-1&&c==-1?p:m+"T"+p}var _4=(function(){var e={};e.version="1.2.0";function a(){for(var k=0,W=new Array(256),K=0;K!=256;++K)k=K,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,W[K]=k;return typeof Int32Array<"u"?new Int32Array(W):W}var t=a();function i(k){var W=0,K=0,J=0,Z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(J=0;J!=256;++J)Z[J]=k[J];for(J=0;J!=256;++J)for(K=k[J],W=256+J;W<4096;W+=256)K=Z[W]=K>>>8^k[K&255];var Q=[];for(J=1;J!=16;++J)Q[J-1]=typeof Int32Array<"u"?Z.subarray(J*256,J*256+256):Z.slice(J*256,J*256+256);return Q}var s=i(t),c=s[0],f=s[1],d=s[2],h=s[3],m=s[4],p=s[5],v=s[6],y=s[7],_=s[8],w=s[9],b=s[10],T=s[11],C=s[12],L=s[13],N=s[14];function j(k,W){for(var K=W^-1,J=0,Z=k.length;J<Z;)K=K>>>8^t[(K^k.charCodeAt(J++))&255];return~K}function V(k,W){for(var K=W^-1,J=k.length-15,Z=0;Z<J;)K=N[k[Z++]^K&255]^L[k[Z++]^K>>8&255]^C[k[Z++]^K>>16&255]^T[k[Z++]^K>>>24]^b[k[Z++]]^w[k[Z++]]^_[k[Z++]]^y[k[Z++]]^v[k[Z++]]^p[k[Z++]]^m[k[Z++]]^h[k[Z++]]^d[k[Z++]]^f[k[Z++]]^c[k[Z++]]^t[k[Z++]];for(J+=15;Z<J;)K=K>>>8^t[(K^k[Z++])&255];return~K}function M(k,W){for(var K=W^-1,J=0,Z=k.length,Q=0,re=0;J<Z;)Q=k.charCodeAt(J++),Q<128?K=K>>>8^t[(K^Q)&255]:Q<2048?(K=K>>>8^t[(K^(192|Q>>6&31))&255],K=K>>>8^t[(K^(128|Q&63))&255]):Q>=55296&&Q<57344?(Q=(Q&1023)+64,re=k.charCodeAt(J++)&1023,K=K>>>8^t[(K^(240|Q>>8&7))&255],K=K>>>8^t[(K^(128|Q>>2&63))&255],K=K>>>8^t[(K^(128|re>>6&15|(Q&3)<<4))&255],K=K>>>8^t[(K^(128|re&63))&255]):(K=K>>>8^t[(K^(224|Q>>12&15))&255],K=K>>>8^t[(K^(128|Q>>6&63))&255],K=K>>>8^t[(K^(128|Q&63))&255]);return~K}return e.table=t,e.bstr=j,e.buf=V,e.str=M,e})(),Ye=(function(){var a={};a.version="1.2.1";function t(D,X){for(var I=D.split("/"),U=X.split("/"),H=0,Y=0,he=Math.min(I.length,U.length);H<he;++H){if(Y=I[H].length-U[H].length)return Y;if(I[H]!=U[H])return I[H]<U[H]?-1:1}return I.length-U.length}function i(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:i(D.slice(0,-1));var X=D.lastIndexOf("/");return X===-1?D:D.slice(0,X+1)}function s(D){if(D.charAt(D.length-1)=="/")return s(D.slice(0,-1));var X=D.lastIndexOf("/");return X===-1?D:D.slice(X+1)}function c(D,X){typeof X=="string"&&(X=new Date(X));var I=X.getHours();I=I<<6|X.getMinutes(),I=I<<5|X.getSeconds()>>>1,D.write_shift(2,I);var U=X.getFullYear()-1980;U=U<<4|X.getMonth()+1,U=U<<5|X.getDate(),D.write_shift(2,U)}function f(D){var X=D.read_shift(2)&65535,I=D.read_shift(2)&65535,U=new Date,H=I&31;I>>>=5;var Y=I&15;I>>>=4,U.setMilliseconds(0),U.setFullYear(I+1980),U.setMonth(Y-1),U.setDate(H);var he=X&31;X>>>=5;var Se=X&63;return X>>>=6,U.setHours(X),U.setMinutes(Se),U.setSeconds(he<<1),U}function d(D){Ma(D,0);for(var X={},I=0;D.l<=D.length-4;){var U=D.read_shift(2),H=D.read_shift(2),Y=D.l+H,he={};switch(U){case 21589:I=D.read_shift(1),I&1&&(he.mtime=D.read_shift(4)),H>5&&(I&2&&(he.atime=D.read_shift(4)),I&4&&(he.ctime=D.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}D.l=Y,X[U]=he}return X}var h;function m(){return h||(h={})}function p(D,X){if(D[0]==80&&D[1]==75)return kr(D,X);if((D[0]|32)==109&&(D[1]|32)==105)return on(D,X);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var I=3,U=512,H=0,Y=0,he=0,Se=0,me=0,pe=[],ne=D.slice(0,512);Ma(ne,0);var P=v(ne);switch(I=P[0],I){case 3:U=512;break;case 4:U=4096;break;case 0:if(P[1]==0)return kr(D,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}U!==512&&(ne=D.slice(0,U),Ma(ne,28));var fe=D.slice(0,U);y(ne,I);var be=ne.read_shift(4,"i");if(I===3&&be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+be);ne.l+=4,he=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),Se=ne.read_shift(4,"i"),H=ne.read_shift(4,"i"),me=ne.read_shift(4,"i"),Y=ne.read_shift(4,"i");for(var ke=-1,Oe=0;Oe<109&&(ke=ne.read_shift(4,"i"),!(ke<0));++Oe)pe[Oe]=ke;var Ie=_(D,U);T(me,Y,Ie,U,pe);var it=L(Ie,he,pe,U);it[he].name="!Directory",H>0&&Se!==re&&(it[Se].name="!MiniFAT"),it[pe[0]].name="!FAT",it.fat_addrs=pe,it.ssz=U;var xt={},At=[],Ua=[],zt=[];N(he,it,Ie,At,H,xt,Ua,Se),w(Ua,zt,At),At.shift();var $r={FileIndex:Ua,FullPaths:zt};return X&&X.raw&&($r.raw={header:fe,sectors:Ie}),$r}function v(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(ue,"Header Signature: "),D.l+=16;var X=D.read_shift(2,"u");return[D.read_shift(2,"u"),X]}function y(D,X){var I=9;switch(D.l+=2,I=D.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function _(D,X){for(var I=Math.ceil(D.length/X)-1,U=[],H=1;H<I;++H)U[H-1]=D.slice(H*X,(H+1)*X);return U[I-1]=D.slice(I*X),U}function w(D,X,I){for(var U=0,H=0,Y=0,he=0,Se=0,me=I.length,pe=[],ne=[];U<me;++U)pe[U]=ne[U]=U,X[U]=I[U];for(;Se<ne.length;++Se)U=ne[Se],H=D[U].L,Y=D[U].R,he=D[U].C,pe[U]===U&&(H!==-1&&pe[H]!==H&&(pe[U]=pe[H]),Y!==-1&&pe[Y]!==Y&&(pe[U]=pe[Y])),he!==-1&&(pe[he]=U),H!==-1&&U!=pe[U]&&(pe[H]=pe[U],ne.lastIndexOf(H)<Se&&ne.push(H)),Y!==-1&&U!=pe[U]&&(pe[Y]=pe[U],ne.lastIndexOf(Y)<Se&&ne.push(Y));for(U=1;U<me;++U)pe[U]===U&&(Y!==-1&&pe[Y]!==Y?pe[U]=pe[Y]:H!==-1&&pe[H]!==H&&(pe[U]=pe[H]));for(U=1;U<me;++U)if(D[U].type!==0){if(Se=U,Se!=pe[Se])do Se=pe[Se],X[U]=X[Se]+"/"+X[U];while(Se!==0&&pe[Se]!==-1&&Se!=pe[Se]);pe[U]=-1}for(X[0]+="/",U=1;U<me;++U)D[U].type!==2&&(X[U]+="/")}function b(D,X,I){for(var U=D.start,H=D.size,Y=[],he=U;I&&H>0&&he>=0;)Y.push(X.slice(he*Q,he*Q+Q)),H-=Q,he=ns(I,he*4);return Y.length===0?we(0):ka(Y).slice(0,D.size)}function T(D,X,I,U,H){var Y=re;if(D===re){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var he=I[D],Se=(U>>>2)-1;if(!he)return;for(var me=0;me<Se&&(Y=ns(he,me*4))!==re;++me)H.push(Y);T(ns(he,U-4),X-1,I,U,H)}}function C(D,X,I,U,H){var Y=[],he=[];H||(H=[]);var Se=U-1,me=0,pe=0;for(me=X;me>=0;){H[me]=!0,Y[Y.length]=me,he.push(D[me]);var ne=I[Math.floor(me*4/U)];if(pe=me*4&Se,U<4+pe)throw new Error("FAT boundary crossed: "+me+" 4 "+U);if(!D[ne])break;me=ns(D[ne],pe)}return{nodes:Y,data:Og([he])}}function L(D,X,I,U){var H=D.length,Y=[],he=[],Se=[],me=[],pe=U-1,ne=0,P=0,fe=0,be=0;for(ne=0;ne<H;++ne)if(Se=[],fe=ne+X,fe>=H&&(fe-=H),!he[fe]){me=[];var ke=[];for(P=fe;P>=0;){ke[P]=!0,he[P]=!0,Se[Se.length]=P,me.push(D[P]);var Oe=I[Math.floor(P*4/U)];if(be=P*4&pe,U<4+be)throw new Error("FAT boundary crossed: "+P+" 4 "+U);if(!D[Oe]||(P=ns(D[Oe],be),ke[P]))break}Y[fe]={nodes:Se,data:Og([me])}}return Y}function N(D,X,I,U,H,Y,he,Se){for(var me=0,pe=U.length?2:0,ne=X[D].data,P=0,fe=0,be;P<ne.length;P+=128){var ke=ne.slice(P,P+128);Ma(ke,64),fe=ke.read_shift(2),be=wh(ke,0,fe-pe),U.push(be);var Oe={name:be,type:ke.read_shift(1),color:ke.read_shift(1),L:ke.read_shift(4,"i"),R:ke.read_shift(4,"i"),C:ke.read_shift(4,"i"),clsid:ke.read_shift(16),state:ke.read_shift(4,"i"),start:0,size:0},Ie=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);Ie!==0&&(Oe.ct=j(ke,ke.l-8));var it=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);it!==0&&(Oe.mt=j(ke,ke.l-8)),Oe.start=ke.read_shift(4,"i"),Oe.size=ke.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=re,Oe.name=""),Oe.type===5?(me=Oe.start,H>0&&me!==re&&(X[me].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",X[Oe.start]===void 0&&(X[Oe.start]=C(I,Oe.start,X.fat_addrs,X.ssz)),X[Oe.start].name=Oe.name,Oe.content=X[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:me!==re&&Oe.start!==re&&X[me]&&(Oe.content=b(Oe,X[me].data,(X[Se]||{}).data))),Oe.content&&Ma(Oe.content,0),Y[be]=Oe,he.push(Oe)}}function j(D,X){return new Date((Sr(D,X+4)/1e7*Math.pow(2,32)+Sr(D,X)/1e7-11644473600)*1e3)}function V(D,X){return m(),p(h.readFileSync(D),X)}function M(D,X){var I=X&&X.type;switch(I||ot&&Buffer.isBuffer(D)&&(I="buffer"),I||"base64"){case"file":return V(D,X);case"base64":return p(Er(Nr(D)),X);case"binary":return p(Er(D),X)}return p(D,X)}function k(D,X){var I=X||{},U=I.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=U+"/",D.FileIndex[0]={name:U,type:5}),I.CLSID&&(D.FileIndex[0].clsid=I.CLSID),W(D)}function W(D){var X="Sh33tJ5";if(!Ye.find(D,"/"+X)){var I=we(4);I[0]=55,I[1]=I[3]=50,I[2]=54,D.FileIndex.push({name:X,type:2,content:I,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+X),K(D)}}function K(D,X){k(D);for(var I=!1,U=!1,H=D.FullPaths.length-1;H>=0;--H){var Y=D.FileIndex[H];switch(Y.type){case 0:U?I=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(Y.R*Y.L*Y.C)&&(I=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!X)){var he=new Date(1987,1,19),Se=0,me=Object.create?Object.create(null):{},pe=[];for(H=0;H<D.FullPaths.length;++H)me[D.FullPaths[H]]=!0,D.FileIndex[H].type!==0&&pe.push([D.FullPaths[H],D.FileIndex[H]]);for(H=0;H<pe.length;++H){var ne=i(pe[H][0]);U=me[ne],U||(pe.push([ne,{name:s(ne).replace("/",""),type:1,clsid:ee,ct:he,mt:he,content:null}]),me[ne]=!0)}for(pe.sort(function(be,ke){return t(be[0],ke[0])}),D.FullPaths=[],D.FileIndex=[],H=0;H<pe.length;++H)D.FullPaths[H]=pe[H][0],D.FileIndex[H]=pe[H][1];for(H=0;H<pe.length;++H){var P=D.FileIndex[H],fe=D.FullPaths[H];if(P.name=s(fe).replace("/",""),P.L=P.R=P.C=-(P.color=1),P.size=P.content?P.content.length:0,P.start=0,P.clsid=P.clsid||ee,H===0)P.C=pe.length>1?1:-1,P.size=0,P.type=5;else if(fe.slice(-1)=="/"){for(Se=H+1;Se<pe.length&&i(D.FullPaths[Se])!=fe;++Se);for(P.C=Se>=pe.length?-1:Se,Se=H+1;Se<pe.length&&i(D.FullPaths[Se])!=i(fe);++Se);P.R=Se>=pe.length?-1:Se,P.type=1}else i(D.FullPaths[H+1]||"")==i(fe)&&(P.R=H+1),P.type=2}}}function J(D,X){var I=X||{};if(I.fileType=="mad")return Ui(D,I);switch(K(D),I.fileType){case"zip":return Jn(D,I)}var U=(function(be){for(var ke=0,Oe=0,Ie=0;Ie<be.FileIndex.length;++Ie){var it=be.FileIndex[Ie];if(it.content){var xt=it.content.length;xt>0&&(xt<4096?ke+=xt+63>>6:Oe+=xt+511>>9)}}for(var At=be.FullPaths.length+3>>2,Ua=ke+7>>3,zt=ke+127>>7,$r=Ua+Oe+At+zt,mr=$r+127>>7,Tl=mr<=109?0:Math.ceil((mr-109)/127);$r+mr+Tl+127>>7>mr;)Tl=++mr<=109?0:Math.ceil((mr-109)/127);var rr=[1,Tl,mr,zt,At,Oe,ke,0];return be.FileIndex[0].size=ke<<6,rr[7]=(be.FileIndex[0].start=rr[0]+rr[1]+rr[2]+rr[3]+rr[4]+rr[5])+(rr[6]+7>>3),rr})(D),H=we(U[7]<<9),Y=0,he=0;{for(Y=0;Y<8;++Y)H.write_shift(1,ve[Y]);for(Y=0;Y<8;++Y)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),Y=0;Y<3;++Y)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,U[2]),H.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:re),H.write_shift(4,U[3]),H.write_shift(-4,U[1]?U[0]-1:re),H.write_shift(4,U[1]),Y=0;Y<109;++Y)H.write_shift(-4,Y<U[2]?U[1]+Y:-1)}if(U[1])for(he=0;he<U[1];++he){for(;Y<236+he*127;++Y)H.write_shift(-4,Y<U[2]?U[1]+Y:-1);H.write_shift(-4,he===U[1]-1?re:he+1)}var Se=function(be){for(he+=be;Y<he-1;++Y)H.write_shift(-4,Y+1);be&&(++Y,H.write_shift(-4,re))};for(he=Y=0,he+=U[1];Y<he;++Y)H.write_shift(-4,G.DIFSECT);for(he+=U[2];Y<he;++Y)H.write_shift(-4,G.FATSECT);Se(U[3]),Se(U[4]);for(var me=0,pe=0,ne=D.FileIndex[0];me<D.FileIndex.length;++me)ne=D.FileIndex[me],ne.content&&(pe=ne.content.length,!(pe<4096)&&(ne.start=he,Se(pe+511>>9)));for(Se(U[6]+7>>3);H.l&511;)H.write_shift(-4,G.ENDOFCHAIN);for(he=Y=0,me=0;me<D.FileIndex.length;++me)ne=D.FileIndex[me],ne.content&&(pe=ne.content.length,!(!pe||pe>=4096)&&(ne.start=he,Se(pe+63>>6)));for(;H.l&511;)H.write_shift(-4,G.ENDOFCHAIN);for(Y=0;Y<U[4]<<2;++Y){var P=D.FullPaths[Y];if(!P||P.length===0){for(me=0;me<17;++me)H.write_shift(4,0);for(me=0;me<3;++me)H.write_shift(4,-1);for(me=0;me<12;++me)H.write_shift(4,0);continue}ne=D.FileIndex[Y],Y===0&&(ne.start=ne.size?ne.start-1:re);var fe=Y===0&&I.root||ne.name;if(pe=2*(fe.length+1),H.write_shift(64,fe,"utf16le"),H.write_shift(2,pe),H.write_shift(1,ne.type),H.write_shift(1,ne.color),H.write_shift(-4,ne.L),H.write_shift(-4,ne.R),H.write_shift(-4,ne.C),ne.clsid)H.write_shift(16,ne.clsid,"hex");else for(me=0;me<4;++me)H.write_shift(4,0);H.write_shift(4,ne.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,ne.start),H.write_shift(4,ne.size),H.write_shift(4,0)}for(Y=1;Y<D.FileIndex.length;++Y)if(ne=D.FileIndex[Y],ne.size>=4096)if(H.l=ne.start+1<<9,ot&&Buffer.isBuffer(ne.content))ne.content.copy(H,H.l,0,ne.size),H.l+=ne.size+511&-512;else{for(me=0;me<ne.size;++me)H.write_shift(1,ne.content[me]);for(;me&511;++me)H.write_shift(1,0)}for(Y=1;Y<D.FileIndex.length;++Y)if(ne=D.FileIndex[Y],ne.size>0&&ne.size<4096)if(ot&&Buffer.isBuffer(ne.content))ne.content.copy(H,H.l,0,ne.size),H.l+=ne.size+63&-64;else{for(me=0;me<ne.size;++me)H.write_shift(1,ne.content[me]);for(;me&63;++me)H.write_shift(1,0)}if(ot)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function Z(D,X){var I=D.FullPaths.map(function(me){return me.toUpperCase()}),U=I.map(function(me){var pe=me.split("/");return pe[pe.length-(me.slice(-1)=="/"?2:1)]}),H=!1;X.charCodeAt(0)===47?(H=!0,X=I[0].slice(0,-1)+X):H=X.indexOf("/")!==-1;var Y=X.toUpperCase(),he=H===!0?I.indexOf(Y):U.indexOf(Y);if(he!==-1)return D.FileIndex[he];var Se=!Y.match(kc);for(Y=Y.replace(Ja,""),Se&&(Y=Y.replace(kc,"!")),he=0;he<I.length;++he)if((Se?I[he].replace(kc,"!"):I[he]).replace(Ja,"")==Y||(Se?U[he].replace(kc,"!"):U[he]).replace(Ja,"")==Y)return D.FileIndex[he];return null}var Q=64,re=-2,ue="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",G={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:re,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ae(D,X,I){m();var U=J(D,I);h.writeFileSync(X,U)}function R(D){for(var X=new Array(D.length),I=0;I<D.length;++I)X[I]=String.fromCharCode(D[I]);return X.join("")}function se(D,X){var I=J(D,X);switch(X&&X.type||"buffer"){case"file":return m(),h.writeFileSync(X.filename,I),I;case"binary":return typeof I=="string"?I:R(I);case"base64":return zc(typeof I=="string"?I:R(I));case"buffer":if(ot)return Buffer.isBuffer(I)?I:Kn(I);case"array":return typeof I=="string"?Er(I):I}return I}var A;function E(D){try{var X=D.InflateRaw,I=new X;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)A=D;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function O(D,X){if(!A)return Qn(D,X);var I=A.InflateRaw,U=new I,H=U._processChunk(D.slice(D.l),U._finishFlushFlag);return D.l+=U.bytesRead,H}function B(D){return A?A.deflateRawSync(D):Fe(D)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ne(D){var X=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(X>>16|X>>8|X)&255}for(var Te=typeof Uint8Array<"u",De=Te?new Uint8Array(256):[],Ve=0;Ve<256;++Ve)De[Ve]=Ne(Ve);function q(D,X){var I=De[D&255];return X<=8?I>>>8-X:(I=I<<8|De[D>>8&255],X<=16?I>>>16-X:(I=I<<8|De[D>>16&255],I>>>24-X))}function ct(D,X){var I=X&7,U=X>>>3;return(D[U]|(I<=6?0:D[U+1]<<8))>>>I&3}function We(D,X){var I=X&7,U=X>>>3;return(D[U]|(I<=5?0:D[U+1]<<8))>>>I&7}function tt(D,X){var I=X&7,U=X>>>3;return(D[U]|(I<=4?0:D[U+1]<<8))>>>I&15}function qe(D,X){var I=X&7,U=X>>>3;return(D[U]|(I<=3?0:D[U+1]<<8))>>>I&31}function Re(D,X){var I=X&7,U=X>>>3;return(D[U]|(I<=1?0:D[U+1]<<8))>>>I&127}function vt(D,X,I){var U=X&7,H=X>>>3,Y=(1<<I)-1,he=D[H]>>>U;return I<8-U||(he|=D[H+1]<<8-U,I<16-U)||(he|=D[H+2]<<16-U,I<24-U)||(he|=D[H+3]<<24-U),he&Y}function Bt(D,X,I){var U=X&7,H=X>>>3;return U<=5?D[H]|=(I&7)<<U:(D[H]|=I<<U&255,D[H+1]=(I&7)>>8-U),X+3}function Kt(D,X,I){var U=X&7,H=X>>>3;return I=(I&1)<<U,D[H]|=I,X+1}function Sa(D,X,I){var U=X&7,H=X>>>3;return I<<=U,D[H]|=I&255,I>>>=8,D[H+1]=I,X+8}function Ar(D,X,I){var U=X&7,H=X>>>3;return I<<=U,D[H]|=I&255,I>>>=8,D[H+1]=I&255,D[H+2]=I>>>8,X+16}function ar(D,X){var I=D.length,U=2*I>X?2*I:X+5,H=0;if(I>=X)return D;if(ot){var Y=mg(U);if(D.copy)D.copy(Y);else for(;H<D.length;++H)Y[H]=D[H];return Y}else if(Te){var he=new Uint8Array(U);if(he.set)he.set(D);else for(;H<I;++H)he[H]=D[H];return he}return D.length=U,D}function bt(D){for(var X=new Array(D),I=0;I<D;++I)X[I]=0;return X}function ya(D,X,I){var U=1,H=0,Y=0,he=0,Se=0,me=D.length,pe=Te?new Uint16Array(32):bt(32);for(Y=0;Y<32;++Y)pe[Y]=0;for(Y=me;Y<I;++Y)D[Y]=0;me=D.length;var ne=Te?new Uint16Array(me):bt(me);for(Y=0;Y<me;++Y)pe[H=D[Y]]++,U<H&&(U=H),ne[Y]=0;for(pe[0]=0,Y=1;Y<=U;++Y)pe[Y+16]=Se=Se+pe[Y-1]<<1;for(Y=0;Y<me;++Y)Se=D[Y],Se!=0&&(ne[Y]=pe[Se+16]++);var P=0;for(Y=0;Y<me;++Y)if(P=D[Y],P!=0)for(Se=q(ne[Y],U)>>U-P,he=(1<<U+4-P)-1;he>=0;--he)X[Se|he<<P]=P&15|Y<<4;return U}var Pe=Te?new Uint16Array(512):bt(512),Be=Te?new Uint16Array(32):bt(32);if(!Te){for(var Ue=0;Ue<512;++Ue)Pe[Ue]=0;for(Ue=0;Ue<32;++Ue)Be[Ue]=0}(function(){for(var D=[],X=0;X<32;X++)D.push(5);ya(D,Be,32);var I=[];for(X=0;X<=143;X++)I.push(8);for(;X<=255;X++)I.push(9);for(;X<=279;X++)I.push(7);for(;X<=287;X++)I.push(8);ya(I,Pe,288)})();var He=(function(){for(var X=Te?new Uint8Array(32768):[],I=0,U=0;I<ye.length-1;++I)for(;U<ye[I+1];++U)X[U]=I;for(;U<32768;++U)X[U]=29;var H=Te?new Uint8Array(259):[];for(I=0,U=0;I<le.length-1;++I)for(;U<le[I+1];++U)H[U]=I;function Y(Se,me){for(var pe=0;pe<Se.length;){var ne=Math.min(65535,Se.length-pe),P=pe+ne==Se.length;for(me.write_shift(1,+P),me.write_shift(2,ne),me.write_shift(2,~ne&65535);ne-- >0;)me[me.l++]=Se[pe++]}return me.l}function he(Se,me){for(var pe=0,ne=0,P=Te?new Uint16Array(32768):[];ne<Se.length;){var fe=Math.min(65535,Se.length-ne);if(fe<10){for(pe=Bt(me,pe,+(ne+fe==Se.length)),pe&7&&(pe+=8-(pe&7)),me.l=pe/8|0,me.write_shift(2,fe),me.write_shift(2,~fe&65535);fe-- >0;)me[me.l++]=Se[ne++];pe=me.l*8;continue}pe=Bt(me,pe,+(ne+fe==Se.length)+2);for(var be=0;fe-- >0;){var ke=Se[ne];be=(be<<5^ke)&32767;var Oe=-1,Ie=0;if((Oe=P[be])&&(Oe|=ne&-32768,Oe>ne&&(Oe-=32768),Oe<ne))for(;Se[Oe+Ie]==Se[ne+Ie]&&Ie<250;)++Ie;if(Ie>2){ke=H[Ie],ke<=22?pe=Sa(me,pe,De[ke+1]>>1)-1:(Sa(me,pe,3),pe+=5,Sa(me,pe,De[ke-23]>>5),pe+=3);var it=ke<8?0:ke-4>>2;it>0&&(Ar(me,pe,Ie-le[ke]),pe+=it),ke=X[ne-Oe],pe=Sa(me,pe,De[ke]>>3),pe-=3;var xt=ke<4?0:ke-2>>1;xt>0&&(Ar(me,pe,ne-Oe-ye[ke]),pe+=xt);for(var At=0;At<Ie;++At)P[be]=ne&32767,be=(be<<5^Se[ne])&32767,++ne;fe-=Ie-1}else ke<=143?ke=ke+48:pe=Kt(me,pe,1),pe=Sa(me,pe,De[ke]),P[be]=ne&32767,++ne}pe=Sa(me,pe,0)-1}return me.l=(pe+7)/8|0,me.l}return function(me,pe){return me.length<8?Y(me,pe):he(me,pe)}})();function Fe(D){var X=we(50+Math.floor(D.length*1.1)),I=He(D,X);return X.slice(0,I)}var Je=Te?new Uint16Array(32768):bt(32768),mt=Te?new Uint16Array(32768):bt(32768),et=Te?new Uint16Array(128):bt(128),_t=1,na=1;function Zt(D,X){var I=qe(D,X)+257;X+=5;var U=qe(D,X)+1;X+=5;var H=tt(D,X)+4;X+=4;for(var Y=0,he=Te?new Uint8Array(19):bt(19),Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],me=1,pe=Te?new Uint8Array(8):bt(8),ne=Te?new Uint8Array(8):bt(8),P=he.length,fe=0;fe<H;++fe)he[z[fe]]=Y=We(D,X),me<Y&&(me=Y),pe[Y]++,X+=3;var be=0;for(pe[0]=0,fe=1;fe<=me;++fe)ne[fe]=be=be+pe[fe-1]<<1;for(fe=0;fe<P;++fe)(be=he[fe])!=0&&(Se[fe]=ne[be]++);var ke=0;for(fe=0;fe<P;++fe)if(ke=he[fe],ke!=0){be=De[Se[fe]]>>8-ke;for(var Oe=(1<<7-ke)-1;Oe>=0;--Oe)et[be|Oe<<ke]=ke&7|fe<<3}var Ie=[];for(me=1;Ie.length<I+U;)switch(be=et[Re(D,X)],X+=be&7,be>>>=3){case 16:for(Y=3+ct(D,X),X+=2,be=Ie[Ie.length-1];Y-- >0;)Ie.push(be);break;case 17:for(Y=3+We(D,X),X+=3;Y-- >0;)Ie.push(0);break;case 18:for(Y=11+Re(D,X),X+=7;Y-- >0;)Ie.push(0);break;default:Ie.push(be),me<be&&(me=be);break}var it=Ie.slice(0,I),xt=Ie.slice(I);for(fe=I;fe<286;++fe)it[fe]=0;for(fe=U;fe<30;++fe)xt[fe]=0;return _t=ya(it,Je,286),na=ya(xt,mt,30),X}function Ii(D,X){if(D[0]==3&&!(D[1]&3))return[ki(X),2];for(var I=0,U=0,H=mg(X||1<<18),Y=0,he=H.length>>>0,Se=0,me=0;(U&1)==0;){if(U=We(D,I),I+=3,U>>>1)U>>1==1?(Se=9,me=5):(I=Zt(D,I),Se=_t,me=na);else{I&7&&(I+=8-(I&7));var pe=D[I>>>3]|D[(I>>>3)+1]<<8;if(I+=32,pe>0)for(!X&&he<Y+pe&&(H=ar(H,Y+pe),he=H.length);pe-- >0;)H[Y++]=D[I>>>3],I+=8;continue}for(;;){!X&&he<Y+32767&&(H=ar(H,Y+32767),he=H.length);var ne=vt(D,I,Se),P=U>>>1==1?Pe[ne]:Je[ne];if(I+=P&15,P>>>=4,(P>>>8&255)===0)H[Y++]=P;else{if(P==256)break;P-=257;var fe=P<8?0:P-4>>2;fe>5&&(fe=0);var be=Y+le[P];fe>0&&(be+=vt(D,I,fe),I+=fe),ne=vt(D,I,me),P=U>>>1==1?Be[ne]:mt[ne],I+=P&15,P>>>=4;var ke=P<4?0:P-2>>1,Oe=ye[P];for(ke>0&&(Oe+=vt(D,I,ke),I+=ke),!X&&he<be&&(H=ar(H,be+100),he=H.length);Y<be;)H[Y]=H[Y-Oe],++Y}}}return X?[H,I+7>>>3]:[H.slice(0,Y),I+7>>>3]}function Qn(D,X){var I=D.slice(D.l||0),U=Ii(I,X);return D.l+=U[1],U[0]}function Es(D,X){if(D)typeof console<"u"&&console.error(X);else throw new Error(X)}function kr(D,X){var I=D;Ma(I,0);var U=[],H=[],Y={FileIndex:U,FullPaths:H};k(Y,{root:X.root});for(var he=I.length-4;(I[he]!=80||I[he+1]!=75||I[he+2]!=5||I[he+3]!=6)&&he>=0;)--he;I.l=he+4,I.l+=4;var Se=I.read_shift(2);I.l+=6;var me=I.read_shift(4);for(I.l=me,he=0;he<Se;++he){I.l+=20;var pe=I.read_shift(4),ne=I.read_shift(4),P=I.read_shift(2),fe=I.read_shift(2),be=I.read_shift(2);I.l+=8;var ke=I.read_shift(4),Oe=d(I.slice(I.l+P,I.l+P+fe));I.l+=P+fe+be;var Ie=I.l;I.l=ke+4,Kr(I,pe,ne,Y,Oe),I.l=Ie}return Y}function Kr(D,X,I,U,H){D.l+=2;var Y=D.read_shift(2),he=D.read_shift(2),Se=f(D);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var me=D.read_shift(4),pe=D.read_shift(4),ne=D.read_shift(4),P=D.read_shift(2),fe=D.read_shift(2),be="",ke=0;ke<P;++ke)be+=String.fromCharCode(D[D.l++]);if(fe){var Oe=d(D.slice(D.l,D.l+fe));(Oe[21589]||{}).mt&&(Se=Oe[21589].mt),((H||{})[21589]||{}).mt&&(Se=H[21589].mt)}D.l+=fe;var Ie=D.slice(D.l,D.l+pe);switch(he){case 8:Ie=O(D,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var it=!1;Y&8&&(me=D.read_shift(4),me==134695760&&(me=D.read_shift(4),it=!0),pe=D.read_shift(4),ne=D.read_shift(4)),pe!=X&&Es(it,"Bad compressed size: "+X+" != "+pe),ne!=I&&Es(it,"Bad uncompressed size: "+I+" != "+ne),En(U,be,Ie,{unsafe:!0,mt:Se})}function Jn(D,X){var I=X||{},U=[],H=[],Y=we(1),he=I.compression?8:0,Se=0,me=0,pe=0,ne=0,P=0,fe=D.FullPaths[0],be=fe,ke=D.FileIndex[0],Oe=[],Ie=0;for(me=1;me<D.FullPaths.length;++me)if(be=D.FullPaths[me].slice(fe.length),ke=D.FileIndex[me],!(!ke.size||!ke.content||be=="Sh33tJ5")){var it=ne,xt=we(be.length);for(pe=0;pe<be.length;++pe)xt.write_shift(1,be.charCodeAt(pe)&127);xt=xt.slice(0,xt.l),Oe[P]=_4.buf(ke.content,0);var At=ke.content;he==8&&(At=B(At)),Y=we(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,Se),Y.write_shift(2,he),ke.mt?c(Y,ke.mt):Y.write_shift(4,0),Y.write_shift(-4,Oe[P]),Y.write_shift(4,At.length),Y.write_shift(4,ke.content.length),Y.write_shift(2,xt.length),Y.write_shift(2,0),ne+=Y.length,U.push(Y),ne+=xt.length,U.push(xt),ne+=At.length,U.push(At),Y=we(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,Se),Y.write_shift(2,he),Y.write_shift(4,0),Y.write_shift(-4,Oe[P]),Y.write_shift(4,At.length),Y.write_shift(4,ke.content.length),Y.write_shift(2,xt.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,it),Ie+=Y.l,H.push(Y),Ie+=xt.length,H.push(xt),++P}return Y=we(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,P),Y.write_shift(2,P),Y.write_shift(4,Ie),Y.write_shift(4,ne),Y.write_shift(2,0),ka([ka(U),ka(H),Y])}var Ea={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ei(D,X){if(D.ctype)return D.ctype;var I=D.name||"",U=I.match(/\.([^\.]+)$/);return U&&Ea[U[1]]||X&&(U=(I=X).match(/[\.\\]([^\.\\])+$/),U&&Ea[U[1]])?Ea[U[1]]:"application/octet-stream"}function Sn(D){for(var X=zc(D),I=[],U=0;U<X.length;U+=76)I.push(X.slice(U,U+76));return I.join(`\r
`)+`\r
`}function $t(D){var X=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var ne=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],U=X.split(`\r
`),H=0;H<U.length;++H){var Y=U[H];if(Y.length==0){I.push("");continue}for(var he=0;he<Y.length;){var Se=76,me=Y.slice(he,he+Se);me.charAt(Se-1)=="="?Se--:me.charAt(Se-2)=="="?Se-=2:me.charAt(Se-3)=="="&&(Se-=3),me=Y.slice(he,he+Se),he+=Se,he<Y.length&&(me+="="),I.push(me)}}return I.join(`\r
`)}function Zr(D){for(var X=[],I=0;I<D.length;++I){for(var U=D[I];I<=D.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+D[++I];X.push(U)}for(var H=0;H<X.length;++H)X[H]=X[H].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return Er(X.join(`\r
`))}function Bi(D,X,I){for(var U="",H="",Y="",he,Se=0;Se<10;++Se){var me=X[Se];if(!me||me.match(/^\s*$/))break;var pe=me.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":U=pe[2].trim();break;case"content-type":Y=pe[2].trim();break;case"content-transfer-encoding":H=pe[2].trim();break}}switch(++Se,H.toLowerCase()){case"base64":he=Er(Nr(X.slice(Se).join("")));break;case"quoted-printable":he=Zr(X.slice(Se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var ne=En(D,U.slice(I.length),he,{unsafe:!0});Y&&(ne.ctype=Y)}function on(D,X){if(R(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=X&&X.root||"",U=(ot&&Buffer.isBuffer(D)?D.toString("binary"):R(D)).split(`\r
`),H=0,Y="";for(H=0;H<U.length;++H)if(Y=U[H],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),I||(I=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),Y.slice(0,I.length)!=I););var he=(U[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Se="--"+(he[1]||""),me=[],pe=[],ne={FileIndex:me,FullPaths:pe};k(ne);var P,fe=0;for(H=0;H<U.length;++H){var be=U[H];be!==Se&&be!==Se+"--"||(fe++&&Bi(ne,U.slice(P,H),I),P=H)}return ne}function Ui(D,X){var I=X||{},U=I.boundary||"SheetJS";U="------="+U;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],Y=D.FullPaths[0],he=Y,Se=D.FileIndex[0],me=1;me<D.FullPaths.length;++me)if(he=D.FullPaths[me].slice(Y.length),Se=D.FileIndex[me],!(!Se.size||!Se.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var pe=Se.content,ne=ot&&Buffer.isBuffer(pe)?pe.toString("binary"):R(pe),P=0,fe=Math.min(1024,ne.length),be=0,ke=0;ke<=fe;++ke)(be=ne.charCodeAt(ke))>=32&&be<128&&++P;var Oe=P>=fe*4/5;H.push(U),H.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+he),H.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),H.push("Content-Type: "+ei(Se,he)),H.push(""),H.push(Oe?$t(ne):Sn(ne))}return H.push(U+`--\r
`),H.join(`\r
`)}function zi(D){var X={};return k(X,D),X}function En(D,X,I,U){var H=U&&U.unsafe;H||k(D);var Y=!H&&Ye.find(D,X);if(!Y){var he=D.FullPaths[0];X.slice(0,he.length)==he?he=X:(he.slice(-1)!="/"&&(he+="/"),he=(he+X).replace("//","/")),Y={name:s(X),type:2},D.FileIndex.push(Y),D.FullPaths.push(he),H||Ye.utils.cfb_gc(D)}return Y.content=I,Y.size=I?I.length:0,U&&(U.CLSID&&(Y.clsid=U.CLSID),U.mt&&(Y.mt=U.mt),U.ct&&(Y.ct=U.ct)),Y}function Ts(D,X){k(D);var I=Ye.find(D,X);if(I){for(var U=0;U<D.FileIndex.length;++U)if(D.FileIndex[U]==I)return D.FileIndex.splice(U,1),D.FullPaths.splice(U,1),!0}return!1}function Ba(D,X,I){k(D);var U=Ye.find(D,X);if(U){for(var H=0;H<D.FileIndex.length;++H)if(D.FileIndex[H]==U)return D.FileIndex[H].name=s(I),D.FullPaths[H]=I,!0}return!1}function hr(D){K(D,!0)}return a.find=Z,a.read=M,a.parse=p,a.write=se,a.writeFile=ae,a.utils={cfb_new:zi,cfb_add:En,cfb_del:Ts,cfb_mov:Ba,cfb_gc:hr,ReadShift:jc,CheckField:k2,prep_blob:Ma,bconcat:ka,use_zlib:E,_deflateRaw:Fe,_inflateRaw:Qn,consts:G},a})();function b4(e){return typeof e=="string"?Qo(e):Array.isArray(e)?WS(e):e}function Jc(e,a,t){if(typeof Deno<"u"){if(t&&typeof a=="string")switch(t){case"utf8":a=new TextEncoder(t).encode(a);break;case"binary":a=Qo(a);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,a)}var i=t=="utf8"?gn(a):a;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,e);if(typeof Blob<"u"){var s=new Blob([b4(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:e,saveAs:!0});var f=document.createElement("a");if(f.download!=null)return f.download=e,f.href=c,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(a)&&(a=Ri(a)),d.write(a),d.close(),a}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+e)}function w4(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);a.open("r"),a.encoding="binary";var t=a.read();return a.close(),t}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+e)}function ra(e){for(var a=Object.keys(e),t=[],i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(e,a[i])&&t.push(a[i]);return t}function wg(e,a){for(var t=[],i=ra(e),s=0;s!==i.length;++s)t[e[i[s]][a]]==null&&(t[e[i[s]][a]]=i[s]);return t}function ef(e){for(var a=[],t=ra(e),i=0;i!==t.length;++i)a[e[t[i]]]=t[i];return a}function tf(e){for(var a=[],t=ra(e),i=0;i!==t.length;++i)a[e[t[i]]]=parseInt(t[i],10);return a}function S4(e){for(var a=[],t=ra(e),i=0;i!==t.length;++i)a[e[t[i]]]==null&&(a[e[t[i]]]=[]),a[e[t[i]]].push(t[i]);return a}var Vo=new Date(1899,11,30,0,0,0);function wa(e,a){var t=e.getTime(),i=Vo.getTime()+(e.getTimezoneOffset()-Vo.getTimezoneOffset())*6e4;return(t-i)/(1440*60*1e3)}var l2=new Date,E4=Vo.getTime()+(l2.getTimezoneOffset()-Vo.getTimezoneOffset())*6e4,Sg=l2.getTimezoneOffset();function af(e){var a=new Date;return a.setTime(e*24*60*60*1e3+E4),a.getTimezoneOffset()!==Sg&&a.setTime(a.getTime()+(a.getTimezoneOffset()-Sg)*6e4),a}function T4(e){var a=0,t=0,i=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var c=1;c!=s.length;++c)if(s[c]){switch(t=1,c>3&&(i=!0),s[c].slice(s[c].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[c].slice(s[c].length-1));case"D":t*=24;case"H":t*=60;case"M":if(i)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}a+=t*parseInt(s[c],10)}return a}var Eg=new Date("2017-02-19T19:06:09.000Z"),c2=isNaN(Eg.getFullYear())?new Date("2/19/17"):Eg,N4=c2.getFullYear()==2017;function Gt(e,a){var t=new Date(e);if(N4)return a>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):a<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(c2.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return e.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function hs(e,a){if(ot&&Buffer.isBuffer(e)){if(a){if(e[0]==255&&e[1]==254)return gn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return gn(Kv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(a){if(e[0]==255&&e[1]==254)return gn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return gn(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(c){return t[c]||c})}catch{}for(var i=[],s=0;s!=e.length;++s)i.push(String.fromCharCode(e[s]));return i.join("")}function Xt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=Xt(e[t]));return a}function ta(e,a){for(var t="";t.length<a;)t+=e;return t}function sn(e){var a=Number(e);if(!isNaN(a))return isFinite(a)?a:NaN;if(!/\d/.test(e))return a;var t=1,i=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(a=Number(i))||(i=i.replace(/[(](.*)[)]/,function(s,c){return t=-t,c}),!isNaN(a=Number(i)))?a/t:a}var A4=["january","february","march","april","may","june","july","august","september","october","november","december"];function gl(e){var a=new Date(e),t=new Date(NaN),i=a.getYear(),s=a.getMonth(),c=a.getDate();if(isNaN(c))return t;var f=e.toLowerCase();if(f.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(f=f.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),f.length>3&&A4.indexOf(f)==-1)return t}else if(f.match(/[a-z]/))return t;return i<0||i>8099?t:(s>0||c>1)&&i!=101?a:e.match(/[^-0-9:,\/\\]/)?t:a}var k4=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,i,s){if(e||typeof i=="string")return t.split(i);for(var c=t.split(i),f=[c[0]],d=1;d<c.length;++d)f.push(s),f.push(c[d]);return f}})();function o2(e){return e?e.content&&e.type?hs(e.content,!0):e.data?Ac(e.data):e.asNodeBuffer&&ot?Ac(e.asNodeBuffer().toString("binary")):e.asBinary?Ac(e.asBinary()):e._data&&e._data.getContent?Ac(hs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function f2(e){if(!e)return null;if(e.data)return dg(e.data);if(e.asNodeBuffer&&ot)return e.asNodeBuffer();if(e._data&&e._data.getContent){var a=e._data.getContent();return typeof a=="string"?dg(a):Array.prototype.slice.call(a)}return e.content&&e.type?e.content:null}function C4(e){return e&&e.name.slice(-4)===".bin"?f2(e):o2(e)}function Vr(e,a){for(var t=e.FullPaths||ra(e.files),i=a.toLowerCase().replace(/[\/]/g,"\\"),s=i.replace(/\\/g,"/"),c=0;c<t.length;++c){var f=t[c].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==f||s==f)return e.files?e.files[t[c]]:e.FileIndex[c]}return null}function ph(e,a){var t=Vr(e,a);if(t==null)throw new Error("Cannot find file "+a+" in zip");return t}function pa(e,a,t){if(!t)return C4(ph(e,a));if(!a)return null;try{return pa(e,a)}catch{return null}}function Tr(e,a,t){if(!t)return o2(ph(e,a));if(!a)return null;try{return Tr(e,a)}catch{return null}}function D4(e,a,t){return f2(ph(e,a))}function Tg(e){for(var a=e.FullPaths||ra(e.files),t=[],i=0;i<a.length;++i)a[i].slice(-1)!="/"&&t.push(a[i].replace(/^Root Entry[\/]/,""));return t.sort()}function lt(e,a,t){if(e.FullPaths){if(typeof t=="string"){var i;return ot?i=Kn(t):i=qS(t),Ye.utils.cfb_add(e,a,i)}Ye.utils.cfb_add(e,a,t)}else e.file(a,t)}function gh(){return Ye.utils.cfb_new()}function u2(e,a){switch(a.type){case"base64":return Ye.read(e,{type:"base64"});case"binary":return Ye.read(e,{type:"binary"});case"buffer":case"array":return Ye.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+a.type)}function Cc(e,a){if(e.charAt(0)=="/")return e.slice(1);var t=a.split("/");a.slice(-1)!="/"&&t.pop();for(var i=e.split("/");i.length!==0;){var s=i.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var fa=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,j4=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ng=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,F4=/<[^>]*>/g,qa=fa.match(Ng)?Ng:F4,O4=/<\w*:/,R4=/<(\/?)\w+:/;function Qe(e,a,t){for(var i={},s=0,c=0;s!==e.length&&!((c=e.charCodeAt(s))===32||c===10||c===13);++s);if(a||(i[0]=e.slice(0,s)),s===e.length)return i;var f=e.match(j4),d=0,h="",m=0,p="",v="",y=1;if(f)for(m=0;m!=f.length;++m){for(v=f[m],c=0;c!=v.length&&v.charCodeAt(c)!==61;++c);for(p=v.slice(0,c).trim();v.charCodeAt(c+1)==32;)++c;for(y=(s=v.charCodeAt(c+1))==34||s==39?1:0,h=v.slice(c+1+y,v.length-y),d=0;d!=p.length&&p.charCodeAt(d)!==58;++d);if(d===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),i[p]=h,i[p.toLowerCase()]=h;else{var _=(d===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(d+1);if(i[_]&&p.slice(d-3,d)=="ext")continue;i[_]=h,i[_.toLowerCase()]=h}}return i}function bn(e){return e.replace(R4,"<$1")}var d2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vh=ef(d2),wt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,a=/_x([\da-fA-F]{4})_/ig;return function t(i){var s=i+"",c=s.indexOf("<![CDATA[");if(c==-1)return s.replace(e,function(d,h){return d2[d]||String.fromCharCode(parseInt(h,d.indexOf("x")>-1?16:10))||d}).replace(a,function(d,h){return String.fromCharCode(parseInt(h,16))});var f=s.indexOf("]]>");return t(s.slice(0,c))+s.slice(c+9,f)+t(s.slice(f+3))}})(),yh=/[&<>'"]/g,M4=/[\u0000-\u0008\u000b-\u001f]/g;function Ot(e){var a=e+"";return a.replace(yh,function(t){return vh[t]}).replace(M4,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ag(e){return Ot(e).replace(/ /g,"_x0020_")}var h2=/[\u0000-\u001f]/g;function _h(e){var a=e+"";return a.replace(yh,function(t){return vh[t]}).replace(/\n/g,"<br/>").replace(h2,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function L4(e){var a=e+"";return a.replace(yh,function(t){return vh[t]}).replace(h2,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var kg=(function(){var e=/&#(\d+);/g;function a(t,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(e,a)}})();function I4(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Vt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function jd(e){for(var a="",t=0,i=0,s=0,c=0,f=0,d=0;t<e.length;){if(i=e.charCodeAt(t++),i<128){a+=String.fromCharCode(i);continue}if(s=e.charCodeAt(t++),i>191&&i<224){f=(i&31)<<6,f|=s&63,a+=String.fromCharCode(f);continue}if(c=e.charCodeAt(t++),i<240){a+=String.fromCharCode((i&15)<<12|(s&63)<<6|c&63);continue}f=e.charCodeAt(t++),d=((i&7)<<18|(s&63)<<12|(c&63)<<6|f&63)-65536,a+=String.fromCharCode(55296+(d>>>10&1023)),a+=String.fromCharCode(56320+(d&1023))}return a}function Cg(e){var a=ki(2*e.length),t,i,s=1,c=0,f=0,d;for(i=0;i<e.length;i+=s)s=1,(d=e.charCodeAt(i))<128?t=d:d<224?(t=(d&31)*64+(e.charCodeAt(i+1)&63),s=2):d<240?(t=(d&15)*4096+(e.charCodeAt(i+1)&63)*64+(e.charCodeAt(i+2)&63),s=3):(s=4,t=(d&7)*262144+(e.charCodeAt(i+1)&63)*4096+(e.charCodeAt(i+2)&63)*64+(e.charCodeAt(i+3)&63),t-=65536,f=55296+(t>>>10&1023),t=56320+(t&1023)),f!==0&&(a[c++]=f&255,a[c++]=f>>>8,f=0),a[c++]=t%256,a[c++]=t>>>8;return a.slice(0,c).toString("ucs2")}function Dg(e){return Kn(e,"binary").toString("utf8")}var So="foo bar baz",It=ot&&(Dg(So)==jd(So)&&Dg||Cg(So)==jd(So)&&Cg)||jd,gn=ot?function(e){return Kn(e,"utf8").toString("binary")}:function(e){for(var a=[],t=0,i=0,s=0;t<e.length;)switch(i=e.charCodeAt(t++),!0){case i<128:a.push(String.fromCharCode(i));break;case i<2048:a.push(String.fromCharCode(192+(i>>6))),a.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,s=e.charCodeAt(t++)-56320+(i<<10),a.push(String.fromCharCode(240+(s>>18&7))),a.push(String.fromCharCode(144+(s>>12&63))),a.push(String.fromCharCode(128+(s>>6&63))),a.push(String.fromCharCode(128+(s&63)));break;default:a.push(String.fromCharCode(224+(i>>12))),a.push(String.fromCharCode(128+(i>>6&63))),a.push(String.fromCharCode(128+(i&63)))}return a.join("")},Hc=(function(){var e={};return function(t,i){var s=t+"|"+(i||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",i||"")}})(),m2=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(a){return[new RegExp("&"+a[0]+";","ig"),a[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)i=i.replace(e[s][0],e[s][1]);return i}})(),B4=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),U4=/<\/?(?:vt:)?variant>/g,z4=/<(?:vt:)([^>]*)>([\s\S]*)</;function jg(e,a){var t=Qe(e),i=e.match(B4(t.baseType))||[],s=[];if(i.length!=t.size){if(a.WTF)throw new Error("unexpected vector length "+i.length+" != "+t.size);return s}return i.forEach(function(c){var f=c.replace(U4,"").match(z4);f&&s.push({v:It(f[2]),t:f[1]})}),s}var x2=/(^\s|\s$|\n)/;function La(e,a){return"<"+e+(a.match(x2)?' xml:space="preserve"':"")+">"+a+"</"+e+">"}function Vc(e){return ra(e).map(function(a){return" "+a+'="'+e[a]+'"'}).join("")}function Me(e,a,t){return"<"+e+(t!=null?Vc(t):"")+(a!=null?(a.match(x2)?' xml:space="preserve"':"")+">"+a+"</"+e:"/")+">"}function $d(e,a){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(a)throw t}return""}function P4(e,a){switch(typeof e){case"string":var t=Me("vt:lpwstr",Ot(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Me((e|0)==e?"vt:i4":"vt:r8",Ot(String(e)));case"boolean":return Me("vt:bool",e?"true":"false")}if(e instanceof Date)return Me("vt:filetime",$d(e));throw new Error("Unable to serialize "+e)}function bh(e){if(ot&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return It(Ri(hh(e)));throw new Error("Bad input format: expected Buffer or string")}var Gc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ba={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},vs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],wr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function H4(e,a){for(var t=1-2*(e[a+7]>>>7),i=((e[a+7]&127)<<4)+(e[a+6]>>>4&15),s=e[a+6]&15,c=5;c>=0;--c)s=s*256+e[a+c];return i==2047?s==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,s+=Math.pow(2,52)),t*Math.pow(2,i-52)*s)}function V4(e,a,t){var i=(a<0||1/a==-1/0?1:0)<<7,s=0,c=0,f=i?-a:a;isFinite(f)?f==0?s=c=0:(s=Math.floor(Math.log(f)/Math.LN2),c=f*Math.pow(2,52-s),s<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?s=-1022:(c-=Math.pow(2,52),s+=1023)):(s=2047,c=isNaN(a)?26985:0);for(var d=0;d<=5;++d,c/=256)e[t+d]=c&255;e[t+6]=(s&15)<<4|c&15,e[t+7]=s>>4|i}var Fg=function(e){for(var a=[],t=10240,i=0;i<e[0].length;++i)if(e[0][i])for(var s=0,c=e[0][i].length;s<c;s+=t)a.push.apply(a,e[0][i].slice(s,s+t));return a},Og=ot?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(a){return Buffer.isBuffer(a)?a:Kn(a)})):Fg(e)}:Fg,Rg=function(e,a,t){for(var i=[],s=a;s<t;s+=2)i.push(String.fromCharCode(Gn(e,s)));return i.join("").replace(Ja,"")},wh=ot?function(e,a,t){return Buffer.isBuffer(e)?e.toString("utf16le",a,t).replace(Ja,""):Rg(e,a,t)}:Rg,Mg=function(e,a,t){for(var i=[],s=a;s<a+t;++s)i.push(("0"+e[s].toString(16)).slice(-2));return i.join("")},p2=ot?function(e,a,t){return Buffer.isBuffer(e)?e.toString("hex",a,a+t):Mg(e,a,t)}:Mg,Lg=function(e,a,t){for(var i=[],s=a;s<t;s++)i.push(String.fromCharCode(ul(e,s)));return i.join("")},e0=ot?function(a,t,i){return Buffer.isBuffer(a)?a.toString("utf8",t,i):Lg(a,t,i)}:Lg,g2=function(e,a){var t=Sr(e,a);return t>0?e0(e,a+4,a+4+t-1):""},v2=g2,y2=function(e,a){var t=Sr(e,a);return t>0?e0(e,a+4,a+4+t-1):""},_2=y2,b2=function(e,a){var t=2*Sr(e,a);return t>0?e0(e,a+4,a+4+t-1):""},w2=b2,S2=function(a,t){var i=Sr(a,t);return i>0?wh(a,t+4,t+4+i):""},E2=S2,T2=function(e,a){var t=Sr(e,a);return t>0?e0(e,a+4,a+4+t):""},N2=T2,A2=function(e,a){return H4(e,a)},Go=A2,Sh=function(a){return Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array};ot&&(v2=function(a,t){if(!Buffer.isBuffer(a))return g2(a,t);var i=a.readUInt32LE(t);return i>0?a.toString("utf8",t+4,t+4+i-1):""},_2=function(a,t){if(!Buffer.isBuffer(a))return y2(a,t);var i=a.readUInt32LE(t);return i>0?a.toString("utf8",t+4,t+4+i-1):""},w2=function(a,t){if(!Buffer.isBuffer(a))return b2(a,t);var i=2*a.readUInt32LE(t);return a.toString("utf16le",t+4,t+4+i-1)},E2=function(a,t){if(!Buffer.isBuffer(a))return S2(a,t);var i=a.readUInt32LE(t);return a.toString("utf16le",t+4,t+4+i)},N2=function(a,t){if(!Buffer.isBuffer(a))return T2(a,t);var i=a.readUInt32LE(t);return a.toString("utf8",t+4,t+4+i)},Go=function(a,t){return Buffer.isBuffer(a)?a.readDoubleLE(t):A2(a,t)},Sh=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array});var ul=function(e,a){return e[a]},Gn=function(e,a){return e[a+1]*256+e[a]},G4=function(e,a){var t=e[a+1]*256+e[a];return t<32768?t:(65535-t+1)*-1},Sr=function(e,a){return e[a+3]*(1<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a]},ns=function(e,a){return e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]},X4=function(e,a){return e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]};function jc(e,a){var t="",i,s,c=[],f,d,h,m;switch(a){case"dbcs":if(m=this.l,ot&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)t+=String.fromCharCode(Gn(this,m)),m+=2;e*=2;break;case"utf8":t=e0(this,this.l,this.l+e);break;case"utf16le":e*=2,t=wh(this,this.l,this.l+e);break;case"wstr":return jc.call(this,e,"dbcs");case"lpstr-ansi":t=v2(this,this.l),e=4+Sr(this,this.l);break;case"lpstr-cp":t=_2(this,this.l),e=4+Sr(this,this.l);break;case"lpwstr":t=w2(this,this.l),e=4+2*Sr(this,this.l);break;case"lpp4":e=4+Sr(this,this.l),t=E2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Sr(this,this.l),t=N2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(f=ul(this,this.l+e++))!==0;)c.push(wo(f));t=c.join("");break;case"_wstr":for(e=0,t="";(f=Gn(this,this.l+e))!==0;)c.push(wo(f)),e+=2;e+=2,t=c.join("");break;case"dbcs-cont":for(t="",m=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return f=ul(this,m),this.l=m+1,d=jc.call(this,e-h,f?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(wo(Gn(this,m))),m+=2}t=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",m=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return f=ul(this,m),this.l=m+1,d=jc.call(this,e-h,f?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(wo(ul(this,m))),m+=1}t=c.join("");break;default:switch(e){case 1:return i=ul(this,this.l),this.l++,i;case 2:return i=(a==="i"?G4:Gn)(this,this.l),this.l+=2,i;case 4:case-4:return a==="i"||(this[this.l+3]&128)===0?(i=(e>0?ns:X4)(this,this.l),this.l+=4,i):(s=Sr(this,this.l),this.l+=4,s);case 8:case-8:if(a==="f")return e==8?s=Go(this,this.l):s=Go([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=p2(this,this.l,e);break}}return this.l+=e,t}var Y4=function(e,a,t){e[t]=a&255,e[t+1]=a>>>8&255,e[t+2]=a>>>16&255,e[t+3]=a>>>24&255},W4=function(e,a,t){e[t]=a&255,e[t+1]=a>>8&255,e[t+2]=a>>16&255,e[t+3]=a>>24&255},q4=function(e,a,t){e[t]=a&255,e[t+1]=a>>>8&255};function K4(e,a,t){var i=0,s=0;if(t==="dbcs"){for(s=0;s!=a.length;++s)q4(this,a.charCodeAt(s),this.l+2*s);i=2*a.length}else if(t==="sbcs"){for(a=a.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=a.length;++s)this[this.l+s]=a.charCodeAt(s)&255;i=a.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(a.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var c=Math.min(this.l+e,this.length);for(s=0;s<Math.min(a.length,e);++s){var f=a.charCodeAt(s);this[this.l++]=f&255,this[this.l++]=f>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(e){case 1:i=1,this[this.l]=a&255;break;case 2:i=2,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255;break;case 3:i=3,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255,a>>>=8,this[this.l+2]=a&255;break;case 4:i=4,Y4(this,a,this.l);break;case 8:if(i=8,t==="f"){V4(this,a,this.l);break}case 16:break;case-4:i=4,W4(this,a,this.l);break}return this.l+=i,this}function k2(e,a){var t=p2(this,this.l,e.length>>1);if(t!==e)throw new Error(a+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Ma(e,a){e.l=a,e.read_shift=jc,e.chk=k2,e.write_shift=K4}function Wa(e,a){e.l+=a}function we(e){var a=ki(e);return Ma(a,0),a}function Zn(e,a,t){if(e){var i,s,c;Ma(e,e.l||0);for(var f=e.length,d=0,h=0;e.l<f;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var m=Zc[d]||Zc[65535];for(i=e.read_shift(1),c=i&127,s=1;s<4&&i&128;++s)c+=((i=e.read_shift(1))&127)<<7*s;h=e.l+c;var p=m.f&&m.f(e,c,t);if(e.l=h,a(p,m,d))return}}}function ur(){var e=[],a=ot?256:2048,t=function(m){var p=we(m);return Ma(p,0),p},i=t(a),s=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&e.push(i),i=null)},c=function(m){return i&&m<i.length-i.l?i:(s(),i=t(Math.max(m+1,a)))},f=function(){return s(),ka(e)},d=function(m){s(),i=m,i.l==null&&(i.l=i.length),c(a)};return{next:c,push:d,end:f,_bufs:e}}function je(e,a,t,i){var s=+a,c;if(!isNaN(s)){i||(i=Zc[s].p||(t||[]).length||0),c=1+(s>=128?1:0)+1,i>=128&&++c,i>=16384&&++c,i>=2097152&&++c;var f=e.next(c);s<=127?f.write_shift(1,s):(f.write_shift(1,(s&127)+128),f.write_shift(1,s>>7));for(var d=0;d!=4;++d)if(i>=128)f.write_shift(1,(i&127)+128),i>>=7;else{f.write_shift(1,i);break}i>0&&Sh(t)&&e.push(t)}}function Fc(e,a,t){var i=Xt(e);if(a.s?(i.cRel&&(i.c+=a.s.c),i.rRel&&(i.r+=a.s.r)):(i.cRel&&(i.c+=a.c),i.rRel&&(i.r+=a.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Ig(e,a,t){var i=Xt(e);return i.s=Fc(i.s,a.s,t),i.e=Fc(i.e,a.s,t),i}function Oc(e,a){if(e.cRel&&e.c<0)for(e=Xt(e);e.c<0;)e.c+=a>8?16384:256;if(e.rRel&&e.r<0)for(e=Xt(e);e.r<0;)e.r+=a>8?1048576:a>5?65536:16384;var t=$e(e);return!e.cRel&&e.cRel!=null&&(t=Q4(t)),!e.rRel&&e.rRel!=null&&(t=Z4(t)),t}function Fd(e,a){return e.s.r==0&&!e.s.rRel&&e.e.r==(a.biff>=12?1048575:a.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Wt(e.s.c)+":"+(e.e.cRel?"":"$")+Wt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(a.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+oa(e.s.r)+":"+(e.e.rRel?"":"$")+oa(e.e.r):Oc(e.s,a.biff)+":"+Oc(e.e,a.biff)}function Eh(e){return parseInt($4(e),10)-1}function oa(e){return""+(e+1)}function Z4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $4(e){return e.replace(/\$(\d+)$/,"$1")}function Th(e){for(var a=J4(e),t=0,i=0;i!==a.length;++i)t=26*t+a.charCodeAt(i)-64;return t-1}function Wt(e){if(e<0)throw new Error("invalid column "+e);var a="";for(++e;e;e=Math.floor((e-1)/26))a=String.fromCharCode((e-1)%26+65)+a;return a}function Q4(e){return e.replace(/^([A-Z])/,"$$$1")}function J4(e){return e.replace(/^\$([A-Z])/,"$1")}function eE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function qt(e){for(var a=0,t=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);s>=48&&s<=57?a=10*a+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:a-1}}function $e(e){for(var a=e.c+1,t="";a;a=(a-1)/26|0)t=String.fromCharCode((a-1)%26+65)+t;return t+(e.r+1)}function dr(e){var a=e.indexOf(":");return a==-1?{s:qt(e),e:qt(e)}:{s:qt(e.slice(0,a)),e:qt(e.slice(a+1))}}function nt(e,a){return typeof a>"u"||typeof a=="number"?nt(e.s,e.e):(typeof e!="string"&&(e=$e(e)),typeof a!="string"&&(a=$e(a)),e==a?e:e+":"+a)}function St(e){var a={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,s=0,c=e.length;for(t=0;i<c&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)t=26*t+s;for(a.s.c=--t,t=0;i<c&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)t=10*t+s;if(a.s.r=--t,i===c||s!=10)return a.e.c=a.s.c,a.e.r=a.s.r,a;for(++i,t=0;i!=c&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)t=26*t+s;for(a.e.c=--t,t=0;i!=c&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)t=10*t+s;return a.e.r=--t,a}function Bg(e,a){var t=e.t=="d"&&a instanceof Date;if(e.z!=null)try{return e.w=Wr(e.z,t?wa(a):a)}catch{}try{return e.w=Wr((e.XF||{}).numFmtId||(t?14:0),t?wa(a):a)}catch{return""+a}}function qn(e,a,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?$n[e.v]||e.v:a==null?Bg(e,e.v):Bg(e,a))}function Mi(e,a){var t=a&&a.sheet?a.sheet:"Sheet1",i={};return i[t]=e,{SheetNames:[t],Sheets:i}}function C2(e,a,t){var i=t||{},s=e?Array.isArray(e):i.dense,c=e||(s?[]:{}),f=0,d=0;if(c&&i.origin!=null){if(typeof i.origin=="number")f=i.origin;else{var h=typeof i.origin=="string"?qt(i.origin):i.origin;f=h.r,d=h.c}c["!ref"]||(c["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var p=St(c["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),f==-1&&(m.e.r=f=p.e.r+1)}for(var v=0;v!=a.length;++v)if(a[v]){if(!Array.isArray(a[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=a[v].length;++y)if(!(typeof a[v][y]>"u")){var _={v:a[v][y]},w=f+v,b=d+y;if(m.s.r>w&&(m.s.r=w),m.s.c>b&&(m.s.c=b),m.e.r<w&&(m.e.r=w),m.e.c<b&&(m.e.c=b),a[v][y]&&typeof a[v][y]=="object"&&!Array.isArray(a[v][y])&&!(a[v][y]instanceof Date))_=a[v][y];else if(Array.isArray(_.v)&&(_.f=a[v][y][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(i.nullError)_.t="e",_.v=0;else if(i.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=i.dateNF||Ze[14],i.cellDates?(_.t="d",_.w=Wr(_.z,wa(_.v))):(_.t="n",_.v=wa(_.v),_.w=Wr(_.z,_.v))):_.t="s";if(s)c[w]||(c[w]=[]),c[w][b]&&c[w][b].z&&(_.z=c[w][b].z),c[w][b]=_;else{var T=$e({c:b,r:w});c[T]&&c[T].z&&(_.z=c[T].z),c[T]=_}}}return m.s.c<1e7&&(c["!ref"]=nt(m)),c}function Sl(e,a){return C2(null,e,a)}function tE(e){return e.read_shift(4,"i")}function ln(e,a){return a||(a=we(4)),a.write_shift(4,e),a}function Ya(e){var a=e.read_shift(4);return a===0?"":e.read_shift(a,"dbcs")}function Ca(e,a){var t=!1;return a==null&&(t=!0,a=we(4+2*e.length)),a.write_shift(4,e.length),e.length>0&&a.write_shift(0,e,"dbcs"),t?a.slice(0,a.l):a}function aE(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function rE(e,a){return a||(a=we(4)),a.write_shift(2,0),a.write_shift(2,0),a}function Nh(e,a){var t=e.l,i=e.read_shift(1),s=Ya(e),c=[],f={t:s,h:s};if((i&1)!==0){for(var d=e.read_shift(4),h=0;h!=d;++h)c.push(aE(e));f.r=c}else f.r=[{ich:0,ifnt:0}];return e.l=t+a,f}function nE(e,a){var t=!1;return a==null&&(t=!0,a=we(15+4*e.t.length)),a.write_shift(1,0),Ca(e.t,a),t?a.slice(0,a.l):a}var iE=Nh;function sE(e,a){var t=!1;return a==null&&(t=!0,a=we(23+4*e.t.length)),a.write_shift(1,1),Ca(e.t,a),a.write_shift(4,1),rE({},a),t?a.slice(0,a.l):a}function qr(e){var a=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:a,iStyleRef:t}}function ys(e,a){return a==null&&(a=we(8)),a.write_shift(-4,e.c),a.write_shift(3,e.iStyleRef||e.s),a.write_shift(1,0),a}function _s(e){var a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:a}}function bs(e,a){return a==null&&(a=we(4)),a.write_shift(3,e.iStyleRef||e.s),a.write_shift(1,0),a}var lE=Ya,D2=Ca;function Ah(e){var a=e.read_shift(4);return a===0||a===4294967295?"":e.read_shift(a,"dbcs")}function Xo(e,a){var t=!1;return a==null&&(t=!0,a=we(127)),a.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&a.write_shift(0,e,"dbcs"),t?a.slice(0,a.l):a}var cE=Ya,Qd=Ah,kh=Xo;function Ch(e){var a=e.slice(e.l,e.l+4),t=a[0]&1,i=a[0]&2;e.l+=4;var s=i===0?Go([0,0,0,0,a[0]&252,a[1],a[2],a[3]],0):ns(a,0)>>2;return t?s/100:s}function j2(e,a){a==null&&(a=we(4));var t=0,i=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?i=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(i=1,t=1),i)a.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function F2(e){var a={s:{},e:{}};return a.s.r=e.read_shift(4),a.e.r=e.read_shift(4),a.s.c=e.read_shift(4),a.e.c=e.read_shift(4),a}function oE(e,a){return a||(a=we(16)),a.write_shift(4,e.s.r),a.write_shift(4,e.e.r),a.write_shift(4,e.s.c),a.write_shift(4,e.e.c),a}var ws=F2,El=oE;function Xa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ms(e,a){return(a||we(8)).write_shift(8,e,"f")}function fE(e){var a={},t=e.read_shift(1),i=t>>>1,s=e.read_shift(1),c=e.read_shift(2,"i"),f=e.read_shift(1),d=e.read_shift(1),h=e.read_shift(1);switch(e.l++,i){case 0:a.auto=1;break;case 1:a.index=s;var m=ss[s];m&&(a.rgb=Yc(m));break;case 2:a.rgb=Yc([f,d,h]);break;case 3:a.theme=s;break}return c!=0&&(a.tint=c>0?c/32767:c/32768),a}function Yo(e,a){if(a||(a=we(8)),!e||e.auto)return a.write_shift(4,0),a.write_shift(4,0),a;e.index!=null?(a.write_shift(1,2),a.write_shift(1,e.index)):e.theme!=null?(a.write_shift(1,6),a.write_shift(1,e.theme)):(a.write_shift(1,5),a.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),a.write_shift(2,t),!e.rgb||e.theme!=null)a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);else{var i=e.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),a.write_shift(1,parseInt(i.slice(0,2),16)),a.write_shift(1,parseInt(i.slice(2,4),16)),a.write_shift(1,parseInt(i.slice(4,6),16)),a.write_shift(1,255)}return a}function uE(e){var a=e.read_shift(1);e.l++;var t={fBold:a&1,fItalic:a&2,fUnderline:a&4,fStrikeout:a&8,fOutline:a&16,fShadow:a&32,fCondense:a&64,fExtend:a&128};return t}function dE(e,a){a||(a=we(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return a.write_shift(1,t),a.write_shift(1,0),a}function O2(e,a){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=e.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return e.l-=4,e.read_shift(0,a==1?"lpstr":"lpwstr")}function hE(e){return O2(e,1)}function mE(e){return O2(e,2)}var Dh=2,fr=3,Eo=11,Ug=12,Wo=19,To=64,xE=65,pE=71,gE=4108,vE=4126,Aa=80,R2=81,yE=[Aa,R2],Jd={1:{n:"CodePage",t:Dh},2:{n:"Category",t:Aa},3:{n:"PresentationFormat",t:Aa},4:{n:"ByteCount",t:fr},5:{n:"LineCount",t:fr},6:{n:"ParagraphCount",t:fr},7:{n:"SlideCount",t:fr},8:{n:"NoteCount",t:fr},9:{n:"HiddenCount",t:fr},10:{n:"MultimediaClipCount",t:fr},11:{n:"ScaleCrop",t:Eo},12:{n:"HeadingPairs",t:gE},13:{n:"TitlesOfParts",t:vE},14:{n:"Manager",t:Aa},15:{n:"Company",t:Aa},16:{n:"LinksUpToDate",t:Eo},17:{n:"CharacterCount",t:fr},19:{n:"SharedDoc",t:Eo},22:{n:"HyperlinksChanged",t:Eo},23:{n:"AppVersion",t:fr,p:"version"},24:{n:"DigSig",t:xE},26:{n:"ContentType",t:Aa},27:{n:"ContentStatus",t:Aa},28:{n:"Language",t:Aa},29:{n:"Version",t:Aa},255:{},2147483648:{n:"Locale",t:Wo},2147483651:{n:"Behavior",t:Wo},1919054434:{}},eh={1:{n:"CodePage",t:Dh},2:{n:"Title",t:Aa},3:{n:"Subject",t:Aa},4:{n:"Author",t:Aa},5:{n:"Keywords",t:Aa},6:{n:"Comments",t:Aa},7:{n:"Template",t:Aa},8:{n:"LastAuthor",t:Aa},9:{n:"RevNumber",t:Aa},10:{n:"EditTime",t:To},11:{n:"LastPrinted",t:To},12:{n:"CreatedDate",t:To},13:{n:"ModifiedDate",t:To},14:{n:"PageCount",t:fr},15:{n:"WordCount",t:fr},16:{n:"CharCount",t:fr},17:{n:"Thumbnail",t:pE},18:{n:"Application",t:Aa},19:{n:"DocSecurity",t:fr},255:{},2147483648:{n:"Locale",t:Wo},2147483651:{n:"Behavior",t:Wo},1919054434:{}},zg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_E=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function bE(e){return e.map(function(a){return[a>>16&255,a>>8&255,a&255]})}var wE=bE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ss=Xt(wE),$n={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},M2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},th={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},No={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jh(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function SE(e){var a=jh();if(!e||!e.match)return a;var t={};if((e.match(qa)||[]).forEach(function(i){var s=Qe(i);switch(s[0].replace(O4,"<")){case"<?xml":break;case"<Types":a.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":a[th[s.ContentType]]!==void 0&&a[th[s.ContentType]].push(s.PartName);break}}),a.xmlns!==ba.CT)throw new Error("Unknown Namespace: "+a.xmlns);return a.calcchain=a.calcchains.length>0?a.calcchains[0]:"",a.sst=a.strs.length>0?a.strs[0]:"",a.style=a.styles.length>0?a.styles[0]:"",a.defaults=t,delete a.calcchains,a}function L2(e,a){var t=S4(th),i=[],s;i[i.length]=fa,i[i.length]=Me("Types",null,{xmlns:ba.CT,"xmlns:xsd":ba.xsd,"xmlns:xsi":ba.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Me("Default",null,{Extension:h[0],ContentType:h[1]})}));var c=function(h){e[h]&&e[h].length>0&&(s=e[h][0],i[i.length]=Me("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:No[h][a.bookType]||No[h].xlsx}))},f=function(h){(e[h]||[]).forEach(function(m){i[i.length]=Me("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:No[h][a.bookType]||No[h].xlsx})})},d=function(h){(e[h]||[]).forEach(function(m){i[i.length]=Me("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:t[h][0]})})};return c("workbooks"),f("sheets"),f("charts"),d("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),f("metadata"),d("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var ft={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Xc(e){var a=e.lastIndexOf("/");return e.slice(0,a+1)+"_rels/"+e.slice(a+1)+".rels"}function Rc(e,a){var t={"!id":{}};if(!e)return t;a.charAt(0)!=="/"&&(a="/"+a);var i={};return(e.match(qa)||[]).forEach(function(s){var c=Qe(s);if(c[0]==="<Relationship"){var f={};f.Type=c.Type,f.Target=c.Target,f.Id=c.Id,c.TargetMode&&(f.TargetMode=c.TargetMode);var d=c.TargetMode==="External"?c.Target:Cc(c.Target,a);t[d]=f,i[c.Id]=f}}),t["!id"]=i,t}function ml(e){var a=[fa,Me("Relationships",null,{xmlns:ba.RELS})];return ra(e["!id"]).forEach(function(t){a[a.length]=Me("Relationship",null,e["!id"][t])}),a.length>2&&(a[a.length]="</Relationships>",a[1]=a[1].replace("/>",">")),a.join("")}function Ft(e,a,t,i,s,c){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),a<0)for(a=e["!idx"];e["!id"]["rId"+a];++a);if(e["!idx"]=a+1,s.Id="rId"+a,s.Type=i,s.Target=t,[ft.HLINK,ft.XPATH,ft.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+a);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,a}var EE="application/vnd.oasis.opendocument.spreadsheet";function TE(e,a){for(var t=bh(e),i,s;i=Gc.exec(t);)switch(i[3]){case"manifest":break;case"file-entry":if(s=Qe(i[0],!1),s.path=="/"&&s.type!==EE)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(a&&a.WTF)throw i}}function NE(e){var a=[fa];a.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),a.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)a.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return a.push("</manifest:manifest>"),a.join("")}function Pg(e,a,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+a+`"/>
`,`  </rdf:Description>
`].join("")}function AE(e,a){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+a+`"/>
`,`  </rdf:Description>
`].join("")}function kE(e){var a=[fa];a.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)a.push(Pg(e[t][0],e[t][1])),a.push(AE("",e[t][0]));return a.push(Pg("","Document","pkg")),a.push("</rdf:RDF>"),a.join("")}function I2(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Uo.version+"</meta:generator></office:meta></office:document-meta>"}var Xr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CE=(function(){for(var e=new Array(Xr.length),a=0;a<Xr.length;++a){var t=Xr[a],i="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[a]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return e})();function B2(e){var a={};e=It(e);for(var t=0;t<Xr.length;++t){var i=Xr[t],s=e.match(CE[t]);s!=null&&s.length>0&&(a[i[1]]=wt(s[1])),i[2]==="date"&&a[i[1]]&&(a[i[1]]=Gt(a[i[1]]))}return a}function Od(e,a,t,i,s){s[e]!=null||a==null||a===""||(s[e]=a,a=Ot(a),i[i.length]=t?Me(e,a,t):La(e,a))}function U2(e,a){var t=a||{},i=[fa,Me("cp:coreProperties",null,{"xmlns:cp":ba.CORE_PROPS,"xmlns:dc":ba.dc,"xmlns:dcterms":ba.dcterms,"xmlns:dcmitype":ba.dcmitype,"xmlns:xsi":ba.xsi})],s={};if(!e&&!t.Props)return i.join("");e&&(e.CreatedDate!=null&&Od("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:$d(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s),e.ModifiedDate!=null&&Od("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:$d(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s));for(var c=0;c!=Xr.length;++c){var f=Xr[c],d=t.Props&&t.Props[f[1]]!=null?t.Props[f[1]]:e?e[f[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&Od(f[0],d,null,i,s)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var ls=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],z2=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function P2(e,a,t,i){var s=[];if(typeof e=="string")s=jg(e,i);else for(var c=0;c<e.length;++c)s=s.concat(e[c].map(function(p){return{v:p}}));var f=typeof a=="string"?jg(a,i).map(function(p){return p.v}):a,d=0,h=0;if(f.length>0)for(var m=0;m!==s.length;m+=2){switch(h=+s[m+1].v,s[m].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=h,t.SheetNames=f.slice(d,d+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=h,t.DefinedNames=f.slice(d,d+h);break;case"Charts":case"Diagramme":t.Chartsheets=h,t.ChartNames=f.slice(d,d+h);break}d+=h}}function DE(e,a,t){var i={};return a||(a={}),e=It(e),ls.forEach(function(s){var c=(e.match(Hc(s[0]))||[])[1];switch(s[2]){case"string":c&&(a[s[1]]=wt(c));break;case"bool":a[s[1]]=c==="true";break;case"raw":var f=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));f&&f.length>0&&(i[s[1]]=f[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&P2(i.HeadingPairs,i.TitlesOfParts,a,t),a}function H2(e){var a=[],t=Me;return e||(e={}),e.Application="SheetJS",a[a.length]=fa,a[a.length]=Me("Properties",null,{xmlns:ba.EXT_PROPS,"xmlns:vt":ba.vt}),ls.forEach(function(i){if(e[i[1]]!==void 0){var s;switch(i[2]){case"string":s=Ot(String(e[i[1]]));break;case"bool":s=e[i[1]]?"true":"false";break}s!==void 0&&(a[a.length]=t(i[0],s))}}),a[a.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),a[a.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(i){return"<vt:lpstr>"+Ot(i)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),a.length>2&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var jE=/<[^>]+>[^<]*/g;function FE(e,a){var t={},i="",s=e.match(jE);if(s)for(var c=0;c!=s.length;++c){var f=s[c],d=Qe(f);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":i=wt(d.name);break;case"</property>":i=null;break;default:if(f.indexOf("<vt:")===0){var h=f.split(">"),m=h[0].slice(4),p=h[1];switch(m){case"lpstr":case"bstr":case"lpwstr":t[i]=wt(p);break;case"bool":t[i]=Vt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[i]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[i]=parseFloat(p);break;case"filetime":case"date":t[i]=Gt(p);break;case"cy":case"error":t[i]=wt(p);break;default:if(m.slice(-1)=="/")break;a.WTF&&typeof console<"u"&&console.warn("Unexpected",f,m,h)}}else if(f.slice(0,2)!=="</"){if(a.WTF)throw new Error(f)}}}return t}function V2(e){var a=[fa,Me("Properties",null,{xmlns:ba.CUST_PROPS,"xmlns:vt":ba.vt})];if(!e)return a.join("");var t=1;return ra(e).forEach(function(s){++t,a[a.length]=Me("property",P4(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Ot(s)})}),a.length>2&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var ah={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Rd;function OE(e,a,t){Rd||(Rd=ef(ah)),a=Rd[a]||a,e[a]=t}function RE(e,a){var t=[];return ra(ah).map(function(i){for(var s=0;s<Xr.length;++s)if(Xr[s][1]==i)return Xr[s];for(s=0;s<ls.length;++s)if(ls[s][1]==i)return ls[s];throw i}).forEach(function(i){if(e[i[1]]!=null){var s=a&&a.Props&&a.Props[i[1]]!=null?a.Props[i[1]]:e[i[1]];switch(i[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(La(ah[i[1]]||i[1],s))}}),Me("DocumentProperties",t.join(""),{xmlns:wr.o})}function ME(e,a){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",s=[];return e&&ra(e).forEach(function(c){if(Object.prototype.hasOwnProperty.call(e,c)){for(var f=0;f<Xr.length;++f)if(c==Xr[f][1])return;for(f=0;f<ls.length;++f)if(c==ls[f][1])return;for(f=0;f<t.length;++f)if(c==t[f])return;var d=e[c],h="string";typeof d=="number"?(h="float",d=String(d)):d===!0||d===!1?(h="boolean",d=d?"1":"0"):d=String(d),s.push(Me(Ag(c),d,{"dt:dt":h}))}}),a&&ra(a).forEach(function(c){if(Object.prototype.hasOwnProperty.call(a,c)&&!(e&&Object.prototype.hasOwnProperty.call(e,c))){var f=a[c],d="string";typeof f=="number"?(d="float",f=String(f)):f===!0||f===!1?(d="boolean",f=f?"1":"0"):f instanceof Date?(d="dateTime.tz",f=f.toISOString()):f=String(f),s.push(Me(Ag(c),f,{"dt:dt":d}))}}),"<"+i+' xmlns="'+wr.o+'">'+s.join("")+"</"+i+">"}function Fh(e){var a=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+a/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function LE(e){var a=typeof e=="string"?new Date(Date.parse(e)):e,t=a.getTime()/1e3+11644473600,i=t%Math.pow(2,32),s=(t-i)/Math.pow(2,32);i*=1e7,s*=1e7;var c=i/Math.pow(2,32)|0;c>0&&(i=i%Math.pow(2,32),s+=c);var f=we(8);return f.write_shift(4,i),f.write_shift(4,s),f}function G2(e,a,t){var i=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-i&3;)++e.l;return s}function X2(e,a,t){var i=e.read_shift(0,"lpwstr");return i}function Y2(e,a,t){return a===31?X2(e):G2(e,a,t)}function rh(e,a,t){return Y2(e,a,t===!1?0:4)}function IE(e,a){if(!a)throw new Error("VtUnalignedString must have positive length");return Y2(e,a,0)}function BE(e){for(var a=e.read_shift(4),t=[],i=0;i!=a;++i){var s=e.l;t[i]=e.read_shift(0,"lpwstr").replace(Ja,""),e.l-s&2&&(e.l+=2)}return t}function UE(e){for(var a=e.read_shift(4),t=[],i=0;i!=a;++i)t[i]=e.read_shift(0,"lpstr-cp").replace(Ja,"");return t}function zE(e){var a=e.l,t=qo(e,R2);e[e.l]==0&&e[e.l+1]==0&&e.l-a&2&&(e.l+=2);var i=qo(e,fr);return[t,i]}function PE(e){for(var a=e.read_shift(4),t=[],i=0;i<a/2;++i)t.push(zE(e));return t}function Hg(e,a){for(var t=e.read_shift(4),i={},s=0;s!=t;++s){var c=e.read_shift(4),f=e.read_shift(4);i[c]=e.read_shift(f,a===1200?"utf16le":"utf8").replace(Ja,"").replace(kc,"!"),a===1200&&f%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),i}function W2(e){var a=e.read_shift(4),t=e.slice(e.l,e.l+a);return e.l+=a,(a&3)>0&&(e.l+=4-(a&3)&3),t}function HE(e){var a={};return a.Size=e.read_shift(4),e.l+=a.Size+3-(a.Size-1)%4,a}function qo(e,a,t){var i=e.read_shift(2),s,c=t||{};if(e.l+=2,a!==Ug&&i!==a&&yE.indexOf(a)===-1&&!((a&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+a+" saw "+i);switch(a===Ug?i:a){case 2:return s=e.read_shift(2,"i"),c.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return G2(e,i,4).replace(Ja,"");case 31:return X2(e);case 64:return Fh(e);case 65:return W2(e);case 71:return HE(e);case 80:return rh(e,i,!c.raw).replace(Ja,"");case 81:return IE(e,i).replace(Ja,"");case 4108:return PE(e);case 4126:case 4127:return i==4127?BE(e):UE(e);default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+i)}}function Vg(e,a){var t=we(4),i=we(4);switch(t.write_shift(4,e==80?31:e),e){case 3:i.write_shift(-4,a);break;case 5:i=we(8),i.write_shift(8,a,"f");break;case 11:i.write_shift(4,a?1:0);break;case 64:i=LE(a);break;case 31:case 80:for(i=we(4+2*(a.length+1)+(a.length%2?0:2)),i.write_shift(4,a.length+1),i.write_shift(0,a,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+a)}return ka([t,i])}function Gg(e,a){var t=e.l,i=e.read_shift(4),s=e.read_shift(4),c=[],f=0,d=0,h=-1,m={};for(f=0;f!=s;++f){var p=e.read_shift(4),v=e.read_shift(4);c[f]=[p,v+t]}c.sort(function(L,N){return L[1]-N[1]});var y={};for(f=0;f!=s;++f){if(e.l!==c[f][1]){var _=!0;if(f>0&&a)switch(a[c[f-1][0]].t){case 2:e.l+2===c[f][1]&&(e.l+=2,_=!1);break;case 80:e.l<=c[f][1]&&(e.l=c[f][1],_=!1);break;case 4108:e.l<=c[f][1]&&(e.l=c[f][1],_=!1);break}if((!a||f==0)&&e.l<=c[f][1]&&(_=!1,e.l=c[f][1]),_)throw new Error("Read Error: Expected address "+c[f][1]+" at "+e.l+" :"+f)}if(a){var w=a[c[f][0]];if(y[w.n]=qo(e,w.t,{raw:!0}),w.p==="version"&&(y[w.n]=String(y[w.n]>>16)+"."+("0000"+String(y[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(y[w.n]){case 0:y[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:rn(d=y[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[w.n])}}else if(c[f][0]===1){if(d=y.CodePage=qo(e,Dh),rn(d),h!==-1){var b=e.l;e.l=c[h][1],m=Hg(e,d),e.l=b}}else if(c[f][0]===0){if(d===0){h=f,e.l=c[f+1][1];continue}m=Hg(e,d)}else{var T=m[c[f][0]],C;switch(e[e.l]){case 65:e.l+=4,C=W2(e);break;case 30:e.l+=4,C=rh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=rh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=ca(e,4);break;case 64:e.l+=4,C=Gt(Fh(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[T]=C}}return e.l=t+i,y}var q2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function VE(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Xg(e,a,t){var i=we(8),s=[],c=[],f=8,d=0,h=we(8),m=we(8);if(h.write_shift(4,2),h.write_shift(4,1200),m.write_shift(4,1),c.push(h),s.push(m),f+=8+h.length,!a){m=we(8),m.write_shift(4,0),s.unshift(m);var p=[we(4)];for(p[0].write_shift(4,e.length),d=0;d<e.length;++d){var v=e[d][0];for(h=we(8+2*(v.length+1)+(v.length%2?0:2)),h.write_shift(4,d+2),h.write_shift(4,v.length+1),h.write_shift(0,v,"dbcs");h.l!=h.length;)h.write_shift(1,0);p.push(h)}h=ka(p),c.unshift(h),f+=8+h.length}for(d=0;d<e.length;++d)if(!(a&&!a[e[d][0]])&&!(q2.indexOf(e[d][0])>-1||z2.indexOf(e[d][0])>-1)&&e[d][1]!=null){var y=e[d][1],_=0;if(a){_=+a[e[d][0]];var w=t[_];if(w.p=="version"&&typeof y=="string"){var b=y.split(".");y=(+b[0]<<16)+(+b[1]||0)}h=Vg(w.t,y)}else{var T=VE(y);T==-1&&(T=31,y=String(y)),h=Vg(T,y)}c.push(h),m=we(8),m.write_shift(4,a?_:2+d),s.push(m),f+=8+h.length}var C=8*(c.length+1);for(d=0;d<c.length;++d)s[d].write_shift(4,C),C+=c[d].length;return i.write_shift(4,f),i.write_shift(4,c.length),ka([i].concat(s).concat(c))}function Yg(e,a,t){var i=e.content;if(!i)return{};Ma(i,0);var s,c,f,d,h=0;i.chk("feff","Byte Order: "),i.read_shift(2);var m=i.read_shift(4),p=i.read_shift(16);if(p!==Ye.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(s=i.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(c=i.read_shift(16),d=i.read_shift(4),s===1&&d!==i.l)throw new Error("Length mismatch: "+d+" !== "+i.l);s===2&&(f=i.read_shift(16),h=i.read_shift(4));var v=Gg(i,a),y={SystemIdentifier:m};for(var _ in v)y[_]=v[_];if(y.FMTID=c,s===1)return y;if(h-i.l==2&&(i.l+=2),i.l!==h)throw new Error("Length mismatch 2: "+i.l+" !== "+h);var w;try{w=Gg(i,null)}catch{}for(_ in w)y[_]=w[_];return y.FMTID=[c,f],y}function Wg(e,a,t,i,s,c){var f=we(s?68:48),d=[f];f.write_shift(2,65534),f.write_shift(2,0),f.write_shift(4,842412599),f.write_shift(16,Ye.utils.consts.HEADER_CLSID,"hex"),f.write_shift(4,s?2:1),f.write_shift(16,a,"hex"),f.write_shift(4,s?68:48);var h=Xg(e,t,i);if(d.push(h),s){var m=Xg(s,null,null);f.write_shift(16,c,"hex"),f.write_shift(4,68+h.length),d.push(m)}return ka(d)}function Ti(e,a){return e.read_shift(a),null}function GE(e,a){a||(a=we(e));for(var t=0;t<e;++t)a.write_shift(1,0);return a}function XE(e,a,t){for(var i=[],s=e.l+a;e.l<s;)i.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return i}function ca(e,a){return e.read_shift(a)===1}function Qa(e,a){return a||(a=we(2)),a.write_shift(2,+!!e),a}function ga(e){return e.read_shift(2,"u")}function Gr(e,a){return a||(a=we(2)),a.write_shift(2,e),a}function K2(e,a){return XE(e,a,ga)}function YE(e){var a=e.read_shift(1),t=e.read_shift(1);return t===1?a:a===1}function Z2(e,a,t){return t||(t=we(2)),t.write_shift(1,a=="e"?+e:+!!e),t.write_shift(1,a=="e"?1:0),t}function t0(e,a,t){var i=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var c=e.read_shift(1);c&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var f=i?e.read_shift(i,s):"";return f}function WE(e){var a=e.read_shift(2),t=e.read_shift(1),i=t&4,s=t&8,c=1+(t&1),f=0,d,h={};s&&(f=e.read_shift(2)),i&&(d=e.read_shift(4));var m=c==2?"dbcs-cont":"sbcs-cont",p=a===0?"":e.read_shift(a,m);return s&&(e.l+=4*f),i&&(e.l+=d),h.t=p,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function qE(e){var a=e.t||"",t=we(3);t.write_shift(2,a.length),t.write_shift(1,1);var i=we(2*a.length);i.write_shift(2*a.length,a,"utf16le");var s=[t,i];return ka(s)}function xs(e,a,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(a,"cpstr");if(t.biff>=12)return e.read_shift(a,"dbcs-cont")}var s=e.read_shift(1);return s===0?i=e.read_shift(a,"sbcs-cont"):i=e.read_shift(a,"dbcs-cont"),i}function a0(e,a,t){var i=e.read_shift(t&&t.biff==2?1:2);return i===0?(e.l++,""):xs(e,i,t)}function Ss(e,a,t){if(t.biff>5)return a0(e,a,t);var i=e.read_shift(1);return i===0?(e.l++,""):e.read_shift(i,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function $2(e,a,t){return t||(t=we(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function KE(e){var a=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[a,t]}function ZE(e){var a=e.read_shift(4),t=e.l,i=!1;a>24&&(e.l+=a-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),e.l=t);var s=e.read_shift((i?a-24:a)>>1,"utf16le").replace(Ja,"");return i&&(e.l+=24),s}function $E(e){for(var a=e.read_shift(2),t="";a-- >0;)t+="../";var i=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return t+i.replace(/\\/g,"/");var c=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var f=e.read_shift(c>>1,"utf16le").replace(Ja,"");return t+f}function QE(e,a){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return ZE(e);case"0303000000000000c000000000000046":return $E(e);default:throw new Error("Unsupported Moniker "+t)}}function Ao(e){var a=e.read_shift(4),t=a>0?e.read_shift(a,"utf16le").replace(Ja,""):"";return t}function qg(e,a){a||(a=we(6+e.length*2)),a.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)a.write_shift(2,e.charCodeAt(t));return a.write_shift(2,0),a}function JE(e,a){var t=e.l+a,i=e.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var s=e.read_shift(2);e.l+=2;var c,f,d,h,m="",p,v;s&16&&(c=Ao(e,t-e.l)),s&128&&(f=Ao(e,t-e.l)),(s&257)===257&&(d=Ao(e,t-e.l)),(s&257)===1&&(h=QE(e,t-e.l)),s&8&&(m=Ao(e,t-e.l)),s&32&&(p=e.read_shift(16)),s&64&&(v=Fh(e)),e.l=t;var y=f||d||h||"";y&&m&&(y+="#"+m),y||(y="#"+m),s&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var _={Target:y};return p&&(_.guid=p),v&&(_.time=v),c&&(_.Tooltip=c),_}function eT(e){var a=we(512),t=0,i=e.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var s=i.indexOf("#"),c=s>-1?31:23;switch(i.charAt(0)){case"#":c=28;break;case".":c&=-3;break}a.write_shift(4,2),a.write_shift(4,c);var f=[8,6815827,6619237,4849780,83];for(t=0;t<f.length;++t)a.write_shift(4,f[t]);if(c==28)i=i.slice(1),qg(i,a);else if(c&2){for(f="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<f.length;++t)a.write_shift(1,parseInt(f[t],16));var d=s>-1?i.slice(0,s):i;for(a.write_shift(4,2*(d.length+1)),t=0;t<d.length;++t)a.write_shift(2,d.charCodeAt(t));a.write_shift(2,0),c&8&&qg(s>-1?i.slice(s+1):"",a)}else{for(f="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<f.length;++t)a.write_shift(1,parseInt(f[t],16));for(var h=0;i.slice(h*3,h*3+3)=="../"||i.slice(h*3,h*3+3)=="..\\";)++h;for(a.write_shift(2,h),a.write_shift(4,i.length-3*h+1),t=0;t<i.length-3*h;++t)a.write_shift(1,i.charCodeAt(t+3*h)&255);for(a.write_shift(1,0),a.write_shift(2,65535),a.write_shift(2,57005),t=0;t<6;++t)a.write_shift(4,0)}return a.slice(0,a.l)}function Q2(e){var a=e.read_shift(1),t=e.read_shift(1),i=e.read_shift(1),s=e.read_shift(1);return[a,t,i,s]}function J2(e,a){var t=Q2(e);return t[3]=0,t}function wn(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2);return{r:a,c:t,ixfe:i}}function ps(e,a,t,i){return i||(i=we(6)),i.write_shift(2,e),i.write_shift(2,a),i.write_shift(2,t||0),i}function tT(e){var a=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:a,flags:t}}function aT(e,a,t){return a===0?"":Ss(e,a,t)}function rT(e,a,t){var i=t.biff>8?4:2,s=e.read_shift(i),c=e.read_shift(i,"i"),f=e.read_shift(i,"i");return[s,c,f]}function ey(e){var a=e.read_shift(2),t=Ch(e);return[a,t]}function nT(e,a,t){e.l+=4,a-=4;var i=e.l+a,s=t0(e,a,t),c=e.read_shift(2);if(i-=e.l,c!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+c);return e.l+=c,s}function rf(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);return{s:{c:i,r:a},e:{c:s,r:t}}}function ty(e,a){return a||(a=we(8)),a.write_shift(2,e.s.r),a.write_shift(2,e.e.r),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c),a}function ay(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1);return{s:{c:i,r:a},e:{c:s,r:t}}}var iT=ay;function ry(e){e.l+=4;var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2);return e.l+=12,[t,a,i]}function sT(e){var a={};return e.l+=4,e.l+=16,a.fSharedNote=e.read_shift(2),e.l+=4,a}function lT(e){var a={};return e.l+=4,e.cf=e.read_shift(2),a}function Pa(e){e.l+=2,e.l+=e.read_shift(2)}var cT={0:Pa,4:Pa,5:Pa,6:Pa,7:lT,8:Pa,9:Pa,10:Pa,11:Pa,12:Pa,13:sT,14:Pa,15:Pa,16:Pa,17:Pa,18:Pa,19:Pa,20:Pa,21:ry};function oT(e,a){for(var t=e.l+a,i=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{i.push(cT[s](e,t-e.l))}catch{return e.l=t,i}}return e.l!=t&&(e.l=t),i}function ko(e,a){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),a-=2,a>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(a>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(a),t}function Oh(e,a,t){var i=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,s=8;break;case"biff4":i=4,s=6;break;case"biff3":i=3,s=6;break;case"biff2":i=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=we(s);return c.write_shift(2,i),c.write_shift(2,a),s>4&&c.write_shift(2,29282),s>6&&c.write_shift(2,1997),s>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function fT(e,a){return a===0||e.read_shift(2),1200}function uT(e,a,t){if(t.enc)return e.l+=a,"";var i=e.l,s=Ss(e,0,t);return e.read_shift(a+i-e.l),s}function dT(e,a){var t=!a||a.biff==8,i=we(t?112:54);for(i.write_shift(a.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function hT(e,a,t){var i=t&&t.biff==8||a==2?e.read_shift(2):(e.l+=a,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function mT(e,a,t){var i=e.read_shift(4),s=e.read_shift(1)&3,c=e.read_shift(1);switch(c){case 0:c="Worksheet";break;case 1:c="Macrosheet";break;case 2:c="Chartsheet";break;case 6:c="VBAModule";break}var f=t0(e,0,t);return f.length===0&&(f="Sheet1"),{pos:i,hs:s,dt:c,name:f}}function xT(e,a){var t=!a||a.biff>=8?2:1,i=we(8+t*e.name.length);i.write_shift(4,e.pos),i.write_shift(1,e.hs||0),i.write_shift(1,e.dt),i.write_shift(1,e.name.length),a.biff>=8&&i.write_shift(1,1),i.write_shift(t*e.name.length,e.name,a.biff<8?"sbcs":"utf16le");var s=i.slice(0,i.l);return s.l=i.l,s}function pT(e,a){for(var t=e.l+a,i=e.read_shift(4),s=e.read_shift(4),c=[],f=0;f!=s&&e.l<t;++f)c.push(WE(e));return c.Count=i,c.Unique=s,c}function gT(e,a){var t=we(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var i=[],s=0;s<e.length;++s)i[s]=qE(e[s]);var c=ka([t].concat(i));return c.parts=[t.length].concat(i.map(function(f){return f.length})),c}function vT(e,a){var t={};return t.dsst=e.read_shift(2),e.l+=a-2,t}function yT(e){var a={};a.r=e.read_shift(2),a.c=e.read_shift(2),a.cnt=e.read_shift(2)-a.c;var t=e.read_shift(2);e.l+=4;var i=e.read_shift(1);return e.l+=3,i&7&&(a.level=i&7),i&32&&(a.hidden=!0),i&64&&(a.hpt=t/20),a}function _T(e){var a=tT(e);if(a.type!=2211)throw new Error("Invalid Future Record "+a.type);var t=e.read_shift(4);return t!==0}function bT(e){return e.read_shift(2),e.read_shift(4)}function Kg(e,a,t){var i=0;t&&t.biff==2||(i=e.read_shift(2));var s=e.read_shift(2);t&&t.biff==2&&(i=1-(s>>15),s&=32767);var c={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[c,s]}function wT(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2),m=e.read_shift(2);return{Pos:[a,t],Dim:[i,s],Flags:c,CurTab:f,FirstTab:d,Selected:h,TabRatio:m}}function ST(){var e=we(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function ET(e,a,t){if(t&&t.biff>=2&&t.biff<5)return{};var i=e.read_shift(2);return{RTL:i&64}}function TT(e){var a=we(18),t=1718;return e&&e.RTL&&(t|=64),a.write_shift(2,t),a.write_shift(4,0),a.write_shift(4,64),a.write_shift(4,0),a.write_shift(4,0),a}function NT(){}function AT(e,a,t){var i={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return i.name=t0(e,0,t),i}function kT(e,a){var t=e.name||"Arial",i=a&&a.biff==5,s=i?15+t.length:16+2*t.length,c=we(s);return c.write_shift(2,e.sz*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,t.length),i||c.write_shift(1,1),c.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),c}function CT(e){var a=wn(e);return a.isst=e.read_shift(4),a}function DT(e,a,t,i){var s=we(10);return ps(e,a,i,s),s.write_shift(4,t),s}function jT(e,a,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=e.l+a,s=wn(e);t.biff==2&&e.l++;var c=a0(e,i-e.l,t);return s.val=c,s}function FT(e,a,t,i,s){var c=!s||s.biff==8,f=we(8+ +c+(1+c)*t.length);return ps(e,a,i,f),f.write_shift(2,t.length),c&&f.write_shift(1,1),f.write_shift((1+c)*t.length,t,c?"utf16le":"sbcs"),f}function OT(e,a,t){var i=e.read_shift(2),s=Ss(e,0,t);return[i,s]}function RT(e,a,t,i){var s=t&&t.biff==5;i||(i=we(s?3+a.length:5+2*a.length)),i.write_shift(2,e),i.write_shift(s?1:2,a.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*a.length,a,s?"sbcs":"utf16le");var c=i.length>i.l?i.slice(0,i.l):i;return c.l==null&&(c.l=c.length),c}var MT=Ss;function Zg(e,a,t){var i=e.l+a,s=t.biff==8||!t.biff?4:2,c=e.read_shift(s),f=e.read_shift(s),d=e.read_shift(2),h=e.read_shift(2);return e.l=i,{s:{r:c,c:d},e:{r:f,c:h}}}function LT(e,a){var t=a.biff==8||!a.biff?4:2,i=we(2*t+6);return i.write_shift(t,e.s.r),i.write_shift(t,e.e.r+1),i.write_shift(2,e.s.c),i.write_shift(2,e.e.c+1),i.write_shift(2,0),i}function IT(e){var a=e.read_shift(2),t=e.read_shift(2),i=ey(e);return{r:a,c:t,ixfe:i[0],rknum:i[1]}}function BT(e,a){for(var t=e.l+a-2,i=e.read_shift(2),s=e.read_shift(2),c=[];e.l<t;)c.push(ey(e));if(e.l!==t)throw new Error("MulRK read error");var f=e.read_shift(2);if(c.length!=f-s+1)throw new Error("MulRK length mismatch");return{r:i,c:s,C:f,rkrec:c}}function UT(e,a){for(var t=e.l+a-2,i=e.read_shift(2),s=e.read_shift(2),c=[];e.l<t;)c.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var f=e.read_shift(2);if(c.length!=f-s+1)throw new Error("MulBlank length mismatch");return{r:i,c:s,C:f,ixfe:c}}function zT(e,a,t,i){var s={},c=e.read_shift(4),f=e.read_shift(4),d=e.read_shift(4),h=e.read_shift(2);return s.patternType=_E[d>>26],i.cellStyles&&(s.alc=c&7,s.fWrap=c>>3&1,s.alcV=c>>4&7,s.fJustLast=c>>7&1,s.trot=c>>8&255,s.cIndent=c>>16&15,s.fShrinkToFit=c>>20&1,s.iReadOrder=c>>22&2,s.fAtrNum=c>>26&1,s.fAtrFnt=c>>27&1,s.fAtrAlc=c>>28&1,s.fAtrBdr=c>>29&1,s.fAtrPat=c>>30&1,s.fAtrProt=c>>31&1,s.dgLeft=f&15,s.dgRight=f>>4&15,s.dgTop=f>>8&15,s.dgBottom=f>>12&15,s.icvLeft=f>>16&127,s.icvRight=f>>23&127,s.grbitDiag=f>>30&3,s.icvTop=d&127,s.icvBottom=d>>7&127,s.icvDiag=d>>14&127,s.dgDiag=d>>21&15,s.icvFore=h&127,s.icvBack=h>>7&127,s.fsxButton=h>>14&1),s}function PT(e,a,t){var i={};return i.ifnt=e.read_shift(2),i.numFmtId=e.read_shift(2),i.flags=e.read_shift(2),i.fStyle=i.flags>>2&1,a-=6,i.data=zT(e,a,i.fStyle,t),i}function $g(e,a,t,i){var s=t&&t.biff==5;i||(i=we(s?16:20)),i.write_shift(2,0),e.style?(i.write_shift(2,e.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,e.numFmtId||0),i.write_shift(2,a<<4));var c=0;return e.numFmtId>0&&s&&(c|=1024),i.write_shift(4,c),i.write_shift(4,0),s||i.write_shift(4,0),i.write_shift(2,0),i}function HT(e){e.l+=4;var a=[e.read_shift(2),e.read_shift(2)];if(a[0]!==0&&a[0]--,a[1]!==0&&a[1]--,a[0]>7||a[1]>7)throw new Error("Bad Gutters: "+a.join("|"));return a}function VT(e){var a=we(8);return a.write_shift(4,0),a.write_shift(2,0),a.write_shift(2,0),a}function Qg(e,a,t){var i=wn(e);(t.biff==2||a==9)&&++e.l;var s=YE(e);return i.val=s,i.t=s===!0||s===!1?"b":"e",i}function GT(e,a,t,i,s,c){var f=we(8);return ps(e,a,i,f),Z2(t,c,f),f}function XT(e,a,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=wn(e),s=Xa(e);return i.val=s,i}function YT(e,a,t,i){var s=we(14);return ps(e,a,i,s),ms(t,s),s}var Jg=aT;function WT(e,a,t){var i=e.l+a,s=e.read_shift(2),c=e.read_shift(2);if(t.sbcch=c,c==1025||c==14849)return[c,s];if(c<1||c>255)throw new Error("Unexpected SupBook type: "+c);for(var f=xs(e,c),d=[];i>e.l;)d.push(a0(e));return[c,s,f,d]}function ev(e,a,t){var i=e.read_shift(2),s,c={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return t.sbcch===14849&&(s=nT(e,a-2,t)),c.body=s||e.read_shift(a-2),typeof s=="string"&&(c.Name=s),c}var qT=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function tv(e,a,t){var i=e.l+a,s=e.read_shift(2),c=e.read_shift(1),f=e.read_shift(1),d=e.read_shift(t&&t.biff==2?1:2),h=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),h=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var m=xs(e,f,t);s&32&&(m=qT[m.charCodeAt(0)]);var p=i-e.l;t&&t.biff==2&&--p;var v=i==e.l||d===0||!(p>0)?[]:oC(e,p,t,d);return{chKey:c,Name:m,itab:h,rgce:v}}function ny(e,a,t){if(t.biff<8)return KT(e,a,t);for(var i=[],s=e.l+a,c=e.read_shift(t.biff>8?4:2);c--!==0;)i.push(rT(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return i}function KT(e,a,t){e[e.l+1]==3&&e[e.l]++;var i=t0(e,a,t);return i.charCodeAt(0)==3?i.slice(1):i}function ZT(e,a,t){if(t.biff<8){e.l+=a;return}var i=e.read_shift(2),s=e.read_shift(2),c=xs(e,i,t),f=xs(e,s,t);return[c,f]}function $T(e,a,t){var i=ay(e);e.l++;var s=e.read_shift(1);return a-=8,[fC(e,a,t),s,i]}function av(e,a,t){var i=iT(e);switch(t.biff){case 2:e.l++,a-=7;break;case 3:case 4:e.l+=2,a-=8;break;default:e.l+=6,a-=12}return[i,lC(e,a,t)]}function QT(e){var a=e.read_shift(4)!==0,t=e.read_shift(4)!==0,i=e.read_shift(4);return[a,t,i]}function JT(e,a,t){if(!(t.biff<8)){var i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),d=Ss(e,0,t);return t.biff<8&&e.read_shift(1),[{r:i,c:s},d,f,c]}}function e3(e,a,t){return JT(e,a,t)}function t3(e,a){for(var t=[],i=e.read_shift(2);i--;)t.push(rf(e));return t}function a3(e){var a=we(2+e.length*8);a.write_shift(2,e.length);for(var t=0;t<e.length;++t)ty(e[t],a);return a}function r3(e,a,t){if(t&&t.biff<8)return i3(e,a,t);var i=ry(e),s=oT(e,a-22,i[1]);return{cmo:i,ft:s}}var n3={8:function(e,a){var t=e.l+a;e.l+=10;var i=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:i}}};function i3(e,a,t){e.l+=4;var i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,a-=36;var f=[];return f.push((n3[i]||Wa)(e,a,t)),{cmo:[s,i,c],ft:f}}function s3(e,a,t){var i=e.l,s="";try{e.l+=4;var c=(t.lastobj||{cmo:[0,0]}).cmo[1],f;[0,5,7,11,12,14].indexOf(c)==-1?e.l+=6:f=KE(e,6,t);var d=e.read_shift(2);e.read_shift(2),ga(e,2);var h=e.read_shift(2);e.l+=h;for(var m=1;m<e.lens.length-1;++m){if(e.l-i!=e.lens[m])throw new Error("TxO: bad continue record");var p=e[e.l],v=xs(e,e.lens[m+1]-e.lens[m]-1);if(s+=v,s.length>=(p?d:2*d))break}if(s.length!==d&&s.length!==d*2)throw new Error("cchText: "+d+" != "+s.length);return e.l=i+a,{t:s}}catch{return e.l=i+a,{t:s}}}function l3(e,a){var t=rf(e);e.l+=16;var i=JE(e,a-24);return[t,i]}function c3(e){var a=we(24),t=qt(e[0]);a.write_shift(2,t.r),a.write_shift(2,t.r),a.write_shift(2,t.c),a.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)a.write_shift(1,parseInt(i[s],16));return ka([a,eT(e[1])])}function o3(e,a){e.read_shift(2);var t=rf(e),i=e.read_shift((a-10)/2,"dbcs-cont");return i=i.replace(Ja,""),[t,i]}function f3(e){var a=e[1].Tooltip,t=we(10+2*(a.length+1));t.write_shift(2,2048);var i=qt(e[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var s=0;s<a.length;++s)t.write_shift(2,a.charCodeAt(s));return t.write_shift(2,0),t}function u3(e){var a=[0,0],t;return t=e.read_shift(2),a[0]=zg[t]||t,t=e.read_shift(2),a[1]=zg[t]||t,a}function d3(e){return e||(e=we(4)),e.write_shift(2,1),e.write_shift(2,1),e}function h3(e){for(var a=e.read_shift(2),t=[];a-- >0;)t.push(J2(e));return t}function m3(e){for(var a=e.read_shift(2),t=[];a-- >0;)t.push(J2(e));return t}function x3(e){e.l+=2;var a={cxfs:0,crc:0};return a.cxfs=e.read_shift(2),a.crc=e.read_shift(4),a}function iy(e,a,t){if(!t.cellStyles)return Wa(e,a);var i=t&&t.biff>=12?4:2,s=e.read_shift(i),c=e.read_shift(i),f=e.read_shift(i),d=e.read_shift(i),h=e.read_shift(2);i==2&&(e.l+=2);var m={s,e:c,w:f,ixfe:d,flags:h};return(t.biff>=5||!t.biff)&&(m.level=h>>8&7),m}function p3(e,a){var t=we(12);t.write_shift(2,a),t.write_shift(2,a),t.write_shift(2,e.width*256),t.write_shift(2,0);var i=0;return e.hidden&&(i|=1),t.write_shift(1,i),i=e.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function g3(e,a){var t={};return a<32||(e.l+=16,t.header=Xa(e),t.footer=Xa(e),e.l+=2),t}function v3(e,a,t){var i={area:!1};if(t.biff!=5)return e.l+=a,i;var s=e.read_shift(1);return e.l+=3,s&16&&(i.area=!0),i}function y3(e){for(var a=we(2*e),t=0;t<e;++t)a.write_shift(2,t+1);return a}var _3=wn,b3=K2,w3=a0;function S3(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(4),s={fmt:a,env:t,len:i,data:e.slice(e.l,e.l+i)};return e.l+=i,s}function E3(e,a,t){t.biffguess&&t.biff==5&&(t.biff=2);var i=wn(e);++e.l;var s=Ss(e,a-7,t);return i.t="str",i.val=s,i}function T3(e){var a=wn(e);++e.l;var t=Xa(e);return a.t="n",a.val=t,a}function N3(e,a,t){var i=we(15);return s0(i,e,a),i.write_shift(8,t,"f"),i}function A3(e){var a=wn(e);++e.l;var t=e.read_shift(2);return a.t="n",a.val=t,a}function k3(e,a,t){var i=we(9);return s0(i,e,a),i.write_shift(2,t),i}function C3(e){var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,"sbcs-cont")}function D3(e,a){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=a-13}function j3(e,a,t){var i=e.l+a,s=wn(e),c=e.read_shift(2),f=xs(e,c,t);return e.l=i,s.t="str",s.val=f,s}var F3=[2,3,48,49,131,139,140,245],nh=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},a=ef({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(d,h){var m=[],p=ki(1);switch(h.type){case"base64":p=Er(Nr(d));break;case"binary":p=Er(d);break;case"buffer":case"array":p=d;break}Ma(p,0);var v=p.read_shift(1),y=!!(v&136),_=!1,w=!1;switch(v){case 2:break;case 3:break;case 48:_=!0,y=!0;break;case 49:_=!0,y=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var b=0,T=521;v==2&&(b=p.read_shift(2)),p.l+=3,v!=2&&(b=p.read_shift(4)),b>1048576&&(b=1e6),v!=2&&(T=p.read_shift(2));var C=p.read_shift(2),L=h.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(L=e[p[p.l]]),p.l+=1,p.l+=2),w&&(p.l+=36);for(var N=[],j={},V=Math.min(p.length,v==2?521:T-10-(_?264:0)),M=w?32:11;p.l<V&&p[p.l]!=13;)switch(j={},j.name=Uc.utils.decode(L,p.slice(p.l,p.l+M)).replace(/[\u0000\r\n].*$/g,""),p.l+=M,j.type=String.fromCharCode(p.read_shift(1)),v!=2&&!w&&(j.offset=p.read_shift(4)),j.len=p.read_shift(1),v==2&&(j.offset=p.read_shift(2)),j.dec=p.read_shift(1),j.name.length&&N.push(j),v!=2&&(p.l+=w?13:14),j.type){case"B":(!_||j.len!=8)&&h.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(p[p.l]!==13&&(p.l=T-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=T;var k=0,W=0;for(m[0]=[],W=0;W!=N.length;++W)m[0][W]=N[W].name;for(;b-- >0;){if(p[p.l]===42){p.l+=C;continue}for(++p.l,m[++k]=[],W=0,W=0;W!=N.length;++W){var K=p.slice(p.l,p.l+N[W].len);p.l+=N[W].len,Ma(K,0);var J=Uc.utils.decode(L,K);switch(N[W].type){case"C":J.trim().length&&(m[k][W]=J.replace(/\s+$/,""));break;case"D":J.length===8?m[k][W]=new Date(+J.slice(0,4),+J.slice(4,6)-1,+J.slice(6,8)):m[k][W]=J;break;case"F":m[k][W]=parseFloat(J.trim());break;case"+":case"I":m[k][W]=w?K.read_shift(-4,"i")^2147483648:K.read_shift(4,"i");break;case"L":switch(J.trim().toUpperCase()){case"Y":case"T":m[k][W]=!0;break;case"N":case"F":m[k][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+J+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[k][W]="##MEMO##"+(w?parseInt(J.trim(),10):K.read_shift(4));break;case"N":J=J.replace(/\u0000/g,"").trim(),J&&J!="."&&(m[k][W]=+J||0);break;case"@":m[k][W]=new Date(K.read_shift(-8,"f")-621356832e5);break;case"T":m[k][W]=new Date((K.read_shift(4)-2440588)*864e5+K.read_shift(4));break;case"Y":m[k][W]=K.read_shift(4,"i")/1e4+K.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[k][W]=-K.read_shift(-8,"f");break;case"B":if(_&&N[W].len==8){m[k][W]=K.read_shift(8,"f");break}case"G":case"P":K.l+=N[W].len;break;case"0":if(N[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[W].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),h.DBF=N,m}function i(d,h){var m=h||{};m.dateNF||(m.dateNF="yyyymmdd");var p=Sl(t(d,m),m);return p["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,p}function s(d,h){try{return Mi(i(d,h),h)}catch(m){if(h&&h.WTF)throw m}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function f(d,h){var m=h||{};if(+m.codepage>=0&&rn(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=ur(),v=$o(d,{header:1,raw:!0,cellDates:!0}),y=v[0],_=v.slice(1),w=d["!cols"]||[],b=0,T=0,C=0,L=1;for(b=0;b<y.length;++b){if(((w[b]||{}).DBF||{}).name){y[b]=w[b].DBF.name,++C;continue}if(y[b]!=null){if(++C,typeof y[b]=="number"&&(y[b]=y[b].toString(10)),typeof y[b]!="string")throw new Error("DBF Invalid column name "+y[b]+" |"+typeof y[b]+"|");if(y.indexOf(y[b])!==b){for(T=0;T<1024;++T)if(y.indexOf(y[b]+"_"+T)==-1){y[b]+="_"+T;break}}}}var N=St(d["!ref"]),j=[],V=[],M=[];for(b=0;b<=N.e.c-N.s.c;++b){var k="",W="",K=0,J=[];for(T=0;T<_.length;++T)_[T][b]!=null&&J.push(_[T][b]);if(J.length==0||y[b]==null){j[b]="?";continue}for(T=0;T<J.length;++T){switch(typeof J[T]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=J[T]instanceof Date?"D":"C";break;default:W="C"}K=Math.max(K,String(J[T]).length),k=k&&k!=W?"C":W}K>250&&(K=250),W=((w[b]||{}).DBF||{}).type,W=="C"&&w[b].DBF.len>K&&(K=w[b].DBF.len),k=="B"&&W=="N"&&(k="N",M[b]=w[b].DBF.dec,K=w[b].DBF.len),V[b]=k=="C"||W=="N"?K:c[k]||0,L+=V[b],j[b]=k}var Z=p.next(32);for(Z.write_shift(4,318902576),Z.write_shift(4,_.length),Z.write_shift(2,296+32*C),Z.write_shift(2,L),b=0;b<4;++b)Z.write_shift(4,0);for(Z.write_shift(4,0|(+a[qv]||3)<<8),b=0,T=0;b<y.length;++b)if(y[b]!=null){var Q=p.next(32),re=(y[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Q.write_shift(1,re,"sbcs"),Q.write_shift(1,j[b]=="?"?"C":j[b],"sbcs"),Q.write_shift(4,T),Q.write_shift(1,V[b]||c[j[b]]||0),Q.write_shift(1,M[b]||0),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(1,0),Q.write_shift(4,0),Q.write_shift(4,0),T+=V[b]||c[j[b]]||0}var ue=p.next(264);for(ue.write_shift(4,13),b=0;b<65;++b)ue.write_shift(4,0);for(b=0;b<_.length;++b){var ve=p.next(L);for(ve.write_shift(1,0),T=0;T<y.length;++T)if(y[T]!=null)switch(j[T]){case"L":ve.write_shift(1,_[b][T]==null?63:_[b][T]?84:70);break;case"B":ve.write_shift(8,_[b][T]||0,"f");break;case"N":var ee="0";for(typeof _[b][T]=="number"&&(ee=_[b][T].toFixed(M[T]||0)),C=0;C<V[T]-ee.length;++C)ve.write_shift(1,32);ve.write_shift(1,ee,"sbcs");break;case"D":_[b][T]?(ve.write_shift(4,("0000"+_[b][T].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(_[b][T].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+_[b][T].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var G=String(_[b][T]!=null?_[b][T]:"").slice(0,V[T]);for(ve.write_shift(1,G,"sbcs"),C=0;C<V[T]-G.length;++C)ve.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:i,from_sheet:f}})(),sy=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},a=new RegExp("\x1BN("+ra(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(y,_){var w=e[_];return typeof w=="number"?hg(w):w},i=function(y,_,w){var b=_.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?y:hg(b)};e["|"]=254;function s(y,_){switch(_.type){case"base64":return c(Nr(y),_);case"binary":return c(y,_);case"buffer":return c(ot&&Buffer.isBuffer(y)?y.toString("binary"):Ri(y),_);case"array":return c(hs(y),_)}throw new Error("Unrecognized type "+_.type)}function c(y,_){var w=y.split(/[\n\r]+/),b=-1,T=-1,C=0,L=0,N=[],j=[],V=null,M={},k=[],W=[],K=[],J=0,Z;for(+_.codepage>=0&&rn(+_.codepage);C!==w.length;++C){J=0;var Q=w[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(a,t),re=Q.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),ue=re[0],ve;if(Q.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":re[1].charAt(0)=="P"&&j.push(Q.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,G=!1,ae=!1,R=!1,se=-1,A=-1;for(L=1;L<re.length;++L)switch(re[L].charAt(0)){case"A":break;case"X":T=parseInt(re[L].slice(1))-1,G=!0;break;case"Y":for(b=parseInt(re[L].slice(1))-1,G||(T=0),Z=N.length;Z<=b;++Z)N[Z]=[];break;case"K":ve=re[L].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(sn(ve))?isNaN(gl(ve).getDate())||(ve=Gt(ve)):(ve=sn(ve),V!==null&&bl(V)&&(ve=af(ve))),ee=!0;break;case"E":R=!0;var E=xl(re[L].slice(1),{r:b,c:T});N[b][T]=[N[b][T],E];break;case"S":ae=!0,N[b][T]=[N[b][T],"S5S"];break;case"G":break;case"R":se=parseInt(re[L].slice(1))-1;break;case"C":A=parseInt(re[L].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}if(ee&&(N[b][T]&&N[b][T].length==2?N[b][T][0]=ve:N[b][T]=ve,V=null),ae){if(R)throw new Error("SYLK shared formula cannot have own formula");var O=se>-1&&N[se][A];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");N[b][T][1]=Ey(O[1],{r:b-se,c:T-A})}break;case"F":var B=0;for(L=1;L<re.length;++L)switch(re[L].charAt(0)){case"X":T=parseInt(re[L].slice(1))-1,++B;break;case"Y":for(b=parseInt(re[L].slice(1))-1,Z=N.length;Z<=b;++Z)N[Z]=[];break;case"M":J=parseInt(re[L].slice(1))/20;break;case"F":break;case"G":break;case"P":V=j[parseInt(re[L].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(K=re[L].slice(1).split(" "),Z=parseInt(K[0],10);Z<=parseInt(K[1],10);++Z)J=parseInt(K[2],10),W[Z-1]=J===0?{hidden:!0}:{wch:J},Ci(W[Z-1]);break;case"C":T=parseInt(re[L].slice(1))-1,W[T]||(W[T]={});break;case"R":b=parseInt(re[L].slice(1))-1,k[b]||(k[b]={}),J>0?(k[b].hpt=J,k[b].hpx=yl(J)):J===0&&(k[b].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}B<1&&(V=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}}return k.length>0&&(M["!rows"]=k),W.length>0&&(M["!cols"]=W),_&&_.sheetRows&&(N=N.slice(0,_.sheetRows)),[N,M]}function f(y,_){var w=s(y,_),b=w[0],T=w[1],C=Sl(b,_);return ra(T).forEach(function(L){C[L]=T[L]}),C}function d(y,_){return Mi(f(y,_),_)}function h(y,_,w,b){var T="C;Y"+(w+1)+";X"+(b+1)+";K";switch(y.t){case"n":T+=y.v||0,y.f&&!y.F&&(T+=";E"+Uh(y.f,{r:w,c:b}));break;case"b":T+=y.v?"TRUE":"FALSE";break;case"e":T+=y.w||y.v;break;case"d":T+='"'+(y.w||y.v)+'"';break;case"s":T+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function m(y,_){_.forEach(function(w,b){var T="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?T+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Wc(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=qc(w.wpx)),typeof w.wch=="number"&&(T+=Math.round(w.wch))),T.charAt(T.length-1)!=" "&&y.push(T)})}function p(y,_){_.forEach(function(w,b){var T="F;";w.hidden?T+="M0;":w.hpt?T+="M"+20*w.hpt+";":w.hpx&&(T+="M"+20*Kc(w.hpx)+";"),T.length>2&&y.push(T+"R"+(b+1))})}function v(y,_){var w=["ID;PWXL;N;E"],b=[],T=St(y["!ref"]),C,L=Array.isArray(y),N=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),y["!cols"]&&m(w,y["!cols"]),y["!rows"]&&p(w,y["!rows"]),w.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var j=T.s.r;j<=T.e.r;++j)for(var V=T.s.c;V<=T.e.c;++V){var M=$e({r:j,c:V});C=L?(y[j]||[])[V]:y[M],!(!C||C.v==null&&(!C.f||C.F))&&b.push(h(C,y,j,V))}return w.join(N)+N+b.join(N)+N+"E"+N}return{to_workbook:d,to_sheet:f,from_sheet:v}})(),ly=(function(){function e(c,f){switch(f.type){case"base64":return a(Nr(c),f);case"binary":return a(c,f);case"buffer":return a(ot&&Buffer.isBuffer(c)?c.toString("binary"):Ri(c),f);case"array":return a(hs(c),f)}throw new Error("Unrecognized type "+f.type)}function a(c,f){for(var d=c.split(`
`),h=-1,m=-1,p=0,v=[];p!==d.length;++p){if(d[p].trim()==="BOT"){v[++h]=[],m=0;continue}if(!(h<0)){var y=d[p].trim().split(","),_=y[0],w=y[1];++p;for(var b=d[p]||"";(b.match(/["]/g)||[]).length&1&&p<d.length-1;)b+=`
`+d[++p];switch(b=b.trim(),+_){case-1:if(b==="BOT"){v[++h]=[],m=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?v[h][m]=!0:b==="FALSE"?v[h][m]=!1:isNaN(sn(w))?isNaN(gl(w).getDate())?v[h][m]=w:v[h][m]=Gt(w):v[h][m]=sn(w),++m;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),v[h][m++]=b!==""?b:null;break}if(b==="EOD")break}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function t(c,f){return Sl(e(c,f),f)}function i(c,f){return Mi(t(c,f),f)}var s=(function(){var c=function(h,m,p,v,y){h.push(m),h.push(p+","+v),h.push('"'+y.replace(/"/g,'""')+'"')},f=function(h,m,p,v){h.push(m+","+p),h.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var m=[],p=St(h["!ref"]),v,y=Array.isArray(h);c(m,"TABLE",0,1,"sheetjs"),c(m,"VECTORS",0,p.e.r-p.s.r+1,""),c(m,"TUPLES",0,p.e.c-p.s.c+1,""),c(m,"DATA",0,0,"");for(var _=p.s.r;_<=p.e.r;++_){f(m,-1,0,"BOT");for(var w=p.s.c;w<=p.e.c;++w){var b=$e({r:_,c:w});if(v=y?(h[_]||[])[w]:h[b],!v){f(m,1,0,"");continue}switch(v.t){case"n":var T=v.w;!T&&v.v!=null&&(T=v.v),T==null?v.f&&!v.F?f(m,1,0,"="+v.f):f(m,1,0,""):f(m,0,T,"V");break;case"b":f(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":f(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Wr(v.z||Ze[14],wa(Gt(v.v)))),f(m,0,v.w,"V");break;default:f(m,1,0,"")}}}f(m,-1,0,"EOD");var C=`\r
`,L=m.join(C);return L}})();return{to_workbook:i,to_sheet:t,from_sheet:s}})(),cy=(function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function a(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(v,y){for(var _=v.split(`
`),w=-1,b=-1,T=0,C=[];T!==_.length;++T){var L=_[T].trim().split(":");if(L[0]==="cell"){var N=qt(L[1]);if(C.length<=N.r)for(w=C.length;w<=N.r;++w)C[w]||(C[w]=[]);switch(w=N.r,b=N.c,L[2]){case"t":C[w][b]=e(L[3]);break;case"v":C[w][b]=+L[3];break;case"vtf":var j=L[L.length-1];case"vtc":switch(L[3]){case"nl":C[w][b]=!!+L[4];break;default:C[w][b]=+L[4];break}L[2]=="vtf"&&(C[w][b]=[C[w][b],j])}}}return y&&y.sheetRows&&(C=C.slice(0,y.sheetRows)),C}function i(v,y){return Sl(t(v,y),y)}function s(v,y){return Mi(i(v,y),y)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),f=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var y=[],_=[],w,b="",T=dr(v["!ref"]),C=Array.isArray(v),L=T.s.r;L<=T.e.r;++L)for(var N=T.s.c;N<=T.e.c;++N)if(b=$e({r:L,c:N}),w=C?(v[L]||[])[N]:v[b],!(!w||w.v==null||w.t==="z")){switch(_=["cell",b,"t"],w.t){case"s":case"str":_.push(a(w.v));break;case"n":w.f?(_[2]="vtf",_[3]="n",_[4]=w.v,_[5]=a(w.f)):(_[2]="v",_[3]=w.v);break;case"b":_[2]="vt"+(w.f?"f":"c"),_[3]="nl",_[4]=w.v?"1":"0",_[5]=a(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var j=wa(Gt(w.v));_[2]="vtc",_[3]="nd",_[4]=""+j,_[5]=w.w||Wr(w.z||Ze[14],j);break;case"e":continue}y.push(_.join(":"))}return y.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(v){return[c,f,d,f,m(v),h].join(`
`)}return{to_workbook:s,to_sheet:i,from_sheet:p}})(),vl=(function(){function e(p,v,y,_,w){w.raw?v[y][_]=p:p===""||(p==="TRUE"?v[y][_]=!0:p==="FALSE"?v[y][_]=!1:isNaN(sn(p))?isNaN(gl(p).getDate())?v[y][_]=p:v[y][_]=Gt(p):v[y][_]=sn(p))}function a(p,v){var y=v||{},_=[];if(!p||p.length===0)return _;for(var w=p.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var T=10,C=0,L=0;L<=b;++L)C=w[L].indexOf(" "),C==-1?C=w[L].length:C++,T=Math.max(T,C);for(L=0;L<=b;++L){_[L]=[];var N=0;for(e(w[L].slice(0,T).trim(),_,L,N,y),N=1;N<=(w[L].length-T)/10+1;++N)e(w[L].slice(T+(N-1)*10,T+N*10).trim(),_,L,N,y)}return y.sheetRows&&(_=_.slice(0,y.sheetRows)),_}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(p){for(var v={},y=!1,_=0,w=0;_<p.length;++_)(w=p.charCodeAt(_))==34?y=!y:!y&&w in t&&(v[w]=(v[w]||0)+1);w=[];for(_ in v)Object.prototype.hasOwnProperty.call(v,_)&&w.push([v[_],_]);if(!w.length){v=i;for(_ in v)Object.prototype.hasOwnProperty.call(v,_)&&w.push([v[_],_])}return w.sort(function(b,T){return b[0]-T[0]||i[b[1]]-i[T[1]]}),t[w.pop()[1]]||44}function c(p,v){var y=v||{},_="",w=y.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(_=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(_=p.charAt(4),p=p.slice(6)):_=s(p.slice(0,1024)):y&&y.FS?_=y.FS:_=s(p.slice(0,1024));var T=0,C=0,L=0,N=0,j=0,V=_.charCodeAt(0),M=!1,k=0,W=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var K=y.dateNF!=null?v4(y.dateNF):null;function J(){var Z=p.slice(N,j),Q={};if(Z.charAt(0)=='"'&&Z.charAt(Z.length-1)=='"'&&(Z=Z.slice(1,-1).replace(/""/g,'"')),Z.length===0)Q.t="z";else if(y.raw)Q.t="s",Q.v=Z;else if(Z.trim().length===0)Q.t="s",Q.v=Z;else if(Z.charCodeAt(0)==61)Z.charCodeAt(1)==34&&Z.charCodeAt(Z.length-1)==34?(Q.t="s",Q.v=Z.slice(2,-1).replace(/""/g,'"')):WA(Z)?(Q.t="n",Q.f=Z.slice(1)):(Q.t="s",Q.v=Z);else if(Z=="TRUE")Q.t="b",Q.v=!0;else if(Z=="FALSE")Q.t="b",Q.v=!1;else if(!isNaN(L=sn(Z)))Q.t="n",y.cellText!==!1&&(Q.w=Z),Q.v=L;else if(!isNaN(gl(Z).getDate())||K&&Z.match(K)){Q.z=y.dateNF||Ze[14];var re=0;K&&Z.match(K)&&(Z=y4(Z,y.dateNF,Z.match(K)||[]),re=1),y.cellDates?(Q.t="d",Q.v=Gt(Z,re)):(Q.t="n",Q.v=wa(Gt(Z,re))),y.cellText!==!1&&(Q.w=Wr(Q.z,Q.v instanceof Date?wa(Q.v):Q.v)),y.cellNF||delete Q.z}else Q.t="s",Q.v=Z;if(Q.t=="z"||(y.dense?(w[T]||(w[T]=[]),w[T][C]=Q):w[$e({c:C,r:T})]=Q),N=j+1,W=p.charCodeAt(N),b.e.c<C&&(b.e.c=C),b.e.r<T&&(b.e.r=T),k==V)++C;else if(C=0,++T,y.sheetRows&&y.sheetRows<=T)return!0}e:for(;j<p.length;++j)switch(k=p.charCodeAt(j)){case 34:W===34&&(M=!M);break;case V:case 10:case 13:if(!M&&J())break e;break}return j-N>0&&J(),w["!ref"]=nt(b),w}function f(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?c(p,v):Sl(a(p,v),v)}function d(p,v){var y="",_=v.type=="string"?[0,0,0,0]:Wh(p,v);switch(v.type){case"base64":y=Nr(p);break;case"binary":y=p;break;case"buffer":v.codepage==65001?y=p.toString("utf8"):v.codepage&&typeof Uc<"u"||(y=ot&&Buffer.isBuffer(p)?p.toString("binary"):Ri(p));break;case"array":y=hs(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+v.type)}return _[0]==239&&_[1]==187&&_[2]==191?y=It(y.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?y=It(y):v.type=="binary"&&typeof Uc<"u",y.slice(0,19)=="socialcalc:version:"?cy.to_sheet(v.type=="string"?y:It(y),v):f(y,v)}function h(p,v){return Mi(d(p,v),v)}function m(p){for(var v=[],y=St(p["!ref"]),_,w=Array.isArray(p),b=y.s.r;b<=y.e.r;++b){for(var T=[],C=y.s.c;C<=y.e.c;++C){var L=$e({r:b,c:C});if(_=w?(p[b]||[])[C]:p[L],!_||_.v==null){T.push("          ");continue}for(var N=(_.w||(qn(_),_.w)||"").slice(0,10);N.length<10;)N+=" ";T.push(N+(C===0?" ":""))}v.push(T.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:d,from_sheet:m}})();function O3(e,a){var t=a||{},i=!!t.WTF;t.WTF=!0;try{var s=sy.to_workbook(e,t);return t.WTF=i,s}catch(c){if(t.WTF=i,!c.message.match(/SYLK bad record ID/)&&i)throw c;return vl.to_workbook(e,a)}}var cs=(function(){function e(E,O,B){if(E){Ma(E,E.l||0);for(var z=B.Enum||se;E.l<E.length;){var le=E.read_shift(2),ye=z[le]||z[65535],Ne=E.read_shift(2),Te=E.l+Ne,De=ye.f&&ye.f(E,Ne,B);if(E.l=Te,O(De,ye,le))return}}}function a(E,O){switch(O.type){case"base64":return t(Er(Nr(E)),O);case"binary":return t(Er(E),O);case"buffer":case"array":return t(E,O)}throw"Unsupported type "+O.type}function t(E,O){if(!E)return E;var B=O||{},z=B.dense?[]:{},le="Sheet1",ye="",Ne=0,Te={},De=[],Ve=[],q={s:{r:0,c:0},e:{r:0,c:0}},ct=B.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)B.Enum=se,e(E,function(Re,vt,Bt){switch(Bt){case 0:B.vers=Re,Re>=4096&&(B.qpro=!0);break;case 6:q=Re;break;case 204:Re&&(ye=Re);break;case 222:ye=Re;break;case 15:case 51:B.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:Bt==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=B.dateNF||Ze[14],B.cellDates&&(Re[1].t="d",Re[1].v=af(Re[1].v))),B.qpro&&Re[3]>Ne&&(z["!ref"]=nt(q),Te[le]=z,De.push(le),z=B.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},Ne=Re[3],le=ye||"Sheet"+(Ne+1),ye="");var Kt=B.dense?(z[Re[0].r]||[])[Re[0].c]:z[$e(Re[0])];if(Kt){Kt.t=Re[1].t,Kt.v=Re[1].v,Re[1].z!=null&&(Kt.z=Re[1].z),Re[1].f!=null&&(Kt.f=Re[1].f);break}B.dense?(z[Re[0].r]||(z[Re[0].r]=[]),z[Re[0].r][Re[0].c]=Re[1]):z[$e(Re[0])]=Re[1];break}},B);else if(E[2]==26||E[2]==14)B.Enum=A,E[2]==14&&(B.qpro=!0,E.l=0),e(E,function(Re,vt,Bt){switch(Bt){case 204:le=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>Ne&&(z["!ref"]=nt(q),Te[le]=z,De.push(le),z=B.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},Ne=Re[3],le="Sheet"+(Ne+1)),ct>0&&Re[0].r>=ct)break;B.dense?(z[Re[0].r]||(z[Re[0].r]=[]),z[Re[0].r][Re[0].c]=Re[1]):z[$e(Re[0])]=Re[1],q.e.c<Re[0].c&&(q.e.c=Re[0].c),q.e.r<Re[0].r&&(q.e.r=Re[0].r);break;case 27:Re[14e3]&&(Ve[Re[14e3][0]]=Re[14e3][1]);break;case 1537:Ve[Re[0]]=Re[1],Re[0]==Ne&&(le=Re[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(z["!ref"]=nt(q),Te[ye||le]=z,De.push(ye||le),!Ve.length)return{SheetNames:De,Sheets:Te};for(var We={},tt=[],qe=0;qe<Ve.length;++qe)Te[De[qe]]?(tt.push(Ve[qe]||De[qe]),We[Ve[qe]]=Te[Ve[qe]]||Te[De[qe]]):(tt.push(Ve[qe]),We[Ve[qe]]={"!ref":"A1"});return{SheetNames:tt,Sheets:We}}function i(E,O){var B=O||{};if(+B.codepage>=0&&rn(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var z=ur(),le=St(E["!ref"]),ye=Array.isArray(E),Ne=[];Le(z,0,c(1030)),Le(z,6,h(le));for(var Te=Math.min(le.e.r,8191),De=le.s.r;De<=Te;++De)for(var Ve=oa(De),q=le.s.c;q<=le.e.c;++q){De===le.s.r&&(Ne[q]=Wt(q));var ct=Ne[q]+Ve,We=ye?(E[De]||[])[q]:E[ct];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?Le(z,13,_(De,q,We.v)):Le(z,14,b(De,q,We.v));else{var tt=qn(We);Le(z,15,v(De,q,tt.slice(0,239)))}}return Le(z,1),z.end()}function s(E,O){var B=O||{};if(+B.codepage>=0&&rn(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var z=ur();Le(z,0,f(E));for(var le=0,ye=0;le<E.SheetNames.length;++le)(E.Sheets[E.SheetNames[le]]||{})["!ref"]&&Le(z,27,R(E.SheetNames[le],ye++));var Ne=0;for(le=0;le<E.SheetNames.length;++le){var Te=E.Sheets[E.SheetNames[le]];if(!(!Te||!Te["!ref"])){for(var De=St(Te["!ref"]),Ve=Array.isArray(Te),q=[],ct=Math.min(De.e.r,8191),We=De.s.r;We<=ct;++We)for(var tt=oa(We),qe=De.s.c;qe<=De.e.c;++qe){We===De.s.r&&(q[qe]=Wt(qe));var Re=q[qe]+tt,vt=Ve?(Te[We]||[])[qe]:Te[Re];if(!(!vt||vt.t=="z"))if(vt.t=="n")Le(z,23,J(We,qe,Ne,vt.v));else{var Bt=qn(vt);Le(z,22,k(We,qe,Ne,Bt.slice(0,239)))}}++Ne}}return Le(z,1),z.end()}function c(E){var O=we(2);return O.write_shift(2,E),O}function f(E){var O=we(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var B=0,z=0,le=0,ye=0;ye<E.SheetNames.length;++ye){var Ne=E.SheetNames[ye],Te=E.Sheets[Ne];if(!(!Te||!Te["!ref"])){++le;var De=dr(Te["!ref"]);B<De.e.r&&(B=De.e.r),z<De.e.c&&(z=De.e.c)}}return B>8191&&(B=8191),O.write_shift(2,B),O.write_shift(1,le),O.write_shift(1,z),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function d(E,O,B){var z={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&B.qpro?(z.s.c=E.read_shift(1),E.l++,z.s.r=E.read_shift(2),z.e.c=E.read_shift(1),E.l++,z.e.r=E.read_shift(2),z):(z.s.c=E.read_shift(2),z.s.r=E.read_shift(2),O==12&&B.qpro&&(E.l+=2),z.e.c=E.read_shift(2),z.e.r=E.read_shift(2),O==12&&B.qpro&&(E.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function h(E){var O=we(8);return O.write_shift(2,E.s.c),O.write_shift(2,E.s.r),O.write_shift(2,E.e.c),O.write_shift(2,E.e.r),O}function m(E,O,B){var z=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(z[0].c=E.read_shift(1),z[3]=E.read_shift(1),z[0].r=E.read_shift(2),E.l+=2):(z[2]=E.read_shift(1),z[0].c=E.read_shift(2),z[0].r=E.read_shift(2)),z}function p(E,O,B){var z=E.l+O,le=m(E,O,B);if(le[1].t="s",B.vers==20768){E.l++;var ye=E.read_shift(1);return le[1].v=E.read_shift(ye,"utf8"),le}return B.qpro&&E.l++,le[1].v=E.read_shift(z-E.l,"cstr"),le}function v(E,O,B){var z=we(7+B.length);z.write_shift(1,255),z.write_shift(2,O),z.write_shift(2,E),z.write_shift(1,39);for(var le=0;le<z.length;++le){var ye=B.charCodeAt(le);z.write_shift(1,ye>=128?95:ye)}return z.write_shift(1,0),z}function y(E,O,B){var z=m(E,O,B);return z[1].v=E.read_shift(2,"i"),z}function _(E,O,B){var z=we(7);return z.write_shift(1,255),z.write_shift(2,O),z.write_shift(2,E),z.write_shift(2,B,"i"),z}function w(E,O,B){var z=m(E,O,B);return z[1].v=E.read_shift(8,"f"),z}function b(E,O,B){var z=we(13);return z.write_shift(1,255),z.write_shift(2,O),z.write_shift(2,E),z.write_shift(8,B,"f"),z}function T(E,O,B){var z=E.l+O,le=m(E,O,B);if(le[1].v=E.read_shift(8,"f"),B.qpro)E.l=z;else{var ye=E.read_shift(2);j(E.slice(E.l,E.l+ye),le),E.l+=ye}return le}function C(E,O,B){var z=O&32768;return O&=-32769,O=(z?E:0)+(O>=8192?O-16384:O),(z?"":"$")+(B?Wt(O):oa(O))}var L={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(E,O){Ma(E,0);for(var B=[],z=0,le="",ye="",Ne="",Te="";E.l<E.length;){var De=E[E.l++];switch(De){case 0:B.push(E.read_shift(8,"f"));break;case 1:ye=C(O[0].c,E.read_shift(2),!0),le=C(O[0].r,E.read_shift(2),!1),B.push(ye+le);break;case 2:{var Ve=C(O[0].c,E.read_shift(2),!0),q=C(O[0].r,E.read_shift(2),!1);ye=C(O[0].c,E.read_shift(2),!0),le=C(O[0].r,E.read_shift(2),!1),B.push(Ve+q+":"+ye+le)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(E.read_shift(2));break;case 6:{for(var ct="";De=E[E.l++];)ct+=String.fromCharCode(De);B.push('"'+ct.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:Te=B.pop(),Ne=B.pop(),B.push(["AND","OR"][De-20]+"("+Ne+","+Te+")");break;default:if(De<32&&N[De])Te=B.pop(),Ne=B.pop(),B.push(Ne+N[De]+Te);else if(L[De]){if(z=L[De][1],z==69&&(z=E[E.l++]),z>B.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+B.join("|")+"|");return}var We=B.slice(-z);B.length-=z,B.push(L[De][0]+"("+We.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}B.length==1?O[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function V(E){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=E.read_shift(2),O[3]=E[E.l++],O[0].c=E[E.l++],O}function M(E,O){var B=V(E);return B[1].t="s",B[1].v=E.read_shift(O-4,"cstr"),B}function k(E,O,B,z){var le=we(6+z.length);le.write_shift(2,E),le.write_shift(1,B),le.write_shift(1,O),le.write_shift(1,39);for(var ye=0;ye<z.length;++ye){var Ne=z.charCodeAt(ye);le.write_shift(1,Ne>=128?95:Ne)}return le.write_shift(1,0),le}function W(E,O){var B=V(E);B[1].v=E.read_shift(2);var z=B[1].v>>1;if(B[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return B[1].v=z,B}function K(E,O){var B=V(E),z=E.read_shift(4),le=E.read_shift(4),ye=E.read_shift(2);if(ye==65535)return z===0&&le===3221225472?(B[1].t="e",B[1].v=15):z===0&&le===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var Ne=ye&32768;return ye=(ye&32767)-16446,B[1].v=(1-Ne*2)*(le*Math.pow(2,ye+32)+z*Math.pow(2,ye)),B}function J(E,O,B,z){var le=we(14);if(le.write_shift(2,E),le.write_shift(1,B),le.write_shift(1,O),z==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var ye=0,Ne=0,Te=0,De=0;return z<0&&(ye=1,z=-z),Ne=Math.log2(z)|0,z/=Math.pow(2,Ne-31),De=z>>>0,(De&2147483648)==0&&(z/=2,++Ne,De=z>>>0),z-=De,De|=2147483648,De>>>=0,z*=Math.pow(2,32),Te=z>>>0,le.write_shift(4,Te),le.write_shift(4,De),Ne+=16383+(ye?32768:0),le.write_shift(2,Ne),le}function Z(E,O){var B=K(E);return E.l+=O-14,B}function Q(E,O){var B=V(E),z=E.read_shift(4);return B[1].v=z>>6,B}function re(E,O){var B=V(E),z=E.read_shift(8,"f");return B[1].v=z,B}function ue(E,O){var B=re(E);return E.l+=O-10,B}function ve(E,O){return E[E.l+O-1]==0?E.read_shift(O,"cstr"):""}function ee(E,O){var B=E[E.l++];B>O-1&&(B=O-1);for(var z="";z.length<B;)z+=String.fromCharCode(E[E.l++]);return z}function G(E,O,B){if(!(!B.qpro||O<21)){var z=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var le=E.read_shift(O-21,"cstr");return[z,le]}}function ae(E,O){for(var B={},z=E.l+O;E.l<z;){var le=E.read_shift(2);if(le==14e3){for(B[le]=[0,""],B[le][0]=E.read_shift(2);E[E.l];)B[le][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return B}function R(E,O){var B=we(5+E.length);B.write_shift(2,14e3),B.write_shift(2,O);for(var z=0;z<E.length;++z){var le=E.charCodeAt(z);B[B.l++]=le>127?95:le}return B[B.l++]=0,B}var se={0:{n:"BOF",f:ga},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},A={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:K},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:Z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Q},38:{n:"??"},39:{n:"NUMBER27",f:re},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:G},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:a}})();function R3(e){var a={},t=e.match(qa),i=0,s=!1;if(t)for(;i!=t.length;++i){var c=Qe(t[i]);switch(c[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!c.val)break;case"<shadow>":case"<shadow/>":a.shadow=1;break;case"</shadow>":break;case"<charset":if(c.val=="1")break;a.cp=fh[parseInt(c.val,10)];break;case"<outline":if(!c.val)break;case"<outline>":case"<outline/>":a.outline=1;break;case"</outline>":break;case"<rFont":a.name=c.val;break;case"<sz":a.sz=c.val;break;case"<strike":if(!c.val)break;case"<strike>":case"<strike/>":a.strike=1;break;case"</strike>":break;case"<u":if(!c.val)break;switch(c.val){case"double":a.uval="double";break;case"singleAccounting":a.uval="single-accounting";break;case"doubleAccounting":a.uval="double-accounting";break}case"<u>":case"<u/>":a.u=1;break;case"</u>":break;case"<b":if(c.val=="0")break;case"<b>":case"<b/>":a.b=1;break;case"</b>":break;case"<i":if(c.val=="0")break;case"<i>":case"<i/>":a.i=1;break;case"</i>":break;case"<color":c.rgb&&(a.color=c.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":a.family=c.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":a.valign=c.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(c[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+c[0])}}return a}var M3=(function(){var e=Hc("t"),a=Hc("rPr");function t(c){var f=c.match(e);if(!f)return{t:"s",v:""};var d={t:"s",v:wt(f[1])},h=c.match(a);return h&&(d.s=R3(h[1])),d}var i=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(f){return f.replace(i,"").split(s).map(t).filter(function(d){return d.v})}})(),L3=(function(){var a=/(\r\n|\n)/g;function t(s,c,f){var d=[];s.u&&d.push("text-decoration: underline;"),s.uval&&d.push("text-underline-style:"+s.uval+";"),s.sz&&d.push("font-size:"+s.sz+"pt;"),s.outline&&d.push("text-effect: outline;"),s.shadow&&d.push("text-shadow: auto;"),c.push('<span style="'+d.join("")+'">'),s.b&&(c.push("<b>"),f.push("</b>")),s.i&&(c.push("<i>"),f.push("</i>")),s.strike&&(c.push("<s>"),f.push("</s>"));var h=s.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(c.push("<"+h+">"),f.push("</"+h+">")),f.push("</span>"),s}function i(s){var c=[[],s.v,[]];return s.v?(s.s&&t(s.s,c[0],c[2]),c[0].join("")+c[1].replace(a,"<br/>")+c[2].join("")):""}return function(c){return c.map(i).join("")}})(),I3=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,B3=/<(?:\w+:)?r>/,U3=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Rh(e,a){var t=a?a.cellHTML:!0,i={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=wt(It(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=It(e),t&&(i.h=_h(i.t))):e.match(B3)&&(i.r=It(e),i.t=wt(It((e.replace(U3,"").match(I3)||[]).join("").replace(qa,""))),t&&(i.h=L3(M3(i.r)))),i):{t:""}}var z3=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,P3=/<(?:\w+:)?(?:si|sstItem)>/g,H3=/<\/(?:\w+:)?(?:si|sstItem)>/;function V3(e,a){var t=[],i="";if(!e)return t;var s=e.match(z3);if(s){i=s[2].replace(P3,"").split(H3);for(var c=0;c!=i.length;++c){var f=Rh(i[c].trim(),a);f!=null&&(t[t.length]=f)}s=Qe(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}var G3=/^\s|\s$|[\t\n\r]/;function oy(e,a){if(!a.bookSST)return"";var t=[fa];t[t.length]=Me("sst",null,{xmlns:vs[0],count:e.Count,uniqueCount:e.Unique});for(var i=0;i!=e.length;++i)if(e[i]!=null){var s=e[i],c="<si>";s.r?c+=s.r:(c+="<t",s.t||(s.t=""),s.t.match(G3)&&(c+=' xml:space="preserve"'),c+=">"+Ot(s.t)+"</t>"),c+="</si>",t[t.length]=c}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function X3(e){return[e.read_shift(4),e.read_shift(4)]}function Y3(e,a){var t=[],i=!1;return Zn(e,function(c,f,d){switch(d){case 159:t.Count=c[0],t.Unique=c[1];break;case 19:t.push(c);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(f.T,!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),t}function W3(e,a){return a||(a=we(8)),a.write_shift(4,e.Count),a.write_shift(4,e.Unique),a}var q3=nE;function K3(e){var a=ur();je(a,159,W3(e));for(var t=0;t<e.length;++t)je(a,19,q3(e[t]));return je(a,160),a.end()}function fy(e){for(var a=[],t=e.split(""),i=0;i<t.length;++i)a[i]=t[i].charCodeAt(0);return a}function Wn(e,a){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),a>=4&&(e.l+=a-4),t}function Z3(e){var a={};return a.id=e.read_shift(0,"lpp4"),a.R=Wn(e,4),a.U=Wn(e,4),a.W=Wn(e,4),a}function $3(e){for(var a=e.read_shift(4),t=e.l+a-4,i={},s=e.read_shift(4),c=[];s-- >0;)c.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(i.name=e.read_shift(0,"lpp4"),i.comps=c,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return i}function Q3(e){var a=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)a.push($3(e));return a}function J3(e){var a=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)a.push(e.read_shift(0,"lpp4"));return a}function eN(e){var a={};return e.read_shift(4),e.l+=4,a.id=e.read_shift(0,"lpp4"),a.name=e.read_shift(0,"lpp4"),a.R=Wn(e,4),a.U=Wn(e,4),a.W=Wn(e,4),a}function tN(e){var a=eN(e);if(a.ename=e.read_shift(0,"8lpp4"),a.blksz=e.read_shift(4),a.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return a}function uy(e,a){var t=e.l+a,i={};i.Flags=e.read_shift(4)&63,e.l+=4,i.AlgID=e.read_shift(4);var s=!1;switch(i.AlgID){case 26126:case 26127:case 26128:s=i.Flags==36;break;case 26625:s=i.Flags==4;break;case 0:s=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=e.read_shift(4),i.KeySize=e.read_shift(4),i.ProviderType=e.read_shift(4),e.l+=8,i.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,i}function dy(e,a){var t={},i=e.l+a;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,i),e.l=i,t}function aN(e){var a=Wn(e);switch(a.Minor){case 2:return[a.Minor,rN(e)];case 3:return[a.Minor,nN()];case 4:return[a.Minor,iN(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+a.Minor)}function rN(e){var a=e.read_shift(4);if((a&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),i=uy(e,t),s=dy(e,e.length-e.l);return{t:"Std",h:i,v:s}}function nN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function iN(e){var a=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),i={};return t.replace(qa,function(c){var f=Qe(c);switch(bn(f[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":a.forEach(function(d){i[d]=f[d]});break;case"<dataIntegrity":i.encryptedHmacKey=f.encryptedHmacKey,i.encryptedHmacValue=f.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=f.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(f);break;default:throw f[0]}}),i}function sN(e,a){var t={},i=t.EncryptionVersionInfo=Wn(e,4);if(a-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);t.Flags=e.read_shift(4),a-=4;var s=e.read_shift(4);return a-=4,t.EncryptionHeader=uy(e,s),a-=s,t.EncryptionVerifier=dy(e,a),t}function lN(e){var a={},t=a.EncryptionVersionInfo=Wn(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return a.Salt=e.read_shift(16),a.EncryptedVerifier=e.read_shift(16),a.EncryptedVerifierHash=e.read_shift(16),a}function Mh(e){var a=0,t,i=fy(e),s=i.length+1,c,f,d,h,m;for(t=ki(s),t[0]=i.length,c=1;c!=s;++c)t[c]=i[c-1];for(c=s-1;c>=0;--c)f=t[c],d=(a&16384)===0?0:1,h=a<<1&32767,m=d|h,a=m^f;return a^52811}var hy=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],a=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(f){return(f/2|f*128)&255},s=function(f,d){return i(f^d)},c=function(f){for(var d=a[f.length-1],h=104,m=f.length-1;m>=0;--m)for(var p=f[m],v=0;v!=7;++v)p&64&&(d^=t[h]),p*=2,--h;return d};return function(f){for(var d=fy(f),h=c(d),m=d.length,p=ki(16),v=0;v!=16;++v)p[v]=0;var y,_,w;for((m&1)===1&&(y=h>>8,p[m]=s(e[0],y),--m,y=h&255,_=d[d.length-1],p[m]=s(_,y));m>0;)--m,y=h>>8,p[m]=s(d[m],y),--m,y=h&255,p[m]=s(d[m],y);for(m=15,w=15-d.length;w>0;)y=h>>8,p[m]=s(e[w],y),--m,--w,y=h&255,p[m]=s(d[m],y),--m,--w;return p}})(),cN=function(e,a,t,i,s){s||(s=a),i||(i=hy(e));var c,f;for(c=0;c!=a.length;++c)f=a[c],f^=i[t],f=(f>>5|f<<3)&255,s[c]=f,++t;return[s,t,i]},oN=function(e){var a=0,t=hy(e);return function(i){var s=cN("",i,a,t);return a=s[1],s[0]}};function fN(e,a,t,i){var s={key:ga(e),verificationBytes:ga(e)};return t.password&&(s.verifier=Mh(t.password)),i.valid=s.verificationBytes===s.verifier,i.valid&&(i.insitu=oN(t.password)),s}function uN(e,a,t){var i=t||{};return i.Info=e.read_shift(2),e.l-=2,i.Info===1?i.Data=lN(e):i.Data=sN(e,a),i}function dN(e,a,t){var i={Type:t.biff>=8?e.read_shift(2):0};return i.Type?uN(e,a-2,i):fN(e,t.biff>=8?a:a-2,t,i),i}var my=(function(){function e(s,c){switch(c.type){case"base64":return a(Nr(s),c);case"binary":return a(s,c);case"buffer":return a(ot&&Buffer.isBuffer(s)?s.toString("binary"):Ri(s),c);case"array":return a(hs(s),c)}throw new Error("Unrecognized type "+c.type)}function a(s,c){var f=c||{},d=f.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,v){Array.isArray(d)&&(d[v]=[]);for(var y=/\\\w+\b/g,_=0,w,b=-1;w=y.exec(p);){switch(w[0]){case"\\cell":var T=p.slice(_,y.lastIndex-w[0].length);if(T[0]==" "&&(T=T.slice(1)),++b,T.length){var C={v:T,t:"s"};Array.isArray(d)?d[v][b]=C:d[$e({r:v,c:b})]=C}break}_=y.lastIndex}b>m.e.c&&(m.e.c=b)}),d["!ref"]=nt(m),d}function t(s,c){return Mi(e(s,c),c)}function i(s){for(var c=["{\\rtf1\\ansi"],f=St(s["!ref"]),d,h=Array.isArray(s),m=f.s.r;m<=f.e.r;++m){c.push("\\trowd\\trautofit1");for(var p=f.s.c;p<=f.e.c;++p)c.push("\\cellx"+(p+1));for(c.push("\\pard\\intbl"),p=f.s.c;p<=f.e.c;++p){var v=$e({r:m,c:p});d=h?(s[m]||[])[p]:s[v],!(!d||d.v==null&&(!d.f||d.F))&&(c.push(" "+(d.w||(qn(d),d.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:i}})();function hN(e){var a=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(a.slice(0,2),16),parseInt(a.slice(2,4),16),parseInt(a.slice(4,6),16)]}function Yc(e){for(var a=0,t=1;a!=3;++a)t=t*256+(e[a]>255?255:e[a]<0?0:e[a]);return t.toString(16).toUpperCase().slice(1)}function mN(e){var a=e[0]/255,t=e[1]/255,i=e[2]/255,s=Math.max(a,t,i),c=Math.min(a,t,i),f=s-c;if(f===0)return[0,0,a];var d=0,h=0,m=s+c;switch(h=f/(m>1?2-m:m),s){case a:d=((t-i)/f+6)%6;break;case t:d=(i-a)/f+2;break;case i:d=(a-t)/f+4;break}return[d/6,h,m/2]}function xN(e){var a=e[0],t=e[1],i=e[2],s=t*2*(i<.5?i:1-i),c=i-s/2,f=[c,c,c],d=6*a,h;if(t!==0)switch(d|0){case 0:case 6:h=s*d,f[0]+=s,f[1]+=h;break;case 1:h=s*(2-d),f[0]+=h,f[1]+=s;break;case 2:h=s*(d-2),f[1]+=s,f[2]+=h;break;case 3:h=s*(4-d),f[1]+=h,f[2]+=s;break;case 4:h=s*(d-4),f[2]+=s,f[0]+=h;break;case 5:h=s*(6-d),f[2]+=h,f[0]+=s;break}for(var m=0;m!=3;++m)f[m]=Math.round(f[m]*255);return f}function Ko(e,a){if(a===0)return e;var t=mN(hN(e));return a<0?t[2]=t[2]*(1+a):t[2]=1-(1-t[2])*(1-a),Yc(xN(t))}var xy=6,pN=15,gN=1,Ga=xy;function Wc(e){return Math.floor((e+Math.round(128/Ga)/256)*Ga)}function qc(e){return Math.floor((e-5)/Ga*100+.5)/100}function Zo(e){return Math.round((e*Ga+5)/Ga*256)/256}function Md(e){return Zo(qc(Wc(e)))}function Lh(e){var a=Math.abs(e-Md(e)),t=Ga;if(a>.005)for(Ga=gN;Ga<pN;++Ga)Math.abs(e-Md(e))<=a&&(a=Math.abs(e-Md(e)),t=Ga);Ga=t}function Ci(e){e.width?(e.wpx=Wc(e.width),e.wch=qc(e.wpx),e.MDW=Ga):e.wpx?(e.wch=qc(e.wpx),e.width=Zo(e.wch),e.MDW=Ga):typeof e.wch=="number"&&(e.width=Zo(e.wch),e.wpx=Wc(e.width),e.MDW=Ga),e.customWidth&&delete e.customWidth}var vN=96,py=vN;function Kc(e){return e*96/py}function yl(e){return e*py/96}var yN={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _N(e,a,t,i){a.Borders=[];var s={},c=!1;(e[0].match(qa)||[]).forEach(function(f){var d=Qe(f);switch(bn(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},d.diagonalUp&&(s.diagonalUp=Vt(d.diagonalUp)),d.diagonalDown&&(s.diagonalDown=Vt(d.diagonalDown)),a.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+d[0]+" in borders")}})}function bN(e,a,t,i){a.Fills=[];var s={},c=!1;(e[0].match(qa)||[]).forEach(function(f){var d=Qe(f);switch(bn(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},a.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":a.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":d.patternType&&(s.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),d.indexed&&(s.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(s.bgColor.theme=parseInt(d.theme,10)),d.tint&&(s.bgColor.tint=parseFloat(d.tint)),d.rgb&&(s.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),d.theme&&(s.fgColor.theme=parseInt(d.theme,10)),d.tint&&(s.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(s.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+d[0]+" in fills")}})}function wN(e,a,t,i){a.Fonts=[];var s={},c=!1;(e[0].match(qa)||[]).forEach(function(f){var d=Qe(f);switch(bn(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":a.Fonts.push(s),s={};break;case"<name":d.val&&(s.name=It(d.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=d.val?Vt(d.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=d.val?Vt(d.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(d.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=d.val?Vt(d.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=d.val?Vt(d.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=d.val?Vt(d.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=d.val?Vt(d.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=d.val?Vt(d.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":d.val&&(s.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(s.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(s.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(s.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=fh[parseInt(d.val,10)];break;case"<color":if(s.color||(s.color={}),d.auto&&(s.color.auto=Vt(d.auto)),d.rgb)s.color.rgb=d.rgb.slice(-6);else if(d.indexed){s.color.index=parseInt(d.indexed,10);var h=ss[s.color.index];s.color.index==81&&(h=ss[1]),h||(h=ss[1]),s.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else d.theme&&(s.color.theme=parseInt(d.theme,10),d.tint&&(s.color.tint=parseFloat(d.tint)),d.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=Ko(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":c=!0;break;case"</AlternateContent>":c=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+d[0]+" in fonts")}})}function SN(e,a,t){a.NumberFmt=[];for(var i=ra(Ze),s=0;s<i.length;++s)a.NumberFmt[i[s]]=Ze[i[s]];var c=e[0].match(qa);if(c)for(s=0;s<c.length;++s){var f=Qe(c[s]);switch(bn(f[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=wt(It(f.formatCode)),h=parseInt(f.numFmtId,10);if(a.NumberFmt[h]=d,h>0){if(h>392){for(h=392;h>60&&a.NumberFmt[h]!=null;--h);a.NumberFmt[h]=d}Yn(d,h)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+f[0]+" in numFmts")}}}function EN(e){var a=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)e[i]!=null&&(a[a.length]=Me("numFmt",null,{numFmtId:i,formatCode:Ot(e[i])}))}),a.length===1?"":(a[a.length]="</numFmts>",a[0]=Me("numFmts",null,{count:a.length-2}).replace("/>",">"),a.join(""))}var Co=["numFmtId","fillId","fontId","borderId","xfId"],Do=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function TN(e,a,t){a.CellXf=[];var i,s=!1;(e[0].match(qa)||[]).forEach(function(c){var f=Qe(c),d=0;switch(bn(f[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=f,delete i[0],d=0;d<Co.length;++d)i[Co[d]]&&(i[Co[d]]=parseInt(i[Co[d]],10));for(d=0;d<Do.length;++d)i[Do[d]]&&(i[Do[d]]=Vt(i[Do[d]]));if(a.NumberFmt&&i.numFmtId>392){for(d=392;d>60;--d)if(a.NumberFmt[i.numFmtId]==a.NumberFmt[d]){i.numFmtId=d;break}}a.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};f.vertical&&(h.vertical=f.vertical),f.horizontal&&(h.horizontal=f.horizontal),f.textRotation!=null&&(h.textRotation=f.textRotation),f.indent&&(h.indent=f.indent),f.wrapText&&(h.wrapText=Vt(f.wrapText)),i.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+f[0]+" in cellXfs")}})}function NN(e){var a=[];return a[a.length]=Me("cellXfs",null),e.forEach(function(t){a[a.length]=Me("xf",null,t)}),a[a.length]="</cellXfs>",a.length===2?"":(a[0]=Me("cellXfs",null,{count:a.length-2}).replace("/>",">"),a.join(""))}var AN=(function(){var a=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,c=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,h,m){var p={};if(!d)return p;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=d.match(a))&&SN(v,p,m),(v=d.match(s))&&wN(v,p,h,m),(v=d.match(i))&&bN(v,p,h,m),(v=d.match(c))&&_N(v,p,h,m),(v=d.match(t))&&TN(v,p,m),p}})();function gy(e,a){var t=[fa,Me("styleSheet",null,{xmlns:vs[0],"xmlns:vt":ba.vt})],i;return e.SSF&&(i=EN(e.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=NN(a.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function kN(e,a){var t=e.read_shift(2),i=Ya(e);return[t,i]}function CN(e,a,t){t||(t=we(6+4*a.length)),t.write_shift(2,e),Ca(a,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function DN(e,a,t){var i={};i.sz=e.read_shift(2)/20;var s=uE(e);s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1);var c=e.read_shift(2);switch(c===700&&(i.bold=1),e.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var f=e.read_shift(1);f!=0&&(i.underline=f);var d=e.read_shift(1);d>0&&(i.family=d);var h=e.read_shift(1);switch(h>0&&(i.charset=h),e.l++,i.color=fE(e),e.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Ya(e),i}function jN(e,a){a||(a=we(153)),a.write_shift(2,e.sz*20),dE(e,a),a.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),a.write_shift(2,t),a.write_shift(1,e.underline||0),a.write_shift(1,e.family||0),a.write_shift(1,e.charset||0),a.write_shift(1,0),Yo(e.color,a);var i=0;return i=2,a.write_shift(1,i),Ca(e.name,a),a.length>a.l?a.slice(0,a.l):a}var FN=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ld,ON=Wa;function rv(e,a){a||(a=we(84)),Ld||(Ld=ef(FN));var t=Ld[e.patternType];t==null&&(t=40),a.write_shift(4,t);var i=0;if(t!=40)for(Yo({auto:1},a),Yo({auto:1},a);i<12;++i)a.write_shift(4,0);else{for(;i<4;++i)a.write_shift(4,0);for(;i<12;++i)a.write_shift(4,0)}return a.length>a.l?a.slice(0,a.l):a}function RN(e,a){var t=e.l+a,i=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:i,numFmtId:s}}function vy(e,a,t){t||(t=we(16)),t.write_shift(2,a||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Ec(e,a){return a||(a=we(10)),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(4,0),a}var MN=Wa;function LN(e,a){return a||(a=we(51)),a.write_shift(1,0),Ec(null,a),Ec(null,a),Ec(null,a),Ec(null,a),Ec(null,a),a.length>a.l?a.slice(0,a.l):a}function IN(e,a){return a||(a=we(52)),a.write_shift(4,e.xfId),a.write_shift(2,1),a.write_shift(1,0),a.write_shift(1,0),Xo(e.name||"",a),a.length>a.l?a.slice(0,a.l):a}function BN(e,a,t){var i=we(2052);return i.write_shift(4,e),Xo(a,i),Xo(t,i),i.length>i.l?i.slice(0,i.l):i}function UN(e,a,t){var i={};i.NumberFmt=[];for(var s in Ze)i.NumberFmt[s]=Ze[s];i.CellXf=[],i.Fonts=[];var c=[],f=!1;return Zn(e,function(h,m,p){switch(p){case 44:i.NumberFmt[h[0]]=h[1],Yn(h[1],h[0]);break;case 43:i.Fonts.push(h),h.color.theme!=null&&a&&a.themeElements&&a.themeElements.clrScheme&&(h.color.rgb=Ko(a.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:c[c.length-1]==617&&i.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:c.push(p),f=!0;break;case 38:c.pop(),f=!1;break;default:if(m.T>0)c.push(p);else if(m.T<0)c.pop();else if(!f||t.WTF&&c[c.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),i}function zN(e,a){if(a){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)a[s]!=null&&++t}),t!=0&&(je(e,615,ln(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)a[s]!=null&&je(e,44,CN(s,a[s]))}),je(e,616))}}function PN(e){var a=1;je(e,611,ln(a)),je(e,43,jN({sz:12,color:{theme:1},name:"Calibri",family:2})),je(e,612)}function HN(e){var a=2;je(e,603,ln(a)),je(e,45,rv({patternType:"none"})),je(e,45,rv({patternType:"gray125"})),je(e,604)}function VN(e){var a=1;je(e,613,ln(a)),je(e,46,LN()),je(e,614)}function GN(e){var a=1;je(e,626,ln(a)),je(e,47,vy({numFmtId:0},65535)),je(e,627)}function XN(e,a){je(e,617,ln(a.length)),a.forEach(function(t){je(e,47,vy(t,0))}),je(e,618)}function YN(e){var a=1;je(e,619,ln(a)),je(e,48,IN({xfId:0,name:"Normal"})),je(e,620)}function WN(e){var a=0;je(e,505,ln(a)),je(e,506)}function qN(e){var a=0;je(e,508,BN(a,"TableStyleMedium9","PivotStyleMedium4")),je(e,509)}function KN(e,a){var t=ur();return je(t,278),zN(t,e.SSF),PN(t),HN(t),VN(t),GN(t),XN(t,a.cellXfs),YN(t),WN(t),qN(t),je(t,279),t.end()}var ZN=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $N(e,a,t){a.themeElements.clrScheme=[];var i={};(e[0].match(qa)||[]).forEach(function(s){var c=Qe(s);switch(c[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=c.val;break;case"<a:sysClr":i.rgb=c.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":c[0].charAt(1)==="/"?(a.themeElements.clrScheme[ZN.indexOf(c[0])]=i,i={}):i.name=c[0].slice(3,c[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+c[0]+" in clrScheme")}})}function QN(){}function JN(){}var eA=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,tA=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,aA=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function rA(e,a,t){a.themeElements={};var i;[["clrScheme",eA,$N],["fontScheme",tA,QN],["fmtScheme",aA,JN]].forEach(function(s){if(!(i=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](i,a,t)})}var nA=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function yy(e,a){(!e||e.length===0)&&(e=Ih());var t,i={};if(!(t=e.match(nA)))throw new Error("themeElements not found in theme");return rA(t[0],i,a),i.raw=e,i}function Ih(e,a){if(a&&a.themeXLSX)return a.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[fa];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function iA(e,a,t){var i=e.l+a,s=e.read_shift(4);if(s!==124226){if(!t.cellStyles){e.l=i;return}var c=e.slice(e.l);e.l=i;var f;try{f=u2(c,{type:"array"})}catch{return}var d=Tr(f,"theme/theme/theme1.xml",!0);if(d)return yy(d,t)}}function sA(e){return e.read_shift(4)}function lA(e){var a={};switch(a.xclrType=e.read_shift(2),a.nTintShade=e.read_shift(2),a.xclrType){case 0:e.l+=4;break;case 1:a.xclrValue=cA(e,4);break;case 2:a.xclrValue=Q2(e);break;case 3:a.xclrValue=sA(e);break;case 4:e.l+=4;break}return e.l+=8,a}function cA(e,a){return Wa(e,a)}function oA(e,a){return Wa(e,a)}function fA(e){var a=e.read_shift(2),t=e.read_shift(2)-4,i=[a];switch(a){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=lA(e);break;case 6:i[1]=oA(e,t);break;case 14:case 15:i[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+a+" "+t)}return i}function uA(e,a){var t=e.l+a;e.l+=2;var i=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),c=[];s-- >0;)c.push(fA(e,t-e.l));return{ixfe:i,ext:c}}function dA(e,a){a.forEach(function(t){t[0]})}function hA(e,a){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ya(e)}}function mA(e){var a=we(12+2*e.name.length);return a.write_shift(4,e.flags),a.write_shift(4,e.version),Ca(e.name,a),a.slice(0,a.l)}function xA(e){for(var a=[],t=e.read_shift(4);t-- >0;)a.push([e.read_shift(4),e.read_shift(4)]);return a}function pA(e){var a=we(4+8*e.length);a.write_shift(4,e.length);for(var t=0;t<e.length;++t)a.write_shift(4,e[t][0]),a.write_shift(4,e[t][1]);return a}function gA(e,a){var t=we(8+2*a.length);return t.write_shift(4,e),Ca(a,t),t.slice(0,t.l)}function vA(e){return e.l+=4,e.read_shift(4)!=0}function yA(e,a){var t=we(8);return t.write_shift(4,e),t.write_shift(4,1),t}function _A(e,a,t){var i={Types:[],Cell:[],Value:[]},s=t||{},c=[],f=!1,d=2;return Zn(e,function(h,m,p){switch(p){case 335:i.Types.push({name:h.name});break;case 51:h.forEach(function(v){d==1?i.Cell.push({type:i.Types[v[0]-1].name,index:v[1]}):d==0&&i.Value.push({type:i.Types[v[0]-1].name,index:v[1]})});break;case 337:d=h?1:0;break;case 338:d=2;break;case 35:c.push(p),f=!0;break;case 36:c.pop(),f=!1;break;default:if(!m.T){if(!f||s.WTF&&c[c.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),i}function bA(){var e=ur();return je(e,332),je(e,334,ln(1)),je(e,335,mA({name:"XLDAPR",version:12e4,flags:3496657072})),je(e,336),je(e,339,gA(1,"XLDAPR")),je(e,52),je(e,35,ln(514)),je(e,4096,ln(0)),je(e,4097,Gr(1)),je(e,36),je(e,53),je(e,340),je(e,337,yA(1)),je(e,51,pA([[1,0]])),je(e,338),je(e,333),e.end()}function wA(e,a,t){var i={Types:[],Cell:[],Value:[]};if(!e)return i;var s=!1,c=2,f;return e.replace(qa,function(d){var h=Qe(d);switch(bn(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<i.Types.length;++m)i.Types[m].name==h.name&&(f=i.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":c==1?i.Cell.push({type:i.Types[h.t-1].name,index:+h.v}):c==0&&i.Value.push({type:i.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":c=1;break;case"</cellMetadata>":c=2;break;case"<valueMetadata":c=0;break;case"</valueMetadata>":c=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!f)break;f.offsets||(f.offsets=[]),f.offsets.push(+h.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return d}),i}function _y(){var e=[fa];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function SA(e){var a=[];if(!e)return a;var t=1;return(e.match(qa)||[]).forEach(function(i){var s=Qe(i);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,a.push(s);break}}),a}function EA(e){var a={};a.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),a.r=$e(t);var i=e.read_shift(1);return i&2&&(a.l="1"),i&8&&(a.a="1"),a}function TA(e,a,t){var i=[];return Zn(e,function(c,f,d){switch(d){case 63:i.push(c);break;default:if(!f.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),i}function NA(e,a,t,i){if(!e)return e;var s=i||{},c=!1;Zn(e,function(d,h,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:c=!0;break;case 36:c=!1;break;default:if(!h.T){if(!c||s.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},s)}function AA(e,a){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return a["!id"][t].Target}var dl=1024;function by(e,a){for(var t=[21600,21600],i=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[Me("xml",null,{"xmlns:v":wr.v,"xmlns:o":wr.o,"xmlns:x":wr.x,"xmlns:mv":wr.mv}).replace(/\/>/,">"),Me("o:shapelayout",Me("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Me("v:shapetype",[Me("v:stroke",null,{joinstyle:"miter"}),Me("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:i})];dl<e*1e3;)dl+=1e3;return a.forEach(function(c){var f=qt(c[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var h=d.type=="gradient"?Me("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=Me("v:fill",h,d),p={on:"t",obscured:"t"};++dl,s=s.concat(["<v:shape"+Vc({id:"_x0000_s"+dl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,Me("v:shadow",null,p),Me("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",La("x:Anchor",[f.c+1,0,f.r+1,0,f.c+3,20,f.r+5,20].join(",")),La("x:AutoFill","False"),La("x:Row",String(f.r)),La("x:Column",String(f.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function nv(e,a,t,i){var s=Array.isArray(e),c;a.forEach(function(f){var d=qt(f.ref);if(s?(e[d.r]||(e[d.r]=[]),c=e[d.r][d.c]):c=e[f.ref],!c){c={t:"z"},s?e[d.r][d.c]=c:e[f.ref]=c;var h=St(e["!ref"]||"BDWGO1000001:A1");h.s.r>d.r&&(h.s.r=d.r),h.e.r<d.r&&(h.e.r=d.r),h.s.c>d.c&&(h.s.c=d.c),h.e.c<d.c&&(h.e.c=d.c);var m=nt(h);m!==e["!ref"]&&(e["!ref"]=m)}c.c||(c.c=[]);var p={a:f.author,t:f.t,r:f.r,T:t};f.h&&(p.h=f.h);for(var v=c.c.length-1;v>=0;--v){if(!t&&c.c[v].T)return;t&&!c.c[v].T&&c.c.splice(v,1)}if(t&&i){for(v=0;v<i.length;++v)if(p.a==i[v].id){p.a=i[v].name||p.a;break}}c.c.push(p)})}function kA(e,a){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],i=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(f){if(!(f===""||f.trim()==="")){var d=f.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&t.push(d[1])}});var c=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return c&&c[1]&&c[1].split(/<\/\w*:?comment>/).forEach(function(f){if(!(f===""||f.trim()==="")){var d=f.match(/<(?:\w+:)?comment[^>]*>/);if(d){var h=Qe(d[0]),m={author:h.authorId&&t[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=qt(h.ref);if(!(a.sheetRows&&a.sheetRows<=p.r)){var v=f.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!v&&!!v[1]&&Rh(v[1])||{r:"",t:"",h:""};m.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),m.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),a.cellHTML&&(m.h=y.h),i.push(m)}}}}),i}function wy(e){var a=[fa,Me("comments",null,{xmlns:vs[0]})],t=[];return a.push("<authors>"),e.forEach(function(i){i[1].forEach(function(s){var c=Ot(s.a);t.indexOf(c)==-1&&(t.push(c),a.push("<author>"+c+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),a.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),a.push("<author>SheetJ5</author>")),a.push("</authors>"),a.push("<commentList>"),e.forEach(function(i){var s=0,c=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?s=t.indexOf("tc="+i[1][0].ID):i[1].forEach(function(h){h.a&&(s=t.indexOf(Ot(h.a))),c.push(h.t||"")}),a.push('<comment ref="'+i[0]+'" authorId="'+s+'"><text>'),c.length<=1)a.push(La("t",Ot(c[0]||"")));else{for(var f=`Comment:
    `+c[0]+`
`,d=1;d<c.length;++d)f+=`Reply:
    `+c[d]+`
`;a.push(La("t",Ot(f)))}a.push("</text></comment>")}),a.push("</commentList>"),a.length>2&&(a[a.length]="</comments>",a[1]=a[1].replace("/>",">")),a.join("")}function CA(e,a){var t=[],i=!1,s={},c=0;return e.replace(qa,function(d,h){var m=Qe(d);switch(bn(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":c=h+d.length;break;case"</text>":s.t=e.slice(c,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&a.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return d}),t}function DA(e,a,t){var i=[fa,Me("ThreadedComments",null,{xmlns:ba.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var c="";(s[1]||[]).forEach(function(f,d){if(!f.T){delete f.ID;return}f.a&&a.indexOf(f.a)==-1&&a.push(f.a);var h={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};d==0?c=h.id:h.parentId=c,f.ID=h.id,f.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+a.indexOf(f.a)).slice(-12)+"}"),i.push(Me("threadedComment",La("text",f.t||""),h))})}),i.push("</ThreadedComments>"),i.join("")}function jA(e,a){var t=[],i=!1;return e.replace(qa,function(c){var f=Qe(c);switch(bn(f[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:f.displayname,id:f.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&a.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),t}function FA(e){var a=[fa,Me("personList",null,{xmlns:ba.TCMNT,"xmlns:x":vs[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,i){a.push(Me("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),a.push("</personList>"),a.join("")}function OA(e){var a={};a.iauthor=e.read_shift(4);var t=ws(e);return a.rfx=t.s,a.ref=$e(t.s),e.l+=16,a}function RA(e,a){return a==null&&(a=we(36)),a.write_shift(4,e[1].iauthor),El(e[0],a),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a}var MA=Ya;function LA(e){return Ca(e.slice(0,54))}function IA(e,a){var t=[],i=[],s={},c=!1;return Zn(e,function(d,h,m){switch(m){case 632:i.push(d);break;case 635:s=d;break;case 637:s.t=d.t,s.h=d.h,s.r=d.r;break;case 636:if(s.author=i[s.iauthor],delete s.iauthor,a.sheetRows&&s.rfx&&a.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!c||a.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),t}function BA(e){var a=ur(),t=[];return je(a,628),je(a,630),e.forEach(function(i){i[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),je(a,632,LA(s.a)))})}),je(a,631),je(a,633),e.forEach(function(i){i[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var c={s:qt(i[0]),e:qt(i[0])};je(a,635,RA([c,s])),s.t&&s.t.length>0&&je(a,637,sE(s)),je(a,636),delete s.iauthor})}),je(a,634),je(a,629),a.end()}var UA="application/vnd.ms-office.vbaProject";function zA(e){var a=Ye.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,i){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ye.utils.cfb_add(a,s,e.FileIndex[i].content)}}),Ye.write(a)}function PA(e,a){a.FullPaths.forEach(function(t,i){if(i!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ye.utils.cfb_add(e,s,a.FileIndex[i].content)}})}var Sy=["xlsb","xlsm","xlam","biff8","xla"];function HA(){return{"!type":"dialog"}}function VA(){return{"!type":"dialog"}}function GA(){return{"!type":"macro"}}function XA(){return{"!type":"macro"}}var xl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,a={r:0,c:0};function t(i,s,c,f){var d=!1,h=!1;c.length==0?h=!0:c.charAt(0)=="["&&(h=!0,c=c.slice(1,-1)),f.length==0?d=!0:f.charAt(0)=="["&&(d=!0,f=f.slice(1,-1));var m=c.length>0?parseInt(c,10)|0:0,p=f.length>0?parseInt(f,10)|0:0;return d?p+=a.c:--p,h?m+=a.r:--m,s+(d?"":"$")+Wt(p)+(h?"":"$")+oa(m)}return function(s,c){return a=c,s.replace(e,t)}})(),Bh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Uh=(function(){return function(a,t){return a.replace(Bh,function(i,s,c,f,d,h){var m=Th(f)-(c?0:t.c),p=Eh(h)-(d?0:t.r),v=p==0?"":d?p+1:"["+p+"]",y=m==0?"":c?m+1:"["+m+"]";return s+"R"+v+"C"+y})}})();function Ey(e,a){return e.replace(Bh,function(t,i,s,c,f,d){return i+(s=="$"?s+c:Wt(Th(c)+a.c))+(f=="$"?f+d:oa(Eh(d)+a.r))})}function YA(e,a,t){var i=dr(a),s=i.s,c=qt(t),f={r:c.r-s.r,c:c.c-s.c};return Ey(e,f)}function WA(e){return e.length!=1}function iv(e){return e.replace(/_xlfn\./g,"")}function xa(e){e.l+=1}function Di(e,a){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Ty(e,a,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return Ny(e);t.biff==12&&(i=4)}var s=e.read_shift(i),c=e.read_shift(i),f=Di(e),d=Di(e);return{s:{r:s,c:f[0],cRel:f[1],rRel:f[2]},e:{r:c,c:d[0],cRel:d[1],rRel:d[2]}}}function Ny(e){var a=Di(e),t=Di(e),i=e.read_shift(1),s=e.read_shift(1);return{s:{r:a[0],c:i,cRel:a[1],rRel:a[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function qA(e,a,t){if(t.biff<8)return Ny(e);var i=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),c=Di(e),f=Di(e);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:s,c:f[0],cRel:f[1],rRel:f[2]}}}function Ay(e,a,t){if(t&&t.biff>=2&&t.biff<=5)return KA(e);var i=e.read_shift(t&&t.biff==12?4:2),s=Di(e);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function KA(e){var a=Di(e),t=e.read_shift(1);return{r:a[0],c:t,cRel:a[1],rRel:a[2]}}function ZA(e){var a=e.read_shift(2),t=e.read_shift(2);return{r:a,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function $A(e,a,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return QA(e);var s=e.read_shift(i>=12?4:2),c=e.read_shift(2),f=(c&16384)>>14,d=(c&32768)>>15;if(c&=16383,d==1)for(;s>524287;)s-=1048576;if(f==1)for(;c>8191;)c=c-16384;return{r:s,c,cRel:f,rRel:d}}function QA(e){var a=e.read_shift(2),t=e.read_shift(1),i=(a&32768)>>15,s=(a&16384)>>14;return a&=16383,i==1&&a>=8192&&(a=a-16384),s==1&&t>=128&&(t=t-256),{r:a,c:t,cRel:s,rRel:i}}function JA(e,a,t){var i=(e[e.l++]&96)>>5,s=Ty(e,t.biff>=2&&t.biff<=5?6:8,t);return[i,s]}function ek(e,a,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}var f=Ty(e,c,t);return[i,s,f]}function tk(e,a,t){var i=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function ak(e,a,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}return e.l+=c,[i,s]}function rk(e,a,t){var i=(e[e.l++]&96)>>5,s=qA(e,a-1,t);return[i,s]}function nk(e,a,t){var i=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[i]}function sv(e){var a=e[e.l+1]&1,t=1;return e.l+=4,[a,t]}function ik(e,a,t){e.l+=2;for(var i=e.read_shift(t&&t.biff==2?1:2),s=[],c=0;c<=i;++c)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function sk(e,a,t){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(t&&t.biff==2?1:2)]}function lk(e,a,t){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(t&&t.biff==2?1:2)]}function ck(e){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(2)]}function ok(e,a,t){var i=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[i]}function ky(e){var a=e.read_shift(1),t=e.read_shift(1);return[a,t]}function fk(e){return e.read_shift(2),ky(e)}function uk(e){return e.read_shift(2),ky(e)}function dk(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=Ay(e,0,t);return[i,s]}function hk(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=$A(e,0,t);return[i,s]}function mk(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var c=Ay(e,0,t);return[i,s,c]}function xk(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[vC[s],jy[s],i]}function pk(e,a,t){var i=e[e.l++],s=e.read_shift(1),c=t&&t.biff<=3?[i==88?-1:0,e.read_shift(1)]:gk(e);return[s,(c[0]===0?jy:gC)[c[1]]]}function gk(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function vk(e,a,t){e.l+=t&&t.biff==2?3:4}function yk(e,a,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var i=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function _k(e){return e.l++,$n[e.read_shift(1)]}function bk(e){return e.l++,e.read_shift(2)}function wk(e){return e.l++,e.read_shift(1)!==0}function Sk(e){return e.l++,Xa(e)}function Ek(e,a,t){return e.l++,t0(e,a-1,t)}function Tk(e,a){var t=[e.read_shift(1)];if(a==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=ca(e,1)?"TRUE":"FALSE",a!=12&&(e.l+=7);break;case 37:case 16:t[1]=$n[e[e.l]],e.l+=a==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Xa(e);break;case 2:t[1]=Ss(e,0,{biff:a>0&&a<8?2:a});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Nk(e,a,t){for(var i=e.read_shift(t.biff==12?4:2),s=[],c=0;c!=i;++c)s.push((t.biff==12?ws:rf)(e));return s}function Ak(e,a,t){var i=0,s=0;t.biff==12?(i=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),i=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--s==0&&(s=256));for(var c=0,f=[];c!=i&&(f[c]=[]);++c)for(var d=0;d!=s;++d)f[c][d]=Tk(e,t.biff);return f}function kk(e,a,t){var i=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,c=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[i,0,c]}function Ck(e,a,t){if(t.biff==5)return Dk(e);var i=e.read_shift(1)>>>5&3,s=e.read_shift(2),c=e.read_shift(4);return[i,s,c]}function Dk(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var i=e.read_shift(2);return e.l+=12,[a,t,i]}function jk(e,a,t){var i=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function Fk(e,a,t){var i=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function Ok(e,a,t){var i=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[i]}function Rk(e,a,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),c=4;if(t)switch(t.biff){case 5:c=15;break;case 12:c=6;break}return e.l+=c,[i,s]}var Mk=Wa,Lk=Wa,Ik=Wa;function r0(e,a,t){return e.l+=2,[ZA(e)]}function zh(e){return e.l+=6,[]}var Bk=r0,Uk=zh,zk=zh,Pk=r0;function Cy(e){return e.l+=2,[ga(e),e.read_shift(2)&1]}var Hk=r0,Vk=Cy,Gk=zh,Xk=r0,Yk=r0,Wk=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qk(e){e.l+=2;var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(4),s=e.read_shift(2),c=e.read_shift(2),f=Wk[t>>2&31];return{ixti:a,coltype:t&3,rt:f,idx:i,c:s,C:c}}function Kk(e){return e.l+=2,[e.read_shift(4)]}function Zk(e,a,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function $k(e,a,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Qk(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[a,t]}function Jk(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[a,t]}function eC(e){return e.l+=4,[0,0]}var lv={1:{n:"PtgExp",f:yk},2:{n:"PtgTbl",f:Ik},3:{n:"PtgAdd",f:xa},4:{n:"PtgSub",f:xa},5:{n:"PtgMul",f:xa},6:{n:"PtgDiv",f:xa},7:{n:"PtgPower",f:xa},8:{n:"PtgConcat",f:xa},9:{n:"PtgLt",f:xa},10:{n:"PtgLe",f:xa},11:{n:"PtgEq",f:xa},12:{n:"PtgGe",f:xa},13:{n:"PtgGt",f:xa},14:{n:"PtgNe",f:xa},15:{n:"PtgIsect",f:xa},16:{n:"PtgUnion",f:xa},17:{n:"PtgRange",f:xa},18:{n:"PtgUplus",f:xa},19:{n:"PtgUminus",f:xa},20:{n:"PtgPercent",f:xa},21:{n:"PtgParen",f:xa},22:{n:"PtgMissArg",f:xa},23:{n:"PtgStr",f:Ek},26:{n:"PtgSheet",f:Zk},27:{n:"PtgEndSheet",f:$k},28:{n:"PtgErr",f:_k},29:{n:"PtgBool",f:wk},30:{n:"PtgInt",f:bk},31:{n:"PtgNum",f:Sk},32:{n:"PtgArray",f:nk},33:{n:"PtgFunc",f:xk},34:{n:"PtgFuncVar",f:pk},35:{n:"PtgName",f:kk},36:{n:"PtgRef",f:dk},37:{n:"PtgArea",f:JA},38:{n:"PtgMemArea",f:jk},39:{n:"PtgMemErr",f:Mk},40:{n:"PtgMemNoMem",f:Lk},41:{n:"PtgMemFunc",f:Fk},42:{n:"PtgRefErr",f:Ok},43:{n:"PtgAreaErr",f:tk},44:{n:"PtgRefN",f:hk},45:{n:"PtgAreaN",f:rk},46:{n:"PtgMemAreaN",f:Qk},47:{n:"PtgMemNoMemN",f:Jk},57:{n:"PtgNameX",f:Ck},58:{n:"PtgRef3d",f:mk},59:{n:"PtgArea3d",f:ek},60:{n:"PtgRefErr3d",f:Rk},61:{n:"PtgAreaErr3d",f:ak},255:{}},tC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},aC={1:{n:"PtgElfLel",f:Cy},2:{n:"PtgElfRw",f:Xk},3:{n:"PtgElfCol",f:Bk},6:{n:"PtgElfRwV",f:Yk},7:{n:"PtgElfColV",f:Pk},10:{n:"PtgElfRadical",f:Hk},11:{n:"PtgElfRadicalS",f:Gk},13:{n:"PtgElfColS",f:Uk},15:{n:"PtgElfColSV",f:zk},16:{n:"PtgElfRadicalLel",f:Vk},25:{n:"PtgList",f:qk},29:{n:"PtgSxName",f:Kk},255:{}},rC={0:{n:"PtgAttrNoop",f:eC},1:{n:"PtgAttrSemi",f:ok},2:{n:"PtgAttrIf",f:lk},4:{n:"PtgAttrChoose",f:ik},8:{n:"PtgAttrGoto",f:sk},16:{n:"PtgAttrSum",f:vk},32:{n:"PtgAttrBaxcel",f:sv},33:{n:"PtgAttrBaxcel",f:sv},64:{n:"PtgAttrSpace",f:fk},65:{n:"PtgAttrSpaceSemi",f:uk},128:{n:"PtgAttrIfError",f:ck},255:{}};function n0(e,a,t,i){if(i.biff<8)return Wa(e,a);for(var s=e.l+a,c=[],f=0;f!==t.length;++f)switch(t[f][0]){case"PtgArray":t[f][1]=Ak(e,0,i),c.push(t[f][1]);break;case"PtgMemArea":t[f][2]=Nk(e,t[f][1],i),c.push(t[f][2]);break;case"PtgExp":i&&i.biff==12&&(t[f][1][1]=e.read_shift(4),c.push(t[f][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[f][0]}return a=s-e.l,a!==0&&c.push(Wa(e,a)),c}function i0(e,a,t){for(var i=e.l+a,s,c,f=[];i!=e.l;)a=i-e.l,c=e[e.l],s=lv[c]||lv[tC[c]],(c===24||c===25)&&(s=(c===24?aC:rC)[e[e.l+1]]),!s||!s.f?Wa(e,a):f.push([s.n,s.f(e,a,t)]);return f}function nC(e){for(var a=[],t=0;t<e.length;++t){for(var i=e[t],s=[],c=0;c<i.length;++c){var f=i[c];if(f)switch(f[0]){case 2:s.push('"'+f[1].replace(/"/g,'""')+'"');break;default:s.push(f[1])}else s.push("")}a.push(s.join(","))}return a.join(";")}var iC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sC(e,a){if(!e&&!(a&&a.biff<=5&&a.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Dy(e,a,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[a]))return e.SheetNames[a];if(!e.XTI)return"SH33TJSERR6";var i=e.XTI[a];if(t.biff<8)return a>1e4&&(a-=65536),a<0&&(a=-a),a==0?"":e.XTI[a-1];if(!i)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[i[0]][0]){case 357:return s=i[1]==-1?"#REF":e.SheetNames[i[1]],i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[i[0]][0];case 355:default:return"SH33TJSSRC"+e[i[0]][0]}switch(e[i[0]][0][0]){case 1025:return s=i[1]==-1?"#REF":e.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 14849:return e[i[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return e[i[0]][0][3]?(s=i[1]==-1?"#REF":e[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+e[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function cv(e,a,t){var i=Dy(e,a,t);return i=="#REF"?i:sC(i,t)}function Va(e,a,t,i,s){var c=s&&s.biff||8,f={s:{c:0,r:0}},d=[],h,m,p,v=0,y=0,_,w="";if(!e[0]||!e[0][0])return"";for(var b=-1,T="",C=0,L=e[0].length;C<L;++C){var N=e[0][C];switch(N[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=d.pop(),m=d.pop(),b>=0){switch(e[0][b][1][0]){case 0:T=ta(" ",e[0][b][1][1]);break;case 1:T=ta("\r",e[0][b][1][1]);break;default:if(T="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}m=m+T,b=-1}d.push(m+iC[N[0]]+h);break;case"PtgIsect":h=d.pop(),m=d.pop(),d.push(m+" "+h);break;case"PtgUnion":h=d.pop(),m=d.pop(),d.push(m+","+h);break;case"PtgRange":h=d.pop(),m=d.pop(),d.push(m+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Fc(N[1][1],f,s),d.push(Oc(p,c));break;case"PtgRefN":p=t?Fc(N[1][1],t,s):N[1][1],d.push(Oc(p,c));break;case"PtgRef3d":v=N[1][1],p=Fc(N[1][2],f,s),w=cv(i,v,s),d.push(w+"!"+Oc(p,c));break;case"PtgFunc":case"PtgFuncVar":var j=N[1][0],V=N[1][1];j||(j=0),j&=127;var M=j==0?[]:d.slice(-j);d.length-=j,V==="User"&&(V=M.shift()),d.push(V+"("+M.join(",")+")");break;case"PtgBool":d.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(N[1]);break;case"PtgNum":d.push(String(N[1]));break;case"PtgStr":d.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(N[1]);break;case"PtgAreaN":_=Ig(N[1][1],t?{s:t}:f,s),d.push(Fd(_,s));break;case"PtgArea":_=Ig(N[1][1],f,s),d.push(Fd(_,s));break;case"PtgArea3d":v=N[1][1],_=N[1][2],w=cv(i,v,s),d.push(w+"!"+Fd(_,s));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=N[1][2];var k=(i.names||[])[y-1]||(i[0]||[])[y],W=k?k.Name:"SH33TJSNAME"+String(y);W&&W.slice(0,6)=="_xlfn."&&!s.xlfn&&(W=W.slice(6)),d.push(W);break;case"PtgNameX":var K=N[1][1];y=N[1][2];var J;if(s.biff<=5)K<0&&(K=-K),i[K]&&(J=i[K][y]);else{var Z="";if(((i[K]||[])[0]||[])[0]==14849||(((i[K]||[])[0]||[])[0]==1025?i[K][y]&&i[K][y].itab>0&&(Z=i.SheetNames[i[K][y].itab-1]+"!"):Z=i.SheetNames[y-1]+"!"),i[K]&&i[K][y])Z+=i[K][y].Name;else if(i[0]&&i[0][y])Z+=i[0][y].Name;else{var Q=(Dy(i,K,s)||"").split(";;");Q[y-1]?Z=Q[y-1]:Z+="SH33TJSERRX"}d.push(Z);break}J||(J={Name:"SH33TJSERRY"}),d.push(J.Name);break;case"PtgParen":var re="(",ue=")";if(b>=0){switch(T="",e[0][b][1][0]){case 2:re=ta(" ",e[0][b][1][1])+re;break;case 3:re=ta("\r",e[0][b][1][1])+re;break;case 4:ue=ta(" ",e[0][b][1][1])+ue;break;case 5:ue=ta("\r",e[0][b][1][1])+ue;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}d.push(re+d.pop()+ue);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":p={c:N[1][1],r:N[1][0]};var ve={c:t.c,r:t.r};if(i.sharedf[$e(p)]){var ee=i.sharedf[$e(p)];d.push(Va(ee,f,ve,i,s))}else{var G=!1;for(h=0;h!=i.arrayf.length;++h)if(m=i.arrayf[h],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){d.push(Va(m[1],f,ve,i,s)),G=!0;break}G||d.push(N[1])}break;case"PtgArray":d.push("{"+nC(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&b>=0&&ae.indexOf(e[0][C][0])==-1){N=e[0][b];var R=!0;switch(N[1][0]){case 4:R=!1;case 0:T=ta(" ",N[1][1]);break;case 5:R=!1;case 1:T=ta("\r",N[1][1]);break;default:if(T="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}d.push((R?T:"")+d.pop()+(R?"":T)),b=-1}}if(d.length>1&&s.WTF)throw new Error("bad formula stack");return d[0]}function lC(e,a,t){var i=e.l+a,s=t.biff==2?1:2,c,f=e.read_shift(s);if(f==65535)return[[],Wa(e,a-2)];var d=i0(e,f,t);return a!==f+s&&(c=n0(e,a-f-s,d,t)),e.l=i,[d,c]}function cC(e,a,t){var i=e.l+a,s=t.biff==2?1:2,c,f=e.read_shift(s);if(f==65535)return[[],Wa(e,a-2)];var d=i0(e,f,t);return a!==f+s&&(c=n0(e,a-f-s,d,t)),e.l=i,[d,c]}function oC(e,a,t,i){var s=e.l+a,c=i0(e,i,t),f;return s!==e.l&&(f=n0(e,s-e.l,c,t)),[c,f]}function fC(e,a,t){var i=e.l+a,s,c=e.read_shift(2),f=i0(e,c,t);return c==65535?[[],Wa(e,a-2)]:(a!==c+2&&(s=n0(e,i-c-2,f,t)),[f,s])}function uC(e){var a;if(Gn(e,e.l+6)!==65535)return[Xa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return a=e[e.l+2]===1,e.l+=8,[a,"b"];case 2:return a=e[e.l+2],e.l+=8,[a,"e"];case 3:return e.l+=8,["","s"]}return[]}function dC(e){if(e==null){var a=we(8);return a.write_shift(1,3),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,65535),a}else if(typeof e=="number")return ms(e);return ms(0)}function Id(e,a,t){var i=e.l+a,s=wn(e);t.biff==2&&++e.l;var c=uC(e),f=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var d=cC(e,i-e.l,t);return{cell:s,val:c[0],formula:d,shared:f>>3&1,tt:c[1]}}function hC(e,a,t,i,s){var c=ps(a,t,s),f=dC(e.v),d=we(6),h=33;d.write_shift(2,h),d.write_shift(4,0);for(var m=we(e.bf.length),p=0;p<e.bf.length;++p)m[p]=e.bf[p];var v=ka([c,f,d,m]);return v}function nf(e,a,t){var i=e.read_shift(4),s=i0(e,i,t),c=e.read_shift(4),f=c>0?n0(e,c,s,t):null;return[s,f]}var mC=nf,sf=nf,xC=nf,pC=nf,gC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},jy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ov(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(a,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function yC(e){var a="of:="+e.replace(Bh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return a.replace(/;/g,"|").replace(/,/g,";")}function Bd(e){var a=e.split(":"),t=a[0].split(".")[0];return[t,a[0].split(".")[1]+(a.length>1?":"+(a[1].split(".")[1]||a[1].split(".")[0]):"")]}function _C(e){return e.replace(/\./,"!")}var Mc={},pl={},Lc=typeof Map<"u";function Ph(e,a,t){var i=0,s=e.length;if(t){if(Lc?t.has(a):Object.prototype.hasOwnProperty.call(t,a)){for(var c=Lc?t.get(a):t[a];i<c.length;++i)if(e[c[i]].t===a)return e.Count++,c[i]}}else for(;i<s;++i)if(e[i].t===a)return e.Count++,i;return e[s]={t:a},e.Count++,e.Unique++,t&&(Lc?(t.has(a)||t.set(a,[]),t.get(a).push(s)):(Object.prototype.hasOwnProperty.call(t,a)||(t[a]=[]),t[a].push(s))),s}function lf(e,a){var t={min:e+1,max:e+1},i=-1;return a.MDW&&(Ga=a.MDW),a.width!=null?t.customWidth=1:a.wpx!=null?i=qc(a.wpx):a.wch!=null&&(i=a.wch),i>-1?(t.width=Zo(i),t.customWidth=1):a.width!=null&&(t.width=a.width),a.hidden&&(t.hidden=!0),a.level!=null&&(t.outlineLevel=t.level=a.level),t}function os(e,a){if(e){var t=[.7,.7,.75,.75,.3,.3];a=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Li(e,a,t){var i=t.revssf[a.z!=null?a.z:"General"],s=60,c=e.length;if(i==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){Yn(a.z,s),t.ssf[s]=a.z,t.revssf[a.z]=i=s;break}}for(s=0;s!=c;++s)if(e[s].numFmtId===i)return s;return e[c]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function Fy(e,a,t,i,s,c){try{i.cellNF&&(e.z=Ze[a])}catch(d){if(i.WTF)throw d}if(!(e.t==="z"&&!i.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Gt(e.v)),(!i||i.cellText!==!1)&&e.t!=="z")try{if(Ze[a]==null&&Yn(g4[a]||"General",a),e.t==="e")e.w=e.w||$n[e.v];else if(a===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pc(e.v);else if(e.t==="d"){var f=wa(e.v);(f|0)===f?e.w=f.toString(10):e.w=Pc(f)}else{if(e.v===void 0)return"";e.w=ds(e.v,pl)}else e.t==="d"?e.w=Wr(a,wa(e.v),pl):e.w=Wr(a,e.v,pl)}catch(d){if(i.WTF)throw d}if(i.cellStyles&&t!=null)try{e.s=c.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ko(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),i.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ko(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),i.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(i.WTF&&c.Fills)throw d}}}function bC(e,a,t){if(e&&e["!ref"]){var i=St(e["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function wC(e,a){var t=St(a);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=nt(t))}var SC=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,EC=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,TC=/<(?:\w:)?hyperlink [^>]*>/mg,NC=/"(\w*:\w*)"/,AC=/<(?:\w:)?col\b[^>]*[\/]?>/g,kC=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,CC=/<(?:\w:)?pageMargins[^>]*\/>/g,Oy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,DC=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,jC=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function FC(e,a,t,i,s,c,f){if(!e)return e;i||(i={"!id":{}});var d=a.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",p="",v=e.match(EC);v?(m=e.slice(0,v.index),p=e.slice(v.index+v[0].length)):m=p=e;var y=m.match(Oy);y?Hh(y[0],d,s,t):(y=m.match(DC))&&RC(y[0],y[1]||"",d,s,t);var _=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var w=m.slice(_,_+50).match(NC);w&&wC(d,w[1])}var b=m.match(jC);b&&b[1]&&WC(b[1],s);var T=[];if(a.cellStyles){var C=m.match(AC);C&&HC(T,C)}v&&ZC(v[1],d,a,h,c,f);var L=p.match(kC);L&&(d["!autofilter"]=GC(L[0]));var N=[],j=p.match(SC);if(j)for(_=0;_!=j.length;++_)N[_]=St(j[_].slice(j[_].indexOf('"')+1));var V=p.match(TC);V&&UC(d,V,i);var M=p.match(CC);if(M&&(d["!margins"]=zC(Qe(M[0]))),!d["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(d["!ref"]=nt(h)),a.sheetRows>0&&d["!ref"]){var k=St(d["!ref"]);a.sheetRows<=+k.e.r&&(k.e.r=a.sheetRows-1,k.e.r>h.e.r&&(k.e.r=h.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>h.e.c&&(k.e.c=h.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),d["!fullref"]=d["!ref"],d["!ref"]=nt(k))}return T.length>0&&(d["!cols"]=T),N.length>0&&(d["!merges"]=N),d}function OC(e){if(e.length===0)return"";for(var a='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)a+='<mergeCell ref="'+nt(e[t])+'"/>';return a+"</mergeCells>"}function Hh(e,a,t,i){var s=Qe(e);t.Sheets[i]||(t.Sheets[i]={}),s.codeName&&(t.Sheets[i].CodeName=wt(It(s.codeName)))}function RC(e,a,t,i,s){Hh(e.slice(0,e.indexOf(">")),t,i,s)}function MC(e,a,t,i,s){var c=!1,f={},d=null;if(i.bookType!=="xlsx"&&a.vbaraw){var h=a.SheetNames[t];try{a.Workbook&&(h=a.Workbook.Sheets[t].CodeName||h)}catch{}c=!0,f.codeName=gn(Ot(h))}if(e&&e["!outline"]){var m={summaryBelow:1,summaryRight:1};e["!outline"].above&&(m.summaryBelow=0),e["!outline"].left&&(m.summaryRight=0),d=(d||"")+Me("outlinePr",null,m)}!c&&!d||(s[s.length]=Me("sheetPr",d,f))}var LC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],IC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function BC(e){var a={sheet:1};return LC.forEach(function(t){e[t]!=null&&e[t]&&(a[t]="1")}),IC.forEach(function(t){e[t]!=null&&!e[t]&&(a[t]="0")}),e.password&&(a.password=Mh(e.password).toString(16).toUpperCase()),Me("sheetProtection",null,a)}function UC(e,a,t){for(var i=Array.isArray(e),s=0;s!=a.length;++s){var c=Qe(It(a[s]),!0);if(!c.ref)return;var f=((t||{})["!id"]||[])[c.id];f?(c.Target=f.Target,c.location&&(c.Target+="#"+wt(c.location))):(c.Target="#"+wt(c.location),f={Target:c.Target,TargetMode:"Internal"}),c.Rel=f,c.tooltip&&(c.Tooltip=c.tooltip,delete c.tooltip);for(var d=St(c.ref),h=d.s.r;h<=d.e.r;++h)for(var m=d.s.c;m<=d.e.c;++m){var p=$e({c:m,r:h});i?(e[h]||(e[h]=[]),e[h][m]||(e[h][m]={t:"z",v:void 0}),e[h][m].l=c):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=c)}}}function zC(e){var a={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(a[t]=parseFloat(e[t]))}),a}function PC(e){return os(e),Me("pageMargins",null,e)}function HC(e,a){for(var t=!1,i=0;i!=a.length;++i){var s=Qe(a[i],!0);s.hidden&&(s.hidden=Vt(s.hidden));var c=parseInt(s.min,10)-1,f=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,Lh(s.width)),Ci(s);c<=f;)e[c++]=Xt(s)}}function VC(e,a){for(var t=["<cols>"],i,s=0;s!=a.length;++s)(i=a[s])&&(t[t.length]=Me("col",null,lf(s,i)));return t[t.length]="</cols>",t.join("")}function GC(e){var a={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return a}function XC(e,a,t,i){var s=typeof e.ref=="string"?e.ref:nt(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,f=dr(s);f.s.r==f.e.r&&(f.e.r=dr(a["!ref"]).e.r,s=nt(f));for(var d=0;d<c.length;++d){var h=c[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref="'"+t.SheetNames[i]+"'!"+s;break}}return d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+s}),Me("autoFilter",null,{ref:s})}var YC=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function WC(e,a){a.Views||(a.Views=[{}]),(e.match(YC)||[]).forEach(function(t,i){var s=Qe(t);a.Views[i]||(a.Views[i]={}),+s.zoomScale&&(a.Views[i].zoom=+s.zoomScale),Vt(s.rightToLeft)&&(a.Views[i].RTL=!0)})}function qC(e,a,t,i){var s={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Me("sheetViews",Me("sheetView",null,s),{})}function KC(e,a,t,i){if(e.c&&t["!comments"].push([a,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",c=e.t,f=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=$n[e.v];break;case"d":i&&i.cellDates?s=Gt(e.v,-1).toISOString():(e=Xt(e),e.t="n",s=""+(e.v=wa(Gt(e.v)))),typeof e.z>"u"&&(e.z=Ze[14]);break;default:s=e.v;break}var d=La("v",Ot(s)),h={r:a},m=Li(i.cellXfs,e,i);switch(m!==0&&(h.s=m),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){d=La("v",""+Ph(i.Strings,e.v,i.revStrings)),h.t="s";break}h.t="str";break}if(e.t!=c&&(e.t=c,e.v=f),typeof e.f=="string"&&e.f){var p=e.F&&e.F.slice(0,a.length)==a?{t:"array",ref:e.F}:null;d=Me("f",Ot(e.f),p)+(e.v!=null?d:"")}return e.l&&t["!links"].push([a,e.l]),e.D&&(h.cm=1),Me("c",d,h)}var ZC=(function(){var e=/<(?:\w+:)?c[ \/>]/,a=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,c=Hc("v"),f=Hc("f");return function(h,m,p,v,y,_){for(var w=0,b="",T=[],C=[],L=0,N=0,j=0,V="",M,k,W=0,K=0,J,Z,Q=0,re=0,ue=Array.isArray(_.CellXf),ve,ee=[],G=[],ae=Array.isArray(m),R=[],se={},A=!1,E=!!p.sheetStubs,O=h.split(a),B=0,z=O.length;B!=z;++B){b=O[B].trim();var le=b.length;if(le!==0){var ye=0;e:for(w=0;w<le;++w)switch(b[w]){case">":if(b[w-1]!="/"){++w;break e}if(p&&p.cellStyles){if(k=Qe(b.slice(ye,w),!0),W=k.r!=null?parseInt(k.r,10):W+1,K=-1,p.sheetRows&&p.sheetRows<W)continue;se={},A=!1,k.ht&&(A=!0,se.hpt=parseFloat(k.ht),se.hpx=yl(se.hpt)),k.hidden=="1"&&(A=!0,se.hidden=!0),k.outlineLevel!=null&&(A=!0,se.level=+k.outlineLevel),A&&(R[W-1]=se)}break;case"<":ye=w;break}if(ye>=w)break;if(k=Qe(b.slice(ye,w),!0),W=k.r!=null?parseInt(k.r,10):W+1,K=-1,!(p.sheetRows&&p.sheetRows<W)){v.s.r>W-1&&(v.s.r=W-1),v.e.r<W-1&&(v.e.r=W-1),p&&p.cellStyles&&(se={},A=!1,k.ht&&(A=!0,se.hpt=parseFloat(k.ht),se.hpx=yl(se.hpt)),k.hidden=="1"&&(A=!0,se.hidden=!0),k.outlineLevel!=null&&(A=!0,se.level=+k.outlineLevel),A&&(R[W-1]=se)),T=b.slice(w).split(e);for(var Ne=0;Ne!=T.length&&T[Ne].trim().charAt(0)=="<";++Ne);for(T=T.slice(Ne),w=0;w!=T.length;++w)if(b=T[w].trim(),b.length!==0){if(C=b.match(t),L=w,N=0,j=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,C!=null&&C.length===2){for(L=0,V=C[1],N=0;N!=V.length&&!((j=V.charCodeAt(N)-64)<1||j>26);++N)L=26*L+j;--L,K=L}else++K;for(N=0;N!=b.length&&b.charCodeAt(N)!==62;++N);if(++N,k=Qe(b.slice(0,N),!0),k.r||(k.r=$e({r:W-1,c:K})),V=b.slice(N),M={t:""},(C=V.match(c))!=null&&C[1]!==""&&(M.v=wt(C[1])),p.cellFormula){if((C=V.match(f))!=null&&C[1]!==""){if(M.f=wt(It(C[1])).replace(/\r\n/g,`
`),p.xlfn||(M.f=iv(M.f)),C[0].indexOf('t="array"')>-1)M.F=(V.match(s)||[])[1],M.F.indexOf(":")>-1&&ee.push([St(M.F),M.F]);else if(C[0].indexOf('t="shared"')>-1){Z=Qe(C[0]);var Te=wt(It(C[1]));p.xlfn||(Te=iv(Te)),G[parseInt(Z.si,10)]=[Z,Te,k.r]}}else(C=V.match(/<f[^>]*\/>/))&&(Z=Qe(C[0]),G[Z.si]&&(M.f=YA(G[Z.si][1],G[Z.si][2],k.r)));var De=qt(k.r);for(N=0;N<ee.length;++N)De.r>=ee[N][0].s.r&&De.r<=ee[N][0].e.r&&De.c>=ee[N][0].s.c&&De.c<=ee[N][0].e.c&&(M.F=ee[N][1])}if(k.t==null&&M.v===void 0)if(M.f||M.F)M.v=0,M.t="n";else if(E)M.t="z";else continue;else M.t=k.t||"n";switch(v.s.c>K&&(v.s.c=K),v.e.c<K&&(v.e.c=K),M.t){case"n":if(M.v==""||M.v==null){if(!E)continue;M.t="z"}else M.v=parseFloat(M.v);break;case"s":if(typeof M.v>"u"){if(!E)continue;M.t="z"}else J=Mc[parseInt(M.v,10)],M.v=J.t,M.r=J.r,p.cellHTML&&(M.h=J.h);break;case"str":M.t="s",M.v=M.v!=null?It(M.v):"",p.cellHTML&&(M.h=_h(M.v));break;case"inlineStr":C=V.match(i),M.t="s",C!=null&&(J=Rh(C[1]))?(M.v=J.t,p.cellHTML&&(M.h=J.h)):M.v="";break;case"b":M.v=Vt(M.v);break;case"d":p.cellDates?M.v=Gt(M.v,1):(M.v=wa(Gt(M.v,1)),M.t="n");break;case"e":(!p||p.cellText!==!1)&&(M.w=M.v),M.v=M2[M.v];break}if(Q=re=0,ve=null,ue&&k.s!==void 0&&(ve=_.CellXf[k.s],ve!=null&&(ve.numFmtId!=null&&(Q=ve.numFmtId),p.cellStyles&&ve.fillId!=null&&(re=ve.fillId))),Fy(M,Q,re,p,y,_),p.cellDates&&ue&&M.t=="n"&&bl(Ze[Q])&&(M.t="d",M.v=af(M.v)),k.cm&&p.xlmeta){var Ve=(p.xlmeta.Cell||[])[+k.cm-1];Ve&&Ve.type=="XLDAPR"&&(M.D=!0)}if(ae){var q=qt(k.r);m[q.r]||(m[q.r]=[]),m[q.r][q.c]=M}else m[k.r]=M}}}}R.length>0&&(m["!rows"]=R)}})();function $C(e,a,t,i){var s=[],c=[],f=St(e["!ref"]),d="",h,m="",p=[],v=0,y=0,_=e["!rows"],w=Array.isArray(e),b={r:m},T,C=-1;for(y=f.s.c;y<=f.e.c;++y)p[y]=Wt(y);for(v=f.s.r;v<=f.e.r;++v){for(c=[],m=oa(v),y=f.s.c;y<=f.e.c;++y){h=p[y]+m;var L=w?(e[v]||[])[y]:e[h];L!==void 0&&(d=KC(L,h,e,a))!=null&&c.push(d)}(c.length>0||_&&_[v])&&(b={r:m},_&&_[v]&&(T=_[v],T.hidden&&(b.hidden=1),C=-1,T.hpx?C=Kc(T.hpx):T.hpt&&(C=T.hpt),C>-1&&(b.ht=C,b.customHeight=1),T.level&&(b.outlineLevel=T.level)),s[s.length]=Me("row",c.join(""),b))}if(_)for(;v<_.length;++v)_&&_[v]&&(b={r:v+1},T=_[v],T.hidden&&(b.hidden=1),C=-1,T.hpx?C=Kc(T.hpx):T.hpt&&(C=T.hpt),C>-1&&(b.ht=C,b.customHeight=1),T.level&&(b.outlineLevel=T.level),s[s.length]=Me("row","",b));return s.join("")}function Ry(e,a,t,i){var s=[fa,Me("worksheet",null,{xmlns:vs[0],"xmlns:r":ba.r})],c=t.SheetNames[e],f=0,d="",h=t.Sheets[c];h==null&&(h={});var m=h["!ref"]||"A1",p=St(m);if(p.e.c>16383||p.e.r>1048575){if(a.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),m=nt(p)}i||(i={}),h["!comments"]=[];var v=[];MC(h,t,e,a,s),s[s.length]=Me("dimension",null,{ref:m}),s[s.length]=qC(h,a,e,t),a.sheetFormat&&(s[s.length]=Me("sheetFormatPr",null,{defaultRowHeight:a.sheetFormat.defaultRowHeight||"16",baseColWidth:a.sheetFormat.baseColWidth||"10",outlineLevelRow:a.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(s[s.length]=VC(h,h["!cols"])),s[f=s.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(d=$C(h,a),d.length>0&&(s[s.length]=d)),s.length>f+1&&(s[s.length]="</sheetData>",s[f]=s[f].replace("/>",">")),h["!protect"]&&(s[s.length]=BC(h["!protect"])),h["!autofilter"]!=null&&(s[s.length]=XC(h["!autofilter"],h,t,e)),h["!merges"]!=null&&h["!merges"].length>0&&(s[s.length]=OC(h["!merges"]));var y=-1,_,w=-1;return h["!links"].length>0&&(s[s.length]="<hyperlinks>",h["!links"].forEach(function(b){b[1].Target&&(_={ref:b[0]},b[1].Target.charAt(0)!="#"&&(w=Ft(i,-1,Ot(b[1].Target).replace(/#.*$/,""),ft.HLINK),_["r:id"]="rId"+w),(y=b[1].Target.indexOf("#"))>-1&&(_.location=Ot(b[1].Target.slice(y+1))),b[1].Tooltip&&(_.tooltip=Ot(b[1].Tooltip)),s[s.length]=Me("hyperlink",null,_))}),s[s.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(s[s.length]=PC(h["!margins"])),(!a||a.ignoreEC||a.ignoreEC==null)&&(s[s.length]=La("ignoredErrors",Me("ignoredError",null,{numberStoredAsText:1,sqref:m}))),v.length>0&&(w=Ft(i,-1,"../drawings/drawing"+(e+1)+".xml",ft.DRAW),s[s.length]=Me("drawing",null,{"r:id":"rId"+w}),h["!drawing"]=v),h["!comments"].length>0&&(w=Ft(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ft.VML),s[s.length]=Me("legacyDrawing",null,{"r:id":"rId"+w}),h["!legacy"]=w),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function QC(e,a){var t={},i=e.l+a;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var c=e.read_shift(1);return e.l=i,c&7&&(t.level=c&7),c&16&&(t.hidden=!0),c&32&&(t.hpt=s/20),t}function JC(e,a,t){var i=we(145),s=(t["!rows"]||[])[e]||{};i.write_shift(4,e),i.write_shift(4,0);var c=320;s.hpx?c=Kc(s.hpx)*20:s.hpt&&(c=s.hpt*20),i.write_shift(2,c),i.write_shift(1,0);var f=0;s.level&&(f|=s.level),s.hidden&&(f|=16),(s.hpx||s.hpt)&&(f|=32),i.write_shift(1,f),i.write_shift(1,0);var d=0,h=i.l;i.l+=4;for(var m={r:e,c:0},p=0;p<16;++p)if(!(a.s.c>p+1<<10||a.e.c<p<<10)){for(var v=-1,y=-1,_=p<<10;_<p+1<<10;++_){m.c=_;var w=Array.isArray(t)?(t[m.r]||[])[m.c]:t[$e(m)];w&&(v<0&&(v=_),y=_)}v<0||(++d,i.write_shift(4,v),i.write_shift(4,y))}var b=i.l;return i.l=h,i.write_shift(4,d),i.l=b,i.length>i.l?i.slice(0,i.l):i}function e6(e,a,t,i){var s=JC(i,t,a);(s.length>17||(a["!rows"]||[])[i])&&je(e,0,s)}var t6=ws,a6=El;function r6(){}function n6(e,a){var t={},i=e[e.l];return++e.l,t.above=!(i&64),t.left=!(i&128),e.l+=18,t.name=lE(e),t}function i6(e,a,t){t==null&&(t=we(84+4*e.length));var i=192;a&&(a.above&&(i&=-65),a.left&&(i&=-129)),t.write_shift(1,i);for(var s=1;s<3;++s)t.write_shift(1,0);return Yo({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),D2(e,t),t.slice(0,t.l)}function s6(e){var a=qr(e);return[a]}function l6(e,a,t){return t==null&&(t=we(8)),ys(a,t)}function c6(e){var a=_s(e);return[a]}function o6(e,a,t){return t==null&&(t=we(4)),bs(a,t)}function f6(e){var a=qr(e),t=e.read_shift(1);return[a,t,"b"]}function u6(e,a,t){return t==null&&(t=we(9)),ys(a,t),t.write_shift(1,e.v?1:0),t}function d6(e){var a=_s(e),t=e.read_shift(1);return[a,t,"b"]}function h6(e,a,t){return t==null&&(t=we(5)),bs(a,t),t.write_shift(1,e.v?1:0),t}function m6(e){var a=qr(e),t=e.read_shift(1);return[a,t,"e"]}function x6(e,a,t){return t==null&&(t=we(9)),ys(a,t),t.write_shift(1,e.v),t}function p6(e){var a=_s(e),t=e.read_shift(1);return[a,t,"e"]}function g6(e,a,t){return t==null&&(t=we(8)),bs(a,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function v6(e){var a=qr(e),t=e.read_shift(4);return[a,t,"s"]}function y6(e,a,t){return t==null&&(t=we(12)),ys(a,t),t.write_shift(4,a.v),t}function _6(e){var a=_s(e),t=e.read_shift(4);return[a,t,"s"]}function b6(e,a,t){return t==null&&(t=we(8)),bs(a,t),t.write_shift(4,a.v),t}function w6(e){var a=qr(e),t=Xa(e);return[a,t,"n"]}function S6(e,a,t){return t==null&&(t=we(16)),ys(a,t),ms(e.v,t),t}function My(e){var a=_s(e),t=Xa(e);return[a,t,"n"]}function E6(e,a,t){return t==null&&(t=we(12)),bs(a,t),ms(e.v,t),t}function T6(e){var a=qr(e),t=Ch(e);return[a,t,"n"]}function N6(e,a,t){return t==null&&(t=we(12)),ys(a,t),j2(e.v,t),t}function A6(e){var a=_s(e),t=Ch(e);return[a,t,"n"]}function k6(e,a,t){return t==null&&(t=we(8)),bs(a,t),j2(e.v,t),t}function C6(e){var a=qr(e),t=Nh(e);return[a,t,"is"]}function D6(e){var a=qr(e),t=Ya(e);return[a,t,"str"]}function j6(e,a,t){return t==null&&(t=we(12+4*e.v.length)),ys(a,t),Ca(e.v,t),t.length>t.l?t.slice(0,t.l):t}function F6(e){var a=_s(e),t=Ya(e);return[a,t,"str"]}function O6(e,a,t){return t==null&&(t=we(8+4*e.v.length)),bs(a,t),Ca(e.v,t),t.length>t.l?t.slice(0,t.l):t}function R6(e,a,t){var i=e.l+a,s=qr(e);s.r=t["!row"];var c=e.read_shift(1),f=[s,c,"b"];if(t.cellFormula){e.l+=2;var d=sf(e,i-e.l,t);f[3]=Va(d,null,s,t.supbooks,t)}else e.l=i;return f}function M6(e,a,t){var i=e.l+a,s=qr(e);s.r=t["!row"];var c=e.read_shift(1),f=[s,c,"e"];if(t.cellFormula){e.l+=2;var d=sf(e,i-e.l,t);f[3]=Va(d,null,s,t.supbooks,t)}else e.l=i;return f}function L6(e,a,t){var i=e.l+a,s=qr(e);s.r=t["!row"];var c=Xa(e),f=[s,c,"n"];if(t.cellFormula){e.l+=2;var d=sf(e,i-e.l,t);f[3]=Va(d,null,s,t.supbooks,t)}else e.l=i;return f}function I6(e,a,t){var i=e.l+a,s=qr(e);s.r=t["!row"];var c=Ya(e),f=[s,c,"str"];if(t.cellFormula){e.l+=2;var d=sf(e,i-e.l,t);f[3]=Va(d,null,s,t.supbooks,t)}else e.l=i;return f}var B6=ws,U6=El;function z6(e,a){return a==null&&(a=we(4)),a.write_shift(4,e),a}function P6(e,a){var t=e.l+a,i=ws(e),s=Ah(e),c=Ya(e),f=Ya(e),d=Ya(e);e.l=t;var h={rfx:i,relId:s,loc:c,display:d};return f&&(h.Tooltip=f),h}function H6(e,a){var t=we(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));El({s:qt(e[0]),e:qt(e[0])},t),kh("rId"+a,t);var i=e[1].Target.indexOf("#"),s=i==-1?"":e[1].Target.slice(i+1);return Ca(s||"",t),Ca(e[1].Tooltip||"",t),Ca("",t),t.slice(0,t.l)}function V6(){}function G6(e,a,t){var i=e.l+a,s=F2(e),c=e.read_shift(1),f=[s];if(f[2]=c,t.cellFormula){var d=mC(e,i-e.l,t);f[1]=d}else e.l=i;return f}function X6(e,a,t){var i=e.l+a,s=ws(e),c=[s];if(t.cellFormula){var f=pC(e,i-e.l,t);c[1]=f,e.l=i}else e.l=i;return c}function Y6(e,a,t){t==null&&(t=we(18));var i=lf(e,a);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var s=0;return a.hidden&&(s|=1),typeof i.width=="number"&&(s|=2),a.level&&(s|=a.level<<8),t.write_shift(2,s),t}var Ly=["left","right","top","bottom","header","footer"];function W6(e){var a={};return Ly.forEach(function(t){a[t]=Xa(e)}),a}function q6(e,a){return a==null&&(a=we(48)),os(e),Ly.forEach(function(t){ms(e[t],a)}),a}function K6(e){var a=e.read_shift(2);return e.l+=28,{RTL:a&32}}function Z6(e,a,t){t==null&&(t=we(30));var i=924;return(((a||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function $6(e){var a=we(24);return a.write_shift(4,4),a.write_shift(4,1),El(e,a),a}function Q6(e,a){return a==null&&(a=we(66)),a.write_shift(2,e.password?Mh(e.password):0),a.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?a.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):a.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),a}function J6(){}function e5(){}function t5(e,a,t,i,s,c,f){if(!e)return e;var d=a||{};i||(i={"!id":{}});var h=d.dense?[]:{},m,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,y=!1,_,w,b,T,C,L,N,j,V,M=[];d.biff=12,d["!row"]=0;var k=0,W=!1,K=[],J={},Z=d.supbooks||s.supbooks||[[]];if(Z.sharedf=J,Z.arrayf=K,Z.SheetNames=s.SheetNames||s.Sheets.map(function(ae){return ae.name}),!d.supbooks&&(d.supbooks=Z,s.Names))for(var Q=0;Q<s.Names.length;++Q)Z[0][Q+1]=s.Names[Q];var re=[],ue=[],ve=!1;Zc[16]={n:"BrtShortReal",f:My};var ee;if(Zn(e,function(R,se,A){if(!y)switch(A){case 148:m=R;break;case 0:_=R,d.sheetRows&&d.sheetRows<=_.r&&(y=!0),j=oa(T=_.r),d["!row"]=_.r,(R.hidden||R.hpt||R.level!=null)&&(R.hpt&&(R.hpx=yl(R.hpt)),ue[R.r]=R);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:R[2]},R[2]){case"n":w.v=R[1];break;case"s":N=Mc[R[1]],w.v=N.t,w.r=N.r;break;case"b":w.v=!!R[1];break;case"e":w.v=R[1],d.cellText!==!1&&(w.w=$n[w.v]);break;case"str":w.t="s",w.v=R[1];break;case"is":w.t="s",w.v=R[1].t;break}if((b=f.CellXf[R[0].iStyleRef])&&Fy(w,b.numFmtId,null,d,c,f),C=R[0].c==-1?C+1:R[0].c,d.dense?(h[T]||(h[T]=[]),h[T][C]=w):h[Wt(C)+j]=w,d.cellFormula){for(W=!1,k=0;k<K.length;++k){var E=K[k];_.r>=E[0].s.r&&_.r<=E[0].e.r&&C>=E[0].s.c&&C<=E[0].e.c&&(w.F=nt(E[0]),W=!0)}!W&&R.length>3&&(w.f=R[3])}if(p.s.r>_.r&&(p.s.r=_.r),p.s.c>C&&(p.s.c=C),p.e.r<_.r&&(p.e.r=_.r),p.e.c<C&&(p.e.c=C),d.cellDates&&b&&w.t=="n"&&bl(Ze[b.numFmtId])){var O=is(w.v);O&&(w.t="d",w.v=new Date(O.y,O.m-1,O.d,O.H,O.M,O.S,O.u))}ee&&(ee.type=="XLDAPR"&&(w.D=!0),ee=void 0);break;case 1:case 12:if(!d.sheetStubs||v)break;w={t:"z",v:void 0},C=R[0].c==-1?C+1:R[0].c,d.dense?(h[T]||(h[T]=[]),h[T][C]=w):h[Wt(C)+j]=w,p.s.r>_.r&&(p.s.r=_.r),p.s.c>C&&(p.s.c=C),p.e.r<_.r&&(p.e.r=_.r),p.e.c<C&&(p.e.c=C),ee&&(ee.type=="XLDAPR"&&(w.D=!0),ee=void 0);break;case 176:M.push(R);break;case 49:ee=((d.xlmeta||{}).Cell||[])[R-1];break;case 494:var B=i["!id"][R.relId];for(B?(R.Target=B.Target,R.loc&&(R.Target+="#"+R.loc),R.Rel=B):R.relId==""&&(R.Target="#"+R.loc),T=R.rfx.s.r;T<=R.rfx.e.r;++T)for(C=R.rfx.s.c;C<=R.rfx.e.c;++C)d.dense?(h[T]||(h[T]=[]),h[T][C]||(h[T][C]={t:"z",v:void 0}),h[T][C].l=R):(L=$e({c:C,r:T}),h[L]||(h[L]={t:"z",v:void 0}),h[L].l=R);break;case 426:if(!d.cellFormula)break;K.push(R),V=d.dense?h[T][C]:h[Wt(C)+j],V.f=Va(R[1],p,{r:_.r,c:C},Z,d),V.F=nt(R[0]);break;case 427:if(!d.cellFormula)break;J[$e(R[0].s)]=R[1],V=d.dense?h[T][C]:h[Wt(C)+j],V.f=Va(R[1],p,{r:_.r,c:C},Z,d);break;case 60:if(!d.cellStyles)break;for(;R.e>=R.s;)re[R.e--]={width:R.w/256,hidden:!!(R.flags&1),level:R.level},ve||(ve=!0,Lh(R.w/256)),Ci(re[R.e+1]);break;case 161:h["!autofilter"]={ref:nt(R)};break;case 476:h["!margins"]=R;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),R.name&&(s.Sheets[t].CodeName=R.name),(R.above||R.left)&&(h["!outline"]={above:R.above,left:R.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),R.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!se.T){if(!v||d.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},d),delete d.supbooks,delete d["!row"],!h["!ref"]&&(p.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(h["!ref"]=nt(m||p)),d.sheetRows&&h["!ref"]){var G=St(h["!ref"]);d.sheetRows<=+G.e.r&&(G.e.r=d.sheetRows-1,G.e.r>p.e.r&&(G.e.r=p.e.r),G.e.r<G.s.r&&(G.s.r=G.e.r),G.e.c>p.e.c&&(G.e.c=p.e.c),G.e.c<G.s.c&&(G.s.c=G.e.c),h["!fullref"]=h["!ref"],h["!ref"]=nt(G))}return M.length>0&&(h["!merges"]=M),re.length>0&&(h["!cols"]=re),ue.length>0&&(h["!rows"]=ue),h}function a5(e,a,t,i,s,c,f){if(a.v===void 0)return!1;var d="";switch(a.t){case"b":d=a.v?"1":"0";break;case"d":a=Xt(a),a.z=a.z||Ze[14],a.v=wa(Gt(a.v)),a.t="n";break;case"n":case"e":d=""+a.v;break;default:d=a.v;break}var h={r:t,c:i};switch(h.s=Li(s.cellXfs,a,s),a.l&&c["!links"].push([$e(h),a.l]),a.c&&c["!comments"].push([$e(h),a.c]),a.t){case"s":case"str":return s.bookSST?(d=Ph(s.Strings,a.v,s.revStrings),h.t="s",h.v=d,f?je(e,18,b6(a,h)):je(e,7,y6(a,h))):(h.t="str",f?je(e,17,O6(a,h)):je(e,6,j6(a,h))),!0;case"n":return a.v==(a.v|0)&&a.v>-1e3&&a.v<1e3?f?je(e,13,k6(a,h)):je(e,2,N6(a,h)):f?je(e,16,E6(a,h)):je(e,5,S6(a,h)),!0;case"b":return h.t="b",f?je(e,15,h6(a,h)):je(e,4,u6(a,h)),!0;case"e":return h.t="e",f?je(e,14,g6(a,h)):je(e,3,x6(a,h)),!0}return f?je(e,12,o6(a,h)):je(e,1,l6(a,h)),!0}function r5(e,a,t,i){var s=St(a["!ref"]||"A1"),c,f="",d=[];je(e,145);var h=Array.isArray(a),m=s.e.r;a["!rows"]&&(m=Math.max(s.e.r,a["!rows"].length-1));for(var p=s.s.r;p<=m;++p){f=oa(p),e6(e,a,s,p);var v=!1;if(p<=s.e.r)for(var y=s.s.c;y<=s.e.c;++y){p===s.s.r&&(d[y]=Wt(y)),c=d[y]+f;var _=h?(a[p]||[])[y]:a[c];if(!_){v=!1;continue}v=a5(e,_,p,y,i,a,v)}}je(e,146)}function n5(e,a){!a||!a["!merges"]||(je(e,177,z6(a["!merges"].length)),a["!merges"].forEach(function(t){je(e,176,U6(t))}),je(e,178))}function i5(e,a){!a||!a["!cols"]||(je(e,390),a["!cols"].forEach(function(t,i){t&&je(e,60,Y6(i,t))}),je(e,391))}function s5(e,a){!a||!a["!ref"]||(je(e,648),je(e,649,$6(St(a["!ref"]))),je(e,650))}function l5(e,a,t){a["!links"].forEach(function(i){if(i[1].Target){var s=Ft(t,-1,i[1].Target.replace(/#.*$/,""),ft.HLINK);je(e,494,H6(i,s))}}),delete a["!links"]}function c5(e,a,t,i){if(a["!comments"].length>0){var s=Ft(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ft.VML);je(e,551,kh("rId"+s)),a["!legacy"]=s}}function o5(e,a,t,i){if(a["!autofilter"]){var s=a["!autofilter"],c=typeof s.ref=="string"?s.ref:nt(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var f=t.Workbook.Names,d=dr(c);d.s.r==d.e.r&&(d.e.r=dr(a["!ref"]).e.r,c=nt(d));for(var h=0;h<f.length;++h){var m=f[h];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==i){m.Ref="'"+t.SheetNames[i]+"'!"+c;break}}h==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+c}),je(e,161,El(St(c))),je(e,162)}}function f5(e,a,t){je(e,133),je(e,137,Z6(a,t)),je(e,138),je(e,134)}function u5(e,a){a["!protect"]&&je(e,535,Q6(a["!protect"]))}function d5(e,a,t,i){var s=ur(),c=t.SheetNames[e],f=t.Sheets[c]||{},d=c;try{t&&t.Workbook&&(d=t.Workbook.Sheets[e].CodeName||d)}catch{}var h=St(f["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(a.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return f["!links"]=[],f["!comments"]=[],je(s,129),(t.vbaraw||f["!outline"])&&je(s,147,i6(d,f["!outline"])),je(s,148,a6(h)),f5(s,f,t.Workbook),i5(s,f),r5(s,f,e,a),u5(s,f),o5(s,f,t,e),n5(s,f),l5(s,f,i),f["!margins"]&&je(s,476,q6(f["!margins"])),(!a||a.ignoreEC||a.ignoreEC==null)&&s5(s,f),c5(s,f,e,i),je(s,130),s.end()}function h5(e){var a=[],t=e.match(/^<c:numCache>/),i;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(c){var f=c.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);f&&(a[+f[1]]=t?+f[2]:f[2])});var s=wt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(c){i=c.replace(/<.*?>/g,"")}),[a,s,i]}function m5(e,a,t,i,s,c){var f=c||{"!type":"chart"};if(!e)return c;var d=0,h=0,m="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var y=h5(v);p.s.r=p.s.c=0,p.e.c=d,m=Wt(d),y[0].forEach(function(_,w){f[m+oa(w)]={t:"n",v:_,z:y[1]},h=w}),p.e.r<h&&(p.e.r=h),++d}),d>0&&(f["!ref"]=nt(p)),f}function x5(e,a,t,i,s){if(!e)return e;i||(i={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},f,d=e.match(Oy);return d&&Hh(d[0],c,s,t),(f=e.match(/drawing r:id="(.*?)"/))&&(c["!rel"]=f[1]),i["!id"][c["!rel"]]&&(c["!drawel"]=i["!id"][c["!rel"]]),c}function p5(e,a){e.l+=10;var t=Ya(e);return{name:t}}function g5(e,a,t,i,s){if(!e)return e;i||(i={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},f=!1;return Zn(e,function(h,m,p){switch(p){case 550:c["!rel"]=h;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),h.name&&(s.Sheets[t].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!f||a.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},a),i["!id"][c["!rel"]]&&(c["!drawel"]=i["!id"][c["!rel"]]),c}var Vh=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],v5=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],y5=[],_5=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function fv(e,a){for(var t=0;t!=e.length;++t)for(var i=e[t],s=0;s!=a.length;++s){var c=a[s];if(i[c[0]]==null)i[c[0]]=c[1];else switch(c[2]){case"bool":typeof i[c[0]]=="string"&&(i[c[0]]=Vt(i[c[0]]));break;case"int":typeof i[c[0]]=="string"&&(i[c[0]]=parseInt(i[c[0]],10));break}}}function uv(e,a){for(var t=0;t!=a.length;++t){var i=a[t];if(e[i[0]]==null)e[i[0]]=i[1];else switch(i[2]){case"bool":typeof e[i[0]]=="string"&&(e[i[0]]=Vt(e[i[0]]));break;case"int":typeof e[i[0]]=="string"&&(e[i[0]]=parseInt(e[i[0]],10));break}}}function Iy(e){uv(e.WBProps,Vh),uv(e.CalcPr,_5),fv(e.WBView,v5),fv(e.Sheets,y5),pl.date1904=Vt(e.WBProps.date1904)}function b5(e){return!e.Workbook||!e.Workbook.WBProps?"false":Vt(e.Workbook.WBProps.date1904)?"true":"false"}var w5="][*?/\\".split("");function By(e,a){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return w5.forEach(function(i){if(e.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function S5(e,a,t){e.forEach(function(i,s){By(i);for(var c=0;c<s;++c)if(i==e[c])throw new Error("Duplicate Sheet Name: "+i);if(t){var f=a&&a[s]&&a[s].CodeName||i;if(f.charCodeAt(0)==95&&f.length>22)throw new Error("Bad Code Name: Worksheet"+f)}})}function E5(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var a=e.Workbook&&e.Workbook.Sheets||[];S5(e.SheetNames,a,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)bC(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var T5=/<\w+:workbook/;function N5(e,a){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,s="xmlns",c={},f=0;if(e.replace(qa,function(h,m){var p=Qe(h);switch(bn(p[0])){case"<?xml":break;case"<workbook":h.match(T5)&&(s="xmlns"+h.match(/<(\w+):/)[1]),t.xmlns=p[s];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Vh.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":t.WBProps[v[0]]=Vt(p[v[0]]);break;case"int":t.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:t.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(t.WBProps.CodeName=It(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=wt(It(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":c={},c.Name=It(p.name),p.comment&&(c.Comment=p.comment),p.localSheetId&&(c.Sheet=+p.localSheetId),Vt(p.hidden||"0")&&(c.Hidden=!0),f=m+h.length;break;case"</definedName>":c.Ref=wt(It(e.slice(f,m))),t.Names.push(c);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&a.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),vs.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Iy(t),t}function Uy(e){var a=[fa];a[a.length]=Me("workbook",null,{xmlns:vs[0],"xmlns:r":ba.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Vh.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(i[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(i.codeName=e.Workbook.WBProps.CodeName,delete i.CodeName)),a[a.length]=Me("workbookPr",null,i);var s=e.Workbook&&e.Workbook.Sheets||[],c=0;if(s&&s[0]&&s[0].Hidden){for(a[a.length]="<bookViews>",c=0;c!=e.SheetNames.length&&!(!s[c]||!s[c].Hidden);++c);c==e.SheetNames.length&&(c=0),a[a.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',a[a.length]="</bookViews>"}for(a[a.length]="<sheets>",c=0;c!=e.SheetNames.length;++c){var f={name:Ot(e.SheetNames[c].slice(0,31))};if(f.sheetId=""+(c+1),f["r:id"]="rId"+(c+1),s[c])switch(s[c].Hidden){case 1:f.state="hidden";break;case 2:f.state="veryHidden";break}a[a.length]=Me("sheet",null,f)}return a[a.length]="</sheets>",t&&(a[a.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var h={name:d.Name};d.Comment&&(h.comment=d.Comment),d.Sheet!=null&&(h.localSheetId=""+d.Sheet),d.Hidden&&(h.hidden="1"),d.Ref&&(a[a.length]=Me("definedName",Ot(d.Ref),h))}),a[a.length]="</definedNames>"),a.length>2&&(a[a.length]="</workbook>",a[1]=a[1].replace("/>",">")),a.join("")}function A5(e,a){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Qd(e),t.name=Ya(e),t}function k5(e,a){return a||(a=we(127)),a.write_shift(4,e.Hidden),a.write_shift(4,e.iTabID),kh(e.strRelID,a),Ca(e.name.slice(0,31),a),a.length>a.l?a.slice(0,a.l):a}function C5(e,a){var t={},i=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=a>8?Ya(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function D5(e,a){a||(a=we(72));var t=0;return e&&e.filterPrivacy&&(t|=8),a.write_shift(4,t),a.write_shift(4,0),D2(e&&e.CodeName||"ThisWorkbook",a),a.slice(0,a.l)}function j5(e,a){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=a-8,t}function F5(e,a,t){var i=e.l+a;e.l+=4,e.l+=1;var s=e.read_shift(4),c=cE(e),f=xC(e,0,t),d=Ah(e);e.l=i;var h={Name:c,Ptg:f};return s<268435455&&(h.Sheet=s),d&&(h.Comment=d),h}function O5(e,a){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],s=!1;a||(a={}),a.biff=12;var c=[],f=[[]];return f.SheetNames=[],f.XTI=[],Zc[16]={n:"BrtFRTArchID$",f:j5},Zn(e,function(h,m,p){switch(p){case 156:f.SheetNames.push(h.name),t.Sheets.push(h);break;case 153:t.WBProps=h;break;case 39:h.Sheet!=null&&(a.SID=h.Sheet),h.Ref=Va(h.Ptg,null,null,f,a),delete a.SID,delete h.Ptg,c.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:f[0].length?f.push([p,h]):f[0]=[p,h],f[f.length-1].XTI=[];break;case 362:f.length===0&&(f[0]=[],f[0].XTI=[]),f[f.length-1].XTI=f[f.length-1].XTI.concat(h),f.XTI=f.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(p),s=!0;break;case 36:i.pop(),s=!1;break;case 37:i.push(p),s=!0;break;case 38:i.pop(),s=!1;break;case 16:break;default:if(!m.T){if(!s||a.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},a),Iy(t),t.Names=c,t.supbooks=f,t}function R5(e,a){je(e,143);for(var t=0;t!=a.SheetNames.length;++t){var i=a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t]&&a.Workbook.Sheets[t].Hidden||0,s={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:a.SheetNames[t]};je(e,156,k5(s))}je(e,144)}function M5(e,a){a||(a=we(127));for(var t=0;t!=4;++t)a.write_shift(4,0);return Ca("SheetJS",a),Ca(Uo.version,a),Ca(Uo.version,a),Ca("7262",a),a.length>a.l?a.slice(0,a.l):a}function L5(e,a){a||(a=we(29)),a.write_shift(-4,0),a.write_shift(-4,460),a.write_shift(4,28800),a.write_shift(4,17600),a.write_shift(4,500),a.write_shift(4,e),a.write_shift(4,e);var t=120;return a.write_shift(1,t),a.length>a.l?a.slice(0,a.l):a}function I5(e,a){if(!(!a.Workbook||!a.Workbook.Sheets)){for(var t=a.Workbook.Sheets,i=0,s=-1,c=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&s==-1?s=i:t[i].Hidden==1&&c==-1&&(c=i);c>s||(je(e,135),je(e,158,L5(s)),je(e,136))}}function B5(e,a){var t=ur();return je(t,131),je(t,128,M5()),je(t,153,D5(e.Workbook&&e.Workbook.WBProps||null)),I5(t,e),R5(t,e),je(t,132),t.end()}function U5(e,a,t){return a.slice(-4)===".bin"?O5(e,t):N5(e,t)}function z5(e,a,t,i,s,c,f,d){return a.slice(-4)===".bin"?t5(e,i,t,s,c,f,d):FC(e,i,t,s,c,f,d)}function P5(e,a,t,i,s,c,f,d){return a.slice(-4)===".bin"?g5(e,i,t,s,c):x5(e,i,t,s,c)}function H5(e,a,t,i,s,c,f,d){return a.slice(-4)===".bin"?GA():XA()}function V5(e,a,t,i,s,c,f,d){return a.slice(-4)===".bin"?HA():VA()}function G5(e,a,t,i){return a.slice(-4)===".bin"?UN(e,t,i):AN(e,t,i)}function X5(e,a,t){return yy(e,t)}function Y5(e,a,t){return a.slice(-4)===".bin"?Y3(e,t):V3(e,t)}function W5(e,a,t){return a.slice(-4)===".bin"?IA(e,t):kA(e,t)}function q5(e,a,t){return a.slice(-4)===".bin"?TA(e):SA(e)}function K5(e,a,t,i){return t.slice(-4)===".bin"?NA(e,a,t,i):void 0}function Z5(e,a,t){return a.slice(-4)===".bin"?_A(e,a,t):wA(e,a,t)}function $5(e,a,t){return(a.slice(-4)===".bin"?B5:Uy)(e)}function Q5(e,a,t,i,s){return(a.slice(-4)===".bin"?d5:Ry)(e,t,i,s)}function J5(e,a,t){return(a.slice(-4)===".bin"?KN:gy)(e,t)}function e8(e,a,t){return(a.slice(-4)===".bin"?K3:oy)(e,t)}function t8(e,a,t){return(a.slice(-4)===".bin"?BA:wy)(e)}function a8(e){return(e.slice(-4)===".bin"?bA:_y)()}var zy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Py=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function tn(e,a){var t=e.split(/\s+/),i=[];if(i[0]=t[0],t.length===1)return i;var s=e.match(zy),c,f,d,h;if(s)for(h=0;h!=s.length;++h)c=s[h].match(Py),(f=c[1].indexOf(":"))===-1?i[c[1]]=c[2].slice(1,c[2].length-1):(c[1].slice(0,6)==="xmlns:"?d="xmlns"+c[1].slice(6):d=c[1].slice(f+1),i[d]=c[2].slice(1,c[2].length-1));return i}function r8(e){var a=e.split(/\s+/),t={};if(a.length===1)return t;var i=e.match(zy),s,c,f,d;if(i)for(d=0;d!=i.length;++d)s=i[d].match(Py),(c=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?f="xmlns"+s[1].slice(6):f=s[1].slice(c+1),t[f]=s[2].slice(1,s[2].length-1));return t}var Ic;function n8(e,a){var t=Ic[e]||wt(e);return t==="General"?ds(a):Wr(t,a)}function i8(e,a,t,i){var s=i;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Vt(i);break;case"i2":case"int":s=parseInt(i,10);break;case"r4":case"float":s=parseFloat(i);break;case"date":case"dateTime.tz":s=Gt(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[wt(a)]=s}function s8(e,a,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||$n[e.v]:a==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pc(e.v):e.w=ds(e.v):e.w=n8(a||"General",e.v)}catch(c){if(t.WTF)throw c}try{var i=Ic[a]||a||"General";if(t.cellNF&&(e.z=i),t.cellDates&&e.t=="n"&&bl(i)){var s=is(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(c){if(t.WTF)throw c}}}function l8(e,a,t){if(t.cellStyles&&a.Interior){var i=a.Interior;i.Pattern&&(i.patternType=yN[i.Pattern]||i.Pattern)}e[a.ID]=a}function c8(e,a,t,i,s,c,f,d,h,m){var p="General",v=i.StyleID,y={};m=m||{};var _=[],w=0;for(v===void 0&&d&&(v=d.StyleID),v===void 0&&f&&(v=f.StyleID);c[v]!==void 0&&(c[v].nf&&(p=c[v].nf),c[v].Interior&&_.push(c[v].Interior),!!c[v].Parent);)v=c[v].Parent;switch(t.Type){case"Boolean":i.t="b",i.v=Vt(e);break;case"String":i.t="s",i.r=kg(wt(e)),i.v=e.indexOf("<")>-1?wt(a||e).replace(/<.*?>/g,""):i.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),i.v=(Gt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),i.v!==i.v?i.v=wt(e):i.v<60&&(i.v=i.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+e),i.t||(i.t="n");break;case"Error":i.t="e",i.v=M2[e],m.cellText!==!1&&(i.w=e);break;default:e==""&&a==""?i.t="z":(i.t="s",i.v=kg(a||e));break}if(s8(i,p,m),m.cellFormula!==!1)if(i.Formula){var b=wt(i.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),i.f=xl(b,s),delete i.Formula,i.ArrayRange=="RC"?i.F=xl("RC:RC",s):i.ArrayRange&&(i.F=xl(i.ArrayRange,s),h.push([St(i.F),i.F]))}else for(w=0;w<h.length;++w)s.r>=h[w][0].s.r&&s.r<=h[w][0].e.r&&s.c>=h[w][0].s.c&&s.c<=h[w][0].e.c&&(i.F=h[w][1]);m.cellStyles&&(_.forEach(function(T){!y.patternType&&T.patternType&&(y.patternType=T.patternType)}),i.s=y),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function o8(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ud(e,a){var t=a||{};wl();var i=Ac(bh(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(i=It(i));var s=i.slice(0,1024).toLowerCase(),c=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var f=Xt(t);return f.type="string",vl.to_workbook(i,f)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(vt){s.indexOf("<"+vt)>=0&&(c=!0)}),c)return q8(i,t);Ic={"General Number":"General","General Date":Ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ze[15],"Short Date":Ze[14],"Long Time":Ze[19],"Medium Time":Ze[18],"Short Time":Ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ze[2],Standard:Ze[4],Percent:Ze[10],Scientific:Ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,h=[],m,p={},v=[],y=t.dense?[]:{},_="",w={},b={},T=tn('<Data ss:Type="String">'),C=0,L=0,N=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},M={},k="",W=0,K=[],J={},Z={},Q=0,re=[],ue=[],ve={},ee=[],G,ae=!1,R=[],se=[],A={},E=0,O=0,B={Sheets:[],WBProps:{date1904:!1}},z={};Gc.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";d=Gc.exec(i);)switch(d[3]=(le=d[3]).toLowerCase()){case"data":if(le=="data"){if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&h.push([d[3],!0]);break}if(h[h.length-1][1])break;d[1]==="/"?c8(i.slice(C,d.index),k,T,h[h.length-1][0]=="comment"?ve:w,{c:L,r:N},V,ee[L],b,R,t):(k="",T=tn(d[0]),C=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(ue.length>0&&(w.c=ue),(!t.sheetRows||t.sheetRows>N)&&w.v!==void 0&&(t.dense?(y[N]||(y[N]=[]),y[N][L]=w):y[Wt(L)+oa(N)]=w),w.HRef&&(w.l={Target:wt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(E=L+(parseInt(w.MergeAcross,10)|0),O=N+(parseInt(w.MergeDown,10)|0),K.push({s:{c:L,r:N},e:{c:E,r:O}})),!t.sheetStubs)w.MergeAcross?L=E+1:++L;else if(w.MergeAcross||w.MergeDown){for(var ye=L;ye<=E;++ye)for(var Ne=N;Ne<=O;++Ne)(ye>L||Ne>N)&&(t.dense?(y[Ne]||(y[Ne]=[]),y[Ne][ye]={t:"z"}):y[Wt(ye)+oa(Ne)]={t:"z"});L=E+1}else++L;else w=r8(d[0]),w.Index&&(L=+w.Index-1),L<j.s.c&&(j.s.c=L),L>j.e.c&&(j.e.c=L),d[0].slice(-2)==="/>"&&++L,ue=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(N<j.s.r&&(j.s.r=N),N>j.e.r&&(j.e.r=N),d[0].slice(-2)==="/>"&&(b=tn(d[0]),b.Index&&(N=+b.Index-1)),L=0,++N):(b=tn(d[0]),b.Index&&(N=+b.Index-1),A={},(b.AutoFitHeight=="0"||b.Height)&&(A.hpx=parseInt(b.Height,10),A.hpt=Kc(A.hpx),se[N]=A),b.Hidden=="1"&&(A.hidden=!0,se[N]=A));break;case"worksheet":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"));v.push(_),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(y["!ref"]=nt(j),t.sheetRows&&t.sheetRows<=j.e.r&&(y["!fullref"]=y["!ref"],j.e.r=t.sheetRows-1,y["!ref"]=nt(j))),K.length&&(y["!merges"]=K),ee.length>0&&(y["!cols"]=ee),se.length>0&&(y["!rows"]=se),p[_]=y}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=L=0,h.push([d[3],!1]),m=tn(d[0]),_=wt(m.Name),y=t.dense?[]:{},K=[],R=[],se=[],z={name:_,Hidden:0},B.Sheets.push(z);break;case"table":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else{if(d[0].slice(-2)=="/>")break;h.push([d[3],!1]),ee=[],ae=!1}break;case"style":d[1]==="/"?l8(V,M,t):M=tn(d[0]);break;case"numberformat":M.nf=wt(tn(d[0]).Format||"General"),Ic[M.nf]&&(M.nf=Ic[M.nf]);for(var Te=0;Te!=392&&Ze[Te]!=M.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(Ze[Te]==null){Yn(M.nf,Te);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(G=tn(d[0]),G.Hidden&&(G.hidden=!0,delete G.Hidden),G.Width&&(G.wpx=parseInt(G.Width,10)),!ae&&G.wpx>10){ae=!0,Ga=xy;for(var De=0;De<ee.length;++De)ee[De]&&Ci(ee[De])}ae&&Ci(G),ee[G.Index-1||ee.length]=G;for(var Ve=0;Ve<+G.Span;++Ve)ee[ee.length]=Xt(G);break;case"namedrange":if(d[1]==="/")break;B.Names||(B.Names=[]);var q=Qe(d[0]),ct={Name:q.Name,Ref:xl(q.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(ct.Sheet=B.Sheets.length-1),B.Names.push(ct);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?k+=i.slice(W,d.index):W=d.index+d[0].length;break;case"interior":if(!t.cellStyles)break;M.Interior=tn(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?OE(J,le,i.slice(Q,d.index)):Q=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else h.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"));o8(ve),ue.push(ve)}else h.push([d[3],!1]),m=tn(d[0]),ve={a:m.Author};break;case"autofilter":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var We=tn(d[0]);y["!autofilter"]={ref:xl(We.Range).replace(/\$/g,"")},h.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&h.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&h.push([d[3],!0]);break;case"null":break;default:if(h.length==0&&d[3]=="document"||h.length==0&&d[3]=="uof")return pv(i,t);var tt=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:tt=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:tt=!1}break;case"excelworkbook":switch(d[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:tt=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:tt=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(i.slice(Q,d.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else Q=d.index+d[0].length;break;case"header":y["!margins"]||os(y["!margins"]={},"xlml"),isNaN(+Qe(d[0]).Margin)||(y["!margins"].header=+Qe(d[0]).Margin);break;case"footer":y["!margins"]||os(y["!margins"]={},"xlml"),isNaN(+Qe(d[0]).Margin)||(y["!margins"].footer=+Qe(d[0]).Margin);break;case"pagemargins":var qe=Qe(d[0]);y["!margins"]||os(y["!margins"]={},"xlml"),isNaN(+qe.Top)||(y["!margins"].top=+qe.Top),isNaN(+qe.Left)||(y["!margins"].left=+qe.Left),isNaN(+qe.Right)||(y["!margins"].right=+qe.Right),isNaN(+qe.Bottom)||(y["!margins"].bottom=+qe.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:tt=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:tt=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:tt=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:tt=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:tt=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:tt=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:tt=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:tt=!1}break;case"smarttags":break;default:tt=!1;break}if(tt||d[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?i8(Z,le,re,i.slice(Q,d.index)):(re=d,Q=d.index+d[0].length);break}if(t.WTF)throw"Unrecognized tag: "+d[3]+"|"+h.join("|")}var Re={};return!t.bookSheets&&!t.bookProps&&(Re.Sheets=p),Re.SheetNames=v,Re.Workbook=B,Re.SSF=Xt(Ze),Re.Props=J,Re.Custprops=Z,Re}function ih(e,a){switch(Xh(a=a||{}),a.type||"base64"){case"base64":return Ud(Nr(e),a);case"binary":case"buffer":case"file":return Ud(e,a);case"array":return Ud(Ri(e),a)}}function f8(e,a){var t=[];return e.Props&&t.push(RE(e.Props,a)),e.Custprops&&t.push(ME(e.Props,e.Custprops)),t.join("")}function u8(){return""}function d8(e,a){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return a.cellXfs.forEach(function(i,s){var c=[];c.push(Me("NumberFormat",null,{"ss:Format":Ot(Ze[i.numFmtId])}));var f={"ss:ID":"s"+(21+s)};t.push(Me("Style",c.join(""),f))}),Me("Styles",t.join(""))}function Hy(e){return Me("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Uh(e.Ref,{r:0,c:0})})}function h8(e){if(!((e||{}).Workbook||{}).Names)return"";for(var a=e.Workbook.Names,t=[],i=0;i<a.length;++i){var s=a[i];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(Hy(s)))}return Me("Names",t.join(""))}function m8(e,a,t,i){if(!e||!((i||{}).Workbook||{}).Names)return"";for(var s=i.Workbook.Names,c=[],f=0;f<s.length;++f){var d=s[f];d.Sheet==t&&(d.Name.match(/^_xlfn\./)||c.push(Hy(d)))}return c.join("")}function x8(e,a,t,i){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Me("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Me("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Me("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)s.push(Me("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<t&&!(i.Workbook.Sheets[c]&&!i.Workbook.Sheets[c].Hidden);++c);c==t&&s.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(La("ProtectContents","True")),e["!protect"].objects&&s.push(La("ProtectObjects","True")),e["!protect"].scenarios&&s.push(La("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(La("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(La("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(f){e["!protect"][f[0]]&&s.push("<"+f[1]+"/>")})),s.length==0?"":Me("WorksheetOptions",s.join(""),{xmlns:wr.x})}function p8(e){return e.map(function(a){var t=I4(a.t||""),i=Me("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Me("Comment",i,{"ss:Author":a.a})}).join("")}function g8(e,a,t,i,s,c,f){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+Ot(Uh(e.f,f))),e.F&&e.F.slice(0,a.length)==a){var h=qt(e.F.slice(a.length+1));d["ss:ArrayRange"]="RC:R"+(h.r==f.r?"":"["+(h.r-f.r)+"]")+"C"+(h.c==f.c?"":"["+(h.c-f.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=Ot(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=Ot(e.l.Tooltip))),t["!merges"])for(var m=t["!merges"],p=0;p!=m.length;++p)m[p].s.c!=f.c||m[p].s.r!=f.r||(m[p].e.c>m[p].s.c&&(d["ss:MergeAcross"]=m[p].e.c-m[p].s.c),m[p].e.r>m[p].s.r&&(d["ss:MergeDown"]=m[p].e.r-m[p].s.r));var v="",y="";switch(e.t){case"z":if(!i.sheetStubs)return"";break;case"n":v="Number",y=String(e.v);break;case"b":v="Boolean",y=e.v?"1":"0";break;case"e":v="Error",y=$n[e.v];break;case"d":v="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ze[14]);break;case"s":v="String",y=L4(e.v||"");break}var _=Li(i.cellXfs,e,i);d["ss:StyleID"]="s"+(21+_),d["ss:Index"]=f.c+1;var w=e.v!=null?y:"",b=e.t=="z"?"":'<Data ss:Type="'+v+'">'+w+"</Data>";return(e.c||[]).length>0&&(b+=p8(e.c)),Me("Cell",b,d)}function v8(e,a){var t='<Row ss:Index="'+(e+1)+'"';return a&&(a.hpt&&!a.hpx&&(a.hpx=yl(a.hpt)),a.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+a.hpx+'"'),a.hidden&&(t+=' ss:Hidden="1"')),t+">"}function y8(e,a,t,i){if(!e["!ref"])return"";var s=St(e["!ref"]),c=e["!merges"]||[],f=0,d=[];e["!cols"]&&e["!cols"].forEach(function(T,C){Ci(T);var L=!!T.width,N=lf(C,T),j={"ss:Index":C+1};L&&(j["ss:Width"]=Wc(N.width)),T.hidden&&(j["ss:Hidden"]="1"),d.push(Me("Column",null,j))});for(var h=Array.isArray(e),m=s.s.r;m<=s.e.r;++m){for(var p=[v8(m,(e["!rows"]||[])[m])],v=s.s.c;v<=s.e.c;++v){var y=!1;for(f=0;f!=c.length;++f)if(!(c[f].s.c>v)&&!(c[f].s.r>m)&&!(c[f].e.c<v)&&!(c[f].e.r<m)){(c[f].s.c!=v||c[f].s.r!=m)&&(y=!0);break}if(!y){var _={r:m,c:v},w=$e(_),b=h?(e[m]||[])[v]:e[w];p.push(g8(b,w,e,a,t,i,_))}}p.push("</Row>"),p.length>2&&d.push(p.join(""))}return d.join("")}function _8(e,a,t){var i=[],s=t.SheetNames[e],c=t.Sheets[s],f=c?m8(c,a,e,t):"";return f.length>0&&i.push("<Names>"+f+"</Names>"),f=c?y8(c,a,e,t):"",f.length>0&&i.push("<Table>"+f+"</Table>"),i.push(x8(c,a,e,t)),i.join("")}function b8(e,a){a||(a={}),e.SSF||(e.SSF=Xt(Ze)),e.SSF&&(wl(),Jo(e.SSF),a.revssf=tf(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF,a.cellXfs=[],Li(a.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(f8(e,a)),t.push(u8()),t.push(""),t.push("");for(var i=0;i<e.SheetNames.length;++i)t.push(Me("Worksheet",_8(i,a,e),{"ss:Name":Ot(e.SheetNames[i])}));return t[2]=d8(e,a),t[3]=h8(e),fa+Me("Workbook",t.join(""),{xmlns:wr.ss,"xmlns:o":wr.o,"xmlns:x":wr.x,"xmlns:ss":wr.ss,"xmlns:dt":wr.dt,"xmlns:html":wr.html})}function w8(e){var a={},t=e.content;if(t.l=28,a.AnsiUserType=t.read_shift(0,"lpstr-ansi"),a.AnsiClipboardFormat=hE(t),t.length-t.l<=4)return a;var i=t.read_shift(4);if(i==0||i>40||(t.l-=4,a.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(i=t.read_shift(4),i!==1907505652)||(a.UnicodeClipboardFormat=mE(t),i=t.read_shift(4),i==0||i>40))return a;t.l-=4,a.Reserved2=t.read_shift(0,"lpwstr")}var S8=[60,1084,2066,2165,2175];function E8(e,a,t,i,s){var c=i,f=[],d=t.slice(t.l,t.l+c);if(s&&s.enc&&s.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(d)}f.push(d),t.l+=c;for(var h=Gn(t,t.l),m=sh[h],p=0;m!=null&&S8.indexOf(h)>-1;)c=Gn(t,t.l+2),p=t.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),d=t.slice(p,t.l+4+c),f.push(d),t.l+=4+c,m=sh[h=Gn(t,t.l)];var v=ka(f);Ma(v,0);var y=0;v.lens=[];for(var _=0;_<f.length;++_)v.lens.push(y),y+=f[_].length;if(v.length<i)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+i;return a.f(v,v.length,s)}function mn(e,a,t){if(e.t!=="z"&&e.XF){var i=0;try{i=e.z||e.XF.numFmtId||0,a.cellNF&&(e.z=Ze[i])}catch(c){if(a.WTF)throw c}if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||$n[e.v]:i===0||i=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pc(e.v):e.w=ds(e.v):e.w=Wr(i,e.v,{date1904:!!t,dateNF:a&&a.dateNF})}catch(c){if(a.WTF)throw c}if(a.cellDates&&i&&e.t=="n"&&bl(Ze[i]||String(i))){var s=is(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function jo(e,a,t){return{v:e,ixfe:a,t}}function T8(e,a){var t={opts:{}},i={},s=a.dense?[]:{},c={},f={},d=null,h=[],m="",p={},v,y="",_,w,b,T,C={},L=[],N,j,V=[],M=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},W={},K=function(Fe){return Fe<8?ss[Fe]:Fe<64&&M[Fe-8]||ss[Fe]},J=function(Fe,Je,mt){var et=Je.XF.data;if(!(!et||!et.patternType||!mt||!mt.cellStyles)){Je.s={},Je.s.patternType=et.patternType;var _t;(_t=Yc(K(et.icvFore)))&&(Je.s.fgColor={rgb:_t}),(_t=Yc(K(et.icvBack)))&&(Je.s.bgColor={rgb:_t})}},Z=function(Fe,Je,mt){if(!(A>1)&&!(mt.sheetRows&&Fe.r>=mt.sheetRows)){if(mt.cellStyles&&Je.XF&&Je.XF.data&&J(Fe,Je,mt),delete Je.ixfe,delete Je.XF,v=Fe,y=$e(Fe),(!f||!f.s||!f.e)&&(f={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<f.s.r&&(f.s.r=Fe.r),Fe.c<f.s.c&&(f.s.c=Fe.c),Fe.r+1>f.e.r&&(f.e.r=Fe.r+1),Fe.c+1>f.e.c&&(f.e.c=Fe.c+1),mt.cellFormula&&Je.f){for(var et=0;et<L.length;++et)if(!(L[et][0].s.c>Fe.c||L[et][0].s.r>Fe.r)&&!(L[et][0].e.c<Fe.c||L[et][0].e.r<Fe.r)){Je.F=nt(L[et][0]),(L[et][0].s.c!=Fe.c||L[et][0].s.r!=Fe.r)&&delete Je.f,Je.f&&(Je.f=""+Va(L[et][1],f,Fe,R,Q));break}}mt.dense?(s[Fe.r]||(s[Fe.r]=[]),s[Fe.r][Fe.c]=Je):s[y]=Je}},Q={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:L,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!a&&!!a.cellStyles,WTF:!!a&&!!a.wtf};a.password&&(Q.password=a.password);var re,ue=[],ve=[],ee=[],G=[],ae=!1,R=[];R.SheetNames=Q.snames,R.sharedf=Q.sharedf,R.arrayf=Q.arrayf,R.names=[],R.XTI=[];var se=0,A=0,E=0,O=[],B=[],z;Q.codepage=1200,rn(1200);for(var le=!1;e.l<e.length-1;){var ye=e.l,Ne=e.read_shift(2);if(Ne===0&&se===10)break;var Te=e.l===e.length?0:e.read_shift(2),De=sh[Ne];if(De&&De.f){if(a.bookSheets&&se===133&&Ne!==133)break;if(se=Ne,De.r===2||De.r==12){var Ve=e.read_shift(2);if(Te-=2,!Q.enc&&Ve!==Ne&&((Ve&255)<<8|Ve>>8)!==Ne)throw new Error("rt mismatch: "+Ve+"!="+Ne);De.r==12&&(e.l+=10,Te-=10)}var q={};if(Ne===10?q=De.f(e,Te,Q):q=E8(Ne,De,e,Te,Q),A==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(Ne){case 34:t.opts.Date1904=k.WBProps.date1904=q;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(Q.enc||(e.l=0),Q.enc=q,!a.password)throw new Error("File is password-protected");if(q.valid==null)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:Q.lastuser=q;break;case 66:var ct=Number(q);switch(ct){case 21010:ct=1200;break;case 32768:ct=1e4;break;case 32769:ct=1252;break}rn(Q.codepage=ct),le=!0;break;case 317:Q.rrtabid=q;break;case 25:Q.winlocked=q;break;case 439:t.opts.RefreshAll=q;break;case 12:t.opts.CalcCount=q;break;case 16:t.opts.CalcDelta=q;break;case 17:t.opts.CalcIter=q;break;case 13:t.opts.CalcMode=q;break;case 14:t.opts.CalcPrecision=q;break;case 95:t.opts.CalcSaveRecalc=q;break;case 15:Q.CalcRefMode=q;break;case 2211:t.opts.FullCalc=q;break;case 129:q.fDialog&&(s["!type"]="dialog"),q.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),q.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:V.push(q);break;case 430:R.push([q]),R[R.length-1].XTI=[];break;case 35:case 547:R[R.length-1].push(q);break;case 24:case 536:z={Name:q.Name,Ref:Va(q.rgce,f,null,R,Q)},q.itab>0&&(z.Sheet=q.itab-1),R.names.push(z),R[0]||(R[0]=[],R[0].XTI=[]),R[R.length-1].push(q),q.Name=="_xlnm._FilterDatabase"&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]=="PtgArea3d"&&(B[q.itab-1]={ref:nt(q.rgce[0][0][1][2])});break;case 22:Q.ExternCount=q;break;case 23:R.length==0&&(R[0]=[],R[0].XTI=[]),R[R.length-1].XTI=R[R.length-1].XTI.concat(q),R.XTI=R.XTI.concat(q);break;case 2196:if(Q.biff<8)break;z!=null&&(z.Comment=q[1]);break;case 18:s["!protect"]=q;break;case 19:q!==0&&Q.WTF&&console.error("Password verifier: "+q);break;case 133:c[q.pos]=q,Q.snames.push(q.name);break;case 10:{if(--A)break;if(f.e){if(f.e.r>0&&f.e.c>0){if(f.e.r--,f.e.c--,s["!ref"]=nt(f),a.sheetRows&&a.sheetRows<=f.e.r){var We=f.e.r;f.e.r=a.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=nt(f),f.e.r=We}f.e.r++,f.e.c++}ue.length>0&&(s["!merges"]=ue),ve.length>0&&(s["!objects"]=ve),ee.length>0&&(s["!cols"]=ee),G.length>0&&(s["!rows"]=G),k.Sheets.push(W)}m===""?p=s:i[m]=s,s=a.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Q.biff===8&&(Q.biff={9:2,521:3,1033:4}[Ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),Q.biffguess=q.BIFFVer==0,q.BIFFVer==0&&q.dt==4096&&(Q.biff=5,le=!0,rn(Q.codepage=28591)),Q.biff==8&&q.BIFFVer==0&&q.dt==16&&(Q.biff=2),A++)break;if(s=a.dense?[]:{},Q.biff<8&&!le&&(le=!0,rn(Q.codepage=a.codepage||1252)),Q.biff<5||q.BIFFVer==0&&q.dt==4096){m===""&&(m="Sheet1"),f={s:{r:0,c:0},e:{r:0,c:0}};var tt={pos:e.l-Te,name:m};c[tt.pos]=tt,Q.snames.push(m)}else m=(c[ye]||{name:""}).name;q.dt==32&&(s["!type"]="chart"),q.dt==64&&(s["!type"]="macro"),ue=[],ve=[],Q.arrayf=L=[],ee=[],G=[],ae=!1,W={Hidden:(c[ye]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(a.dense?(s[q.r]||[])[q.c]:s[$e({c:q.c,r:q.r})])&&++q.c,N={ixfe:q.ixfe,XF:V[q.ixfe]||{},v:q.val,t:"n"},E>0&&(N.z=O[N.ixfe>>8&63]),mn(N,a,t.opts.Date1904),Z({c:q.c,r:q.r},N,a);break;case 5:case 517:N={ixfe:q.ixfe,XF:V[q.ixfe],v:q.val,t:q.t},E>0&&(N.z=O[N.ixfe>>8&63]),mn(N,a,t.opts.Date1904),Z({c:q.c,r:q.r},N,a);break;case 638:N={ixfe:q.ixfe,XF:V[q.ixfe],v:q.rknum,t:"n"},E>0&&(N.z=O[N.ixfe>>8&63]),mn(N,a,t.opts.Date1904),Z({c:q.c,r:q.r},N,a);break;case 189:for(var qe=q.c;qe<=q.C;++qe){var Re=q.rkrec[qe-q.c][0];N={ixfe:Re,XF:V[Re],v:q.rkrec[qe-q.c][1],t:"n"},E>0&&(N.z=O[N.ixfe>>8&63]),mn(N,a,t.opts.Date1904),Z({c:qe,r:q.r},N,a)}break;case 6:case 518:case 1030:{if(q.val=="String"){d=q;break}if(N=jo(q.val,q.cell.ixfe,q.tt),N.XF=V[N.ixfe],a.cellFormula){var vt=q.formula;if(vt&&vt[0]&&vt[0][0]&&vt[0][0][0]=="PtgExp"){var Bt=vt[0][0][1][0],Kt=vt[0][0][1][1],Sa=$e({r:Bt,c:Kt});C[Sa]?N.f=""+Va(q.formula,f,q.cell,R,Q):N.F=((a.dense?(s[Bt]||[])[Kt]:s[Sa])||{}).F}else N.f=""+Va(q.formula,f,q.cell,R,Q)}E>0&&(N.z=O[N.ixfe>>8&63]),mn(N,a,t.opts.Date1904),Z(q.cell,N,a),d=q}break;case 7:case 519:if(d)d.val=q,N=jo(q,d.cell.ixfe,"s"),N.XF=V[N.ixfe],a.cellFormula&&(N.f=""+Va(d.formula,f,d.cell,R,Q)),E>0&&(N.z=O[N.ixfe>>8&63]),mn(N,a,t.opts.Date1904),Z(d.cell,N,a),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{L.push(q);var Ar=$e(q[0].s);if(_=a.dense?(s[q[0].s.r]||[])[q[0].s.c]:s[Ar],a.cellFormula&&_){if(!d||!Ar||!_)break;_.f=""+Va(q[1],f,q[0],R,Q),_.F=nt(q[0])}}break;case 1212:{if(!a.cellFormula)break;if(y){if(!d)break;C[$e(d.cell)]=q[0],_=a.dense?(s[d.cell.r]||[])[d.cell.c]:s[$e(d.cell)],(_||{}).f=""+Va(q[0],f,v,R,Q)}}break;case 253:N=jo(h[q.isst].t,q.ixfe,"s"),h[q.isst].h&&(N.h=h[q.isst].h),N.XF=V[N.ixfe],E>0&&(N.z=O[N.ixfe>>8&63]),mn(N,a,t.opts.Date1904),Z({c:q.c,r:q.r},N,a);break;case 513:a.sheetStubs&&(N={ixfe:q.ixfe,XF:V[q.ixfe],t:"z"},E>0&&(N.z=O[N.ixfe>>8&63]),mn(N,a,t.opts.Date1904),Z({c:q.c,r:q.r},N,a));break;case 190:if(a.sheetStubs)for(var ar=q.c;ar<=q.C;++ar){var bt=q.ixfe[ar-q.c];N={ixfe:bt,XF:V[bt],t:"z"},E>0&&(N.z=O[N.ixfe>>8&63]),mn(N,a,t.opts.Date1904),Z({c:ar,r:q.r},N,a)}break;case 214:case 516:case 4:N=jo(q.val,q.ixfe,"s"),N.XF=V[N.ixfe],E>0&&(N.z=O[N.ixfe>>8&63]),mn(N,a,t.opts.Date1904),Z({c:q.c,r:q.r},N,a);break;case 0:case 512:A===1&&(f=q);break;case 252:h=q;break;case 1054:if(Q.biff==4){O[E++]=q[1];for(var ya=0;ya<E+163&&Ze[ya]!=q[1];++ya);ya>=163&&Yn(q[1],E+163)}else Yn(q[1],q[0]);break;case 30:{O[E++]=q;for(var Pe=0;Pe<E+163&&Ze[Pe]!=q;++Pe);Pe>=163&&Yn(q,E+163)}break;case 229:ue=ue.concat(q);break;case 93:ve[q.cmo[0]]=Q.lastobj=q;break;case 438:Q.lastobj.TxO=q;break;case 127:Q.lastobj.ImData=q;break;case 440:for(T=q[0].s.r;T<=q[0].e.r;++T)for(b=q[0].s.c;b<=q[0].e.c;++b)_=a.dense?(s[T]||[])[b]:s[$e({c:b,r:T})],_&&(_.l=q[1]);break;case 2048:for(T=q[0].s.r;T<=q[0].e.r;++T)for(b=q[0].s.c;b<=q[0].e.c;++b)_=a.dense?(s[T]||[])[b]:s[$e({c:b,r:T})],_&&_.l&&(_.l.Tooltip=q[1]);break;case 28:{if(Q.biff<=5&&Q.biff>=2)break;_=a.dense?(s[q[0].r]||[])[q[0].c]:s[$e(q[0])];var Be=ve[q[2]];_||(a.dense?(s[q[0].r]||(s[q[0].r]=[]),_=s[q[0].r][q[0].c]={t:"z"}):_=s[$e(q[0])]={t:"z"},f.e.r=Math.max(f.e.r,q[0].r),f.s.r=Math.min(f.s.r,q[0].r),f.e.c=Math.max(f.e.c,q[0].c),f.s.c=Math.min(f.s.c,q[0].c)),_.c||(_.c=[]),w={a:q[1],t:Be.TxO.t},_.c.push(w)}break;case 2173:dA(V[q.ixfe],q.ext);break;case 125:{if(!Q.cellStyles)break;for(;q.e>=q.s;)ee[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)},ae||(ae=!0,Lh(q.w/256)),Ci(ee[q.e+1])}break;case 520:{var Ue={};q.level!=null&&(G[q.r]=Ue,Ue.level=q.level),q.hidden&&(G[q.r]=Ue,Ue.hidden=!0),q.hpt&&(G[q.r]=Ue,Ue.hpt=q.hpt,Ue.hpx=yl(q.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||os(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ne]]=q;break;case 161:s["!margins"]||os(s["!margins"]={}),s["!margins"].header=q.header,s["!margins"].footer=q.footer;break;case 574:q.RTL&&(k.Views[0].RTL=!0);break;case 146:M=q;break;case 2198:re=q;break;case 140:j=q;break;case 442:m?W.CodeName=q||W.name:k.WBProps.CodeName=q||"ThisWorkbook";break}}else De||console.error("Missing Info for XLS Record 0x"+Ne.toString(16)),e.l+=Te}return t.SheetNames=ra(c).sort(function(He,Fe){return Number(He)-Number(Fe)}).map(function(He){return c[He].name}),a.bookSheets||(t.Sheets=i),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&B.forEach(function(He,Fe){t.Sheets[t.SheetNames[Fe]]["!autofilter"]=He}),t.Strings=h,t.SSF=Xt(Ze),Q.enc&&(t.Encryption=Q.enc),re&&(t.Themes=re),t.Metadata={},j!==void 0&&(t.Metadata.Country=j),R.names.length>0&&(k.Names=R.names),t.Workbook=k,t}var Bc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function N8(e,a,t){var i=Ye.find(e,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var s=Yg(i,Jd,Bc.DSI);for(var c in s)a[c]=s[c]}catch(m){if(t.WTF)throw m}var f=Ye.find(e,"/!SummaryInformation");if(f&&f.size>0)try{var d=Yg(f,eh,Bc.SI);for(var h in d)a[h]==null&&(a[h]=d[h])}catch(m){if(t.WTF)throw m}a.HeadingPairs&&a.TitlesOfParts&&(P2(a.HeadingPairs,a.TitlesOfParts,a,t),delete a.HeadingPairs,delete a.TitlesOfParts)}function A8(e,a){var t=[],i=[],s=[],c=0,f,d=wg(Jd,"n"),h=wg(eh,"n");if(e.Props)for(f=ra(e.Props),c=0;c<f.length;++c)(Object.prototype.hasOwnProperty.call(d,f[c])?t:Object.prototype.hasOwnProperty.call(h,f[c])?i:s).push([f[c],e.Props[f[c]]]);if(e.Custprops)for(f=ra(e.Custprops),c=0;c<f.length;++c)Object.prototype.hasOwnProperty.call(e.Props||{},f[c])||(Object.prototype.hasOwnProperty.call(d,f[c])?t:Object.prototype.hasOwnProperty.call(h,f[c])?i:s).push([f[c],e.Custprops[f[c]]]);var m=[];for(c=0;c<s.length;++c)q2.indexOf(s[c][0])>-1||z2.indexOf(s[c][0])>-1||s[c][1]!=null&&m.push(s[c]);i.length&&Ye.utils.cfb_add(a,"/SummaryInformation",Wg(i,Bc.SI,h,eh)),(t.length||m.length)&&Ye.utils.cfb_add(a,"/DocumentSummaryInformation",Wg(t,Bc.DSI,d,Jd,m.length?m:null,Bc.UDI))}function Vy(e,a){a||(a={}),Xh(a),dh(),a.codepage&&uh(a.codepage);var t,i;if(e.FullPaths){if(Ye.find(e,"/encryption"))throw new Error("File is password-protected");t=Ye.find(e,"!CompObj"),i=Ye.find(e,"/Workbook")||Ye.find(e,"/Book")}else{switch(a.type){case"base64":e=Er(Nr(e));break;case"binary":e=Er(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ma(e,0),i={content:e}}var s,c;if(t&&w8(t),a.bookProps&&!a.bookSheets)s={};else{var f=ot?"buffer":"array";if(i&&i.content)s=T8(i.content,a);else if((c=Ye.find(e,"PerfectOffice_MAIN"))&&c.content)s=cs.to_workbook(c.content,(a.type=f,a));else if((c=Ye.find(e,"NativeContent_MAIN"))&&c.content)s=cs.to_workbook(c.content,(a.type=f,a));else throw(c=Ye.find(e,"MN0"))&&c.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a.bookVBA&&e.FullPaths&&Ye.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=zA(e))}var d={};return e.FullPaths&&N8(e,d,a),s.Props=s.Custprops=d,a.bookFiles&&(s.cfb=e),s}function k8(e,a){var t=a||{},i=Ye.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Ye.utils.cfb_add(i,s,Gy(e,t)),t.biff==8&&(e.Props||e.Custprops)&&A8(e,i),t.biff==8&&e.vbaraw&&PA(i,Ye.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),i}var Zc={0:{f:QC},1:{f:s6},2:{f:T6},3:{f:m6},4:{f:f6},5:{f:w6},6:{f:D6},7:{f:v6},8:{f:I6},9:{f:L6},10:{f:R6},11:{f:M6},12:{f:c6},13:{f:A6},14:{f:p6},15:{f:d6},16:{f:My},17:{f:F6},18:{f:_6},19:{f:Nh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:F5},40:{},42:{},43:{f:DN},44:{f:kN},45:{f:ON},46:{f:MN},47:{f:RN},48:{},49:{f:tE},50:{},51:{f:xA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:iy},62:{f:C6},63:{f:EA},64:{f:J6},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Wa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:K6},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:n6},148:{f:t6,p:16},151:{f:V6},152:{},153:{f:C5},154:{},155:{},156:{f:A5},157:{},158:{},159:{T:1,f:X3},160:{T:-1},161:{T:1,f:ws},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:B6},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:hA},336:{T:-1},337:{f:vA,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ny},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:G6},427:{f:X6},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:W6},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:r6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:P6},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:MA},633:{T:1},634:{T:-1},635:{T:1,f:OA},636:{T:-1},637:{f:iE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:p5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:e5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},sh={6:{f:Id},10:{f:Ti},12:{f:ga},13:{f:ga},14:{f:ca},15:{f:ca},16:{f:Xa},17:{f:ca},18:{f:ca},19:{f:ga},20:{f:Jg},21:{f:Jg},23:{f:ny},24:{f:tv},25:{f:ca},26:{},27:{},28:{f:e3},29:{},34:{f:ca},35:{f:ev},38:{f:Xa},39:{f:Xa},40:{f:Xa},41:{f:Xa},42:{f:ca},43:{f:ca},47:{f:dN},49:{f:AT},51:{f:ga},60:{},61:{f:wT},64:{f:ca},65:{f:NT},66:{f:ga},77:{},80:{},81:{},82:{},85:{f:ga},89:{},90:{},91:{},92:{f:uT},93:{f:r3},94:{},95:{f:ca},96:{},97:{},99:{f:ca},125:{f:iy},128:{f:HT},129:{f:hT},130:{f:ga},131:{f:ca},132:{f:ca},133:{f:mT},134:{},140:{f:u3},141:{f:ga},144:{},146:{f:m3},151:{},152:{},153:{},154:{},155:{},156:{f:ga},157:{},158:{},160:{f:b3},161:{f:g3},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:BT},190:{f:UT},193:{f:Ti},197:{},198:{},199:{},200:{},201:{},202:{f:ca},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ga},220:{},221:{f:ca},222:{},224:{f:PT},225:{f:fT},226:{f:Ti},227:{},229:{f:t3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:pT},253:{f:CT},255:{f:vT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:K2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ca},353:{f:Ti},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:WT},431:{f:ca},432:{},433:{},434:{},437:{},438:{f:s3},439:{f:ca},440:{f:l3},441:{},442:{f:a0},443:{},444:{f:ga},445:{},446:{},448:{f:Ti},449:{f:bT,r:2},450:{f:Ti},512:{f:Zg},513:{f:_3},515:{f:XT},516:{f:jT},517:{f:Qg},519:{f:w3},520:{f:yT},523:{},545:{f:av},549:{f:Kg},566:{},574:{f:ET},638:{f:IT},659:{},1048:{},1054:{f:OT},1084:{},1212:{f:$T},2048:{f:o3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ko},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ti},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:x3,r:12},2173:{f:uA,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ca,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:ZT,r:12},2197:{},2198:{f:iA,r:12},2199:{},2200:{},2201:{},2202:{f:QT,r:12},2203:{f:Ti},2204:{},2205:{},2206:{},2207:{},2211:{f:_T},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ga},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:v3},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:h3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Zg},1:{},2:{f:A3},3:{f:T3},4:{f:E3},5:{f:Qg},7:{f:C3},8:{},9:{f:ko},11:{},22:{f:ga},30:{f:MT},31:{},32:{},33:{f:av},36:{},37:{f:Kg},50:{f:D3},62:{},52:{},67:{},68:{f:ga},69:{},86:{},126:{},127:{f:S3},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:j3},223:{},234:{},354:{},421:{},518:{f:Id},521:{f:ko},536:{f:tv},547:{f:ev},561:{},579:{},1030:{f:Id},1033:{f:ko},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Le(e,a,t,i){var s=a;if(!isNaN(s)){var c=i||(t||[]).length||0,f=e.next(4);f.write_shift(2,s),f.write_shift(2,c),c>0&&Sh(t)&&e.push(t)}}function C8(e,a,t,i){var s=(t||[]).length||0;if(s<=8224)return Le(e,a,t,s);var c=a;if(!isNaN(c)){for(var f=t.parts||[],d=0,h=0,m=0;m+(f[d]||8224)<=8224;)m+=f[d]||8224,d++;var p=e.next(4);for(p.write_shift(2,c),p.write_shift(2,m),e.push(t.slice(h,h+m)),h+=m;h<s;){for(p=e.next(4),p.write_shift(2,60),m=0;m+(f[d]||8224)<=8224;)m+=f[d]||8224,d++;p.write_shift(2,m),e.push(t.slice(h,h+m)),h+=m}}}function s0(e,a,t){return e||(e=we(7)),e.write_shift(2,a),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function D8(e,a,t,i){var s=we(9);return s0(s,e,a),Z2(t,i||"b",s),s}function j8(e,a,t){var i=we(8+2*t.length);return s0(i,e,a),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function F8(e,a,t,i){if(a.v!=null)switch(a.t){case"d":case"n":var s=a.t=="d"?wa(Gt(a.v)):a.v;s==(s|0)&&s>=0&&s<65536?Le(e,2,k3(t,i,s)):Le(e,3,N3(t,i,s));return;case"b":case"e":Le(e,5,D8(t,i,a.v,a.t));return;case"s":case"str":Le(e,4,j8(t,i,(a.v||"").slice(0,255)));return}Le(e,1,s0(null,t,i))}function O8(e,a,t,i){var s=Array.isArray(a),c=St(a["!ref"]||"A1"),f,d="",h=[];if(c.e.c>255||c.e.r>16383){if(i.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),f=nt(c)}for(var m=c.s.r;m<=c.e.r;++m){d=oa(m);for(var p=c.s.c;p<=c.e.c;++p){m===c.s.r&&(h[p]=Wt(p)),f=h[p]+d;var v=s?(a[m]||[])[p]:a[f];v&&F8(e,v,m,p)}}}function R8(e,a){for(var t=a||{},i=ur(),s=0,c=0;c<e.SheetNames.length;++c)e.SheetNames[c]==t.sheet&&(s=c);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Le(i,t.biff==4?1033:t.biff==3?521:9,Oh(e,16,t)),O8(i,e.Sheets[e.SheetNames[s]],s,t),Le(i,10),i.end()}function M8(e,a,t){Le(e,49,kT({sz:12,name:"Arial"},t))}function L8(e,a,t){a&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)a[s]!=null&&Le(e,1054,RT(s,a[s],t))})}function I8(e,a){var t=we(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Le(e,2151,t),t=we(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),ty(St(a["!ref"]||"A1"),t),t.write_shift(4,4),Le(e,2152,t)}function B8(e,a){for(var t=0;t<16;++t)Le(e,224,$g({numFmtId:0,style:!0},0,a));a.cellXfs.forEach(function(i){Le(e,224,$g(i,0,a))})}function U8(e,a){for(var t=0;t<a["!links"].length;++t){var i=a["!links"][t];Le(e,440,c3(i)),i[1].Tooltip&&Le(e,2048,f3(i))}delete a["!links"]}function z8(e,a){if(a){var t=0;a.forEach(function(i,s){++t<=256&&i&&Le(e,125,p3(lf(s,i),s))})}}function P8(e,a,t,i,s){var c=16+Li(s.cellXfs,a,s);if(a.v==null&&!a.bf){Le(e,513,ps(t,i,c));return}if(a.bf)Le(e,6,hC(a,t,i,s,c));else switch(a.t){case"d":case"n":var f=a.t=="d"?wa(Gt(a.v)):a.v;Le(e,515,YT(t,i,f,c));break;case"b":case"e":Le(e,517,GT(t,i,a.v,c,s,a.t));break;case"s":case"str":if(s.bookSST){var d=Ph(s.Strings,a.v,s.revStrings);Le(e,253,DT(t,i,d,c))}else Le(e,516,FT(t,i,(a.v||"").slice(0,255),c,s));break;default:Le(e,513,ps(t,i,c))}}function H8(e,a,t){var i=ur(),s=t.SheetNames[e],c=t.Sheets[s]||{},f=(t||{}).Workbook||{},d=(f.Sheets||[])[e]||{},h=Array.isArray(c),m=a.biff==8,p,v="",y=[],_=St(c["!ref"]||"A1"),w=m?65536:16384;if(_.e.c>255||_.e.r>=w){if(a.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,w-1)}Le(i,2057,Oh(t,16,a)),Le(i,13,Gr(1)),Le(i,12,Gr(100)),Le(i,15,Qa(!0)),Le(i,17,Qa(!1)),Le(i,16,ms(.001)),Le(i,95,Qa(!0)),Le(i,42,Qa(!1)),Le(i,43,Qa(!1)),Le(i,130,Gr(1)),Le(i,128,VT()),Le(i,131,Qa(!1)),Le(i,132,Qa(!1)),m&&z8(i,c["!cols"]),Le(i,512,LT(_,a)),m&&(c["!links"]=[]);for(var b=_.s.r;b<=_.e.r;++b){v=oa(b);for(var T=_.s.c;T<=_.e.c;++T){b===_.s.r&&(y[T]=Wt(T)),p=y[T]+v;var C=h?(c[b]||[])[T]:c[p];C&&(P8(i,C,b,T,a),m&&C.l&&c["!links"].push([p,C.l]))}}var L=d.CodeName||d.name||s;return m&&Le(i,574,TT((f.Views||[])[0])),m&&(c["!merges"]||[]).length&&Le(i,229,a3(c["!merges"])),m&&U8(i,c),Le(i,442,$2(L)),m&&I8(i,c),Le(i,10),i.end()}function V8(e,a,t){var i=ur(),s=(e||{}).Workbook||{},c=s.Sheets||[],f=s.WBProps||{},d=t.biff==8,h=t.biff==5;if(Le(i,2057,Oh(e,5,t)),t.bookType=="xla"&&Le(i,135),Le(i,225,d?Gr(1200):null),Le(i,193,GE(2)),h&&Le(i,191),h&&Le(i,192),Le(i,226),Le(i,92,dT("SheetJS",t)),Le(i,66,Gr(d?1200:1252)),d&&Le(i,353,Gr(0)),d&&Le(i,448),Le(i,317,y3(e.SheetNames.length)),d&&e.vbaraw&&Le(i,211),d&&e.vbaraw){var m=f.CodeName||"ThisWorkbook";Le(i,442,$2(m))}Le(i,156,Gr(17)),Le(i,25,Qa(!1)),Le(i,18,Qa(!1)),Le(i,19,Gr(0)),d&&Le(i,431,Qa(!1)),d&&Le(i,444,Gr(0)),Le(i,61,ST()),Le(i,64,Qa(!1)),Le(i,141,Gr(0)),Le(i,34,Qa(b5(e)=="true")),Le(i,14,Qa(!0)),d&&Le(i,439,Qa(!1)),Le(i,218,Gr(0)),M8(i,e,t),L8(i,e.SSF,t),B8(i,t),d&&Le(i,352,Qa(!1));var p=i.end(),v=ur();d&&Le(v,140,d3()),d&&t.Strings&&C8(v,252,gT(t.Strings)),Le(v,10);var y=v.end(),_=ur(),w=0,b=0;for(b=0;b<e.SheetNames.length;++b)w+=(d?12:11)+(d?2:1)*e.SheetNames[b].length;var T=p.length+w+y.length;for(b=0;b<e.SheetNames.length;++b){var C=c[b]||{};Le(_,133,xT({pos:T,hs:C.Hidden||0,dt:0,name:e.SheetNames[b]},t)),T+=a[b].length}var L=_.end();if(w!=L.length)throw new Error("BS8 "+w+" != "+L.length);var N=[];return p.length&&N.push(p),L.length&&N.push(L),y.length&&N.push(y),ka(N)}function G8(e,a){var t=a||{},i=[];e&&!e.SSF&&(e.SSF=Xt(Ze)),e&&e.SSF&&(wl(),Jo(e.SSF),t.revssf=tf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Yh(t),t.cellXfs=[],Li(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)i[i.length]=H8(s,t,e);return i.unshift(V8(e,i,t)),ka(i)}function Gy(e,a){for(var t=0;t<=e.SheetNames.length;++t){var i=e.Sheets[e.SheetNames[t]];if(!(!i||!i["!ref"])){var s=dr(i["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var c=a||{};switch(c.biff||2){case 8:case 5:return G8(e,a);case 4:case 3:case 2:return R8(e,a)}throw new Error("invalid type "+c.bookType+" for BIFF")}function dv(e,a){var t=a||{},i=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var c=e.match(/<\/table/i),f=s.index,d=c&&c.index||e.length,h=k4(e.slice(f,d),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,p=0,v=0,y=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(f=0;f<h.length;++f){var b=h[f].trim(),T=b.slice(0,3).toLowerCase();if(T=="<tr"){if(++m,t.sheetRows&&t.sheetRows<=m){--m;break}p=0;continue}if(!(T!="<td"&&T!="<th")){var C=b.split(/<\/t[dh]>/i);for(d=0;d<C.length;++d){var L=C[d].trim();if(L.match(/<t[dh]/i)){for(var N=L,j=0;N.charAt(0)=="<"&&(j=N.indexOf(">"))>-1;)N=N.slice(j+1);for(var V=0;V<w.length;++V){var M=w[V];M.s.c==p&&M.s.r<m&&m<=M.e.r&&(p=M.e.c+1,V=-1)}var k=Qe(L.slice(0,L.indexOf(">")));y=k.colspan?+k.colspan:1,((v=+k.rowspan)>1||y>1)&&w.push({s:{r:m,c:p},e:{r:m+(v||1)-1,c:p+y-1}});var W=k.t||k["data-t"]||"";if(!N.length){p+=y;continue}if(N=m2(N),_.s.r>m&&(_.s.r=m),_.e.r<m&&(_.e.r=m),_.s.c>p&&(_.s.c=p),_.e.c<p&&(_.e.c=p),!N.length){p+=y;continue}var K={t:"s",v:N};t.raw||!N.trim().length||W=="s"||(N==="TRUE"?K={t:"b",v:!0}:N==="FALSE"?K={t:"b",v:!1}:isNaN(sn(N))?isNaN(gl(N).getDate())||(K={t:"d",v:Gt(N)},t.cellDates||(K={t:"n",v:wa(K.v)}),K.z=t.dateNF||Ze[14]):K={t:"n",v:sn(N)}),t.dense?(i[m]||(i[m]=[]),i[m][p]=K):i[$e({r:m,c:p})]=K,p+=y}}}}return i["!ref"]=nt(_),w.length&&(i["!merges"]=w),i}function X8(e,a,t,i){for(var s=e["!merges"]||[],c=[],f=a.s.c;f<=a.e.c;++f){for(var d=0,h=0,m=0;m<s.length;++m)if(!(s[m].s.r>t||s[m].s.c>f)&&!(s[m].e.r<t||s[m].e.c<f)){if(s[m].s.r<t||s[m].s.c<f){d=-1;break}d=s[m].e.r-s[m].s.r+1,h=s[m].e.c-s[m].s.c+1;break}if(!(d<0)){var p=$e({r:t,c:f}),v=i.dense?(e[t]||[])[f]:e[p],y=v&&v.v!=null&&(v.h||_h(v.w||(qn(v),v.w)||""))||"",_={};d>1&&(_.rowspan=d),h>1&&(_.colspan=h),i.editable?y='<span contenteditable="true">'+y+"</span>":v&&(_["data-t"]=v&&v.t||"z",v.v!=null&&(_["data-v"]=v.v),v.z!=null&&(_["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+v.l.Target+'">'+y+"</a>")),_.id=(i.id||"sjs")+"-"+p,c.push(Me("td",y,_))}}var w="<tr>";return w+c.join("")+"</tr>"}var Y8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',W8="</body></html>";function q8(e,a){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Mi(dv(t[0],a),a);var i=Kh();return t.forEach(function(s,c){Zh(i,dv(s,a),"Sheet"+(c+1))}),i}function K8(e,a,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Xy(e,a){var t=a||{},i=t.header!=null?t.header:Y8,s=t.footer!=null?t.footer:W8,c=[i],f=dr(e["!ref"]);t.dense=Array.isArray(e),c.push(K8(e,f,t));for(var d=f.s.r;d<=f.e.r;++d)c.push(X8(e,f,d,t));return c.push("</table>"+s),c.join("")}function Yy(e,a,t){var i=t||{},s=0,c=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var f=typeof i.origin=="string"?qt(i.origin):i.origin;s=f.r,c=f.c}var d=a.getElementsByTagName("tr"),h=Math.min(i.sheetRows||1e7,d.length),m={s:{r:0,c:0},e:{r:s,c}};if(e["!ref"]){var p=dr(e["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),s==-1&&(m.e.r=s=p.e.r+1)}var v=[],y=0,_=e["!rows"]||(e["!rows"]=[]),w=0,b=0,T=0,C=0,L=0,N=0;for(e["!cols"]||(e["!cols"]=[]);w<d.length&&b<h;++w){var j=d[w];if(hv(j)){if(i.display)continue;_[b]={hidden:!0}}var V=j.children;for(T=C=0;T<V.length;++T){var M=V[T];if(!(i.display&&hv(M))){var k=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):m2(M.innerHTML),W=M.getAttribute("data-z")||M.getAttribute("z");for(y=0;y<v.length;++y){var K=v[y];K.s.c==C+c&&K.s.r<b+s&&b+s<=K.e.r&&(C=K.e.c+1-c,y=-1)}N=+M.getAttribute("colspan")||1,((L=+M.getAttribute("rowspan")||1)>1||N>1)&&v.push({s:{r:b+s,c:C+c},e:{r:b+s+(L||1)-1,c:C+c+(N||1)-1}});var J={t:"s",v:k},Z=M.getAttribute("data-t")||M.getAttribute("t")||"";k!=null&&(k.length==0?J.t=Z||"z":i.raw||k.trim().length==0||Z=="s"||(k==="TRUE"?J={t:"b",v:!0}:k==="FALSE"?J={t:"b",v:!1}:isNaN(sn(k))?isNaN(gl(k).getDate())||(J={t:"d",v:Gt(k)},i.cellDates||(J={t:"n",v:wa(J.v)}),J.z=i.dateNF||Ze[14]):J={t:"n",v:sn(k)})),J.z===void 0&&W!=null&&(J.z=W);var Q="",re=M.getElementsByTagName("A");if(re&&re.length)for(var ue=0;ue<re.length&&!(re[ue].hasAttribute("href")&&(Q=re[ue].getAttribute("href"),Q.charAt(0)!="#"));++ue);Q&&Q.charAt(0)!="#"&&(J.l={Target:Q}),i.dense?(e[b+s]||(e[b+s]=[]),e[b+s][C+c]=J):e[$e({c:C+c,r:b+s})]=J,m.e.c<C+c&&(m.e.c=C+c),C+=N}}++b}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,b-1+s),e["!ref"]=nt(m),b>=h&&(e["!fullref"]=nt((m.e.r=d.length-w+b-1+s,m))),e}function Wy(e,a){var t=a||{},i=t.dense?[]:{};return Yy(i,e,a)}function Z8(e,a){return Mi(Wy(e,a),a)}function hv(e){var a="",t=$8(e);return t&&(a=t(e).getPropertyValue("display")),a||(a=e.style&&e.style.display),a==="none"}function $8(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Q8(e){var a=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=wt(a.replace(/<[^>]*>/g,""));return[t]}var mv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function qy(e,a){var t=a||{},i=bh(e),s=[],c,f,d={name:""},h="",m=0,p,v,y={},_=[],w=t.dense?[]:{},b,T,C={value:""},L="",N=0,j=[],V=-1,M=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,K={},J=[],Z={},Q=0,re=0,ue=[],ve=1,ee=1,G=[],ae={Names:[]},R={},se=["",""],A=[],E={},O="",B=0,z=!1,le=!1,ye=0;for(Gc.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=Gc.exec(i);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?w["!ref"]=nt(k):w["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=k.e.r&&(w["!fullref"]=w["!ref"],k.e.r=t.sheetRows-1,w["!ref"]=nt(k)),J.length&&(w["!merges"]=J),ue.length&&(w["!rows"]=ue),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),_.push(p.name),y[p.name]=w,le=!1):b[0].charAt(b[0].length-2)!=="/"&&(p=Qe(b[0],!1),V=M=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,w=t.dense?[]:{},J=[],ue=[],le=!0);break;case"table-row-group":b[1]==="/"?--W:++W;break;case"table-row":case"":if(b[1]==="/"){V+=ve,ve=1;break}if(v=Qe(b[0],!1),v.?V=v.-1:V==-1&&(V=0),ve=+v["number-rows-repeated"]||1,ve<10)for(ye=0;ye<ve;++ye)W>0&&(ue[V+ye]={level:W});M=-1;break;case"covered-table-cell":b[1]!=="/"&&++M,t.sheetStubs&&(t.dense?(w[V]||(w[V]=[]),w[V][M]={t:"z"}):w[$e({r:V,c:M})]={t:"z"}),L="",j=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++M,C=Qe(b[0],!1),ee=parseInt(C["number-columns-repeated"]||"1",10),T={t:"z",v:null},C.formula&&t.cellFormula!=!1&&(T.f=ov(wt(C.formula))),(C.||C["value-type"])=="string"&&(T.t="s",T.v=wt(C["string-value"]||""),t.dense?(w[V]||(w[V]=[]),w[V][M]=T):w[$e({r:V,c:M})]=T),M+=ee-1;else if(b[1]!=="/"){++M,L="",N=0,j=[],ee=1;var Ne=ve?V+ve-1:V;if(M>k.e.c&&(k.e.c=M),M<k.s.c&&(k.s.c=M),V<k.s.r&&(k.s.r=V),Ne>k.e.r&&(k.e.r=Ne),C=Qe(b[0],!1),A=[],E={},T={t:C.||C["value-type"],v:null},t.cellFormula)if(C.formula&&(C.formula=wt(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(Q=parseInt(C["number-matrix-rows-spanned"],10)||0,re=parseInt(C["number-matrix-columns-spanned"],10)||0,Z={s:{r:V,c:M},e:{r:V+Q-1,c:M+re-1}},T.F=nt(Z),G.push([Z,T.F])),C.formula)T.f=ov(C.formula);else for(ye=0;ye<G.length;++ye)V>=G[ye][0].s.r&&V<=G[ye][0].e.r&&M>=G[ye][0].s.c&&M<=G[ye][0].e.c&&(T.F=G[ye][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(Q=parseInt(C["number-rows-spanned"],10)||0,re=parseInt(C["number-columns-spanned"],10)||0,Z={s:{r:V,c:M},e:{r:V+Q-1,c:M+re-1}},J.push(Z)),C["number-columns-repeated"]&&(ee=parseInt(C["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=Vt(C["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(C.value);break;case"percentage":T.t="n",T.v=parseFloat(C.value);break;case"currency":T.t="n",T.v=parseFloat(C.value);break;case"date":T.t="d",T.v=Gt(C["date-value"]),t.cellDates||(T.t="n",T.v=wa(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=T4(C["time-value"])/86400,t.cellDates&&(T.t="d",T.v=af(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(C.);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",C["string-value"]!=null&&(L=wt(C["string-value"]),j=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(z=!1,T.t==="s"&&(T.v=L||"",j.length&&(T.R=j),z=N==0),R.Target&&(T.l=R),A.length>0&&(T.c=A,A=[]),L&&t.cellText!==!1&&(T.w=L),z&&(T.t="z",delete T.v),(!z||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=V))for(var Te=0;Te<ve;++Te){if(ee=parseInt(C["number-columns-repeated"]||"1",10),t.dense)for(w[V+Te]||(w[V+Te]=[]),w[V+Te][M]=Te==0?T:Xt(T);--ee>0;)w[V+Te][M+ee]=Xt(T);else for(w[$e({r:V+Te,c:M})]=T;--ee>0;)w[$e({r:V+Te,c:M+ee})]=Xt(T);k.e.c<=M&&(k.e.c=M)}ee=parseInt(C["number-columns-repeated"]||"1",10),M+=ee-1,ee=0,T={},L="",j=[]}R={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((c=s.pop())[0]!==b[3])throw"Bad state: "+c}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((c=s.pop())[0]!==b[3])throw"Bad state: "+c;E.t=L,j.length&&(E.R=j),E.a=O,A.push(E)}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!1]);O="",B=0,L="",N=0,j=[];break;case"creator":b[1]==="/"?O=i.slice(B,b.index):B=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((c=s.pop())[0]!==b[3])throw"Bad state: "+c}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!1]);L="",N=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(K[d.name]=h,(c=s.pop())[0]!==b[3])throw"Bad state: "+c}else b[0].charAt(b[0].length-2)!=="/"&&(h="",d=Qe(b[0],!1),s.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":f=Qe(b[0],!1),h+=mv[b[3]][f.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":f=Qe(b[0],!1),h+=mv[b[3]][f.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":h+=i.slice(m,b.index);break}else m=b.index+b[0].length;break;case"named-range":f=Qe(b[0],!1),se=Bd(f["cell-range-address"]);var De={Name:f.name,Ref:se[0]+"!"+se[1]};le&&(De.Sheet=_.length),ae.Names.push(De);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(b[1]==="/"&&(!C||!C["string-value"])){var Ve=Q8(i.slice(N,b.index));L=(L.length>0?L+`
`:"")+Ve[0]}else Qe(b[0],!1),N=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{se=Bd(Qe(b[0])["target-range-address"]),y[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(R=Qe(b[0],!1),!R.href)break;R.Target=wt(R.href),delete R.href,R.Target.charAt(0)=="#"&&R.Target.indexOf(".")>-1?(se=Bd(R.Target.slice(1)),R.Target="#"+se[0]+"!"+se[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(b)}}var q={Sheets:y,SheetNames:_,Workbook:ae};return t.bookSheets&&delete q.Sheets,q}function xv(e,a){a=a||{},Vr(e,"META-INF/manifest.xml")&&TE(pa(e,"META-INF/manifest.xml"),a);var t=Tr(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var i=qy(It(t),a);return Vr(e,"meta.xml")&&(i.Props=B2(pa(e,"meta.xml"))),i}function pv(e,a){return qy(e,a)}var J8=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),a="<office:document-styles "+Vc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return fa+a}})(),gv=(function(){var e=function(c){return Ot(c).replace(/  +/g,function(f){return'<text:s text:c="'+f.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},a=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,i=function(c,f,d){var h=[];h.push('      <table:table table:name="'+Ot(f.SheetNames[d])+`" table:style-name="ta1">
`);var m=0,p=0,v=dr(c["!ref"]||"A1"),y=c["!merges"]||[],_=0,w=Array.isArray(c);if(c["!cols"])for(p=0;p<=v.e.c;++p)h.push("        <table:table-column"+(c["!cols"][p]?' table:style-name="co'+c["!cols"][p].ods+'"':"")+`></table:table-column>
`);var b="",T=c["!rows"]||[];for(m=0;m<v.s.r;++m)b=T[m]?' table:style-name="ro'+T[m].ods+'"':"",h.push("        <table:table-row"+b+`></table:table-row>
`);for(;m<=v.e.r;++m){for(b=T[m]?' table:style-name="ro'+T[m].ods+'"':"",h.push("        <table:table-row"+b+`>
`),p=0;p<v.s.c;++p)h.push(a);for(;p<=v.e.c;++p){var C=!1,L={},N="";for(_=0;_!=y.length;++_)if(!(y[_].s.c>p)&&!(y[_].s.r>m)&&!(y[_].e.c<p)&&!(y[_].e.r<m)){(y[_].s.c!=p||y[_].s.r!=m)&&(C=!0),L["table:number-columns-spanned"]=y[_].e.c-y[_].s.c+1,L["table:number-rows-spanned"]=y[_].e.r-y[_].s.r+1;break}if(C){h.push(t);continue}var j=$e({r:m,c:p}),V=w?(c[m]||[])[p]:c[j];if(V&&V.f&&(L["table:formula"]=Ot(yC(V.f)),V.F&&V.F.slice(0,j.length)==j)){var M=dr(V.F);L["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,L["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!V){h.push(a);continue}switch(V.t){case"b":N=V.v?"TRUE":"FALSE",L["office:value-type"]="boolean",L["office:boolean-value"]=V.v?"true":"false";break;case"n":N=V.w||String(V.v||0),L["office:value-type"]="float",L["office:value"]=V.v||0;break;case"s":case"str":N=V.v==null?"":V.v,L["office:value-type"]="string";break;case"d":N=V.w||Gt(V.v).toISOString(),L["office:value-type"]="date",L["office:date-value"]=Gt(V.v).toISOString(),L["table:style-name"]="ce1";break;default:h.push(a);continue}var k=e(N);if(V.l&&V.l.Target){var W=V.l.Target;W=W.charAt(0)=="#"?"#"+_C(W.slice(1)):W,W.charAt(0)!="#"&&!W.match(/^\w+:/)&&(W="../"+W),k=Me("text:a",k,{"xlink:href":W.replace(/&/g,"&amp;")})}h.push("          "+Me("table:table-cell",Me("text:p",k,{}),L)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},s=function(c,f){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var d=0;f.SheetNames.map(function(m){return f.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var p=0;p<m["!cols"].length;++p)if(m["!cols"][p]){var v=m["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Ci(v),v.ods=d;var y=m["!cols"][p].wpx+"px";c.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),c.push(`  </style:style>
`),++d}}});var h=0;f.SheetNames.map(function(m){return f.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var p=0;p<m["!rows"].length;++p)if(m["!rows"][p]){m["!rows"][p].ods=h;var v=m["!rows"][p].hpx+"px";c.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),c.push(`  </style:style>
`),++h}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(f,d){var h=[fa],m=Vc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Vc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(h.push("<office:document"+m+p+`>
`),h.push(I2().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+m+`>
`),s(h,f),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var v=0;v!=f.SheetNames.length;++v)h.push(i(f.Sheets[f.SheetNames[v]],f,v));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),d.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function Ky(e,a){if(a.bookType=="fods")return gv(e,a);var t=gh(),i="",s=[],c=[];return i="mimetype",lt(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",lt(t,i,gv(e,a)),s.push([i,"text/xml"]),c.push([i,"ContentFile"]),i="styles.xml",lt(t,i,J8(e,a)),s.push([i,"text/xml"]),c.push([i,"StylesFile"]),i="meta.xml",lt(t,i,fa+I2()),s.push([i,"text/xml"]),c.push([i,"MetadataFile"]),i="manifest.rdf",lt(t,i,kE(c)),s.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",lt(t,i,NE(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function gs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function lh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):It(Ri(e))}function eD(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Er(gn(e))}function tD(e,a){e:for(var t=0;t<=e.length-a.length;++t){for(var i=0;i<a.length;++i)if(e[t+i]!=a[i])continue e;return!0}return!1}function ji(e){var a=e.reduce(function(s,c){return s+c.length},0),t=new Uint8Array(a),i=0;return e.forEach(function(s){t.set(s,i),i+=s.length}),t}function vv(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function aD(e,a){for(var t=(e[a+15]&127)<<7|e[a+14]>>1,i=e[a+14]&1,s=a+13;s>=a;--s)i=i*256+e[s];return(e[a+15]&128?-i:i)*Math.pow(10,t-6176)}function rD(e,a,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,i-6176);e[a+15]|=i>>7,e[a+14]|=(i&127)<<1;for(var c=0;s>=1;++c,s/=256)e[a+c]=s&255;e[a+15]|=t>=0?0:128}function $c(e,a){var t=a?a[0]:0,i=e[t]&127;e:if(e[t++]>=128&&(i|=(e[t]&127)<<7,e[t++]<128||(i|=(e[t]&127)<<14,e[t++]<128)||(i|=(e[t]&127)<<21,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return a&&(a[0]=t),i}function jt(e){var a=new Uint8Array(7);a[0]=e&127;var t=1;e:if(e>127){if(a[t-1]|=128,a[t]=e>>7&127,++t,e<=16383||(a[t-1]|=128,a[t]=e>>14&127,++t,e<=2097151)||(a[t-1]|=128,a[t]=e>>21&127,++t,e<=268435455)||(a[t-1]|=128,a[t]=e/256>>>21&127,++t,e<=34359738367)||(a[t-1]|=128,a[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;a[t-1]|=128,a[t]=e/16777216>>>21&127,++t}return a.slice(0,t)}function aa(e){var a=0,t=e[a]&127;e:if(e[a++]>=128){if(t|=(e[a]&127)<<7,e[a++]<128||(t|=(e[a]&127)<<14,e[a++]<128)||(t|=(e[a]&127)<<21,e[a++]<128))break e;t|=(e[a]&127)<<28}return t}function Nt(e){for(var a=[],t=[0];t[0]<e.length;){var i=t[0],s=$c(e,t),c=s&7;s=Math.floor(s/8);var f=0,d;if(s==0)break;switch(c){case 0:{for(var h=t[0];e[t[0]++]>=128;);d=e.slice(h,t[0])}break;case 5:f=4,d=e.slice(t[0],t[0]+f),t[0]+=f;break;case 1:f=8,d=e.slice(t[0],t[0]+f),t[0]+=f;break;case 2:f=$c(e,t),d=e.slice(t[0],t[0]+f),t[0]+=f;break;case 3:case 4:default:throw new Error("PB Type ".concat(c," for Field ").concat(s," at offset ").concat(i))}var m={data:d,type:c};a[s]==null?a[s]=[m]:a[s].push(m)}return a}function Ra(e){var a=[];return e.forEach(function(t,i){t.forEach(function(s){s.data&&(a.push(jt(i*8+s.type)),s.type==2&&a.push(jt(s.data.length)),a.push(s.data))})}),ji(a)}function Gh(e,a){return(e==null?void 0:e.map(function(t){return a(t.data)}))||[]}function Pr(e){for(var a,t=[],i=[0];i[0]<e.length;){var s=$c(e,i),c=Nt(e.slice(i[0],i[0]+s));i[0]+=s;var f={id:aa(c[1][0].data),messages:[]};c[2].forEach(function(d){var h=Nt(d.data),m=aa(h[3][0].data);f.messages.push({meta:h,data:e.slice(i[0],i[0]+m)}),i[0]+=m}),(a=c[3])!=null&&a[0]&&(f.merge=aa(c[3][0].data)>>>0>0),t.push(f)}return t}function ll(e){var a=[];return e.forEach(function(t){var i=[];i[1]=[{data:jt(t.id),type:0}],i[2]=[],t.merge!=null&&(i[3]=[{data:jt(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(f){s.push(f.data),f.meta[3]=[{type:0,data:jt(f.data.length)}],i[2].push({data:Ra(f.meta),type:2})});var c=Ra(i);a.push(jt(c.length)),a.push(c),s.forEach(function(f){return a.push(f)})}),ji(a)}function nD(e,a){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],i=$c(a,t),s=[];t[0]<a.length;){var c=a[t[0]]&3;if(c==0){var f=a[t[0]++]>>2;if(f<60)++f;else{var d=f-59;f=a[t[0]],d>1&&(f|=a[t[0]+1]<<8),d>2&&(f|=a[t[0]+2]<<16),d>3&&(f|=a[t[0]+3]<<24),f>>>=0,f++,t[0]+=d}s.push(a.slice(t[0],t[0]+f)),t[0]+=f;continue}else{var h=0,m=0;if(c==1?(m=(a[t[0]]>>2&7)+4,h=(a[t[0]++]&224)<<3,h|=a[t[0]++]):(m=(a[t[0]++]>>2)+1,c==2?(h=a[t[0]]|a[t[0]+1]<<8,t[0]+=2):(h=(a[t[0]]|a[t[0]+1]<<8|a[t[0]+2]<<16|a[t[0]+3]<<24)>>>0,t[0]+=4)),s=[ji(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(m>=h)for(s.push(s[0].slice(-h)),m-=h;m>=s[s.length-1].length;)s.push(s[s.length-1]),m-=s[s.length-1].length;s.push(s[0].slice(-h,-h+m))}}var p=ji(s);if(p.length!=i)throw new Error("Unexpected length: ".concat(p.length," != ").concat(i));return p}function Hr(e){for(var a=[],t=0;t<e.length;){var i=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,a.push(nD(i,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return ji(a)}function cl(e){for(var a=[],t=0;t<e.length;){var i=Math.min(e.length-t,268435455),s=new Uint8Array(4);a.push(s);var c=jt(i),f=c.length;a.push(c),i<=60?(f++,a.push(new Uint8Array([i-1<<2]))):i<=256?(f+=2,a.push(new Uint8Array([240,i-1&255]))):i<=65536?(f+=3,a.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(f+=4,a.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(f+=5,a.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),a.push(e.slice(t,t+i)),f+=i,s[0]=0,s[1]=f&255,s[2]=f>>8&255,s[3]=f>>16&255,t+=i}return ji(a)}function iD(e,a,t,i){var s=gs(e),c=s.getUint32(4,!0),f=(i>1?12:8)+vv(c&(i>1?3470:398))*4,d=-1,h=-1,m=NaN,p=new Date(2001,0,1);c&512&&(d=s.getUint32(f,!0),f+=4),f+=vv(c&(i>1?12288:4096))*4,c&16&&(h=s.getUint32(f,!0),f+=4),c&32&&(m=s.getFloat64(f,!0),f+=8),c&64&&(p.setTime(p.getTime()+s.getFloat64(f,!0)*1e3),f+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:m};break;case 3:v={t:"s",v:a[h]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(d>-1)v={t:"s",v:t[d]};else if(h>-1)v={t:"s",v:a[h]};else if(!isNaN(m))v={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function sD(e,a,t){var i=gs(e),s=i.getUint32(8,!0),c=12,f=-1,d=-1,h=NaN,m=NaN,p=new Date(2001,0,1);s&1&&(h=aD(e,c),c+=16),s&2&&(m=i.getFloat64(c,!0),c+=8),s&4&&(p.setTime(p.getTime()+i.getFloat64(c,!0)*1e3),c+=8),s&8&&(d=i.getUint32(c,!0),c+=4),s&16&&(f=i.getUint32(c,!0),c+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:a[d]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(f>-1)v={t:"s",v:t[f]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return v}function zd(e,a){var t=new Uint8Array(32),i=gs(t),s=12,c=0;switch(t[0]=5,e.t){case"n":t[1]=2,rD(t,s,e.v),c|=1,s+=16;break;case"b":t[1]=6,i.setFloat64(s,e.v?1:0,!0),c|=2,s+=8;break;case"s":if(a.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,i.setUint32(s,a.indexOf(e.v),!0),c|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(8,c,!0),t.slice(0,s)}function Pd(e,a){var t=new Uint8Array(32),i=gs(t),s=12,c=0;switch(t[0]=3,e.t){case"n":t[2]=2,i.setFloat64(s,e.v,!0),c|=32,s+=8;break;case"b":t[2]=6,i.setFloat64(s,e.v?1:0,!0),c|=32,s+=8;break;case"s":if(a.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,i.setUint32(s,a.indexOf(e.v),!0),c|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(4,c,!0),t.slice(0,s)}function lD(e,a,t){switch(e[0]){case 0:case 1:case 2:case 3:return iD(e,a,t,e[0]);case 5:return sD(e,a,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ha(e){var a=Nt(e);return $c(a[1][0].data)}function yv(e,a){var t=Nt(a.data),i=aa(t[1][0].data),s=t[3],c=[];return(s||[]).forEach(function(f){var d=Nt(f.data),h=aa(d[1][0].data)>>>0;switch(i){case 1:c[h]=lh(d[3][0].data);break;case 8:{var m=e[Ha(d[9][0].data)][0],p=Nt(m.data),v=e[Ha(p[1][0].data)][0],y=aa(v.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var _=Nt(v.data);c[h]=_[3].map(function(w){return lh(w.data)}).join("")}break}}),c}function cD(e,a){var t,i,s,c,f,d,h,m,p,v,y,_,w,b,T=Nt(e),C=aa(T[1][0].data)>>>0,L=aa(T[2][0].data)>>>0,N=((i=(t=T[8])==null?void 0:t[0])==null?void 0:i.data)&&aa(T[8][0].data)>0||!1,j,V;if((c=(s=T[7])==null?void 0:s[0])!=null&&c.data&&a!=0)j=(d=(f=T[7])==null?void 0:f[0])==null?void 0:d.data,V=(m=(h=T[6])==null?void 0:h[0])==null?void 0:m.data;else if((v=(p=T[4])==null?void 0:p[0])!=null&&v.data&&a!=1)j=(_=(y=T[4])==null?void 0:y[0])==null?void 0:_.data,V=(b=(w=T[3])==null?void 0:w[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(a," cell storage");for(var M=N?4:1,k=gs(j),W=[],K=0;K<j.length/2;++K){var J=k.getUint16(K*2,!0);J<65535&&W.push([K,J])}if(W.length!=L)throw"Expected ".concat(L," cells, found ").concat(W.length);var Z=[];for(K=0;K<W.length-1;++K)Z[W[K][0]]=V.subarray(W[K][1]*M,W[K+1][1]*M);return W.length>=1&&(Z[W[W.length-1][0]]=V.subarray(W[W.length-1][1]*M)),{R:C,cells:Z}}function oD(e,a){var t,i=Nt(a.data),s=(t=i==null?void 0:i[7])!=null&&t[0]?aa(i[7][0].data)>>>0>0?1:0:-1,c=Gh(i[5],function(f){return cD(f,s)});return{nrows:aa(i[4][0].data)>>>0,data:c.reduce(function(f,d){return f[d.R]||(f[d.R]=[]),d.cells.forEach(function(h,m){if(f[d.R][m])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(m));f[d.R][m]=h}),f},[])}}function fD(e,a,t){var i,s=Nt(a.data),c={s:{r:0,c:0},e:{r:0,c:0}};if(c.e.r=(aa(s[6][0].data)>>>0)-1,c.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(c.e.c=(aa(s[7][0].data)>>>0)-1,c.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=nt(c);var f=Nt(s[4][0].data),d=yv(e,e[Ha(f[4][0].data)][0]),h=(i=f[17])!=null&&i[0]?yv(e,e[Ha(f[17][0].data)][0]):[],m=Nt(f[3][0].data),p=0;m[1].forEach(function(v){var y=Nt(v.data),_=e[Ha(y[2][0].data)][0],w=aa(_.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var b=oD(e,_);b.data.forEach(function(T,C){T.forEach(function(L,N){var j=$e({r:p+C,c:N}),V=lD(L,d,h);V&&(t[j]=V)})}),p+=b.nrows})}function uD(e,a){var t=Nt(a.data),i={"!ref":"A1"},s=e[Ha(t[2][0].data)],c=aa(s[0].meta[1][0].data);if(c!=6001)throw new Error("6000 unexpected reference to ".concat(c));return fD(e,s[0],i),i}function dD(e,a){var t,i=Nt(a.data),s={name:(t=i[1])!=null&&t[0]?lh(i[1][0].data):"",sheets:[]},c=Gh(i[2],Ha);return c.forEach(function(f){e[f].forEach(function(d){var h=aa(d.meta[1][0].data);h==6e3&&s.sheets.push(uD(e,d))})}),s}function hD(e,a){var t=Kh(),i=Nt(a.data),s=Gh(i[1],Ha);if(s.forEach(function(c){e[c].forEach(function(f){var d=aa(f.meta[1][0].data);if(d==2){var h=dD(e,f);h.sheets.forEach(function(m,p){Zh(t,m,p==0?h.name:h.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Hd(e){var a,t,i,s,c={},f=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var m;try{m=Hr(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var p;try{p=Pr(m)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){c[v.id]=v.messages,f.push(v.id)})}}),!f.length)throw new Error("File has no messages");var d=((s=(i=(t=(a=c==null?void 0:c[1])==null?void 0:a[0])==null?void 0:t.meta)==null?void 0:i[1])==null?void 0:s[0].data)&&aa(c[1][0].meta[1][0].data)==1&&c[1][0];if(d||f.forEach(function(h){c[h].forEach(function(m){var p=aa(m.meta[1][0].data)>>>0;if(p==1)if(!d)d=m;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return hD(c,d)}function mD(e,a,t){var i,s,c,f;if(!((i=e[6])!=null&&i[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var d=((f=(c=e[8])==null?void 0:c[0])==null?void 0:f.data)&&aa(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var h=0,m=gs(e[7][0].data),p=0,v=[],y=gs(e[4][0].data),_=0,w=[],b=0;b<a.length;++b){if(a[b]==null){m.setUint16(b*2,65535,!0),y.setUint16(b*2,65535);continue}m.setUint16(b*2,p,!0),y.setUint16(b*2,_,!0);var T,C;switch(typeof a[b]){case"string":T=zd({t:"s",v:a[b]},t),C=Pd({t:"s",v:a[b]},t);break;case"number":T=zd({t:"n",v:a[b]},t),C=Pd({t:"n",v:a[b]},t);break;case"boolean":T=zd({t:"b",v:a[b]},t),C=Pd({t:"b",v:a[b]},t);break;default:throw new Error("Unsupported value "+a[b])}v.push(T),p+=T.length,w.push(C),_+=C.length,++h}for(e[2][0].data=jt(h);b<e[7][0].data.length/2;++b)m.setUint16(b*2,65535,!0),y.setUint16(b*2,65535,!0);return e[6][0].data=ji(v),e[3][0].data=ji(w),h}function xD(e,a){if(!a||!a.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=dr(t["!ref"]);i.s.r=i.s.c=0;var s=!1;i.e.c>9&&(s=!0,i.e.c=9),i.e.r>49&&(s=!0,i.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(nt(i)));var c=$o(t,{range:i,header:1}),f=["~Sh33tJ5~"];c.forEach(function(O){return O.forEach(function(B){typeof B=="string"&&f.push(B)})});var d={},h=[],m=Ye.read(a.numbers,{type:"base64"});m.FileIndex.map(function(O,B){return[O,m.FullPaths[B]]}).forEach(function(O){var B=O[0],z=O[1];if(B.type==2&&B.name.match(/\.iwa/)){var le=B.content,ye=Hr(le),Ne=Pr(ye);Ne.forEach(function(Te){h.push(Te.id),d[Te.id]={deps:[],location:z,type:aa(Te.messages[0].meta[1][0].data)}})}}),h.sort(function(O,B){return O-B});var p=h.filter(function(O){return O>1}).map(function(O){return[O,jt(O)]});m.FileIndex.map(function(O,B){return[O,m.FullPaths[B]]}).forEach(function(O){var B=O[0];if(O[1],!!B.name.match(/\.iwa/)){var z=Pr(Hr(B.content));z.forEach(function(le){le.messages.forEach(function(ye){p.forEach(function(Ne){le.messages.some(function(Te){return aa(Te.meta[1][0].data)!=11006&&tD(Te.data,Ne[1])})&&d[Ne[0]].deps.push(le.id)})})})}});for(var v=Ye.find(m,d[1].location),y=Pr(Hr(v.content)),_,w=0;w<y.length;++w){var b=y[w];b.id==1&&(_=b)}var T=Ha(Nt(_.messages[0].data)[1][0].data);for(v=Ye.find(m,d[T].location),y=Pr(Hr(v.content)),w=0;w<y.length;++w)b=y[w],b.id==T&&(_=b);for(T=Ha(Nt(_.messages[0].data)[2][0].data),v=Ye.find(m,d[T].location),y=Pr(Hr(v.content)),w=0;w<y.length;++w)b=y[w],b.id==T&&(_=b);for(T=Ha(Nt(_.messages[0].data)[2][0].data),v=Ye.find(m,d[T].location),y=Pr(Hr(v.content)),w=0;w<y.length;++w)b=y[w],b.id==T&&(_=b);var C=Nt(_.messages[0].data);{C[6][0].data=jt(i.e.r+1),C[7][0].data=jt(i.e.c+1);var L=Ha(C[46][0].data),N=Ye.find(m,d[L].location),j=Pr(Hr(N.content));{for(var V=0;V<j.length&&j[V].id!=L;++V);if(j[V].id!=L)throw"Bad ColumnRowUIDMapArchive";var M=Nt(j[V].messages[0].data);M[1]=[],M[2]=[],M[3]=[];for(var k=0;k<=i.e.c;++k){var W=[];W[1]=W[2]=[{type:0,data:jt(k+420690)}],M[1].push({type:2,data:Ra(W)}),M[2].push({type:0,data:jt(k)}),M[3].push({type:0,data:jt(k)})}M[4]=[],M[5]=[],M[6]=[];for(var K=0;K<=i.e.r;++K)W=[],W[1]=W[2]=[{type:0,data:jt(K+726270)}],M[4].push({type:2,data:Ra(W)}),M[5].push({type:0,data:jt(K)}),M[6].push({type:0,data:jt(K)});j[V].messages[0].data=Ra(M)}N.content=cl(ll(j)),N.size=N.content.length,delete C[46];var J=Nt(C[4][0].data);{J[7][0].data=jt(i.e.r+1);var Z=Nt(J[1][0].data),Q=Ha(Z[2][0].data);N=Ye.find(m,d[Q].location),j=Pr(Hr(N.content));{if(j[0].id!=Q)throw"Bad HeaderStorageBucket";var re=Nt(j[0].messages[0].data);for(K=0;K<c.length;++K){var ue=Nt(re[2][0].data);ue[1][0].data=jt(K),ue[4][0].data=jt(c[K].length),re[2][K]={type:re[2][0].type,data:Ra(ue)}}j[0].messages[0].data=Ra(re)}N.content=cl(ll(j)),N.size=N.content.length;var ve=Ha(J[2][0].data);N=Ye.find(m,d[ve].location),j=Pr(Hr(N.content));{if(j[0].id!=ve)throw"Bad HeaderStorageBucket";for(re=Nt(j[0].messages[0].data),k=0;k<=i.e.c;++k)ue=Nt(re[2][0].data),ue[1][0].data=jt(k),ue[4][0].data=jt(i.e.r+1),re[2][k]={type:re[2][0].type,data:Ra(ue)};j[0].messages[0].data=Ra(re)}N.content=cl(ll(j)),N.size=N.content.length;var ee=Ha(J[4][0].data);(function(){for(var O=Ye.find(m,d[ee].location),B=Pr(Hr(O.content)),z,le=0;le<B.length;++le){var ye=B[le];ye.id==ee&&(z=ye)}var Ne=Nt(z.messages[0].data);{Ne[3]=[];var Te=[];f.forEach(function(q,ct){Te[1]=[{type:0,data:jt(ct)}],Te[2]=[{type:0,data:jt(1)}],Te[3]=[{type:2,data:eD(q)}],Ne[3].push({type:2,data:Ra(Te)})})}z.messages[0].data=Ra(Ne);var De=ll(B),Ve=cl(De);O.content=Ve,O.size=O.content.length})();var G=Nt(J[3][0].data);{var ae=G[1][0];delete G[2];var R=Nt(ae.data);{var se=Ha(R[2][0].data);(function(){for(var O=Ye.find(m,d[se].location),B=Pr(Hr(O.content)),z,le=0;le<B.length;++le){var ye=B[le];ye.id==se&&(z=ye)}var Ne=Nt(z.messages[0].data);{delete Ne[6],delete G[7];var Te=new Uint8Array(Ne[5][0].data);Ne[5]=[];for(var De=0,Ve=0;Ve<=i.e.r;++Ve){var q=Nt(Te);De+=mD(q,c[Ve],f),q[1][0].data=jt(Ve),Ne[5].push({data:Ra(q),type:2})}Ne[1]=[{type:0,data:jt(i.e.c+1)}],Ne[2]=[{type:0,data:jt(i.e.r+1)}],Ne[3]=[{type:0,data:jt(De)}],Ne[4]=[{type:0,data:jt(i.e.r+1)}]}z.messages[0].data=Ra(Ne);var ct=ll(B),We=cl(ct);O.content=We,O.size=O.content.length})()}ae.data=Ra(R)}J[3][0].data=Ra(G)}C[4][0].data=Ra(J)}_.messages[0].data=Ra(C);var A=ll(y),E=cl(A);return v.content=E,v.size=v.content.length,m}function Zy(e){return function(t){for(var i=0;i!=e.length;++i){var s=e[i];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function Xh(e){Zy([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Yh(e){Zy([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function pD(e){return ft.WS.indexOf(e)>-1?"sheet":e==ft.CS?"chart":e==ft.DS?"dialog":e==ft.MS?"macro":e&&e.length?e:"sheet"}function gD(e,a){if(!e)return 0;try{e=a.map(function(i){return i.id||(i.id=i.strRelID),[i.name,e["!id"][i.id].Target,pD(e["!id"][i.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function vD(e,a,t,i,s,c,f,d,h,m,p,v){try{c[i]=Rc(Tr(e,t,!0),a);var y=pa(e,a),_;switch(d){case"sheet":_=z5(y,a,s,h,c[i],m,p,v);break;case"chart":if(_=P5(y,a,s,h,c[i],m,p,v),!_||!_["!drawel"])break;var w=Cc(_["!drawel"].Target,a),b=Xc(w),T=AA(Tr(e,w,!0),Rc(Tr(e,b,!0),w)),C=Cc(T,w),L=Xc(C);_=m5(Tr(e,C,!0),C,h,Rc(Tr(e,L,!0),C),m,_);break;case"macro":_=H5(y,a,s,h,c[i],m,p,v);break;case"dialog":_=V5(y,a,s,h,c[i],m,p,v);break;default:throw new Error("Unrecognized sheet type "+d)}f[i]=_;var N=[];c&&c[i]&&ra(c[i]).forEach(function(j){var V="";if(c[i][j].Type==ft.CMNT){V=Cc(c[i][j].Target,a);var M=W5(pa(e,V,!0),V,h);if(!M||!M.length)return;nv(_,M,!1)}c[i][j].Type==ft.TCMNT&&(V=Cc(c[i][j].Target,a),N=N.concat(CA(pa(e,V,!0),h)))}),N&&N.length&&nv(_,N,!0,h.people||[])}catch(j){if(h.WTF)throw j}}function Ur(e){return e.charAt(0)=="/"?e.slice(1):e}function yD(e,a){if(wl(),a=a||{},Xh(a),Vr(e,"META-INF/manifest.xml")||Vr(e,"objectdata.xml"))return xv(e,a);if(Vr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hd<"u"){if(e.FileIndex)return Hd(e);var t=Ye.utils.cfb_new();return Tg(e).forEach(function(ue){lt(t,ue,D4(e,ue))}),Hd(t)}throw new Error("Unsupported NUMBERS file")}if(!Vr(e,"[Content_Types].xml"))throw Vr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=Tg(e),s=SE(Tr(e,"[Content_Types].xml")),c=!1,f,d;if(s.workbooks.length===0&&(d="xl/workbook.xml",pa(e,d,!0)&&s.workbooks.push(d)),s.workbooks.length===0){if(d="xl/workbook.bin",!pa(e,d,!0))throw new Error("Could not find workbook");s.workbooks.push(d),c=!0}s.workbooks[0].slice(-3)=="bin"&&(c=!0);var h={},m={};if(!a.bookSheets&&!a.bookProps){if(Mc=[],s.sst)try{Mc=Y5(pa(e,Ur(s.sst)),s.sst,a)}catch(ue){if(a.WTF)throw ue}a.cellStyles&&s.themes.length&&(h=X5(Tr(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],a)),s.style&&(m=G5(pa(e,Ur(s.style)),s.style,h,a))}s.links.map(function(ue){try{var ve=Rc(Tr(e,Xc(Ur(ue))),ue);return K5(pa(e,Ur(ue)),ve,ue,a)}catch{}});var p=U5(pa(e,Ur(s.workbooks[0])),s.workbooks[0],a),v={},y="";s.coreprops.length&&(y=pa(e,Ur(s.coreprops[0]),!0),y&&(v=B2(y)),s.extprops.length!==0&&(y=pa(e,Ur(s.extprops[0]),!0),y&&DE(y,v,a)));var _={};(!a.bookSheets||a.bookProps)&&s.custprops.length!==0&&(y=Tr(e,Ur(s.custprops[0]),!0),y&&(_=FE(y,a)));var w={};if((a.bookSheets||a.bookProps)&&(p.Sheets?f=p.Sheets.map(function(ve){return ve.name}):v.Worksheets&&v.SheetNames.length>0&&(f=v.SheetNames),a.bookProps&&(w.Props=v,w.Custprops=_),a.bookSheets&&typeof f<"u"&&(w.SheetNames=f),a.bookSheets?w.SheetNames:a.bookProps))return w;f={};var b={};a.bookDeps&&s.calcchain&&(b=q5(pa(e,Ur(s.calcchain)),s.calcchain));var T=0,C={},L,N;{var j=p.Sheets;v.Worksheets=j.length,v.SheetNames=[];for(var V=0;V!=j.length;++V)v.SheetNames[V]=j[V].name}var M=c?"bin":"xml",k=s.workbooks[0].lastIndexOf("/"),W=(s.workbooks[0].slice(0,k+1)+"_rels/"+s.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Vr(e,W)||(W="xl/_rels/workbook."+M+".rels");var K=Rc(Tr(e,W,!0),W.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(a.xlmeta=Z5(pa(e,Ur(s.metadata[0])),s.metadata[0],a)),(s.people||[]).length>=1&&(a.people=jA(pa(e,Ur(s.people[0])),a)),K&&(K=gD(K,p.Sheets));var J=pa(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=v.Worksheets;++T){var Z="sheet";if(K&&K[T]?(L="xl/"+K[T][1].replace(/[\/]?xl\//,""),Vr(e,L)||(L=K[T][1]),Vr(e,L)||(L=W.replace(/_rels\/.*$/,"")+K[T][1]),Z=K[T][2]):(L="xl/worksheets/sheet"+(T+1-J)+"."+M,L=L.replace(/sheet0\./,"sheet.")),N=L.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),a&&a.sheets!=null)switch(typeof a.sheets){case"number":if(T!=a.sheets)continue e;break;case"string":if(v.SheetNames[T].toLowerCase()!=a.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(a.sheets)){for(var Q=!1,re=0;re!=a.sheets.length;++re)typeof a.sheets[re]=="number"&&a.sheets[re]==T&&(Q=1),typeof a.sheets[re]=="string"&&a.sheets[re].toLowerCase()==v.SheetNames[T].toLowerCase()&&(Q=1);if(!Q)continue e}}vD(e,L,N,v.SheetNames[T],T,C,f,Z,a,p,h,m)}return w={Directory:s,Workbook:p,Props:v,Custprops:_,Deps:b,Sheets:f,SheetNames:v.SheetNames,Strings:Mc,Styles:m,Themes:h,SSF:Xt(Ze)},a&&a.bookFiles&&(e.files?(w.keys=i,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(ue,ve){ue=ue.replace(/^Root Entry[\/]/,""),w.keys.push(ue),w.files[ue]=e.FileIndex[ve]}))),a&&a.bookVBA&&(s.vba.length>0?w.vbaraw=pa(e,Ur(s.vba[0]),!0):s.defaults&&s.defaults.bin===UA&&(w.vbaraw=pa(e,"xl/vbaProject.bin",!0))),w}function _D(e,a){var t=a||{},i="Workbook",s=Ye.find(e,i);try{if(i="/!DataSpaces/Version",s=Ye.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(Z3(s.content),i="/!DataSpaces/DataSpaceMap",s=Ye.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var c=Q3(s.content);if(c.length!==1||c[0].comps.length!==1||c[0].comps[0].t!==0||c[0].name!=="StrongEncryptionDataSpace"||c[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ye.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var f=J3(s.content);if(f.length!=1||f[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ye.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);tN(s.content)}catch{}if(i="/EncryptionInfo",s=Ye.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var d=aN(s.content);if(i="/EncryptedPackage",s=Ye.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],s.content,t.password||"",t);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function bD(e,a){return a.bookType=="ods"?Ky(e,a):a.bookType=="numbers"?xD(e,a):a.bookType=="xlsb"?wD(e,a):SD(e,a)}function wD(e,a){dl=1024,e&&!e.SSF&&(e.SSF=Xt(Ze)),e&&e.SSF&&(wl(),Jo(e.SSF),a.revssf=tf(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Lc?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo);var t=a.bookType=="xlsb"?"bin":"xml",i=Sy.indexOf(a.bookType)>-1,s=jh();Yh(a=a||{});var c=gh(),f="",d=0;if(a.cellXfs=[],Li(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),f="docProps/core.xml",lt(c,f,U2(e.Props,a)),s.coreprops.push(f),Ft(a.rels,2,f,ft.CORE_PROPS),f="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&h.push(e.SheetNames[m]);e.Props.SheetNames=h}for(e.Props.Worksheets=e.Props.SheetNames.length,lt(c,f,H2(e.Props)),s.extprops.push(f),Ft(a.rels,3,f,ft.EXT_PROPS),e.Custprops!==e.Props&&ra(e.Custprops||{}).length>0&&(f="docProps/custom.xml",lt(c,f,V2(e.Custprops)),s.custprops.push(f),Ft(a.rels,4,f,ft.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var p={"!id":{}},v=e.Sheets[e.SheetNames[d-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:f="xl/worksheets/sheet"+d+"."+t,lt(c,f,Q5(d-1,f,a,e,p)),s.sheets.push(f),Ft(a.wbrels,-1,"worksheets/sheet"+d+"."+t,ft.WS[0])}if(v){var _=v["!comments"],w=!1,b="";_&&_.length>0&&(b="xl/comments"+d+"."+t,lt(c,b,t8(_,b)),s.comments.push(b),Ft(p,-1,"../comments"+d+"."+t,ft.CMNT),w=!0),v["!legacy"]&&w&&lt(c,"xl/drawings/vmlDrawing"+d+".vml",by(d,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&lt(c,Xc(f),ml(p))}return a.Strings!=null&&a.Strings.length>0&&(f="xl/sharedStrings."+t,lt(c,f,e8(a.Strings,f,a)),s.strs.push(f),Ft(a.wbrels,-1,"sharedStrings."+t,ft.SST)),f="xl/workbook."+t,lt(c,f,$5(e,f)),s.workbooks.push(f),Ft(a.rels,1,f,ft.WB),f="xl/theme/theme1.xml",lt(c,f,Ih(e.Themes,a)),s.themes.push(f),Ft(a.wbrels,-1,"theme/theme1.xml",ft.THEME),f="xl/styles."+t,lt(c,f,J5(e,f,a)),s.styles.push(f),Ft(a.wbrels,-1,"styles."+t,ft.STY),e.vbaraw&&i&&(f="xl/vbaProject.bin",lt(c,f,e.vbaraw),s.vba.push(f),Ft(a.wbrels,-1,"vbaProject.bin",ft.VBA)),f="xl/metadata."+t,lt(c,f,a8(f)),s.metadata.push(f),Ft(a.wbrels,-1,"metadata."+t,ft.XLMETA),lt(c,"[Content_Types].xml",L2(s,a)),lt(c,"_rels/.rels",ml(a.rels)),lt(c,"xl/_rels/workbook."+t+".rels",ml(a.wbrels)),delete a.revssf,delete a.ssf,c}function SD(e,a){dl=1024,e&&!e.SSF&&(e.SSF=Xt(Ze)),e&&e.SSF&&(wl(),Jo(e.SSF),a.revssf=tf(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Lc?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo);var t="xml",i=Sy.indexOf(a.bookType)>-1,s=jh();Yh(a=a||{});var c=gh(),f="",d=0;if(a.cellXfs=[],Li(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),f="docProps/core.xml",lt(c,f,U2(e.Props,a)),s.coreprops.push(f),Ft(a.rels,2,f,ft.CORE_PROPS),f="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&h.push(e.SheetNames[m]);e.Props.SheetNames=h}e.Props.Worksheets=e.Props.SheetNames.length,lt(c,f,H2(e.Props)),s.extprops.push(f),Ft(a.rels,3,f,ft.EXT_PROPS),e.Custprops!==e.Props&&ra(e.Custprops||{}).length>0&&(f="docProps/custom.xml",lt(c,f,V2(e.Custprops)),s.custprops.push(f),Ft(a.rels,4,f,ft.CUST_PROPS));var p=["SheetJ5"];for(a.tcid=0,d=1;d<=e.SheetNames.length;++d){var v={"!id":{}},y=e.Sheets[e.SheetNames[d-1]],_=(y||{})["!type"]||"sheet";switch(_){case"chart":default:f="xl/worksheets/sheet"+d+"."+t,lt(c,f,Ry(d-1,a,e,v)),s.sheets.push(f),Ft(a.wbrels,-1,"worksheets/sheet"+d+"."+t,ft.WS[0])}if(y){var w=y["!comments"],b=!1,T="";if(w&&w.length>0){var C=!1;w.forEach(function(L){L[1].forEach(function(N){N.T==!0&&(C=!0)})}),C&&(T="xl/threadedComments/threadedComment"+d+"."+t,lt(c,T,DA(w,p,a)),s.threadedcomments.push(T),Ft(v,-1,"../threadedComments/threadedComment"+d+"."+t,ft.TCMNT)),T="xl/comments"+d+"."+t,lt(c,T,wy(w)),s.comments.push(T),Ft(v,-1,"../comments"+d+"."+t,ft.CMNT),b=!0}y["!legacy"]&&b&&lt(c,"xl/drawings/vmlDrawing"+d+".vml",by(d,y["!comments"])),delete y["!comments"],delete y["!legacy"]}v["!id"].rId1&&lt(c,Xc(f),ml(v))}return a.Strings!=null&&a.Strings.length>0&&(f="xl/sharedStrings."+t,lt(c,f,oy(a.Strings,a)),s.strs.push(f),Ft(a.wbrels,-1,"sharedStrings."+t,ft.SST)),f="xl/workbook."+t,lt(c,f,Uy(e)),s.workbooks.push(f),Ft(a.rels,1,f,ft.WB),f="xl/theme/theme1.xml",lt(c,f,Ih(e.Themes,a)),s.themes.push(f),Ft(a.wbrels,-1,"theme/theme1.xml",ft.THEME),f="xl/styles."+t,lt(c,f,gy(e,a)),s.styles.push(f),Ft(a.wbrels,-1,"styles."+t,ft.STY),e.vbaraw&&i&&(f="xl/vbaProject.bin",lt(c,f,e.vbaraw),s.vba.push(f),Ft(a.wbrels,-1,"vbaProject.bin",ft.VBA)),f="xl/metadata."+t,lt(c,f,_y()),s.metadata.push(f),Ft(a.wbrels,-1,"metadata."+t,ft.XLMETA),p.length>1&&(f="xl/persons/person.xml",lt(c,f,FA(p)),s.people.push(f),Ft(a.wbrels,-1,"persons/person.xml",ft.PEOPLE)),lt(c,"[Content_Types].xml",L2(s,a)),lt(c,"_rels/.rels",ml(a.rels)),lt(c,"xl/_rels/workbook."+t+".rels",ml(a.wbrels)),delete a.revssf,delete a.ssf,c}function Wh(e,a){var t="";switch((a||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Nr(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(a&&a.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function ED(e,a){return Ye.find(e,"EncryptedPackage")?_D(e,a):Vy(e,a)}function TD(e,a){var t,i=e,s=a||{};return s.type||(s.type=ot&&Buffer.isBuffer(e)?"buffer":"base64"),t=u2(i,s),yD(t,s)}function $y(e,a){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return ih(e.slice(t),a);default:break e}return vl.to_workbook(e,a)}function ND(e,a){var t="",i=Wh(e,a);switch(a.type){case"base64":t=Nr(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=hs(e);break;default:throw new Error("Unrecognized type "+a.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(t=It(t)),a.type="binary",$y(t,a)}function AD(e,a){var t=e;return a.type=="base64"&&(t=Nr(t)),t=Uc.utils.decode(1200,t.slice(2),"str"),a.type="binary",$y(t,a)}function kD(e){return e.match(/[^\x00-\x7F]/)?gn(e):e}function Vd(e,a,t,i){return i?(t.type="string",vl.to_workbook(e,t)):vl.to_workbook(a,t)}function _l(e,a){dh();var t=a||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return _l(new Uint8Array(e),(t=Xt(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var i=e,s=[0,0,0,0],c=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),pl={},t.dateNF&&(pl.dateNF=t.dateNF),t.type||(t.type=ot&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=ot?"buffer":"binary",i=w4(e),typeof Uint8Array<"u"&&!ot&&(t.type="array")),t.type=="string"&&(c=!0,t.type="binary",t.codepage=65001,i=kD(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var f=new ArrayBuffer(3),d=new Uint8Array(f);if(d.foo="bar",!d.foo)return t=Xt(t),t.type="array",_l(hh(i),t)}switch((s=Wh(i,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return ED(Ye.read(i,t),t);break;case 9:if(s[1]<=8)return Vy(i,t);break;case 60:return ih(i,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return O3(i,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return ly.to_workbook(i,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?TD(i,t):Vd(e,i,t,c);case 239:return s[3]===60?ih(i,t):Vd(e,i,t,c);case 255:if(s[1]===254)return AD(i,t);if(s[1]===0&&s[2]===2&&s[3]===0)return cs.to_workbook(i,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return cs.to_workbook(i,t);break;case 3:case 131:case 139:case 140:return nh.to_workbook(i,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return my.to_workbook(i,t);break;case 10:case 13:case 32:return ND(i,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return F3.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?nh.to_workbook(i,t):Vd(e,i,t,c)}function Qy(e,a){switch(a.type){case"base64":case"binary":break;case"buffer":case"array":a.type="";break;case"file":return Jc(a.file,Ye.write(e,{type:ot?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");default:throw new Error("Unrecognized type "+a.type)}return Ye.write(e,a)}function CD(e,a){var t=Xt(a||{}),i=bD(e,t);return DD(i,t)}function DD(e,a){var t={},i=ot?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(a.compression&&(t.compression="DEFLATE"),a.password)t.type=i;else switch(a.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+a.type)}var s=e.FullPaths?Ye.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!a.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(a.type=="binary"||a.type=="base64")return s;s=new Uint8Array(Qo(s))}return a.password&&typeof encrypt_agile<"u"?Qy(encrypt_agile(s,a.password),a):a.type==="file"?Jc(a.file,s):a.type=="string"?It(s):s}function jD(e,a){var t=a||{},i=k8(e,t);return Qy(i,t)}function pn(e,a,t){t||(t="");var i=t+e;switch(a.type){case"base64":return zc(gn(i));case"binary":return gn(i);case"string":return e;case"file":return Jc(a.file,i,"utf8");case"buffer":return ot?Kn(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):pn(i,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type)}function FD(e,a){switch(a.type){case"base64":return zc(e);case"binary":return e;case"string":return e;case"file":return Jc(a.file,e,"binary");case"buffer":return ot?Kn(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type)}function Fo(e,a){switch(a.type){case"string":case"base64":case"binary":for(var t="",i=0;i<e.length;++i)t+=String.fromCharCode(e[i]);return a.type=="base64"?zc(t):a.type=="string"?It(t):t;case"file":return Jc(a.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+a.type)}}function Jy(e,a){dh(),E5(e);var t=Xt(a||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=Jy(e,t);return t.type="array",Qo(i)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return pn(b8(e,t),t);case"slk":case"sylk":return pn(sy.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return pn(Xy(e.Sheets[e.SheetNames[s]],t),t);case"txt":return FD(e_(e.Sheets[e.SheetNames[s]],t),t);case"csv":return pn(qh(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return pn(ly.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return Fo(nh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return pn(vl.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return pn(my.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return pn(cy.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return pn(Ky(e,t),t);case"wk1":return Fo(cs.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return Fo(cs.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Fo(Gy(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),jD(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return CD(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function OD(e,a,t,i,s,c,f,d){var h=oa(t),m=d.defval,p=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),v=!0,y=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:t,enumerable:!1})}catch{y.__rowNum__=t}else y.__rowNum__=t;if(!f||e[t])for(var _=a.s.c;_<=a.e.c;++_){var w=f?e[t][_]:e[i[_]+h];if(w===void 0||w.t===void 0){if(m===void 0)continue;c[_]!=null&&(y[c[_]]=m);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(c[_]!=null){if(b==null)if(w.t=="e"&&b===null)y[c[_]]=null;else if(m!==void 0)y[c[_]]=m;else if(p&&b===null)y[c[_]]=null;else continue;else y[c[_]]=p&&(w.t!=="n"||w.t==="n"&&d.rawNumbers!==!1)?b:qn(w,b,d);b!=null&&(v=!1)}}return{row:y,isempty:v}}function $o(e,a){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},i=0,s=1,c=[],f=0,d="",h={s:{r:0,c:0},e:{r:0,c:0}},m=a||{},p=m.range!=null?m.range:e["!ref"];switch(m.header===1?i=1:m.header==="A"?i=2:Array.isArray(m.header)?i=3:m.header==null&&(i=0),typeof p){case"string":h=St(p);break;case"number":h=St(e["!ref"]),h.s.r=p;break;default:h=p}i>0&&(s=0);var v=oa(h.s.r),y=[],_=[],w=0,b=0,T=Array.isArray(e),C=h.s.r,L=0,N={};T&&!e[C]&&(e[C]=[]);var j=m.skipHidden&&e["!cols"]||[],V=m.skipHidden&&e["!rows"]||[];for(L=h.s.c;L<=h.e.c;++L)if(!(j[L]||{}).hidden)switch(y[L]=Wt(L),t=T?e[C][L]:e[y[L]+v],i){case 1:c[L]=L-h.s.c;break;case 2:c[L]=y[L];break;case 3:c[L]=m.header[L-h.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),d=f=qn(t,null,m),b=N[f]||0,!b)N[f]=1;else{do d=f+"_"+b++;while(N[d]);N[f]=b,N[d]=1}c[L]=d}for(C=h.s.r+s;C<=h.e.r;++C)if(!(V[C]||{}).hidden){var M=OD(e,h,C,y,i,c,T,m);(M.isempty===!1||(i===1?m.blankrows!==!1:m.blankrows))&&(_[w++]=M.row)}return _.length=w,_}var _v=/"/g;function RD(e,a,t,i,s,c,f,d){for(var h=!0,m=[],p="",v=oa(t),y=a.s.c;y<=a.e.c;++y)if(i[y]){var _=d.dense?(e[t]||[])[y]:e[i[y]+v];if(_==null)p="";else if(_.v!=null){h=!1,p=""+(d.rawNumbers&&_.t=="n"?_.v:qn(_,null,d));for(var w=0,b=0;w!==p.length;++w)if((b=p.charCodeAt(w))===s||b===c||b===34||d.forceQuotes){p='"'+p.replace(_v,'""')+'"';break}p=="ID"&&(p='"ID"')}else _.f!=null&&!_.F?(h=!1,p="="+_.f,p.indexOf(",")>=0&&(p='"'+p.replace(_v,'""')+'"')):p="";m.push(p)}return d.blankrows===!1&&h?null:m.join(f)}function qh(e,a){var t=[],i=a??{};if(e==null||e["!ref"]==null)return"";var s=St(e["!ref"]),c=i.FS!==void 0?i.FS:",",f=c.charCodeAt(0),d=i.RS!==void 0?i.RS:`
`,h=d.charCodeAt(0),m=new RegExp((c=="|"?"\\|":c)+"+$"),p="",v=[];i.dense=Array.isArray(e);for(var y=i.skipHidden&&e["!cols"]||[],_=i.skipHidden&&e["!rows"]||[],w=s.s.c;w<=s.e.c;++w)(y[w]||{}).hidden||(v[w]=Wt(w));for(var b=0,T=s.s.r;T<=s.e.r;++T)(_[T]||{}).hidden||(p=RD(e,s,T,v,f,h,c,i),p!=null&&(i.strip&&(p=p.replace(m,"")),(p||i.blankrows!==!1)&&t.push((b++?d:"")+p)));return delete i.dense,t.join("")}function e_(e,a){a||(a={}),a.FS="	",a.RS=`
`;var t=qh(e,a);return t}function MD(e){var a="",t,i="";if(e==null||e["!ref"]==null)return[];var s=St(e["!ref"]),c="",f=[],d,h=[],m=Array.isArray(e);for(d=s.s.c;d<=s.e.c;++d)f[d]=Wt(d);for(var p=s.s.r;p<=s.e.r;++p)for(c=oa(p),d=s.s.c;d<=s.e.c;++d)if(a=f[d]+c,t=m?(e[p]||[])[d]:e[a],i="",t!==void 0){if(t.F!=null){if(a=t.F,!t.f)continue;i=t.f,a.indexOf(":")==-1&&(a=a+":"+a)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}h[h.length]=a+"="+i}return h}function t_(e,a,t){var i=t||{},s=+!i.skipHeader,c=e||{},f=0,d=0;if(c&&i.origin!=null)if(typeof i.origin=="number")f=i.origin;else{var h=typeof i.origin=="string"?qt(i.origin):i.origin;f=h.r,d=h.c}var m,p={s:{c:0,r:0},e:{c:d,r:f+a.length-1+s}};if(c["!ref"]){var v=St(c["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),f==-1&&(f=v.e.r+1,p.e.r=f+a.length-1+s)}else f==-1&&(f=0,p.e.r=a.length-1+s);var y=i.header||[],_=0;a.forEach(function(b,T){ra(b).forEach(function(C){(_=y.indexOf(C))==-1&&(y[_=y.length]=C);var L=b[C],N="z",j="",V=$e({c:d+_,r:f+T+s});m=Qc(c,V),L&&typeof L=="object"&&!(L instanceof Date)?c[V]=L:(typeof L=="number"?N="n":typeof L=="boolean"?N="b":typeof L=="string"?N="s":L instanceof Date?(N="d",i.cellDates||(N="n",L=wa(L)),j=i.dateNF||Ze[14]):L===null&&i.nullError&&(N="e",L=0),m?(m.t=N,m.v=L,delete m.w,delete m.R,j&&(m.z=j)):c[V]=m={t:N,v:L},j&&(m.z=j))})}),p.e.c=Math.max(p.e.c,d+y.length-1);var w=oa(f);if(s)for(_=0;_<y.length;++_)c[Wt(_+d)+w]={t:"s",v:y[_]};return c["!ref"]=nt(p),c}function LD(e,a){return t_(null,e,a)}function Qc(e,a,t){if(typeof a=="string"){if(Array.isArray(e)){var i=qt(a);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[a]||(e[a]={t:"z"})}return typeof a!="number"?Qc(e,$e(a)):Qc(e,$e({r:a,c:t||0}))}function ID(e,a){if(typeof a=="number"){if(a>=0&&e.SheetNames.length>a)return a;throw new Error("Cannot find sheet # "+a)}else if(typeof a=="string"){var t=e.SheetNames.indexOf(a);if(t>-1)return t;throw new Error("Cannot find sheet name |"+a+"|")}else throw new Error("Cannot find sheet |"+a+"|")}function Kh(){return{SheetNames:[],Sheets:{}}}function Zh(e,a,t,i){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&e.SheetNames.indexOf(t)>=0){var c=t.match(/(^.*?)(\d+)$/);s=c&&+c[2]||0;var f=c&&c[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=f+s)!=-1;++s);}if(By(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=a,t}function BD(e,a,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var i=ID(e,a);switch(e.Workbook.Sheets[i]||(e.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[i].Hidden=t}function UD(e,a){return e.z=a,e}function a_(e,a,t){return a?(e.l={Target:a},t&&(e.l.Tooltip=t)):delete e.l,e}function zD(e,a,t){return a_(e,"#"+a,t)}function PD(e,a,t){e.c||(e.c=[]),e.c.push({t:a,a:t||"SheetJS"})}function HD(e,a,t,i){for(var s=typeof a!="string"?a:St(a),c=typeof a=="string"?a:nt(a),f=s.s.r;f<=s.e.r;++f)for(var d=s.s.c;d<=s.e.c;++d){var h=Qc(e,f,d);h.t="n",h.F=c,delete h.v,f==s.s.r&&d==s.s.c&&(h.f=t,i&&(h.D=!0))}return e}var Dc={encode_col:Wt,encode_row:oa,encode_cell:$e,encode_range:nt,decode_col:Th,decode_row:Eh,split_cell:eE,decode_cell:qt,decode_range:dr,format_cell:qn,sheet_add_aoa:C2,sheet_add_json:t_,sheet_add_dom:Yy,aoa_to_sheet:Sl,json_to_sheet:LD,table_to_sheet:Wy,table_to_book:Z8,sheet_to_csv:qh,sheet_to_txt:e_,sheet_to_json:$o,sheet_to_html:Xy,sheet_to_formulae:MD,sheet_to_row_object_array:$o,sheet_get_cell:Qc,book_new:Kh,book_append_sheet:Zh,book_set_sheet_visibility:BD,cell_set_number_format:UD,cell_set_hyperlink:a_,cell_set_internal_link:zD,cell_add_comment:PD,sheet_set_array_formula:HD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Gd={firstName:"",lastName:"",email:"",trip:"",group:"",status:"To Invite"},ol=({label:e,children:a,className:t,required:i})=>u.jsxs("div",{className:t,children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e," ",i&&u.jsx("span",{className:"text-red-600",children:"*"})]}),a]}),Tc=Ia.forwardRef((e,a)=>u.jsx("input",{ref:a,...e,className:`w-full px-3 py-2 bg-white border rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""} ${"aria-invalid"in e&&e["aria-invalid"]==="true"?"border-red-500":"border-gray-300"}`})),VD=e=>u.jsx("select",{...e,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}),GD=({isOpen:e,onClose:a,onSave:t,participantToEdit:i,defaultTrip:s,existingParticipants:c})=>{const[f,d]=ce.useState(Gd),[h,m]=ce.useState({}),[p,v]=ce.useState(!1),[y,_]=ce.useState(null),[w,b]=ce.useState(!1),T=ce.useRef(null),C=ce.useRef(""),L=Oi();if(ce.useEffect(()=>{if(e)if(i){const k=i.name;if(k&&!("firstName"in i)){const W=String(k).trim().split(/\s+/),K=W.length>1?W.pop():"",J=W.join(" ");d({...i,firstName:J,lastName:K})}else d(i)}else d({...Gd,trip:s??""})},[i,e,s]),ce.useEffect(()=>{if(e){setTimeout(()=>{try{T.current&&T.current.focus()}catch{}},50);try{C.current=JSON.stringify({firstName:(i?i.firstName||"":(i==null?void 0:i.name)||"").toString().trim(),lastName:(i&&i.lastName||"").toString().trim(),email:((i==null?void 0:i.email)||"").toString().trim(),trip:((i==null?void 0:i.trip)||s||"").toString().trim(),group:((i==null?void 0:i.group)||"").toString().trim(),status:(i==null?void 0:i.status)||Gd.status})}catch{C.current=""}}},[e,i,s]),ce.useEffect(()=>{const k=W=>{W.key==="Escape"&&e&&(W.preventDefault(),M())};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[e,f]),!e)return null;const N=k=>{const{name:W,value:K}=k.target;d(J=>({...J,[W]:K}))},j=async()=>{const k={...f};(!k.trip||k.trip.length===0)&&s&&(k.trip=s),k.firstName=(k.firstName||k.name||"").toString().trim(),k.lastName=(k.lastName||"").toString().trim(),k.email=(k.email||"").toString().trim(),k.trip=(k.trip||"").toString().trim(),k.group=(k.group||"").toString().trim();const W={};if((!k.firstName||k.firstName.length<1)&&(W.firstName="Nome  richiesto"),(!k.lastName||k.lastName.length<1)&&(W.lastName="Cognome  richiesto"),(!k.email||!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(k.email))&&(W.email="Valid email is required"),(!k.trip||k.trip.length===0)&&(W.trip="Trip is required"),m(W),_(null),Object.keys(W).length>0)return;if((c??[]).filter(Z=>String((Z.trip||"").toString().trim())===String((k.trip||"").toString().trim())).find(Z=>(Z.email||"").toLowerCase()===(k.email||"").toLowerCase()&&String(Z.id??Z._id??"")!==String(k.id??k._id??""))){const Z="Email gi presente per questo viaggio";m(Q=>({...Q,email:Z}));try{L.showToast(Z,"error")}catch{}return}try{v(!0);const Z=t(k);Z&&typeof Z.then=="function"&&await Z,L.showToast("Partecipante salvato","success");try{C.current=JSON.stringify({firstName:k.firstName,lastName:k.lastName,email:k.email,trip:k.trip,group:k.group,status:k.status})}catch{}a()}catch(Z){_("Errore durante il salvataggio. Riprovare.");try{L.showToast("Errore salvataggio partecipante","error")}catch{}console.error("ParticipantModal save error",Z)}finally{v(!1)}},V=()=>{try{return JSON.stringify({firstName:(f.firstName||"").toString().trim(),lastName:(f.lastName||"").toString().trim(),email:(f.email||"").toString().trim(),trip:(f.trip||"").toString().trim(),group:(f.group||"").toString().trim(),status:f.status})!==C.current}catch{return!1}},M=()=>{p||(V()?b(!0):a())};return u.jsxs("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300 animate-fade-in",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale",children:[u.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:i?"Modifica partecipante":"Aggiungi partecipante"}),u.jsx("button",{onClick:M,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Chiudi",children:u.jsx(yn,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto space-y-4",children:[Object.keys(h).length>0&&u.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded text-sm",children:["Correggi i seguenti errori:",u.jsx("ul",{className:"mt-1 list-disc list-inside",children:Object.entries(h).map(([k,W])=>u.jsx("li",{children:W},k))})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs(ol,{label:"Nome",required:!0,children:[u.jsx(Tc,{ref:T,"data-testid":void 0,name:"firstName",value:f.firstName||"",onChange:N,placeholder:"es. Marco",disabled:p,"aria-invalid":h.firstName?"true":"false",required:!0,"aria-required":!0}),h.firstName&&u.jsx("div",{className:"text-xs text-red-600 mt-1",children:h.firstName})]}),u.jsxs(ol,{label:"Cognome",required:!0,children:[u.jsx(Tc,{"data-testid":void 0,name:"lastName",value:f.lastName||"",onChange:N,placeholder:"es. Rossi",disabled:p,"aria-invalid":h.lastName?"true":"false",required:!0,"aria-required":!0}),h.lastName&&u.jsx("div",{className:"text-xs text-red-600 mt-1",children:h.lastName})]})]}),u.jsxs(ol,{label:"Email",required:!0,children:[u.jsx(Tc,{"data-testid":void 0,name:"email",value:f.email,onChange:N,placeholder:"m.rossi@example.com",disabled:p,"aria-invalid":h.email?"true":"false",required:!0,"aria-required":!0}),h.email&&u.jsx("div",{className:"text-xs text-red-600 mt-1",children:h.email})]}),!s&&u.jsxs(ol,{label:"Viaggio",required:!0,children:[u.jsx(Tc,{"data-testid":void 0,name:"trip",value:f.trip,onChange:N,placeholder:"Nome del viaggio",disabled:p,"aria-invalid":h.trip?"true":"false",required:!0,"aria-required":!0}),h.trip&&u.jsx("div",{className:"text-xs text-red-600 mt-1",children:h.trip})]}),u.jsxs(ol,{label:"Group",children:[u.jsx(Tc,{"data-testid":void 0,name:"group",value:f.group,onChange:N,placeholder:"Nome del gruppo",disabled:p,"aria-invalid":h.group?"true":"false"}),h.group&&u.jsx("div",{className:"text-xs text-red-600 mt-1",children:h.group})]}),u.jsx(ol,{label:"Status",children:u.jsxs(VD,{"data-testid":void 0,name:"status",value:f.status,onChange:N,children:[u.jsx("option",{value:"Registered",children:"Registrato"}),u.jsx("option",{value:"Invited",children:"Invitato"}),u.jsx("option",{value:"To Invite",children:"Da invitare"})]})})]}),u.jsxs("footer",{className:"flex justify-end items-center space-x-4 p-5 bg-gray-50 border-t border-gray-200 rounded-b-xl",children:[u.jsx("button",{onClick:M,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Annulla"}),u.jsxs("div",{className:"flex items-center",children:[y&&u.jsx("div",{className:"text-sm text-red-600 mr-4",children:y}),u.jsx("button",{"data-testid":void 0,onClick:j,disabled:p,className:`bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg ${p?"opacity-70 cursor-not-allowed":"hover:bg-blue-700"} transition-colors`,children:p?"Salvataggio...":"Salva partecipante"})]})]})]}),u.jsx(_n,{open:w,title:"Ci sono modifiche non salvate",message:"Hai modifiche non salvate. Vuoi davvero chiudere senza salvare?",confirmLabel:"Chiudi senza salvare",cancelLabel:"Continua a modificare",onConfirm:()=>{b(!1),a()},onCancel:()=>b(!1)}),u.jsx("style",{children:"@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } } @keyframes fadeInScale { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } } .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; } .animate-fade-in-scale { animation: fadeInScale 0.2s ease-out forwards; }"})]})},XD=[],YD=e=>{switch(e){case"Registered":return"bg-green-100 text-green-800";case"Invited":return"bg-blue-100 text-blue-800";case"To Invite":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},WD=({tripName:e,participants:a,onBack:t,onSendReminder:i,onSendInvite:s,onSaveParticipant:c,onDeleteParticipant:f})=>{const d=ce.useRef(null),h=Oi(),m=A=>{const E=A.target.files&&A.target.files[0];if(!E)return;console.log("[ManageParticipants] import triggered",E.name,E.size);try{h.showToast("Import avviato","info")}catch{}const O=new FileReader;O.onload=B=>{var le;const z=(le=B.target)==null?void 0:le.result;try{let ye;z instanceof ArrayBuffer?ye=_l(z,{type:"array"}):ye=_l(z,{type:"binary"});const Ne=ye.Sheets[ye.SheetNames[0]],Te=Dc.sheet_to_json(Ne,{defval:""});let De=0;Te.forEach(Ve=>{const q=Ve.name||Ve.Name||Ve.Nome||"",ct=Ve.email||Ve.Email||"",We=Ve.group||Ve.Group||Ve.Gruppo||"";if(!q||!ct)return;De+=1;const tt=String(q).trim().split(/\s+/),qe=tt.length>1?tt.pop():"",Re=tt.join(" "),vt={id:Date.now()+Math.floor(Math.random()*1e4),name:q,firstName:Re,lastName:qe,email:ct,trip:e,group:We,status:"To Invite"};try{c&&c(vt)}catch(Bt){console.warn("onSaveParticipant error",Bt)}});try{h.showToast(`${De} partecipanti importati`,"success")}catch{}}catch(ye){console.error("[ManageParticipants] import error",ye);try{h.showToast("Errore import file","error")}catch{}alert("Errore durante l'import dei partecipanti. Controlla il formato.")}try{A.currentTarget&&(A.currentTarget.value="")}catch{}},O.onerror=B=>{console.error("[ManageParticipants] file read error",B);try{h&&h.showToast("Errore lettura file","error")}catch{}try{A.currentTarget&&(A.currentTarget.value="")}catch{}},O.readAsArrayBuffer(E)},[p,v]=ce.useState(""),[y,_]=ce.useState("all"),[w,b]=ce.useState([]),[T,C]=ce.useState(!1),[L,N]=ce.useState(null),[j,V]=ce.useState(!1),[M,k]=ce.useState(null),[W,K]=ce.useState({key:"name",direction:"ascending"}),J=ce.useRef(null),Z=ce.useMemo(()=>{let A=[...a].filter(E=>y==="all"||E.status===y).filter(E=>((E.firstName||E.name)+" "+(E.lastName||"")).trim().toLowerCase().includes(p.toLowerCase())||E.email.toLowerCase().includes(p.toLowerCase())||E.group.toLowerCase().includes(p.toLowerCase()));return W!==null&&A.sort((E,O)=>{if(W.key==="name"){const le=((E.firstName||E.name)+" "+(E.lastName||"")).trim(),ye=((O.firstName||O.name)+" "+(O.lastName||"")).trim();return le<ye?W.direction==="ascending"?-1:1:le>ye?W.direction==="ascending"?1:-1:0}const B=E[W.key],z=O[W.key];return B<z?W.direction==="ascending"?-1:1:B>z?W.direction==="ascending"?1:-1:0}),A},[a,p,y,W]);ce.useEffect(()=>{if(J.current){const A=Z.length,E=w.length;J.current.checked=E===A&&A>0,J.current.indeterminate=E>0&&E<A}},[w,Z]);const Q=A=>{let E="ascending";W&&W.key===A&&W.direction==="ascending"&&(E="descending"),K({key:A,direction:E})},re=A=>!W||W.key!==A?u.jsx("span",{className:"inline-block w-4 h-4"}):W.direction==="ascending"?u.jsx(Mv,{className:"w-4 h-4 inline-block ml-1"}):u.jsx(Lv,{className:"w-4 h-4 inline-block ml-1"}),ue=A=>{A.target.checked?b(Z.map(E=>String(E.id??E._id??""))):b([])},ve=A=>{const E=String(A);b(O=>O.includes(E)?O.filter(B=>B!==E):[...O,E])},ee=()=>{const E=[["ID","Nome","Cognome","Email","Trip","Group","Status"].join(",")];Z.forEach(le=>{const ye=(le.firstName||le.name||"").toString(),Ne=(le.lastName||"").toString(),Te=[le.id,ye,Ne,le.email,le.trip,le.group,le.status].map(De=>`"${String(De||"")}"`).join(",");E.push(Te)});const O=E.join(`
`),B=new Blob([O],{type:"text/csv;charset=utf-8;"}),z=document.createElement("a");z.href=URL.createObjectURL(B),z.download=`${e.replace(/\s+/g,"_")}_participants.csv`,z.click()},G=ce.useMemo(()=>{const A=a.filter(B=>w.includes(String(B.id??B._id??"")));return A.length===0?null:A.some(B=>B.status==="To Invite")?{type:"invite",label:`Send Invite (${w.length})`,bg:"bg-blue-600 hover:bg-blue-700"}:A.some(B=>B.status==="Invited")?{type:"remind",label:`Send Reminder (${w.length})`,bg:"bg-blue-600 hover:bg-blue-700"}:null},[w,a]),ae=()=>{if(G){if(G.type==="invite")s(e,w.length),b([]);else if(G.type==="remind"){const E=a.filter(O=>w.includes(String(O.id??O._id??""))).filter(O=>O.status!=="Registered");if(E.length===0){console.log("[ManageParticipants] no participants to remind"),h.showToast("All selected participants are already registered.","info");return}i(E.length,()=>b([]))}}},R=()=>{N(null),C(!0)},se=A=>{N(A),C(!0)};return u.jsxs("div",{className:"animate-fade-in",children:[u.jsx(GD,{isOpen:T,onClose:()=>C(!1),participantToEdit:L,defaultTrip:e,existingParticipants:a,onSave:A=>c?c(A):Promise.resolve()}),u.jsxs("div",{className:"flex items-center mb-6",children:[u.jsx("button",{onClick:t,className:"mr-4 p-2 rounded-full hover:bg-gray-200 transition-colors text-gray-600","aria-label":"Torna indietro",children:u.jsx(us,{className:"w-6 h-6 transform rotate-90"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e}),u.jsx("p",{className:"text-sm text-gray-500",children:"Elenco partecipanti"})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[u.jsx("div",{className:"p-6 border-b border-gray-200 bg-gray-50/50",children:u.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-[280px]",children:[u.jsxs("div",{className:"relative flex-1 max-w-md",children:[u.jsx(Fi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Cerca partecipanti...",value:p,onChange:A=>v(A.target.value),className:"pl-9 pr-4 py-2 w-full border rounded-lg bg-white text-sm text-gray-900 placeholder-gray-500 border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]}),u.jsxs("div",{className:"relative w-44",children:[u.jsxs("select",{value:y,onChange:A=>_(A.target.value),className:"w-full border border-gray-300 rounded-lg py-2 pl-3 pr-8 text-sm text-gray-700 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition appearance-none",children:[u.jsx("option",{value:"all",children:"Tutti gli stati"}),u.jsx("option",{value:"Registered",children:"Registrato"}),u.jsx("option",{value:"Invited",children:"Invitato"}),u.jsx("option",{value:"To Invite",children:"Da invitare"})]}),u.jsx(us,{className:"w-4 h-4 text-gray-400 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[w.length>0&&G&&u.jsx("button",{"data-testid":void 0,onClick:ae,className:`${G.bg} text-white text-sm font-semibold px-4 py-2 rounded-lg transition-colors shadow-sm`,children:G.label}),u.jsxs("button",{"data-testid":void 0,onClick:R,className:"bg-blue-600 text-white text-sm font-semibold px-3 py-2 rounded-lg hover:bg-blue-700 transition-colors shadow-sm flex items-center",children:[u.jsx(fs,{className:"w-4 h-4 mr-2"})," Aggiungi partecipante"]}),u.jsx("input",{id:"participants-file-input",ref:d,onChange:m,accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",type:"file",className:"hidden"}),u.jsxs("label",{htmlFor:"participants-file-input",onClick:()=>{var A;return(A=d.current)==null?void 0:A.click()},className:"bg-white text-gray-700 text-sm font-semibold px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors border border-gray-300 flex items-center shadow-sm cursor-pointer",children:[u.jsx(Rw,{className:"w-4 h-4 mr-2"})," Importa"]}),u.jsxs("button",{onClick:ee,className:"bg-white text-gray-700 text-sm font-semibold px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors border border-gray-300 flex items-center shadow-sm",children:[u.jsx(Mw,{className:"w-4 h-4 mr-2"})," Esporta"]})]})]})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[u.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 border-b border-gray-200",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-4 w-10",children:u.jsx("input",{type:"checkbox",ref:J,onChange:ue,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:u.jsxs("button",{onClick:()=>Q("name"),className:"flex items-center hover:text-gray-900 font-bold",children:["Participant ",re("name")]})}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:u.jsxs("button",{onClick:()=>Q("group"),className:"flex items-center hover:text-gray-900 font-bold",children:["Group ",re("group")]})}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:u.jsxs("button",{onClick:()=>Q("status"),className:"flex items-center hover:text-gray-900 font-bold",children:["Status ",re("status")]})}),u.jsx("th",{scope:"col",className:"px-6 py-4 text-right font-bold",children:"ACTIONS"})]})}),u.jsx("tbody",{children:Z.length>0?Z.map(A=>u.jsxs("tr",{className:`bg-white border-b last:border-b-0 hover:bg-gray-50 transition-colors ${w.includes(String(A.id??A._id??""))?"bg-blue-50":""}`,children:[u.jsx("td",{className:"px-6 py-4",children:u.jsx("input",{type:"checkbox",checked:w.includes(String(A.id??A._id??"")),onChange:()=>ve(A.id??A._id??""),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),u.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-9 h-9 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-bold mr-3 text-sm",children:((A.firstName||A.name||A.lastName||"").charAt(0)||"").toUpperCase()}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-bold text-gray-900",children:((A.firstName||A.name)+" "+(A.lastName||"")).trim()}),u.jsx("div",{className:"text-xs text-gray-500 font-normal",children:A.email})]})]})}),u.jsx("td",{className:"px-6 py-4 text-gray-600",children:A.group}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 text-xs font-medium rounded-full ${YD(A.status)}`,children:A.status})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[u.jsx("button",{onClick:()=>se(A),className:"p-1.5 text-gray-400 hover:text-gray-600 rounded-full transition-colors hover:bg-gray-100","aria-label":"Edit participant",children:u.jsx(vn,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>{k(A),V(!0)},className:"p-1.5 text-gray-400 hover:text-red-600 rounded-full transition-colors hover:bg-red-50","aria-label":"Delete participant",children:u.jsx(cn,{className:"w-4 h-4"})})]})})]},String(A.id??A._id??""))):u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:"No participants found matching your search for this trip."})})})]})}),u.jsx(_n,{open:j,title:"Eliminare partecipante",message:"Eliminare questo partecipante?",confirmLabel:"Elimina",cancelLabel:"Annulla",variant:"danger",onCancel:()=>{V(!1),k(null)},onConfirm:()=>{M&&f&&f(String(M.id??M._id??"")),V(!1),k(null)}})]})]})},qD=({onSelectTrip:e,participants:a})=>{const t=ce.useMemo(()=>{const i={};return a.forEach(s=>{i[s.trip]||(i[s.trip]={name:s.trip,totalParticipants:0,registeredCount:0,groups:0}),i[s.trip].totalParticipants+=1,s.status==="Registered"&&(i[s.trip].registeredCount+=1)}),Object.keys(i).forEach(s=>{const c=new Set(a.filter(f=>f.trip===s).map(f=>f.group));i[s].groups=c.size}),Object.values(i)},[a]);return u.jsxs("div",{className:"animate-fade-in",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Manage Participants"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Select a trip to view and manage its participants."})]}),u.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden border border-gray-200",children:u.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[u.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 border-b border-gray-200",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Trip Name"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Total Participants"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Registration Status"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Groups"}),u.jsx("th",{scope:"col",className:"px-6 py-4 text-right",children:"Actions"})]})}),u.jsx("tbody",{children:t.map(i=>u.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>e(i.name),children:[u.jsx("th",{scope:"row",className:"px-6 py-5 font-medium text-gray-900 whitespace-nowrap text-base",children:i.name}),u.jsx("td",{className:"px-6 py-5",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(Fv,{className:"w-4 h-4 mr-2 text-gray-400"}),u.jsx("span",{className:"font-semibold text-gray-700",children:i.totalParticipants})]})}),u.jsx("td",{className:"px-6 py-5",children:u.jsxs("div",{className:"w-full max-w-xs",children:[u.jsxs("div",{className:"flex justify-between mb-1",children:[u.jsxs("span",{className:"text-xs font-medium text-blue-700",children:[i.registeredCount," Registered"]}),u.jsxs("span",{className:"text-xs font-medium text-gray-500",children:[Math.round(i.registeredCount/i.totalParticipants*100),"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${i.registeredCount/i.totalParticipants*100}%`}})})]})}),u.jsx("td",{className:"px-6 py-5",children:u.jsxs("span",{className:"bg-gray-100 text-gray-700 py-1 px-3 rounded-full text-xs font-medium",children:[i.groups," Groups"]})}),u.jsx("td",{className:"px-6 py-5 text-right",children:u.jsx("button",{onClick:s=>{s.stopPropagation(),e(i.name)},className:"text-blue-600 hover:text-blue-900 font-medium text-sm px-3 py-1.5 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:"Manage Participants"})})]},i.name))})]})})]})},KD=({participants:e=XD,onSendReminder:a,onSendInvite:t,onSaveParticipant:i,onDeleteParticipant:s})=>{const[c,f]=ce.useState(null),d=p=>{f(p)},h=()=>{f(null)},m=ce.useMemo(()=>c?e.filter(p=>p.trip===c):[],[c,e]);return u.jsx("div",{className:"p-8 bg-gray-50 min-h-full",children:c?u.jsx(WD,{tripName:c,participants:m,onBack:h,onSendReminder:a,onSendInvite:t,onSaveParticipant:i,onDeleteParticipant:s}):u.jsx(qD,{onSelectTrip:d,participants:e})})},ZD=["Tour Leader","Assistenza Aeroportuale","Assistenza Hotel","Coordinatore"],bv={firstName:"",lastName:"",category:"Tour Leader",phone:"",email:"",notes:""},fl=({label:e,children:a,className:t})=>u.jsxs("div",{className:t,children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),a]}),Oo=e=>u.jsx("input",{...e,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}),$D=e=>u.jsx("textarea",{...e,rows:3,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}),QD=e=>u.jsx("select",{...e,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}),JD=({isOpen:e,onClose:a,onSave:t,contactToEdit:i})=>{const[s,c]=ce.useState(bv);if(ce.useEffect(()=>{if(e)if(i){const m=i.name;if(m&&!("firstName"in i)){const p=String(m).trim().split(/\s+/),v=p.length>1?p.pop():"",y=p.join(" ");c({...i,firstName:y,lastName:v})}else c(i)}else c(bv)},[i,e]),!e)return null;const f=m=>{const{name:p,value:v}=m.target;c(y=>({...y,[p]:v}))},d=(()=>{try{return Oi()}catch{return null}})(),h=()=>{const m=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(s.email&&!m.test(s.email)){try{d&&d.showToast("Email non valida","error")}catch{}return}if(s.phone&&s.phone.replace(/\D/g,"").length<6){try{d&&d.showToast("Numero di telefono non valido","error")}catch{}return}t(s,i==null?void 0:i.id)};return u.jsxs("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300 animate-fade-in",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale",children:[u.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:i?"Edit Contact":"Add New Contact"}),u.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(yn,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(fl,{label:"Nome",children:u.jsx(Oo,{name:"firstName",value:s.firstName||"",onChange:f,placeholder:"e.g. Mario"})}),u.jsx(fl,{label:"Cognome",children:u.jsx(Oo,{name:"lastName",value:s.lastName||"",onChange:f,placeholder:"e.g. Rossi"})})]}),u.jsx(fl,{label:"Categoria",children:u.jsx(QD,{name:"category",value:s.category,onChange:f,children:ZD.map(m=>u.jsx("option",{value:m,children:m},m))})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(fl,{label:"Telefono",children:u.jsx(Oo,{name:"phone",value:s.phone,onChange:f,placeholder:"+39 123 456789"})}),u.jsx(fl,{label:"Email",children:u.jsx(Oo,{name:"email",type:"email",value:s.email,onChange:f,placeholder:"m.rossi@example.com"})})]}),u.jsx(fl,{label:"Note",children:u.jsx($D,{name:"notes",value:s.notes,onChange:f,placeholder:"Referente h24, etc."})})]}),u.jsxs("footer",{className:"flex justify-end items-center space-x-4 p-5 bg-gray-50 border-t border-gray-200 rounded-b-xl",children:[u.jsx("button",{onClick:a,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Cancel"}),u.jsx("button",{onClick:h,className:"bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Save Contact"})]})]}),u.jsx("style",{children:"@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } } @keyframes fadeInScale { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } } .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; } .animate-fade-in-scale { animation: fadeInScale 0.2s ease-out forwards; }"})]})},ej=({contacts:e,setContacts:a})=>{const[t,i]=ce.useState(!1),[s,c]=ce.useState(null),[f,d]=ce.useState(""),h=J=>J.slice().sort((Z,Q)=>{const re=`${Z.firstName||""} ${Z.lastName||""}`.trim().toLowerCase(),ue=`${Q.firstName||""} ${Q.lastName||""}`.trim().toLowerCase();return re<ue?-1:re>ue?1:0}),m=J=>{const Z=J.name||"",Q=String(Z).trim().split(/\s+/),re=Q.length>1?Q.pop():"",ue=Q.join(" ");return{id:J.id||J._id||Date.now(),firstName:ue||"",lastName:re||"",category:J.category||"Tour Leader",phone:J.phone||"",email:J.email||"",notes:J.notes||""}},p=()=>{c(null),i(!0)},v=J=>{(async()=>{try{const Z=await fetch(`/api/contacts/${J.id}`);if(!Z.ok)throw new Error("not-found");const Q=await Z.json(),re=m(Q);c(re)}catch(Z){console.warn("Could not fetch contact for edit",Z),c(J)}finally{i(!0)}})()},y=()=>{i(!1),c(null)},[_,w]=ce.useState(!1),[b,T]=ce.useState(null),C=J=>{T(J),w(!0)},L=async()=>{if(b!==null){try{String(b).length>8&&await fetch(`/api/contacts/${b}`,{method:"DELETE"})}catch(J){console.warn("Delete request failed",J)}a(J=>J.filter(Z=>Z.id!==b));try{k&&k.showToast("Contatto eliminato","success")}catch{}}w(!1),T(null)},N=()=>{w(!1),T(null)},j=async(J,Z)=>{try{if(Z!==void 0&&String(Z).length>8){const Q=await fetch(`/api/contacts/${Z}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)});if(!Q.ok)throw new Error("update-failed");const re=await Q.json(),ue=m(re);a(ve=>ve.map(ee=>ee.id===Z?ue:ee));try{k&&k.showToast("Contatto aggiornato","success")}catch{}}else if(Z!==void 0){const Q=await fetch("/api/contacts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)});if(Q.ok){const re=await Q.json(),ue=m(re);a(ve=>[ue,...ve.filter(ee=>ee.id!==Z)]);try{k&&k.showToast("Contatto creato","success")}catch{}}else a(re=>re.map(ue=>ue.id===Z?{...ue,...J}:ue))}else{const Q=await fetch("/api/contacts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)});if(Q.ok){const re=await Q.json(),ue=m(re);a(ve=>[ue,...ve]);try{k&&k.showToast("Contatto creato","success")}catch{}}else{const re={id:Date.now(),...J};a(ue=>[re,...ue])}}y()}catch(Q){console.error("Save contact error",Q);try{k&&k.showToast("Errore durante il salvataggio del contatto","error")}catch{}}},V=e.filter(J=>`${(J.firstName||"").toString()} ${(J.lastName||"").toString()}`.trim().toLowerCase().includes(f.toLowerCase())||(J.email||"").toLowerCase().includes(f.toLowerCase())||(J.category||"").toLowerCase().includes(f.toLowerCase())),M=ce.useRef(null),k=(()=>{try{return Oi()}catch{return null}})();Ia.useEffect(()=>{(async()=>{try{const J=await fetch("/api/contacts");if(!J.ok)throw new Error("no-contacts");const Q=(await J.json()||[]).map(re=>({id:re.id,firstName:(re.name||"").split(" ")[0]||"",lastName:(re.name||"").split(" ").slice(1).join(" ")||"",category:re.category||"Tour Leader",phone:re.phone||"",email:re.email||"",notes:re.notes||""}));a(Q),a(h(Q))}catch(J){console.warn("Could not load contacts",J)}})()},[]);const W=J=>{const Z=J.target.files&&J.target.files[0];if(!Z)return;console.log("ManageContacts: handleFileImport triggered",Z&&Z.name,"size",Z&&Z.size);try{k&&k.showToast("Import avviato","info")}catch{}const Q=new FileReader;Q.onload=re=>{var ve;const ue=(ve=re.target)==null?void 0:ve.result;try{let ee;ue instanceof ArrayBuffer?ee=_l(ue,{type:"array"}):ee=_l(ue,{type:"binary"});const G=ee.Sheets[ee.SheetNames[0]],ae=Dc.sheet_to_json(G,{defval:""}),R=ae.map(E=>{const O=E.firstName||E.FirstName||E["First Name"]||E.Nome||"",B=E.lastName||E.LastName||E["Last Name"]||E.Cognome||"";let z=O||"",le=B||"";if(!z&&!le){const ye=E.name||E.Name||E.Nome||E.nome||"",Ne=String(ye).trim().split(/\s+/);le=Ne.length>1?Ne.pop():"",z=Ne.join(" ")}return{firstName:(z||"").toString(),lastName:(le||"").toString(),category:E.category||E.Category||E.Categoria||"Tour Leader",phone:E.phone||E.Phone||E.Telefono||"",email:E.email||E.Email||"",notes:E.notes||E.Notes||E.Note||""}}),se=[],A=new Set(e.map(E=>(E.email||"").toLowerCase()));if(R.forEach(E=>{if(!`${(E.firstName||"").toString()} ${(E.lastName||"").toString()}`.trim()||!E.email)return;const B=(E.email||"").toLowerCase();A.has(B)||(A.add(B),se.push({id:Date.now()+Math.floor(Math.random()*1e4),...E}))}),se.length>0){a(E=>[...se,...E]),a(E=>h([...se,...E])),a(E=>h(E.map(O=>O.id===id?{...O,...ae}:O))),a(E=>h([{id:ae.id,...ae},...E.filter(O=>O.id!==id)])),a(E=>h([{id:ae.id,...ae},...E])),a(E=>h(E.filter(O=>O.id!==b)));try{k&&k.showToast(`${se.length} contatti importati`,"success")}catch{}}try{J.currentTarget&&(J.currentTarget.value="")}catch(E){console.warn("Could not clear input in onload",E)}}catch(ee){console.error("Import error",ee);try{k&&k.showToast("Errore durante l'import del file","error")}catch{}alert("Errore durante l'import del file. Controlla il formato.");try{J.currentTarget&&(J.currentTarget.value="")}catch(G){console.warn("Could not clear input in error handler",G)}}},Q.onerror=re=>{console.error("File read error",re);try{k&&k.showToast("Errore lettura file","error")}catch{}alert("Errore durante la lettura del file.");try{J.currentTarget&&(J.currentTarget.value="")}catch(ue){console.warn("Could not clear input in onerror",ue)}},Q.readAsArrayBuffer(Z)},K=()=>{try{let J=function(ae){const R=new ArrayBuffer(ae.length),se=new Uint8Array(R);for(let A=0;A!=ae.length;++A)se[A]=ae.charCodeAt(A)&255;return R};const Z=V.map(ae=>({Nome:ae.firstName||ae.name||"",Cognome:ae.lastName||"",Categoria:ae.category||"",Telefono:ae.phone||"",Email:ae.email||"",Note:ae.notes||""})),Q=Dc.json_to_sheet(Z),re=Dc.book_new();Dc.book_append_sheet(re,Q,"Contacts");const ue=Jy(re,{bookType:"xlsx",type:"binary"}),ve=new Blob([J(ue)],{type:"application/octet-stream"}),ee=URL.createObjectURL(ve),G=document.createElement("a");G.href=ee,G.download=`contacts_export_${Date.now()}.xlsx`,G.click(),URL.revokeObjectURL(ee)}catch(J){console.error("Export error",J);try{k&&k.showToast("Errore durante l'export","error")}catch{}alert("Errore durante l'export.")}};return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-8",children:[u.jsxs("header",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Manage Contacts"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Manage emergency and support contacts for trips."})]}),u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Fi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search contacts...",value:f,onChange:J=>d(J.target.value),className:"pl-10 pr-4 py-2 w-72 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{id:"contacts-file-input",ref:M,onChange:W,accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",type:"file",className:"hidden"}),u.jsx("label",{htmlFor:"contacts-file-input",onClick:()=>{var J;return(J=M.current)==null?void 0:J.click()},className:"bg-white border border-gray-300 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition cursor-pointer",children:"Import"}),u.jsx("button",{onClick:K,className:"bg-white border border-gray-300 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition",children:"Export"}),u.jsx("button",{onClick:p,className:"bg-blue-500 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Add Contact"})]})]})}),u.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:u.jsxs("div",{className:"overflow-x-auto",children:[u.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[u.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Nome Contatto"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Categoria"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Telefono"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Email"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Note"}),u.jsx("th",{scope:"col",className:"px-6 py-4 text-right",children:"Actions"})]})}),u.jsx("tbody",{children:V.map(J=>u.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[u.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap",children:`${(J.firstName||J.name||"").toString()} ${(J.lastName||"").toString()}`.trim()}),u.jsx("td",{className:"px-6 py-4",children:J.category}),u.jsx("td",{className:"px-6 py-4",children:J.phone}),u.jsx("td",{className:"px-6 py-4",children:J.email}),u.jsx("td",{className:"px-6 py-4 max-w-xs truncate",children:J.notes}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[u.jsx("button",{onClick:()=>v(J),className:"p-1.5 text-gray-500 hover:text-gray-700 rounded-md transition-colors hover:bg-gray-100","aria-label":"Edit contact",children:u.jsx(vn,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>C(J.id),className:"p-1.5 text-red-500 hover:text-red-700 rounded-md transition-colors hover:bg-red-100","aria-label":"Delete contact",children:u.jsx(cn,{className:"w-4 h-4"})})]})})]},J.id))})]}),V.length===0&&u.jsxs("div",{className:"text-center py-12",children:[u.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"No contacts found."}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Try adjusting your search or add a new contact."})]})]})})]}),u.jsx(JD,{isOpen:t,onClose:y,onSave:j,contactToEdit:s}),u.jsx(_n,{open:_,title:"Conferma eliminazione",message:"Sei sicuro di voler eliminare questo contatto? Questa azione  irreversibile.",confirmLabel:"Elimina",cancelLabel:"Annulla",variant:"danger",onConfirm:L,onCancel:N})]})},tj=()=>u.jsxs("div",{className:"p-8",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Reports"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"View and generate reports for your trips."})]}),u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-8 text-center",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Coming Soon!"}),u.jsx("p",{className:"text-gray-500 mt-2",children:"The reports functionality is currently under development."})]})]}),aj=`PENALI, RIMBORSI E ASSICURAZIONI

PENALI
Dal 19 Luglio alla data partenza in caso di cancellazione la penale applicata sar pari al 100% della quota.

RIMBORSI
Nessun rimborso verr riconosciuto per mancata presentazione alla partenza, per interruzione del viaggio iniziato qualsiasi ne sia il motivo o la ragione, per mancanza o per irregolarit dei documenti personali, come nessuna responsabilit compete a SaraRosso Incentive per le situazioni sopracitate.

Assicurazione viaggio medico/bagaglio Nobis inclusa:
Massimale bagaglio di   1.500,00;
Massimale di  50.000,00 per spese mediche, farmaceutiche ed ospedaliere

POLIZZA FACOLTATIVA SPESE MEDICHE E ANNULLAMENTO

Puoi stipulare la polizza pi adatta alle tue esigenze contattando: emissioni@clikki.it

Usufruendo dello sconto riservato. Ricordiamo che un'eventuale polizza annullamento va stipulata almeno 30 giorni prima della partenza (prego notare che levento che impedisce la partecipazione al viaggio deve essere imprevedibile, documentabile, non conosciuto al momento della prenotazione e non dipendente dalla volont dellassicurato).`,rj=`TERMINI SPECIFICI PER IL VIAGGIO A IBIZA

CLAUSOLA METEO
In caso di condizioni meteorologiche avverse che impediscano le attivit in barca, verranno proposte attivit alternative a terra di pari valore. Non sono previsti rimborsi monetari.

ASSICURAZIONE AGGIUNTIVA
 fortemente consigliata la stipula di un'assicurazione aggiuntiva per la copertura di attivit sportive acquatiche. L'organizzazione non si assume responsabilit per incidenti derivanti da tali attivit.`,wv=e=>e.replace(/emissioni@clikki\.it/g,'<a href="mailto:emissioni@clikki.it">emissioni@clikki.it</a>').split(`

`).map(t=>`<p>${t.replace(/\n/g,"<br />")}</p>`).join(""),nj=[{id:"1",title:"Termini e Condizioni",trip:null,content:wv(aj)},{id:"2",title:"Termini e Condizioni",trip:"Trip to Ibiza",content:wv(rj)}],ij=["Trip to Ibiza","Sales Kick-off Dubai","Team Retreat Mykonos"],Nc=({command:e,title:a,children:t,applyFormat:i})=>u.jsx("button",{type:"button",onMouseDown:s=>s.preventDefault(),onClick:()=>i(e),className:"p-2 rounded hover:bg-gray-200",title:a,children:t}),sj=({editorRef:e})=>{const a=(t,i=null)=>{e.current&&e.current.focus(),document.execCommand(t,!1,i)};return u.jsxs("div",{className:"flex items-center space-x-1 p-2 bg-gray-100 border border-b-0 border-gray-300 rounded-t-lg text-gray-700",children:[u.jsx(Nc,{command:"bold",title:"Bold",applyFormat:a,children:u.jsx("strong",{className:"font-bold w-5 text-center",children:"B"})}),u.jsx(Nc,{command:"italic",title:"Italic",applyFormat:a,children:u.jsx("em",{className:"italic w-5 text-center",children:"I"})}),u.jsx(Nc,{command:"underline",title:"Underline",applyFormat:a,children:u.jsx("u",{className:"underline w-5 text-center",children:"U"})}),u.jsx("span",{className:"w-px h-5 bg-gray-300 mx-2"}),u.jsx(Nc,{command:"insertUnorderedList",title:"Bulleted List",applyFormat:a,children:u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})}),u.jsx(Nc,{command:"insertOrderedList",title:"Numbered List",applyFormat:a,children:u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{d:"M10 3a1 1 0 00-1 1v1.333H5.333a1 1 0 100 1.334h3.667v1.333H5.333a1 1 0 100 1.334h3.667v1.333H5.333a1 1 0 100 1.334H9V16a1 1 0 102 0v-1.333h3.667a1 1 0 100-1.334h-3.667v-1.333h3.667a1 1 0 100-1.334h-3.667V8.667h3.667a1 1 0 100-1.334H11V4a1 1 0 00-1-1z",clipRule:"evenodd",fillRule:"evenodd"})})})]})},lj=({documentToEdit:e,onClose:a,onSave:t,globalDocExists:i})=>{const[s,c]=ce.useState(""),[f,d]=ce.useState(null),h=ce.useRef(null);ce.useEffect(()=>{if(e)c(e.title),d(e.trip);else{const v=!i,y=v?null:ij[0];c("Termini e Condizioni"),d(y)}},[e,i]);const m=()=>{var y;const v=((y=h.current)==null?void 0:y.innerHTML)||"";t({id:e==null?void 0:e.id,title:s,trip:f,content:v})};return e==null||e.trip,u.jsxs("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300 animate-fade-in",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale",children:[u.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:e?"Modifica Documento":"Crea Nuovo Documento"}),u.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(yn,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto space-y-6",children:[u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titolo Documento"}),u.jsx("input",{type:"text",value:s,onChange:v=>c(v.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]})}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contenuto"}),u.jsx(sj,{editorRef:h}),u.jsx("div",{ref:h,contentEditable:!0,dangerouslySetInnerHTML:{__html:(e==null?void 0:e.content)||""},className:`w-full p-4 text-gray-800 leading-relaxed 
        [&_p]:mb-4 [&_a]:text-blue-600 [&_a:hover]:underline
        [&_ul]:list-disc [&_ul]:pl-8 [&_ol]:list-decimal [&_ol]:pl-8 border border-gray-300 rounded-b-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition bg-white min-h-[250px]`})]})]}),u.jsxs("footer",{className:"flex justify-end items-center space-x-4 p-5 bg-gray-50 border-t border-gray-200 rounded-b-xl",children:[u.jsx("button",{onClick:a,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Annulla"}),u.jsx("button",{onClick:m,className:"bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Salva Documento"})]})]}),u.jsx("style",{children:`
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                @keyframes fadeInScale { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
                .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; }
                .animate-fade-in-scale { animation: fadeInScale 0.2s ease-out forwards; }
            `})]})},cj=({documents:e,setDocuments:a})=>{const[t,i]=ce.useState(!1),[s,c]=ce.useState(null),[f,d]=ce.useState(!1),h=ce.useMemo(()=>e.some(N=>N.trip===null),[e]);ce.useEffect(()=>{let N=!0;return(async()=>{d(!0);const V=await Lo();if(!N)return;const M=V.map((K,J)=>({id:String(K._id??K.id??`terms-${J}`),title:K.title??K.label??"",trip:K.trip??null,content:K.content??""})),k=new Set,W=M.filter(K=>k.has(K.id)?!1:(k.add(K.id),!0));a(W),d(!1)})(),()=>{N=!1}},[a]);const m=()=>{c(null),i(!0)},p=N=>{c(N),i(!0)},[v,y]=ce.useState(!1),[_,w]=ce.useState(null),b=N=>{w(N),y(!0)},T=async()=>{_!==null&&await Qw(_)&&a(j=>j.filter(V=>V.id!==_)),y(!1),w(null)},C=()=>{y(!1),w(null)},L=async N=>{if(N.id){const j=await $w(N.id,{title:N.title,trip:N.trip,content:N.content});j&&a(V=>V.map(M=>M.id===N.id?{...M,title:j.title??N.title,trip:j.trip??N.trip,content:j.content??N.content}:M))}else if(await Uv({title:N.title,content:N.content,trip:N.trip})){const M=(await Lo()).map(k=>({id:k._id??k.id??"",title:k.title??"",trip:k.trip??null,content:k.content??""}));a(M)}i(!1),c(null)};return u.jsxs(u.Fragment,{children:[t&&u.jsx(lj,{documentToEdit:s,onClose:()=>i(!1),onSave:L,globalDocExists:h}),u.jsx(_n,{open:v,title:"Conferma eliminazione",message:"Sei sicuro di voler eliminare questo documento? Questa azione  irreversibile.",confirmLabel:"Elimina",cancelLabel:"Annulla",variant:"danger",onConfirm:T,onCancel:C}),u.jsxs("div",{className:"p-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Terms & Conditions"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Manage global and trip-specific terms and conditions."})]}),u.jsxs("button",{onClick:m,className:"bg-blue-500 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center",children:[u.jsx(fs,{className:"w-5 h-5 mr-2"}),"Create New Document"]})]}),u.jsxs("div",{className:"space-y-4",children:[e.map((N,j)=>u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:N.title}),u.jsx("p",{className:`text-sm ${N.trip?"text-gray-500":"text-blue-600 font-medium"}`,children:N.trip?`Specifico per: ${N.trip}`:"Documento Globale"})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("button",{onClick:()=>p(N),className:"p-2 text-gray-500 hover:text-gray-700 rounded-md transition-colors hover:bg-gray-100","aria-label":"Edit document",children:u.jsx(vn,{className:"w-5 h-5"})}),N.trip!==null&&u.jsx("button",{onClick:()=>b(N.id),className:"p-2 text-red-500 hover:text-red-700 rounded-md transition-colors hover:bg-red-100","aria-label":"Delete document",children:u.jsx(cn,{className:"w-5 h-5"})})]})]},N.id||`terms-${j}`)),e.length===0&&u.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl shadow-sm",children:[u.jsx("h3",{className:"text-xl font-medium text-gray-700",children:"Nessun documento trovato."}),u.jsx("p",{className:"text-gray-500 mt-2",children:"Inizia creando un nuovo documento."})]})]})]})]})},Sv=({label:e,children:a})=>u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),a]}),oj=e=>u.jsx("input",{...e,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition read-only:bg-gray-100 read-only:cursor-not-allowed"}),fj=e=>u.jsx("textarea",{...e,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition read-only:bg-gray-100 read-only:cursor-not-allowed"}),r_="Trip to Ibiza",ch="31 Luglio, 2026",uj="il nostro team di supporto",dj="support@example.com",hj="Il Team Organizzativo",mj="IncentiveTravel",Ev=` ULTIMO PROMEMORIA: Completa la tua Registrazione al ${r_}  Scadenza ${ch}`,Tv=`Ciao [Nome del Destinatario],

Ti scriviamo come cortese sollecito per ricordarti di completare la tua registrazione per il ${r_}.

La tua scheda di adesione non  ancora stata finalizzata. Ti preghiamo di farlo entro e non oltre la data di scadenza perentoria del ${ch} per assicurarti il tuo posto.

Per completare la tua iscrizione, segui questo link:

[LINK ALLA SCHEDA DI ADESIONE]

Perch  Importante agire Ora:
La compilazione tempestiva della scheda  cruciale per poter procedere con le prenotazioni logistiche fondamentali, quali:

Biglietteria Aerea: Emissione del tuo biglietto.
Alloggi: Prenotazione definitiva della tua sistemazione.
Esperienze: Conferma della tua partecipazione alle attivit esclusive in programma.

Dopo la scadenza del ${ch}, purtroppo non saremo pi in grado di garantire la tua partecipazione a causa delle tempistiche di prenotazione richieste dai fornitori.

Se hai gi inviato la scheda, ti preghiamo di ignorare questo messaggio. Se invece stai riscontrando problemi tecnici, rispondi a questa email o contatta ${uj} al ${dj}.

Non vediamo l'ora di averti a bordo!

Cordiali saluti,

${hj}
${mj}`,xj=({isOpen:e,onClose:a,onSend:t,participantCount:i})=>{const[s,c]=ce.useState(!1),[f,d]=ce.useState(Ev),[h,m]=ce.useState(Tv);return ce.useEffect(()=>{e&&(c(!1),d(Ev),m(Tv))},[e]),e?u.jsxs("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300 animate-fade-in",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale",children:[u.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Invia Reminder"}),u.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(yn,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[u.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["Stai per inviare una mail di promemoria a ",u.jsx("span",{className:"font-bold",children:i})," partecipante/i. ",s?"Modifica il testo qui sotto.":'Controlla il testo qui sotto o clicca "Modifica" per personalizzarlo.']}),u.jsxs("div",{className:"space-y-4",children:[u.jsx(Sv,{label:"Oggetto",children:u.jsx(oj,{value:f,onChange:p=>d(p.target.value),readOnly:!s})}),u.jsx(Sv,{label:"Corpo della Mail",children:u.jsx(fj,{value:h,onChange:p=>m(p.target.value),rows:18,readOnly:!s})})]})]}),u.jsxs("footer",{className:"flex justify-end items-center space-x-4 p-5 bg-gray-50 border-t border-gray-200 rounded-b-xl",children:[u.jsx("button",{onClick:a,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Annulla"}),s?u.jsx("button",{onClick:()=>c(!1),className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Fine"}):u.jsx("button",{onClick:()=>c(!0),className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Modifica"}),u.jsx("button",{onClick:()=>t(f,h),className:"bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Invia Reminder"})]})]}),u.jsx("style",{children:`
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
                @keyframes fadeInScale {
                    from { transform: scale(0.95); opacity: 0; }
                    to { transform: scale(1); opacity: 1; }
                }
                .animate-fade-in {
                    animation: fadeIn 0.2s ease-out forwards;
                }
                .animate-fade-in-scale {
                    animation: fadeInScale 0.2s ease-out forwards;
                }
            `})]}):null},Nv=`OGGETTO: INVITO RISERVATO E PERSONALE

Bergamo, 12 Giugno 2025

Oggetto: Meeting Beverage Network 2025
 
Caro Enrico,

Come nostra consuetudine e tradizione siamo pronti per il meeting autunnale. Un momento molto importante durante il quale la grande famiglia Beverage Network si ritrova ed insieme incontra i suoi partner industriali pi rilevanti.  

Per questo motivo e con grande entusiasmo ho il piacere di invitarTi al meeting che si terr dal 6 al 10 Novembre 2025 ad Abu Dhabi, la perla scintillante del Golfo, dove si incontrano lusso e tradizione, passato e futuro.

Mi auguro di poter trascorrere insieme questo periodo in un clima ed un'atmosfera serena ispirati dallenergia innovativa della Capitale degli Emirati. Come di consueto alterneremo relax e convivialit ad importanti spazi dedicati al nostro lavoro.

Parteciperanno anche quest'anno i nostri partner industriali pi rilevanti.  

L'invito  strettamente personale e non cedibile. Ricordo che per un eventuale accompagnatore abbiamo previsto un contributo sulla quota di partecipazione. 

La quota sar diversa per eventuali ulteriori partecipanti o aggregati esterni non operativi in azienda. Per questo dovr essere richiesto oltre che il preventivo anche la disponibilit alla sede Beverage Network che vi informer dettagliatamente in base alla capienza.  

In allegato troverai tutte le necessarie informazioni per soci, affiliati ed accompagnatori.  La scheda di adesione on-line (necessaria per ogni partecipante) dovr essere compilata tassativamente cliccando al seguente link entro e non oltre il 18 Luglio 2025.  

[LINK ALLA SCHEDA DI ADESIONE]

Nellattesa di incontrarTi in questo importante appuntamento, l'occasione mi  gradita per porgere a titolo personale, dellintero consiglio di amministrazione e dei nostri pi stretti collaboratori il pi cordiale Arrivederci nell'oasi di bellezza ed innovazione nel cuore del deserto: Abu Dhabi!

 
Beverage Network 

Societ Consortile a responsabilit limitata
Il Presidente
Antonio Portaccio`,pj=({isOpen:e,onClose:a,onSend:t,tripName:i,inviteeCount:s,initialBody:c})=>{const[f,d]=ce.useState(!1),[h,m]=ce.useState(c||Nv),[p,v]=ce.useState(!1),[y,_]=ce.useState(!1);return ce.useEffect(()=>{e&&(d(!1),m(c||Nv))},[e,c]),e?u.jsxs("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300 animate-fade-in",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale",children:[u.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Conferma Invio Inviti"}),u.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(yn,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[u.jsxs("p",{className:"text-gray-600 mb-4",children:["Stai per inviare ",u.jsx("span",{className:"font-bold text-gray-800",children:s})," inviti per il viaggio ",u.jsxs("span",{className:"font-bold text-gray-800",children:['"',i,'"']}),"."]}),u.jsx("p",{className:"text-gray-600 mb-6",children:"Vuoi procedere?"}),u.jsxs("div",{className:"bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded-lg flex items-start",children:[u.jsx(Iv,{className:"w-5 h-5 mr-3 mt-0.5 flex-shrink-0"}),u.jsx("p",{className:"text-sm",children:"Una volta inviati, i partecipanti riceveranno una mail con il link per la registrazione. Questa azione non pu essere annullata."})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("h3",{className:"text-xs font-semibold uppercase text-gray-500 mb-2",children:"Anteprima Email"}),u.jsx("textarea",{value:h,onChange:w=>m(w.target.value),rows:15,readOnly:!f,className:"w-full p-4 font-sans text-sm bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition read-only:bg-gray-100 read-only:cursor-not-allowed","aria-label":"Email content"})]}),u.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[u.jsx("input",{id:"saveTemplate",type:"checkbox",checked:y,onChange:w=>_(w.target.checked),className:"h-4 w-4"}),u.jsx("label",{htmlFor:"saveTemplate",className:"text-sm text-gray-700",children:"Salva come template per questo viaggio"})]})]}),u.jsxs("footer",{className:"flex justify-end items-center space-x-4 p-5 bg-gray-50 border-t border-gray-200 rounded-b-xl",children:[u.jsx("button",{onClick:a,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Annulla"}),f?u.jsx("button",{onClick:()=>d(!1),disabled:p,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Fine"}):u.jsx("button",{onClick:()=>d(!0),disabled:p,className:"bg-white border border-gray-300 text-gray-800 font-semibold px-5 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Modifica"}),u.jsx("button",{onClick:async()=>{if(!p){v(!0);try{await t(h,y)}catch{}finally{v(!1)}}},disabled:p,className:"bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-70 disabled:cursor-not-allowed",children:p?"Invio in corso...":"Conferma e Invia"})]})]}),u.jsx("style",{children:`
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
                @keyframes fadeInScale {
                    from { transform: scale(0.95); opacity: 0; }
                    to { transform: scale(1); opacity: 1; }
                }
                .animate-fade-in {
                    animation: fadeIn 0.2s ease-out forwards;
                }
                .animate-fade-in-scale {
                    animation: fadeInScale 0.2s ease-out forwards;
                }
            `})]}):null},gj=()=>{const[e,a]=ce.useState([]),[t,i]=ce.useState(!1),[s,c]=ce.useState(!1),[f,d]=ce.useState(!1),[h,m]=ce.useState(null),p=async()=>{i(!0);try{const _=await Yd();_&&_.length&&a(_.map(w=>({id:w.value,title:w.label,value:w.value,label:w.label})))}catch(_){console.error("Failed to load documents",_)}i(!1)};ce.useEffect(()=>{p()},[]);const v=_=>{m(_),d(!0)},y=async()=>{if(!h)return d(!1);try{if(await eS(h)){a(w=>w.filter(b=>b.id!==h));try{window.dispatchEvent(new CustomEvent("documents:changed",{detail:{action:"delete",id:h}}))}catch{}}else alert("Errore durante l'eliminazione")}catch(_){console.error("Delete failed",_),alert("Errore durante l'eliminazione")}d(!1),m(null)};return u.jsxs("div",{className:"p-8",children:[u.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Documents"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Manage and view trip-related documents."})]}),u.jsx("div",{children:u.jsx("button",{onClick:()=>c(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg",children:"Create Document"})})]}),u.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:u.jsx("div",{className:"p-4",children:t?u.jsx("div",{children:"Loading..."}):u.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[u.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3",children:"Title"}),u.jsx("th",{className:"px-4 py-3",children:"ID"}),u.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),u.jsx("tbody",{children:e.map(_=>u.jsxs("tr",{className:"border-b last:border-b-0 hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:_.title}),u.jsx("td",{className:"px-4 py-3",children:_.id}),u.jsx("td",{className:"px-4 py-3 text-right",children:u.jsxs("div",{className:"inline-flex items-center space-x-2",children:[u.jsx("button",{onClick:async()=>{const w=await Jw(_.id);try{window.__E2E_lastOpenDoc=w||null}catch{}c(!0)},className:"text-gray-600 hover:text-gray-800 px-2 py-1 rounded",children:"Edit"}),u.jsx("button",{onClick:()=>v(_.id),className:"text-red-600 hover:text-red-800 px-2 py-1 rounded",children:"Delete"})]})})]},_.id))})]})})}),u.jsx(zv,{open:s,onCreated:_=>{c(!1),p();try{window.dispatchEvent(new CustomEvent("documents:changed",{detail:{action:"create",doc:_}}))}catch{}},onClose:()=>c(!1)}),u.jsx(_n,{open:f,title:"Conferma eliminazione",message:"Sei sicuro di voler eliminare questo documento?",confirmLabel:"Elimina",cancelLabel:"Annulla",variant:"danger",onConfirm:y,onCancel:()=>d(!1)})]})},vj=[{id:"2",destinationName:"Ibiza",country:"Spagna",dateAdded:"15 Mag, 2026",fullData:{destinationName:"Ibiza",country:"Spagna",documents:"Passport or valid ID card required for EU citizens.",timeZone:"GMT+2 (same as Italy during summer).",currency:"Euro ().",language:"Spanish and Catalan. English and Italian are widely spoken.",climate:"Mediterranean climate, hot summers and mild winters.",vaccinationsHealth:"No specific vaccinations required. European Health Insurance Card (EHIC) is recommended."}},{id:"3",destinationName:"Mykonos",country:"Grecia",dateAdded:"01 Dic, 2025",fullData:{destinationName:"Mykonos",country:"Grecia",documents:"Passport or valid ID card required for EU citizens.",timeZone:"GMT+3 (1 hour ahead of Italy).",currency:"Euro ().",language:"Greek. English is widely spoken in tourist areas.",climate:"Mediterranean climate, known for being windy (Meltemi).",vaccinationsHealth:"No specific vaccinations required. European Health Insurance Card (EHIC) is recommended."}},{id:"1",destinationName:"Abu Dhabi",country:"Emirati Arabi Uniti",dateAdded:"22 Lug, 2026",fullData:{destinationName:"Abu Dhabi",country:"Emirati Arabi Uniti",documents:"Entry into the Emirates only requires a passport with a minimum validity of 6 months. No visa is needed for EU citizens for stays up to 90 days.",timeZone:"The time difference is GMT+3, which is 3 hours ahead of Italian time (2 hours when daylight saving time is in effect).",currency:"The Emirati Dirham (AED) is worth approximately 0.25. Major credit cards are accepted everywhere.",language:"The official language is Arabic. English is understood and widely spoken in tourist areas.",climate:"The climate in the United Arab Emirates is subtropical and arid. Rain is rare. The best time to visit is from October to April when temperatures are milder.",vaccinationsHealth:"No mandatory vaccinations are required. Medicines are readily available in numerous pharmacies."}}],yj=({informations:e,setInformations:a})=>{const[t,i]=ce.useState(!1),[s,c]=ce.useState(null),[f,d]=ce.useState(null),h=f,m=()=>{c(null),d(null),i(!0)},p=async j=>{c(j.id),d(null),i(!0);try{const V=await fetch(`http://localhost:5001/api/useful-informations/${j.id}`);if(!V.ok)throw new Error(`Failed to fetch useful info ${j.id}`);const M=await V.json();d(M.usefulInfo||null)}catch(V){console.error("Failed to load full useful info for editing",V)}},v=()=>{i(!1),c(null),d(null)},[y,_]=ce.useState(!1),[w,b]=ce.useState(null),T=j=>{b(j),_(!0)},C=async()=>{if(w!==null)try{if(!(await fetch(`http://localhost:5001/api/useful-informations/${w}`,{method:"DELETE"})).ok)throw new Error("Delete failed");a(V=>V.filter(M=>M.id!==w))}catch(j){console.error("Failed to delete useful info",j)}finally{_(!1),b(null)}},L=()=>{_(!1),b(null)},N=async j=>{var V,M;if(s!==null)try{const k=await fetch(`http://localhost:5001/api/useful-informations/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({usefulInfo:j,title:j.destinationName,content:""})});if(!k.ok)throw new Error("Update failed");const W=await k.json();a(K=>K.map(J=>{var Z,Q,re;return J.id===s?{id:String(W._id||W.id||s),destinationName:((Z=W.usefulInfo)==null?void 0:Z.destinationName)||j.destinationName,country:((Q=W.usefulInfo)==null?void 0:Q.country)||j.country,dateAdded:((re=K.find(ue=>ue.id===s))==null?void 0:re.dateAdded)||new Date().toLocaleDateString("it-IT"),fullData:W.usefulInfo||j}:J}))}catch(k){console.error("Failed to update useful info",k)}finally{v()}else try{const W={title:j.destinationName&&j.destinationName.trim()||j.country&&j.country.trim()||j.documents&&String(j.documents).split(`
`)[0].slice(0,60)||"Untitled Useful Information",usefulInfo:j,content:""};console.debug("Creating useful info with payload:",W);const K=await fetch("http://localhost:5001/api/useful-informations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(W)});if(!K.ok)throw new Error("Create failed");const J=await K.json(),Z={id:String(J._id||J.id||Date.now()),destinationName:((V=J.usefulInfo)==null?void 0:V.destinationName)||j.destinationName,country:((M=J.usefulInfo)==null?void 0:M.country)||j.country,dateAdded:new Date(J.createdAt||Date.now()).toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"numeric"}).replace(".",""),fullData:J.usefulInfo||j};a(Q=>[Z,...Q])}catch(k){console.error("Failed to create useful info",k)}finally{v()}};return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-8",children:[u.jsxs("header",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Useful Informations"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Manage useful travel information for participants."})]}),u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Fi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search information...",className:"pl-10 pr-4 py-2 w-72 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]}),u.jsx("button",{onClick:m,className:"bg-blue-500 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Create New Useful Information"})]})}),u.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[u.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Destination Name"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Country"}),u.jsx("th",{scope:"col",className:"px-6 py-4",children:"Date Added"}),u.jsx("th",{scope:"col",className:"px-6 py-4 text-right",children:"Actions"})]})}),u.jsx("tbody",{children:e.map(j=>u.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[u.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap",children:j.destinationName}),u.jsx("td",{className:"px-6 py-4",children:j.country}),u.jsx("td",{className:"px-6 py-4",children:j.dateAdded}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[u.jsx("button",{onClick:()=>p(j),className:"p-1.5 text-gray-500 hover:text-gray-700 rounded-md transition-colors hover:bg-gray-100","aria-label":"Edit information",children:u.jsx(vn,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>T(j.id),className:"p-1.5 text-red-500 hover:text-red-700 rounded-md transition-colors hover:bg-red-100","aria-label":"Delete information",children:u.jsx(cn,{className:"w-4 h-4"})})]})})]},j.id))})]})})})]}),u.jsx(Yv,{isOpen:t,onClose:v,onSave:N,infoToEdit:h}),u.jsx(_n,{open:y,title:"Conferma eliminazione",message:"Sei sicuro di voler eliminare questa informazione? Questa azione  irreversibile.",confirmLabel:"Elimina",cancelLabel:"Annulla",variant:"danger",onConfirm:C,onCancel:L})]})},_j=[{id:1,tripName:"Sales Kick-off Dubai",sender:"Team Eventi",subject:"Invito Esclusivo: Sales Kick-off 2026",body:`Gentile Collega,

Siamo lieti di invitarti al Sales Kick-off 2026 che si terr a Dubai.

Per favore conferma la tua presenza compilando il form.

Cordiali saluti,
Team Eventi`,status:"Ready",lastModified:"15 Ott, 2025"},{id:2,tripName:"Trip to Ibiza",sender:"HR Department",subject:"Your Ticket to Ibiza!",body:`Hola!

Get ready for an amazing trip to Ibiza. We have planned exciting activities for the team.

Please register using the link below.

Best,
HR Team`,status:"Draft",lastModified:"20 Set, 2025"}],bj=[{id:"IBZ2026",name:"Trip to Ibiza"},{id:"DXB2026",name:"Sales Kick-off Dubai"},{id:"MYK2025",name:"Team Retreat Mykonos"},{id:"ASP2025",name:"Ski Trip to Aspen"}],Ro=({label:e,required:a,children:t,className:i})=>u.jsxs("div",{className:i,children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e," ",a&&u.jsx("span",{className:"text-red-500",children:"*"})]}),t]}),Av=e=>u.jsx("input",{...e,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}),wj=e=>u.jsx("textarea",{...e,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${e.className||""}`}),Sj=({children:e,value:a,onChange:t})=>u.jsxs("div",{className:"relative",children:[u.jsx("select",{value:a,onChange:t,className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition appearance-none pr-8",children:e}),u.jsx(us,{className:"w-5 h-5 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"})]}),Ej=({invites:e=_j,onSave:a,onDelete:t})=>{const[i,s]=ce.useState("list"),[c,f]=ce.useState(""),[d,h]=ce.useState(null),[m,p]=ce.useState({tripName:"",sender:"",subject:"",body:""}),v=()=>{p({tripName:"",sender:"",subject:"",body:""}),h(null),s("create")},y=M=>{p({tripName:M.tripName,sender:M.sender,subject:M.subject,body:M.body}),h(M.id),s("edit")},[_,w]=ce.useState(!1),[b,T]=ce.useState(null),C=Oi(),L=M=>{T(M),w(!0)},N=()=>{if(!m.tripName||!m.sender||!m.subject||!m.body){console.log("[Invites] validation failed - empty fields"),C.showToast("Compila tutti i campi obbligatori.","error");return}const M=new Date().toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"numeric"}),k={id:d||String(Date.now()),...m,status:"Draft",lastModified:M};a&&a(k),s("list");try{C.showToast("Template salvato con successo.","success")}catch(W){console.error("Toast error",W)}},j=e.filter(M=>M.tripName.toLowerCase().includes(c.toLowerCase())||M.subject.toLowerCase().includes(c.toLowerCase())),V=M=>{switch(M){case"Ready":return"bg-green-100 text-green-800";case"Sent":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return i==="list"?u.jsxs("div",{className:"p-8 animate-fade-in",children:[u.jsxs("header",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Invites"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Manage email invitation templates for your trips."})]}),u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Fi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search templates...",value:c,onChange:M=>f(M.target.value),className:"pl-10 pr-4 py-2 w-72 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"})]}),u.jsxs("button",{"data-testid":void 0,onClick:v,className:"bg-blue-500 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center",children:[u.jsx(fs,{className:"w-5 h-5 mr-2"}),"Create New Invite"]})]})}),u.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:u.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[u.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-4",children:"Trip Name"}),u.jsx("th",{className:"px-6 py-4",children:"Subject"}),u.jsx("th",{className:"px-6 py-4",children:"Sender"}),u.jsx("th",{className:"px-6 py-4",children:"Status"}),u.jsx("th",{className:"px-6 py-4",children:"Last Modified"}),u.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),u.jsxs("tbody",{children:[j.map(M=>u.jsxs("tr",{className:"bg-white border-b last:border-b-0 hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:M.tripName}),u.jsx("td",{className:"px-6 py-4",children:M.subject}),u.jsx("td",{className:"px-6 py-4",children:M.sender}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium ${V(M.status)}`,children:M.status})}),u.jsx("td",{className:"px-6 py-4",children:M.lastModified}),u.jsx("td",{className:"px-6 py-4 text-right",children:u.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[u.jsx("button",{"data-testid":void 0,onClick:()=>y(M),className:"p-1.5 text-gray-500 hover:text-gray-700 rounded-md hover:bg-gray-100",children:u.jsx(vn,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>L(M.id??M._id??""),className:"p-1.5 text-red-500 hover:text-red-700 rounded-md hover:bg-red-100",children:u.jsx(cn,{className:"w-4 h-4"})})]})})]},String(M.id??M._id??""))),j.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"No invites found. Create a new one to get started."})})]})]})}),u.jsx(_n,{open:_,title:"Eliminare template",message:"Sei sicuro di voler eliminare questo template?",confirmLabel:"Elimina",cancelLabel:"Annulla",onCancel:()=>{w(!1),T(null)},onConfirm:()=>{b!==null&&t&&t(b),w(!1),T(null)}})]}):u.jsxs("div",{className:"p-8 animate-fade-in",children:[u.jsxs("header",{className:"mb-8 flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:i==="create"?"Create Template":"Edit Template"}),u.jsx("p",{className:"text-gray-500 mt-1",children:"Design your email invitation."})]}),u.jsx("button",{"data-testid":void 0,onClick:()=>s("list"),className:"bg-white border border-gray-300 text-gray-700 font-semibold px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"Back to List"})]}),u.jsx("div",{className:"max-w-4xl mx-auto",children:u.jsx("div",{className:"bg-white p-8 rounded-2xl shadow-sm",children:u.jsxs("div",{className:"space-y-6",children:[u.jsx(Ro,{label:"Seleziona Viaggio",required:!0,children:u.jsxs(Sj,{value:m.tripName,onChange:M=>p({...m,tripName:M.target.value}),children:[u.jsx("option",{value:"",disabled:!0,children:"-- Seleziona un viaggio --"}),bj.map(M=>u.jsx("option",{value:M.name,children:M.name},M.id))]})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsx(Ro,{label:"Mittente",required:!0,children:u.jsx(Av,{placeholder:"e.g. Team Eventi",value:m.sender,onChange:M=>p({...m,sender:M.target.value})})}),u.jsx(Ro,{label:"Oggetto",required:!0,children:u.jsx(Av,{placeholder:"e.g. Invito Esclusivo: Sales Kick-off 2026",value:m.subject,onChange:M=>p({...m,subject:M.target.value})})})]}),u.jsxs(Ro,{label:"Corpo della mail",required:!0,children:[u.jsx(wj,{rows:12,placeholder:"Scrivi qui il contenuto dell'invito...",value:m.body,onChange:M=>p({...m,body:M.target.value})}),u.jsxs("div",{className:"mt-2 flex items-center text-xs text-gray-500 space-x-2",children:[u.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded border border-gray-200",children:"[NOME_PARTECIPANTE]"}),u.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded border border-gray-200",children:"[LINK_REGISTRAZIONE]"}),u.jsx("span",{children:"verranno sostituiti automaticamente."})]})]})]})})}),u.jsxs("footer",{className:"mt-8 pt-6 border-t border-gray-200 flex justify-end items-center space-x-4",children:[u.jsx("button",{className:"bg-white border border-gray-300 text-gray-700 font-semibold px-6 py-2.5 rounded-lg hover:bg-gray-50 transition-colors",children:"Invia Test"}),u.jsx("button",{"data-testid":void 0,onClick:N,className:"bg-blue-600 text-white font-semibold px-6 py-2.5 rounded-lg hover:bg-blue-700 transition-colors",children:"Salva Template"})]})]})},Tj=[{id:1,firstName:"Mario",lastName:"Rossi",category:"Tour Leader",phone:"+39 123 456789",email:"m.rossi@example.com",notes:"Referente h24 per il gruppo Milano"},{id:2,firstName:"Laura",lastName:"Verdi",category:"Assistenza Aeroportuale",phone:"+39 987 654321",email:"l.verdi@example.com",notes:"Presente in aeroporto Malpensa per partenze e arrivi"},{id:3,firstName:"Giuseppe",lastName:"Bianchi",category:"Assistenza Hotel",phone:"+39 456 123789",email:"g.bianchi@example.com",notes:"Contatto in hotel per check-in e check-out"}],Nj=[{id:1,name:"Dietary Restrictions & Allergies",trip:"Trip to Ibiza",responses:"65/80"},{id:2,name:"Activity Preferences",trip:"Sales Kick-off Dubai",responses:"80/85"},{id:3,name:"Post-Trip Feedback",trip:"Team Retreat Mykonos",responses:"145/150"}],Aj=()=>{const[e,a]=ce.useState("dashboard"),[t,i]=ce.useState("hidden"),[s,c]=ce.useState(!1),[f,d]=ce.useState("hidden"),[h,m]=ce.useState(null),[p,v]=ce.useState(void 0),[y,_]=ce.useState(!1),[w,b]=ce.useState(0),[T,C]=ce.useState(null),[L,N]=ce.useState(!1),[j,V]=ce.useState(null),[M,k]=ce.useState(vj),[W,K]=ce.useState(nj),[J,Z]=ce.useState([]),[Q,re]=ce.useState(Tj),[ue,ve]=ce.useState(Nj),[ee,G]=ce.useState([]),[ae,R]=ce.useState([]),se=jv();Ia.useEffect(()=>{(async()=>{try{const[Be,Ue]=await Promise.all([fetch("http://localhost:5001/api/invites"),fetch("http://localhost:5001/api/participants")]);if(Be.ok){const He=await Be.json();G(He.map(Fe=>({...Fe,id:Fe._id??Fe.id})))}if(Ue.ok){const He=await Ue.json();R(He.map(Fe=>({...Fe,id:Fe._id??Fe.id})))}}catch(Be){console.error("Error loading admin data",Be)}try{const Be=await fetch("http://localhost:5001/api/forms");if(Be.ok){const Ue=await Be.json(),He=Ue.items||Ue;ve(He.map(Fe=>({id:Fe._id??Fe.id,name:Fe.title||Fe.name||"Untitled Form",description:Fe.description||"",trip:"",responses:"",status:Fe.status||"draft"})))}}catch(Be){console.error("Error loading forms",Be)}try{const Be=await fetch("http://localhost:5001/api/privacy-policies");if(Be.ok){const Ue=await Be.json();Z(Ue.map(He=>({id:He._id??He.id,title:He.title,trip:He.trip??null,content:He.content||""})))}}catch(Be){console.error("Error loading privacy policies",Be)}try{const Be=await fetch("http://localhost:5001/api/useful-informations/summary");if(Be.ok){const Ue=await Be.json(),He=Ue.items||Ue;k(He.map(Fe=>({id:Fe.id??Fe._id??Fe._id,destinationName:Fe.title||"",country:"",dateAdded:new Date(Fe.createdAt).toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"numeric"}).replace(".",""),fullData:{}})))}}catch(Be){console.error("Error loading useful informations",Be)}})()},[]);const A=()=>i("create"),E=()=>i("edit"),O=()=>i("hidden"),B=()=>{i("hidden")},z=Pe=>{v(Pe),c(!0)},le=()=>{c(!1),v(void 0)},ye=()=>{c(!1),v(void 0)},Ne=()=>d("create"),Te=()=>d("hidden"),De=async Pe=>{try{const Be=String(Pe),Ue=await fetch(`http://localhost:5001/api/forms/${Be}`);if(!Ue.ok)throw new Error("Fetch form failed");const He=await Ue.json();m(He),d("edit")}catch(Be){console.error("Load form for edit failed",Be),se.push("Impossibile caricare il form per la modifica.","error")}},Ve=async Pe=>{try{const Be=String(Pe),Ue=await fetch(`http://localhost:5001/api/forms/${Be}`,{method:"DELETE"});if(!Ue.ok&&Ue.status!==204)throw new Error("Delete failed");ve(He=>He.filter(Fe=>String(Fe.id)!==Be)),se.push("Form eliminato.","success")}catch(Be){console.error("Delete form error",Be),se.push("Errore durante la cancellazione del form.","error")}},q=async Pe=>{try{const Be=String(Pe),Ue=await fetch(`http://localhost:5001/api/forms/${Be}`);if(!Ue.ok)throw new Error("Fetch form failed");const He=await Ue.json(),Fe={title:`${He.title||He.name||"Untitled Form"} (copy)`,description:He.description||He.desc||"",sections:He.sections||[],status:"draft"},Je=await fetch("http://localhost:5001/api/forms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});if(!Je.ok)throw new Error("Clone failed");const mt=await Je.json(),et={id:mt._id??mt.id,name:mt.title??mt.name??"Untitled Form",trip:"",responses:"",status:mt.status||"draft"};ve(_t=>[et,..._t]),se.push("Form clonato.","success")}catch(Be){console.error("Clone form error",Be),se.push("Errore durante la clonazione del form.","error")}},ct=Pe=>{if(!Pe)return;const Be={id:Pe._id??Pe.id,name:Pe.title??Pe.name??"Untitled Form",description:Pe.description||"",trip:"",responses:"",status:Pe.status||"draft"},Ue=ue.some(He=>String(He.id)===String(Be.id));ve(Ue?He=>He.map(Fe=>String(Fe.id)===String(Be.id)?Be:Fe):He=>[Be,...He]),d("hidden"),m(null)},We=async Pe=>{try{if(ee.some(Ue=>String(Ue.id)===String(Pe.id))){const Ue=String(Pe.id),He=await fetch(`http://localhost:5001/api/invites/${Ue}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(!He.ok)throw new Error("Update invite failed");const Fe=await He.json(),Je={...Fe,id:Fe._id??Fe.id};G(mt=>mt.map(et=>String(et.id)===String(Je.id)?Je:et))}else{const Ue=await fetch("http://localhost:5001/api/invites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(!Ue.ok)throw new Error("Create invite failed");const He=await Ue.json(),Fe={...He,id:He._id??He.id};G(Je=>[Fe,...Je])}}catch(Be){console.error("Invite save error",Be),se.push("Errore durante il salvataggio del template. Vedi console per dettagli.","error")}},tt=async Pe=>{try{const Be=String(Pe),Ue=await fetch(`http://localhost:5001/api/invites/${Be}`,{method:"DELETE"});if(!Ue.ok&&Ue.status!==204)throw new Error("Delete failed");G(He=>He.filter(Fe=>String(Fe.id)!==Be))}catch(Be){console.error("Invite delete error",Be),se.push("Errore durante la cancellazione del template. Vedi console per dettagli.","error")}},qe=(Pe,Be)=>{b(Pe),Be&&C(()=>Be),_(!0)},Re=()=>{_(!1),b(0),C(null)},vt=(Pe,Be)=>{se.push(`Invio del promemoria a ${w} partecipanti in corso... Oggetto: ${Pe}`,"info"),T&&T(),Re()},Bt=(Pe,Be)=>{const Ue=ee.find(He=>He.tripName===Pe);V({tripName:Pe,inviteeCount:Be,emailBody:Ue?Ue.body:void 0}),N(!0)},Kt=()=>{N(!1),V(null)},Sa=async(Pe,Be)=>{if(!j)return;const{tripName:Ue,inviteeCount:He}=j;try{const Fe=await fetch("http://localhost:5001/api/invites/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tripName:Ue,emailBody:Pe})});if(!Fe.ok)throw new Error("Send failed");const Je=await Fe.json();if(se.push(`Invio completato: ${Je.sent} inviati, ${Je.failed} falliti`,"success"),Be)try{const mt=await fetch("http://localhost:5001/api/invites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tripName:Ue,body:Pe})});if(mt.ok){const et=await mt.json();V(_t=>_t&&{..._t,emailBody:Pe}),G(_t=>[{...et,id:et._id??et.id},..._t])}}catch(mt){console.error("Save template error",mt)}try{R(mt=>mt.map(et=>et.trip===Ue?{...et,status:"Invited"}:et)),await fetch("http://localhost:5001/api/participants/update-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tripName:Ue,status:"Invited"})})}catch(mt){console.error("Update participants status failed",mt)}}catch(Fe){console.error("Error sending invites",Fe),se.push("Errore durante l'invio degli inviti. Vedi console per dettagli.","error")}finally{Kt()}},Ar=Pe=>{i("hidden"),c(!1),d("hidden"),a(Pe)},ar=async Pe=>{try{if(ae.some(Ue=>String(Ue.id)===String(Pe.id))){const Ue=String(Pe.id);return fetch(`http://localhost:5001/api/participants/${Ue}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)}).then(async Fe=>{if(!Fe.ok)throw new Error("Update participant failed");const Je=await Fe.json();return R(mt=>mt.map(et=>String(et.id)===String(Je._id??Je.id)?{...Je,id:Je._id??Je.id}:et)),Je})}else return fetch("http://localhost:5001/api/participants",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)}).then(async He=>{if(!He.ok)throw new Error("Create participant failed");const Fe=await He.json();return R(Je=>[{...Fe,id:Fe._id??Fe.id},...Je]),Fe})}catch(Be){console.error("Participant save error",Be),se.push("Errore durante il salvataggio del partecipante. Vedi console.","error")}},bt=async Pe=>{try{const Be=String(Pe),Ue=await fetch(`http://localhost:5001/api/participants/${Be}`,{method:"DELETE"});if(!Ue.ok&&Ue.status!==204)throw new Error("Delete participant failed");R(He=>He.filter(Fe=>String(Fe.id)!==Be))}catch(Be){console.error("Participant delete error",Be),se.push("Errore durante la cancellazione del partecipante. Vedi console.","error")}},ya=()=>{if(t!=="hidden")return u.jsx(LS,{onCancel:O,onSave:B,isEditing:t==="edit"});if(s)return u.jsx(HS,{onCancel:le,onSave:ye,initialType:p});if(f!=="hidden"){const Pe=f==="edit";return u.jsx(MS,{onCancel:Te,onSave:Be=>ct(Be),isEditing:Pe,initialData:h,onDelete:Be=>{Ve(Be),d("hidden"),m(null)}})}switch(e){case"dashboard":return u.jsx(Wp,{onCreateTrip:A,onCreateCommunication:z,onSendReminder:qe,onSendInvites:Bt});case"manage-trip":return u.jsx(qw,{onCreateTrip:A,onEditTrip:E,onCreateCommunication:z});case"manage-contacts":return u.jsx(ej,{contacts:Q,setContacts:re});case"manage-participants":return u.jsx(KD,{participants:ae,onSendReminder:qe,onSendInvite:Bt,onSaveParticipant:ar,onDeleteParticipant:bt});case"invites":return u.jsx(Ej,{invites:ee,onSave:We,onDelete:tt});case"communications":return u.jsx(US,{onCreateCommunication:z});case"useful-informations":return u.jsx(yj,{informations:M,setInformations:k});case"forms":return u.jsx(VS,{onCreateForm:Ne,onEditForm:De,onDeleteForm:Ve,onCloneForm:q,forms:ue});case"privacy-policy":return u.jsx(ES,{documents:J,setDocuments:Z});case"terms-conditions":return u.jsx(cj,{documents:W,setDocuments:K});case"documents":return u.jsx(gj,{});case"reports":return u.jsx(tj,{});default:return u.jsx(Wp,{onCreateTrip:A,onCreateCommunication:z,onSendReminder:qe,onSendInvites:Bt})}};return u.jsx(Dv,{children:u.jsxs("div",{className:"bg-gray-100 min-h-screen flex",children:[u.jsx(zw,{activeView:e,setActiveView:Ar}),u.jsx("main",{className:"flex-1 h-screen overflow-y-auto",children:ya()}),u.jsx(xj,{isOpen:y,onClose:Re,onSend:vt,participantCount:w}),u.jsx(pj,{isOpen:L,onClose:Kt,onSend:Sa,tripName:(j==null?void 0:j.tripName)||"",inviteeCount:(j==null?void 0:j.inviteeCount)||0,initialBody:j==null?void 0:j.emailBody})]})})},kj=()=>u.jsx(Dv,{children:u.jsx(Aj,{})}),n_=document.getElementById("root");if(!n_)throw new Error("Could not find root element to mount to");const Cj=ww.createRoot(n_);Cj.render(u.jsx(Ia.StrictMode,{children:u.jsx(OS,{children:u.jsx(kj,{})})}));
